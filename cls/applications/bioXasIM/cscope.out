cscope 15 $HOME/git/testing/py27_qt5/py2.7/cls/applications/bioXasIM               0001031231
	@__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 
	gşs
:

4 
This
 
wl
 
hou£
 
®l
 
of
 
the
 
CªadŸn
 
Lightsourû
 
¥ecific
 
moduËs


6 
impÜt
 
os


7 
impÜt
 
time


8 
äom
 
d©‘ime
 
impÜt
 
d©e


9 
impÜt
 
bz2


11 
äom
 
şs
.
uts
.
log
 
impÜt
 
g‘_moduË_logg”
, 
	glog_to_cÚsŞe
, 
log_to_qt


12 
äom
 
	gşs
.
	g­pWidg‘s
.
impÜt
 
Enum


14 
	gabs_·th_to_tİ
 = 
os
.
·th
.
	$dœÇme
(
__fe__
)

15 
abs_·th_to_ši_fe
 = 
os
.
·th
.
	`dœÇme
(
__fe__
) + '/app.ini'

	@__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 
	gşs
:

4 
This
 
wl
 
hou£
 
®l
 
of
 
the
 
CªadŸn
 
Lightsourû
 
¥ecific
 
moduËs


6 
impÜt
 
os


7 
impÜt
 
time


8 
äom
 
d©‘ime
 
impÜt
 
d©e


9 
impÜt
 
bz2


11 
äom
 
şs
.
uts
.
log
 
impÜt
 
g‘_moduË_logg”
, 
	glog_to_cÚsŞe
, 
log_to_qt


12 
äom
 
	gşs
.
	g­pWidg‘s
.
impÜt
 
Enum


14 
	gabs_·th_to_tİ
 = 
os
.
·th
.
	$dœÇme
(
__fe__
)

15 
abs_·th_to_ši_fe
 = 
os
.
·th
.
	`dœÇme
(
__fe__
) + '/app.ini'

	@app.ini

1 [
DEFAULT
]

2 
	gmajÜ_v”siÚ
 = 1

3 
mšÜ_v”siÚ
 = 0

4 #tİ = 
C
:/
cÚŒŞs
/
py2
.7/
şs


5 
tİ
 = /
home
/
b”gr
/
g™
/
‹¡šg
/
py27_qt5
/
py2
.7/
şs
/

6 
dœ¦ash
=/

7 
­pDœ
 = %(
tİ
)
s
/
­¶iÿtiÚs
/
bioXasIM


8 
d©aDœ
 = %(
tİ
)
s
/
d©a


9 
imagesDœ
 = %(
tİ
)
s
/
images


10 
icoDœ1
 = %(
­pDœ
)
s
/
icÚs
/
²g


11 
widg‘sDœ
 = %(
­pDœ
)
s
/
widg‘s


12 
widg‘sUiDœ
 = %(
­pDœ
)
s
/
widg‘s
/
ui


13 
uiDœ
 = %(
­pDœ
)
s
/
ui


14 
cfgDœ
 = %(
­pDœ
)
s
/
StxmDœ
/
MiüoscİeCÚfigu¿tiÚ


15 
mŒcfg
 = %(
cfgDœ
)
s
/
MÙÜ
.
cfg


16 
autoSaveD©a
 = 
Œue


18 
sÿnPlugšDœ
=%(
tİ
)
s
/
­¶iÿtiÚs
/
bioXasIM
/
sÿn_¶ugšs


23 
§m¶e_pos™iÚšg_mode
='GONIOMETER'

26 
fše_§m¶e_pos™iÚšg_mode
='ZONEPLATE'

30 [
DATA
]

31 
§ve_®l_d©a
=
FALSE


32 
§ve_jpg_thumbÇs
=
TRUE


34 [
CAMERA
]

35 
’abËd
=1

36 
ÿm”a_wavefÜm
 = 
BL1610
-
I10
:
uhv
:
ÿlib_ÿm
:
wv_rbv


37 
äame_wd
 = 640

38 
äame_ht
 = 480

39 
sÿlšg_çùÜ
=17.250

42 [
SAMPLE_POSITIONS
]

43 
xpos_1
=-5000

44 
ypos_1
=5000

45 
xpos_2
=0

46 
ypos_2
=5000

47 
xpos_3
=5000

48 
ypos_3
=5000

49 
xpos_4
=-5000

50 
ypos_4
=0

51 
xpos_5
=0

52 
ypos_5
=0

53 
xpos_6
=5000

54 
ypos_6
=0

55 
xi0pos
=-46.7

56 
yi0pos
=-8000

57 
§m¶e_cœşe_dŸm
=1000

59 [
FINE_SCAN_RANGES
]

60 
§m¶e_x
=60

61 
§m¶e_y
=60

62 
zp_x
=70

63 
zp_y
=70

65 [
SAMPLE_IMAGE_LXL
]

66 #if(
sÿn_ty³
 == 'COARSE'):

67 #accR = 
v–o
 * (
accTime
 + 0.1)

69 ##
accR
 = 2.0

70 #if(
sÿn_ºg
 >= 20.0):

72 #–if(
sÿn_ºg
 >= 10.0):

74 #–if(
sÿn_ºg
 <= 2.0):

75 ##
accR
 = 0.45 * 
sÿn_ºg


76 #accR = 0.65 * 
sÿn_ºg


80 #§m¶
image
 
sÿÂšg
 
numb”s


84 #zÚ•Ï‹ 
sÿÂšg


85 
f_acc_ºg
=3.0

86 
f_decc_ºg
=3.0

89 
c_sÿn1_pdly
=0.0

90 
c_sÿn2_pdly
=0.00

93 
f_sÿn2_pdly
=0.0

94 
f_sÿn1_pdly
=0.1

95 #fÜû 
dÚe
 
v®ues
 
¬e
: 0=
NORMAL
, 1=
FORCED
, 2=
INTERNAL_TIMED


96 
	gc_fx_fÜû_dÚe
=0

97 
c_fy_fÜû_dÚe
=0

99 
f_fx_fÜû_dÚe
=0

100 
f_fy_fÜû_dÚe
=1

102 [
SAMPLE_IMAGE_PXP
]

103 
f_acc_ºg
=0.0

104 
c_sÿn1_pdly
=0.0

105 
c_sÿn2_pdly
=0.0

108 
f_sÿn2_pdly
=0.0

109 
f_sÿn1_pdly
=0.00

110 #fÜû 
dÚe
 
v®ues
 
¬e
: 0=
NORMAL
, 1=
FORCED
, 2=
INTERNAL_TIMED


111 
	gc_fx_fÜû_dÚe
=0

112 
c_fy_fÜû_dÚe
=0

113 
f_fx_fÜû_dÚe
=1

114 
f_fy_fÜû_dÚe
=1

117 [
SAMPLE_POINT_SPEC_SCAN
]

118 
f_acc_ºg
=0.0

119 
c_sÿn1_pdly
=0.0

120 
c_sÿn2_pdly
=0.0

121 
c_sÿn3_pdly
=0.0

122 
c_sÿn4_pdly
=0.0

123 
f_sÿn1_pdly
=0.0

124 
f_sÿn2_pdly
=0.0

125 
f_sÿn3_pdly
=0.0

126 
f_sÿn4_pdly
=0.0

127 #fÜû 
dÚe
 
v®ues
 
¬e
: 0=
NORMAL
, 1=
FORCED
, 2=
INTERNAL_TIMED


128 
	gc_fx_fÜû_dÚe
=0

129 
c_fy_fÜû_dÚe
=0

130 
f_fx_fÜû_dÚe
=1

131 
f_fy_fÜû_dÚe
=1

134 [
SAMPLE_LINE_SPEC_SCAN
]

135 
f_acc_ºg
=0.0

136 
c_sÿn1_pdly
=0.0

137 
c_sÿn2_pdly
=0.0

139 
f_sÿn1_pdly
=0.0

140 
f_sÿn2_pdly
=0.0

142 
sÿn3_pdly
=0.0

143 
sÿn4_pdly
=0.0

144 #fÜû 
dÚe
 
v®ues
 
¬e
: 0=
NORMAL
, 1=
FORCED
, 2=
INTERNAL_TIMED


145 
	gc_fx_fÜû_dÚe
=0

146 
c_fy_fÜû_dÚe
=0

147 
f_fx_fÜû_dÚe
=0

148 
f_fy_fÜû_dÚe
=1

150 [
FOCUS_SCAN
]

151 
c_sÿn1_pdly
=0.0

152 
c_sÿn2_pdly
=0.0

153 
f_sÿn2_pdly
=0.0

154 
f_sÿn1_pdly
=0.15

155 #fÜû 
dÚe
 
v®ues
 
¬e
: 0=
NORMAL
, 1=
FORCED
, 2=
INTERNAL_TIMED


156 
	gf_fx_fÜû_dÚe
=2

157 
f_fy_fÜû_dÚe
=1

	@bioMain.py

2 
C»©ed
 
	gÚ
 2014-06-23

4 @
	gauthÜ
: 
b”gr


10 .. 
moduË
:: 
£±SÿnMašWšdow


11 :
¶©fÜm
: 
Wšdows


12 :
synİsis
: 
The
 
maš
 
moduË
 
pySTXM


13 .. 
moduËauthÜ
:: 
Russ
 
B”g
 <
russ
.
b”g
@
lightsourû
.
ÿ
>

16 
impÜt
 
Œaûback


17 
impÜt
 
time


18 
impÜt
 
d©‘ime


19 
äom
 
time
 
impÜt
 
mktime
, 
	g¡ráime
, 
	g¡½time
, 
	ggmtime


20 
impÜt
 
	gsys
, 
	gos


21 
impÜt
 
	gglob


22 
impÜt
 
numpy
 
as
 
	gÅ


23 
impÜt
 
	gQueue


24 
impÜt
 
	g©ex™


25 
impÜt
 
	gcİy


27 
äom
 
PyQt5
 
impÜt
 
	gQtCÜe
, 
	gQtGui
, 
	guic
, 
	gQtWidg‘s


28 
äom
 
	gguiqwt
.
cÚfig
 
impÜt
 
	g_


29 
äom
 
th»adšg
 
impÜt
 
	gLock


30 
impÜt
 
	gcİy


32 
äom
 
	gy­sy
.
PlugšMªag”
 
impÜt
 
	gPlugšMªag”


34 
impÜt
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	g£tup_’v


36 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	gd©a
.
bioxas_im_d©a_io
 
impÜt
 
	gBioxasD©aIo


38 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
bioXasIM
 
impÜt
 
	gabs_·th_to_ši_fe


39 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
bioxas_u£r
 
impÜt
 
	gu¤_acù_mªag”


41 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


42 
äom
 
	gşs
.
	guts
.
diù_uts
 
impÜt
 
	gdù_g‘
, 
	gdù_put


43 
äom
 
	gşs
.
	guts
.
roi_diù_defs
 
	gimpÜt
 *

44 
äom
 
	gşs
.
	guts
.
cfg·r£r
 
impÜt
 
	gCÚfigCÏss


45 
äom
 
	gşs
.
	guts
.
roi_uts
 
impÜt
 
	gwidg‘_com_cmnd_ty³s
, 
	gg‘_fœ¡_¥_db_äom_wdg_com
, 
	g»£t_unique_roi_id


46 
äom
 
	gşs
.
	guts
.
fe_sy¡em_toŞs
 
impÜt
 
	gma¡”_g‘_£q_Çmes
, 
	gg‘_thumb_fe_Çme_li¡


48 
äom
 
	gşs
.
	g¶ÙWidg‘s
.
imageWidg‘
 
impÜt
 
	gImageWidg‘


49 
äom
 
	gşs
.
	g¶ÙWidg‘s
.
	g¡rtoŞ
.
¡rToŞWidg‘
 
impÜt
 
	gSŒToŞWidg‘


50 
äom
 
	gşs
.
	g¶ÙWidg‘s
.
curveWidg‘
 
impÜt
 
	gCurveV›w”Widg‘
, 
	gg‘_Ãxt_cŞÜ
, 
	gg‘_basic_lše_¡yË


51 
äom
 
	gşs
.
	g¶ÙWidg‘s
.
uts
 
	gimpÜt
 *

54 
äom
 
	gşs
.
	gsÿÂšg
.
Ba£Sÿn
 
impÜt
 
	gLOAD_ALL


55 
äom
 
	gşs
.
	gsÿÂšg
.
d©aRecÜd”
 
impÜt
 
	gHdrD©a


56 
äom
 
	gşs
.
	gsÿÂšg
.
ty³s
 
impÜt
 
	gimage_ty³s
, 
	gsÿn_ty³s
, 
	gsÿn_·Ãl_Üd”
, 
	gsÿn_sub_ty³s
, \

57 
	g¥©Ÿl_ty³_´efix
, 
	g’”gy_sÿn_Üd”_ty³s
, 
	g§m¶e_fše_pos™iÚšg_modes
,\

58 
	g§m¶e_pos™iÚšg_modes
, 
	gsÿn_¡©us_ty³s
, 
	g’d¡©iÚ_id_ty³s


59 
äom
 
	gşs
.
	gsÿÂšg
.
ba£
 
impÜt
 
	gSÿnP¬amWidg‘


60 
äom
 
	gşs
.
	gÿWidg‘s
.
ÿLab–Widg‘
 
impÜt
 
	gÿ_aiLab–Widg‘
, 
	gÿ_mbbiLab–Widg‘
, 
	gÿ_¡rLab–
, 
	gÿ_biLab–Widg‘


62 
äom
 
	gşs
.
	g­pWidg‘s
.
	gu£r_accouÁ
.
logš
 
impÜt
 
	glogšWidg‘


63 #äom 
şs
.
­pWidg‘s
.
¥yd”_cÚsŞe
 
impÜt
 
Sh–lWidg‘
#, 
Sh–lDock


64 
äom
 
	gşs
.
	g­p_d©a
.
deçuÉs
 
impÜt
 
	gma¡”_cŞÜs
, 
	gg‘_¡yË
, 
	grgb_as_hex


66 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	gwidg‘s
.
mÙÜPª–
 
impÜt
 
	gPos™iÚ”sPª–


67 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	gwidg‘s
.
pvDi¥ÏyPª–
 
impÜt
 
	gPVsPª–


68 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	gwidg‘s
.
d‘eùÜsPª–
 
impÜt
 
	gD‘eùÜsPª–


70 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
bl07ID01
 
impÜt
 
	gMAIN_OBJ
, 
	gPOS_TYPE_BL
, 
	gPOS_TYPE_ES


71 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	gwidg‘s
.
sÿn_queue_bË
 
impÜt
 
	gSÿnQueueTabËWidg‘


74 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
deviû_Çmes
 
	gimpÜt
 *

76 #äom 
bcm
.
•ics
.
deviûs
 
impÜt
 
sÿn


77 
äom
 
	gbcm
.
	gdeviû
.
ba£
 
impÜt
 
	gBa£Deviû


78 
äom
 
	gbcm
.
	g•ics_deviûs
.
sÿn
 
impÜt
 
	gSÿn


82 #»ad 
the
 
ši
 
fe
 
ªd
 
lßd
h 
dœeùÜ›s


83 
	g­pCÚfig
 = 
CÚfigCÏss
(
abs_·th_to_ši_fe
)

84 
sÿnPlugšDœ
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'scanPluginDir')

85 
	gmajÜ_v”siÚ
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'major_version')

86 
	gmšÜ_v”siÚ
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'minor_version')

87 
	guiDœ
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'uiDir')

89 
	g§m¶e_pos_mode
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'sample_positioning_mode')

90 
	g§m¶e_fš•os_mode
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'fine_sample_positioning_mode')

92 if(
	g§m¶e_pos_mode
.
fšd
('COARSEXY') > -1):

93 
§m¶e_pos_mode
 = 
§m¶e_pos™iÚšg_modes
.
COARSEXY


94 
–if
(
§m¶e_pos_mode
.
fšd
('GONIOMETER') > -1):

95 
§m¶e_pos_mode
 = 
§m¶e_pos™iÚšg_modes
.
GONIOMETER


97 
§m¶e_pos_mode
 = 
§m¶e_pos™iÚšg_modes
.
SAMPLEXY


99 #£tu°
moduË
 
logg”
 
w™h
 
a
  do-
nÙhšg
 
hªdËr


100 
_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

102 
aùive_u£r
 = 
NÚe


104 
PLOTTER_IMAGES_TAB
 = 0

105 
PLOTTER_SPECTRA_TAB
 = 1

107 
NUM_POINTS_LOST_AFTER_EDIFF
 = 2

108 
DATA_OFFSET
 = 1

111 
ho¡Çme
 = 
os
.
g‘’v
('COMPUTERNAME')

112 if(
ho¡Çme
 == 'WKS-W001465'):

113 #th
Ãw
 
‹¡
 
compu‹r
 
š
 
Şd
 
magÃt
 
m­pšg
 
room


114 
FAKE_MARKER
=
F®£


115 
UNIT_SCALAR
 = 0.001

118 
VELO_SCALAR
 = 1000.0

119 
USE_PIEZO
 = 
True


120 
–if
(
ho¡Çme
 == 'NBK-W001021'):

121 #my 
nÙebook
 
compu‹r


122 
FAKE_MARKER
=
True


123 
UNIT_SCALAR
 = 1.0

124 
USE_PIEZO
 = 
F®£


126 #th
Şd
 
¡xm_cÚŒŞ
 
cÚmpu‹r


127 
FAKE_MARKER
 = 
F®£


128 
UNIT_SCALAR
 = 0.001

129 
VELO_SCALAR
 = 0.001

130 
USE_PIEZO
 = 
True


135 
şass
 
	$bioxasMWšdow
(
QtWidg‘s
.
QMašWšdow
):

137 
şassdocs


139 
_£t_sÿn_bŠs
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
)

140 #_check_fÜ_ªÙh”_sÿÀğ
QtCÜe
.
	`pyqtSigÇl
(
objeù
)

142 
def
 
	$__š™__
(
£lf
, 
·»Á
=
NÚe
):

144 
	$__š™__
(): 
desütiÚ


146 :
·¿m
 
·»Á
=
NÚe
:…¬’t=NÚ
desütiÚ


147 :
ty³
 
·»Á
=
NÚe
:…arent=Noneype

149 :
»tuºs
: 
NÚe


151 
	`su³r
(
bioxasMWšdow
, 
£lf
).
	`__š™__
(
·»Á
)

152 
uic
.
	`lßdUi
(
uiDœ
 + '//sÿnD‘as-mašWšdow-¶ugšs-d¬k.ui', 
£lf
)

153 #£lf.
	`£tWšdowT™Ë
('pyStxm %s.% CªadŸÀLighˆSourû Inc. ' % (
majÜ_v”siÚ
, 
mšÜ_v”siÚ
))

154 
£lf
.
	`£tWšdowT™Ë
('pyBioXa %s.% CªadŸÀLighˆSourû Inc. %s' % (
MAIN_OBJ
.
	`g‘
('APP.MAJOR_VER'), MAIN_OBJ.get('APP.MINOR_VER'), MAIN_OBJ.get('APP.DATE')))

156 
©ex™
.(
£lf
.
Ú_ex™
)

157 
£lf
.
	`£tGeom‘ry
(10,100,1900,1300)

158 
£lf
.
qssh“t
 = 
	`g‘_¡yË
('dark')

159 #£lf.
	`£tStyËSh“t
(
£lf
.
qssh“t
)

160 #£lf.
	`­¶y_¡yËsh“t
(
£lf
.
ûÁ¿lwidg‘
, s–f.
qssh“t
)

162 
auto_logš
 = 
True


163 
£lf
.
logšWdgt
 = 
	`logšWidg‘
(
u¤_acù_mªag”
, 
auto_logš
=auto_login)

164 if(
auto_logš
):

165 
£lf
.
aùive_u£r
 = s–f.
logšWdgt
.
	`g‘_u£r_obj
()

166 
´št
 '% sucûsfuÈlogged in' % 
£lf
.
aùive_u£r
.
	`g‘_u£ºame
()

167 
´št
 'Aùivu£¸d©¨dœ : %s' % 
£lf
.
aùive_u£r
.
	`g‘_d©a_dœ
()

169 
MAIN_OBJ
.
	`£t
('APP.USER', 
£lf
.
aùive_u£r
)

171 
Œy
:

172 
£lf
.
log
 = 
	`log_to_qt
()

173 #cÚÃù 
logg”


174 
£lf
.
log
.
Ãw_msg
.
	`cÚÃù
(£lf.
add_to_log
)

176 
£lf
.
upd©eStyËBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_upd©e_¡yË
)

177 #£lf.
sÿnTy³ToŞBox
.
cu¼’tChªged
.
	`cÚÃù
(
£lf
.
Ú_toŞbox_chªged
)

179 
£lf
.
_£t_sÿn_bŠs
.
	`cÚÃù
(£lf.
Ú_£t_sÿn_bŠs
)

180 #£lf.
_check_fÜ_ªÙh”_sÿn
.
	`cÚÃù
(
£lf
.
check_fÜ_mÜe_ev_»giÚs
)

181 
£lf
.
sšgË_’”gy
 = 
True


183 
£lf
.
d©a
 = []

184 
£lf
.
rvrsdd©a
 = []

185 
£lf
.
sÿn_tbox_widg‘s
 = []

187 
£lf
.
sÿn_š_´og»ss
 = 
F®£


188 
£lf
.
image_¡¬‹d
 = 
F®£


190 
£lf
.
vidTim”
 = 
QtCÜe
.
	`QTim”
()

191 
£lf
.
vidTim”
.
timeout
.
	`cÚÃù
(£lf.
Ú_video_tim”
)

193 
£lf
.
	`£tup_maš_gui
()

194 
£lf
.
	`£tup_image_¶Ù
()

195 
£lf
.
	`£tup_¥eù¿_¶Ù
()

196 #
#£lf.
shu‰”FbkLbl
 = 
	`ÿ_biLab–Widg‘
(
MAIN_OBJ
.
	`deviû
(
DNM_SHUTTER
).
	`g‘_Çme
(), 
Ïb–Widg‘
=
£lf
.shu‰”FbkLbÈ, 
hdrText
=DNM_SHUTTER,
t™Ë_cŞÜ
='wh™e', 
İtiÚs
ğ
	`diù
(
¡©e_şrs
=['black','blue']))

197 
£lf
.
¡©us_diù
 = {
	}
}

199 if(
LOAD_ALL
):

200 
£lf
.
š™_¡©usb¬
()

202 
£lf
.
sÿn
 = 
NÚe


203 
£lf
.
dw–l
 = 0

205 #¨
v¬ŸbË
 
to
 
hŞd
 
the
 
li¡
 
of
 
ev_rois
 
cu¼’t
 
sÿn


206 
£lf
.
ev_rois
 = 
NÚe


207 
£lf
.
cur_ev_idx
 = 0

208 
£lf
.
cur_¥_rois
 = {}

209 #£lf.
e_roi_queue
 = 
Queue
.Queue()

211 
£lf
.
yS‘pošts
 = 
NÚe


212 
£lf
.
xS‘pošts
 = 
NÚe


213 
£lf
.
ÅoštsX
 = 0

214 
£lf
.
ÅoštsY
 = 0

216 
£lf
.
accRªge
 = 0

217 
£lf
.
dccRªge
 = 0

218 
£lf
.
executšgSÿn
 = 
NÚe


220 
£lf
.
¡İpšg
 = 
F®£


222 
£lf
.
š™_®l_sÿns
()

224 
£lf
.
£t_bu‰Ús_fÜ_¡¬tšg
()

226 
£lf
.
´eviousSÿnTy³
 = 
NÚe


228 
£lf
.
£tup_sÿn_toŞbox
()

229 
£lf
.
sÿn_·Ãl_idx
 = s–f.
sÿnTy³ToŞBox
.
cu¼’tIndex
()

230 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
£t_zp_focus_mode
()

231 
£lf
.
_sÿn_ty³
 = s–f.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
ty³


232 
£lf
.
_sÿn_sub_ty³
 = s–f.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
sub_ty³


234 
£lf
.
tim”
 = 
QtCÜe
.
QTim”
()

235 
£lf
.
tim”
.
timeout
.
cÚÃù
(£lf.
Ú_upd©e_¡yË
)

236 
£lf
.
tim”
.
¡¬t
(100)

238 #£lf.
¡¬t_•ics_sks
()

239 #£lf.
£tup_šfo_dock
()

240 
£lf
.
lßdImageD©aBŠ
.
şicked
.
cÚÃù
(£lf.
lßd_simuÏ‹d_image_d©a
)

241 
exû±
:

242 
Œaûback
.
´št_exc
()

244 
def
 
	$lßd_simuÏ‹d_image_d©a
(
£lf
):

245 
glob®
 
SIMULATE_IMAGE_DATA
, 
SIM_DATA


247 
SIMULATE_IMAGE_DATA
 = 
True


248 
SIM_DATA
 = 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`g‘_cu¼’t_d©a
()

249 
_logg”
.
	`šfo
('Loaded Simulated data')

251 
def
 
	$¡¬t_•ics_sks
(
£lf
):

253 
	$¡¬t_•ics_sks
(): 
desütiÚ


255 :
»tuºs
: 
NÚe


257 
MAIN_OBJ
.
	`deviû
('Shu‰”TaskRun').
	`put
(1)

260 
def
 
	$Ú_upd©e_¡yË
(
£lf
):

262 
	$Ú_upd©e_¡yË
(): 
desütiÚ


264 :
»tuºs
: 
NÚe


267 
£lf
.
tim”
.
	`¡İ
()

268 
£lf
.
qssh“t
 = 
	`g‘_¡yË
('dark')

269 
£lf
.
	`£tStyËSh“t
(£lf.
qssh“t
)

270 
£lf
.
	`­¶y_¡yËsh“t
(£lf.
ûÁ¿lwidg‘
, s–f.
qssh“t
)

271 
£lf
.
	`upd©e_¶Ù_cŞÜs
()

274 
def
 
	$upd©e_¶Ù_cŞÜs
(
£lf
):

276 
	$upd©e_¶Ù_cŞÜs
(): 
desütiÚ


278 :
»tuºs
: 
NÚe


280 
fg_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_forgrnd'])

281 
bg_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_bckgrnd'])

282 
mš_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_gridmaj'])

283 
maj_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_gridmin'])

285 
£lf
.
evSÿÅlÙ
.
	`£t_grid_·¿m‘”s
(
bg_şr
, 
mš_şr
, 
maj_şr
)

286 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_grid_·¿m‘”s
(
bg_şr
, 
mš_şr
, 
maj_şr
)

287 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_cs_grid_·¿m‘”s
(
fg_şr
, 
bg_şr
, 
mš_şr
, 
maj_şr
)

288 
£lf
.
¥eù¿Widg‘
.
	`£t_grid_·¿m‘”s
(
bg_şr
, 
mš_şr
, 
maj_şr
)

291 
def
 
	$­¶y_¡yËsh“t
(
£lf
, 
widg‘
, 
ssh“t
):

293 
	$­¶y_¡yËsh“t
(): 
desütiÚ


295 :
·¿m
 
widg‘
: widg‘ 
desütiÚ


296 :
ty³
 
widg‘
: widgetype

298 :
·¿m
 
ssh“t
: ssh“ˆ
desütiÚ


299 :
ty³
 
ssh“t
: ssheetype

301 :
»tuºs
: 
NÚe


303 #fÜ 
some
 
»asÚ
 
the
 
¡ysh“t
 
i¢t
 
picked
 
up
 
by
h
ûÁ¿l
 
widg‘
 
ªd
 
ûÁ¿lF¿me
 
so
 
fÜû
 
™
 
h”e


304 
widg‘
.
	`£tStyËSh“t
(
ssh“t
)

309 
def
 
	$add_to_log
(
£lf
, 
şr
, 
msg
):

311 
	$add_to_log
(): 
desütiÚ


313 :
·¿m
 
şr
: cÌ 
desütiÚ


314 :
ty³
 
şr
: clrype

316 :
·¿m
 
msg
: msg 
desütiÚ


317 :
ty³
 
msg
: msgype

319 :
»tuºs
: 
NÚe


322 
This
 
is
 
a
 
sigÇl
 
hªdËr
 
th©
 i 
cÚÃùed
 
to
 
the
 
logg”
 
so
hat

323 
mes§ges
 
£Á
 
to
 
the
 
logg”
 
¬e
 
th’
 
di¥Ïyed
 
by
 
this
 
­ps
 
loggš


324 
widg‘
, 
cŞÜ
 
is
 
suµÜ‹d
 
the
 
v¬yšg
 
Ëv–s
 
of
 
mes§ge
 
logged


326 if(
şr
 
is
 
nÙ
 
NÚe
):

327 
£lf
.
logWšdow
.
	`£tTextCŞÜ
(
şr
)

328 
£lf
.
logWšdow
.
	`­³nd
(
msg
)

331 
def
 
	$lßd_dœ_v›w
(
£lf
):

333 
	$lßd_dœ_v›w
(): 
desütiÚ


335 :
»tuºs
: 
NÚe


337 
£lf
.
dœ_mod–
 = 
QtWidg‘s
.
	`QFeSy¡emMod–
()

338 
£lf
.
dœ_mod–
.
	`£tRoÙP©h
Ğ
QtCÜe
.
QDœ
.
	`cu¼’tP©h
() )

340 #£lf.
dœ_mod–
.
	`£tRoÙP©h
Ğ
QtCÜe
.
	`QSŒšg
(
MAIN_OBJ
.
	`g‘_£ssiÚ_šfo
().
	`g‘_d©a_dœ
()) )

341 
£lf
.
dœT»eV›w
.
	`£tMod–
(£lf.
dœ_mod–
)

342 
£lf
.
dœT»eV›w
.
şicked
.
	`cÚÃù
(£lf.
Ú_Œ“V›w_şicked
)

345 @
QtCÜe
.
	`pyqtSlÙ
(QtCÜe.
QMod–Index
)

346 
def
 
	$Ú_Œ“V›w_şicked
(
£lf
, 
šdex
):

348 
	$Ú_Œ“V›w_şicked
(): 
desütiÚ


350 :
·¿m
 
šdex
: index 
desütiÚ


351 :
ty³
 
šdex
: indexype

353 :
»tuºs
: 
NÚe


355 
šdexI‹m
 = 
£lf
.
dœ_mod–
.
	`šdex
(
šdex
.
	`row
(), 0, index.
	`·»Á
())

356 
feName
 = 
£lf
.
dœ_mod–
.
	`feName
(
šdexI‹m
)

357 
feP©h
 = 
£lf
.
dœ_mod–
.
	`feP©h
(
šdexI‹m
)

358 
´št
 '£Ëùed [%s]' % (
feP©h
)

360 
def
 
	$Ú_£t_sÿn_bŠs
(
£lf
, 
do_wh©
):

362 
	$Ú_£t_sÿn_bŠs
(): 
desütiÚ


364 :
·¿m
 
do_wh©
: do_wh© 
desütiÚ


365 :
ty³
 
do_wh©
: do_whatype

367 :
»tuºs
: 
NÚe


369 if(
do_wh©
 == 'SET_FOR_SCANNING'):

370 
£lf
.
	`£t_bu‰Ús_fÜ_sÿÂšg
()

371 
	`–if
(
do_wh©
 == 'SET_FOR_STARTING'):

372 
£lf
.
	`£t_bu‰Ús_fÜ_¡¬tšg
()

374 
·ss


376 
def
 
	$£t_bu‰Ús_fÜ_sÿÂšg
(
£lf
):

378 
	$£t_bu‰Ús_fÜ_sÿÂšg
(): 
desütiÚ


380 :
»tuºs
: 
NÚe


382 
£lf
.
sÿn_š_´og»ss
 = 
True


383 
£lf
.
¡¬tBŠ
.
	`£tEÇbËd
(
F®£
)

384 #£lf.
¡İBŠ
.
	`£tEÇbËd
(
True
)

385 
£lf
.
·u£BŠ
.
	`£tEÇbËd
(
True
)

386 
£lf
.
sÿnsF¿me
.
	`£tEÇbËd
(
F®£
)

387 #£lf.
sÿn_tbox_widg‘s
[
£lf
.
sÿn_·Ãl_idx
].
	`£t_»ad_Úly
()

388 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_’abË_drİ_ev’ts
(
F®£
)

390 
def
 
	$£t_bu‰Ús_fÜ_¡¬tšg
(
£lf
):

392 
	$£t_bu‰Ús_fÜ_¡¬tšg
(): 
desütiÚ


394 :
»tuºs
: 
NÚe


396 
£lf
.
sÿn_š_´og»ss
 = 
F®£


397 
£lf
.
¡¬tBŠ
.
	`£tEÇbËd
(
True
)

398 #£lf.
¡İBŠ
.
	`£tEÇbËd
(
F®£
)

399 
£lf
.
·u£BŠ
.
	`£tEÇbËd
(
F®£
)

400 
£lf
.
sÿnsF¿me
.
	`£tEÇbËd
(
True
)

401 #£lf.
sÿn_tbox_widg‘s
[
£lf
.
sÿn_·Ãl_idx
].
	`£t_ed™abË
()

402 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_’abË_drİ_ev’ts
(
True
)

404 
def
 
	$š™_®l_sÿns
(
£lf
):

406 
	$š™_®l_sÿns
(): 
desütiÚ


409 #’su» 
a
 
cÚÃùiÚ
 
to
 
dcs
 
v®ues
 
so
 
th©
 
the
 
fÜ¡
 
d©a
 
cŞËùiÚ
 
gÛs
 
smoÙh


410 
_logg”
.
	`šfo
('intializing DCS connections')

411 
deviûs
 = 
MAIN_OBJ
.
	`g‘_deviûs
()

412 
d
 = 
MAIN_OBJ
.
	`ke_pos™iÚ”_¢­shÙ
(
deviûs
['POSITIONERS'])

413 
d
 = 
MAIN_OBJ
.
	`ke_d‘eùÜs_¢­shÙ
(
deviûs
['DETECTORS'])

414 
d
 = 
MAIN_OBJ
.
	`ke_pvs_¢­shÙ
(
deviûs
['PVS'])

415 
_logg”
.
	`šfo
('intializing DCS connections: Done')

417 #£lf.
d‘SCAN
 = 
	`D‘eùÜSSCAN
()

418 #£lf.
imageSCAN
 = 
	`Sam¶eImageW™hEÃrgySSCAN
()

419 #£lf.
poštSCAN
 = 
£lf
.
imageSCAN


420 #£lf.
o§SCAN
 = 
	`O§SSCAN
()

421 #£lf.
o§FocusSCAN
 = 
	`O§FocusSSCAN
()

422 #£lf.
focusSCAN
 = 
	`FocusSSCAN
()

423 #£lf.
g’”icSCAN
 = 
	`Pos™iÚ”SSCAN
()

424 #£lf.
lšeS³cSCAN
 = 
	`LšeS³cSSCAN
()

425 #£lf.
zpTomoSCAN
 = 
	`ZÚePÏ‹Sam¶eImageW™hEÃrgySSCAN
()

427 #Ãed 
time
 
the£
 
¡škšg
 
pvs
 
to
 
cÚÃù


428 #time.
	`¦“p
(0.5)

430 #£lf.
imageSCAN
.
	`¡İ
()

431 #£lf.
poštSCAN
.
	`¡İ
()

432 #£lf.
focusSCAN
.
	`¡İ
()

434 
def
 
	$şo£Ev’t
(
£lf
,
ev’t
):

436 
	$şo£Ev’t
(): 
desütiÚ


438 :
·¿m
 
ev’t
:ƒv’ˆ
desütiÚ


439 :
ty³
 
ev’t
:ƒventype

441 :
»tuºs
: 
NÚe


443 
»suÉ
 = 
QtWidg‘s
.
QMes§geBox
.
	`que¡iÚ
(
£lf
,

446 
QtWidg‘s
.
QMes§geBox
.
Yes
| QtWidg‘s.QMes§geBox.
No
)

447 
ev’t
.
	`ignÜe
()

449 
»suÉ
 =ğ
QtWidg‘s
.
QMes§geBox
.
Yes
:

450 
ev’t
.
	`acû±
()

452 
def
 
	$Ú_ed™_zp_·¿ms
(
£lf
):

454 
	$Ú_ed™_zp_·¿ms
(): 
desütiÚ


456 :
»tuºs
: 
NÚe


459 
£lf
.
åFÜm
.
	`show
()

461 
def
 
	$£tup_maš_gui
(
£lf
):

463 
	$£tup_maš_gui
(): 
desütiÚ


465 :
»tuºs
: 
NÚe


467 #£lf.
¡©usB¬
 = 
QtWidg‘s
.
	`QStusB¬
()

468 #£lf.
	`Ïyout
().
	`addWidg‘
(
£lf
.
¡©usB¬
)

469 
£lf
.
	`£tMšimumSize
(1000,1000)

470 
£lf
.
	`£tMaximumSize
(2000,2000)

472 #£lf.
	`cÚÃù
(
£lf
.
aùiÚEx™
, 
QtCÜe
.
	`SIGNAL
('Œigg”ed()'), QtCÜe.
	`SLOT
('close()'))

473 
£lf
.
aùiÚEx™
.
Œigg”ed
.
	`cÚÃù
(£lf.
şo£
)

474 
£lf
.
aùiÚZP_P¬ams
.
Œigg”ed
.
	`cÚÃù
(£lf.
Ú_ed™_zp_·¿ms
)

476 
£lf
.
¡¬tBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_¡¬t_ssÿn
)

477 
£lf
.
·u£BŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_·u£
)

478 
£lf
.
¡İBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_¡İ
)

480 #»memb” 
th©
 
the
 
¡rtToŞWidg‘
 
u£s
h
pv
 
¥ecif›d
 
š
 
couÁ”s
.
ši


481 
£lf
.
evSÿÅlÙ
 = 
	`SŒToŞWidg‘
(1, 
pvLi¡
=[
MAIN_OBJ
.
	`deviû
('tick”').
	`g‘_Çme
()])

483 
£lf
.
’abË_d‘fbk
 = 
F®£


484 
£lf
.
’abË_o§fbk
 = 
F®£


486 if(
LOAD_ALL
):

488 
vbox2
 = 
QtWidg‘s
.
	`QVBoxLayout
()

489 
vbox2
.
	`addWidg‘
(
£lf
.
evSÿÅlÙ
)

490 
vbox2
.
	`£tCÚ‹ÁsM¬gšs
(1,1,1,1)

491 
£lf
.
couÁ”PlÙF¿me
.
	`£tLayout
(
vbox2
)

493 #’d¡©iÚ 
pos™iÚ”s
 
·Ãl


494 #thi 
exşude
 
li¡
 
is
 
a
 
hack
 
now
, 
this
 
Ãeds
 
to
 
»ãr
 
back
Ø
som‘hšg
 
š
 
the
 
BL
 
cÚfig
 
fe


495 
exşude_li¡
 = ['_ZonePlateZ_base', 'SampleFineX', 'SampleFineY', 'CoarseX.X', 'CoarseY.Y', 'AUX1','AUX2','Cff','PeemM3Trans']

496 
£lf
.
esPosPª–
 = 
	`Pos™iÚ”sPª–
(
POS_TYPE_ES
, 
exşude_li¡
)

497 
¥aûr
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(20,40,QtWidg‘s.
QSizePŞicy
.
Mšimum
,QtWidg‘s.QSizePŞicy.
Ex·ndšg
)

498 
vbox3
 = 
QtWidg‘s
.
	`QVBoxLayout
()

499 
vbox3
.
	`addWidg‘
(
£lf
.
esPosPª–
)

500 
vbox3
.
	`addI‹m
(
¥aûr
)

501 
£lf
.
’d¡©iÚPos™iÚ”sF¿me
.
	`£tLayout
(
vbox3
)

503 #b—mlš
pos™iÚ”s
 
·Ãl


504 
£lf
.
blPosPª–
 = 
	`Pos™iÚ”sPª–
(
POS_TYPE_BL
)

505 
¥aûr
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(20,40,QtWidg‘s.
QSizePŞicy
.
Mšimum
,QtWidg‘s.QSizePŞicy.
Ex·ndšg
)

506 
vbox4
 = 
QtWidg‘s
.
	`QVBoxLayout
()

507 
vbox4
.
	`addWidg‘
(
£lf
.
blPosPª–
)

508 
vbox4
.
	`addI‹m
(
¥aûr
)

509 
£lf
.
b—mlšePos™iÚ”sF¿me
.
	`£tLayout
(
vbox4
)

511 #‹m³¿tu» 
·Ãl


512 
dev_obj
 = 
MAIN_OBJ
.
	`g‘_deviû_obj
()

513 
‹mps
 = 
dev_obj
.
	`g‘_®l_‹m³¿tu»s
(
POS_TYPE_ES
)

514 
£lf
.
esTempPª–
 = 
	`PVsPª–
(
‹mps
, 
egu
='deg C')

515 #£lf.
esTempPª–
 = 
	`Tem³¿tu»sPª–
(
POS_TYPE_ES
)

516 
¥aûr
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(20,40,QtWidg‘s.
QSizePŞicy
.
Mšimum
,QtWidg‘s.QSizePŞicy.
Ex·ndšg
)

517 
vbox5
 = 
QtWidg‘s
.
	`QVBoxLayout
()

518 
vbox5
.
	`addWidg‘
(
£lf
.
esTempPª–
)

519 
vbox5
.
	`addI‹m
(
¥aûr
)

520 
£lf
.
esTempsF¿me
.
	`£tLayout
(
vbox5
)

522 #´essu» 
·Ãl


523 
dev_obj
 = 
MAIN_OBJ
.
	`g‘_deviû_obj
()

524 
´e¤s
 = 
dev_obj
.
	`g‘_®l_´essu»s
(
POS_TYPE_ES
)

525 
£lf
.
esP»ssPª–
 = 
	`PVsPª–
(
´e¤s
, 
egu
='TÜr', 
’gš“ršg_nÙ©iÚ
=
True
)

526 #£lf.
esTempPª–
 = 
	`Tem³¿tu»sPª–
(
POS_TYPE_ES
)

527 
¥aûr
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(20,40,QtWidg‘s.
QSizePŞicy
.
Mšimum
,QtWidg‘s.QSizePŞicy.
Ex·ndšg
)

528 
vbox6
 = 
QtWidg‘s
.
	`QVBoxLayout
()

529 
vbox6
.
	`addWidg‘
(
£lf
.
esP»ssPª–
)

530 
vbox6
.
	`addI‹m
(
¥aûr
)

531 
£lf
.
esP»ssu»sF¿me
.
	`£tLayout
(
vbox6
)

533 
£lf
.
d‘eùÜsPª–
 = 
	`D‘eùÜsPª–
()

534 
¥aûr
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(20, 20, QtWidg‘s.
QSizePŞicy
.
Mšimum
, QtWidg‘s.QSizePŞicy.
Ex·ndšg
)

535 
vbox5
 = 
QtWidg‘s
.
	`QVBoxLayout
()

536 
vbox5
.
	`addWidg‘
(
£lf
.
d‘eùÜsPª–
)

537 
vbox5
.
	`addI‹m
(
¥aûr
)

538 
£lf
.
d‘eùÜsF¿me
.
	`£tLayout
(
vbox5
)

541 
£lf
.
	`lßd_dœ_v›w
()

542 
£lf
.
pythÚsh–l
 = 
NÚe


544 
£lf
.
shu‰”CÁ¾ComboBox
.
cu¼’tIndexChªged
.
	`cÚÃù
(£lf.
Ú_shu‰”CÁ¾ComboBox
)

545 
idx
 = 
£lf
.
shu‰”CÁ¾ComboBox
.
	`cu¼’tIndex
()

546 
£lf
.
	`Ú_shu‰”CÁ¾ComboBox
(0) #Auto

548 
£lf
.
sÿn_´og»ss_bË
 =
	`SÿnQueueTabËWidg‘
()

549 
£lf
.
sÿn_q_Ïyout
.
	`addWidg‘
(£lf.
sÿn_´og»ss_bË
)

550 
£lf
.
	`š™_images_äame
()

552 
def
 
	$š™_images_äame
(
£lf
):

553 
äom
 
şs
.
­¶iÿtiÚs
.
bioXasIM
.
widg‘s
.
thumbÇV›w”
 
impÜt
 
CÚùSh“t


554 
£lf
.
images_wšdow
 = 
	`CÚùSh“t
(£lf.
aùive_u£r
.
	`g‘_d©a_dœ
())

556 
vbox
 = 
QtWidg‘s
.
	`QVBoxLayout
()

557 
vbox
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

558 
vbox
.
	`addWidg‘
(
£lf
.
images_wšdow
)

559 
£lf
.
imagesF¿me
.
	`£tLayout
(
vbox
)

561 
def
 
	$Ú_shu‰”CÁ¾ComboBox
(
£lf
, 
idx
):

563 
	$Ú_shu‰”CÁ¾ComboBox
(): 
desütiÚ


565 :
·¿m
 
idx
: idx 
desütiÚ


566 :
ty³
 
idx
: idxype

568 :
»tuºs
: 
NÚe


571 0 = 
Auto


572 1 = 
O³n


573 2 = 
Clo£


575 #idx = 
£lf
.
shu‰”CÁ¾ComboBox
.
	`cu¼’tIndex
()

577 #if(
idx
 == 0):

579 #MAIN_OBJ.
	`deviû
(
DNM_SHUTTER
).
	`şo£
()

580 #MAIN_OBJ.
	`deviû
(
DNM_SHUTTER
).
	`£t_to_auto
()

581 #
#–if(
idx
 == 1):

583 #MAIN_OBJ.
	`deviû
(
DNM_SHUTTER
).
	`£t_to_mªu®
()

584 #MAIN_OBJ.
	`deviû
(
DNM_SHUTTER
).
	`İ’
()

587 #MAIN_OBJ.
	`deviû
(
DNM_SHUTTER
).
	`£t_to_mªu®
()

588 #MAIN_OBJ.
	`deviû
(
DNM_SHUTTER
).
	`şo£
()

590 
def
 
	$£tup_sÿn_toŞbox
(
£lf
):

592 
	$£tup_sÿn_toŞbox
(): 
desütiÚ


594 :
»tuºs
: 
NÚe


596 #C»©
¶ugš
 
mªag”


597 
Ïyout
 = 
QtWidg‘s
.
	`QVBoxLayout
()

598 
Ïyout
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

599 
Ïyout
.
	`£tS·cšg
(0)

601 
£lf
.
sÿnTy³ToŞBox
 = 
QtWidg‘s
.
	`QToŞBox
()

602 
£lf
.
sÿnTy³ToŞBox
.
	`Ïyout
().
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

603 
£lf
.
sÿnTy³ToŞBox
.
	`Ïyout
().
	`£tS·cšg
(0)

604 #£lf.
sÿnTy³ToŞBox
.
	`£tStyËSh“t
(" QToolBox::tab {padding-left: 100px;} ")

605 
£lf
.
mªag”
 = 
	`PlugšMªag”
(
ÿ‹gÜ›s_f‹r
={ "Sÿns": 
SÿnP¬amWidg‘
})

606 
£lf
.
mªag”
.
£tPlugšPÏûs
(['scan_plugins'])

607 #Lßd 
¶ugšs


608 
£lf
.
mªag”
.
loÿ‹Plugšs
()

609 
£lf
.
mªag”
.
lßdPlugšs
()

611 
·ges
 = 0

612 
num_sÿns
 = 0

613 
sÿns
 = {}

615 #w®k 
the
 
¶ugš
 
dœeùÜy
 
lookšg
 
¶ugšs
 
of
 
ÿ‹gÜy
 
SÿnP¬amWidg‘


616 
¶ugš
 
š
 
£lf
.
mªag”
.
g‘PlugšsOfC©egÜy
("Scans"):

617 
´št
 "Found SCAN…lugš [%s]" % 
¶ugš
.
¶ugš_objeù
.
Çme


618 
sÿns
[
¶ugš
.
¶ugš_objeù
.
idx
] =…lugin.plugin_object

619 
num_sÿns
 += 1

621 #now 
š£¹
 
th’
 
š
 
the
 
Üd”
h
¶ugšs
 
idx
 
v®ue
 
§ys


622 
idx
 
š
 
	$¿nge
(
num_sÿns
):

623 #¶ugš.
¶ugš_objeù
 
is
 
ª
 
š¡ªû
 
of
 
the
 
¶ugš


624 #£lf.
d©afÜm©‹rsCombo
.
	`addI‹m
(
¶ugš
.
¶ugš_objeù
.
Çme
)

625 #£lf.
d©afÜm©‹rs
[
¶ugš
.
¶ugš_objeù
.
Çme
] =…lugin.plugin_object

626 
£lf
.
sÿnTy³ToŞBox
.
	`š£¹I‹m
(
·ges
, 
sÿns
[
idx
], sÿns[idx].
Çme
)

627 
sÿns
[
idx
].
roi_chªged
.
	`cÚÃù
(
£lf
.
Ú_sÿÅluggš_roi_chªged
)

628 
sÿns
[
idx
].
roi_d–‘ed
.
	`cÚÃù
(
£lf
.
Ú_sÿÁabË_roi_d–‘ed
)

629 
sÿns
[
idx
].
¶Ù_d©a
.
	`cÚÃù
(
£lf
.
Ú_¶Ù_d©a_lßded
)

630 
sÿns
[
idx
].
£Ëùed
.
	`cÚÃù
(
£lf
.
£t_cu¼’t_sÿn_¶uggš
)

631 
sÿns
[
idx
].
ş—r_®l_sig
.
	`cÚÃù
(
£lf
.
Ú_ş—r_®l
)

633 
£lf
.
sÿn_tbox_widg‘s
.
	`­³nd
(
sÿns
[
idx
])

634 
·ges
 += 1

636 
Ïyout
.
	`addWidg‘
(
£lf
.
sÿnTy³ToŞBox
)

637 
£lf
.
sÿnsF¿me
.
	`£tLayout
(
Ïyout
)

639 #####
_deàğ£lf.sÿn_tbox_widg‘s[0].g‘_max_sÿn_¿nge_lim™_def()

640 
¶Ù_™em_ty³
 = 
£lf
.
sÿn_tbox_widg‘s
[0].plot_item_type

641 if(
£lf
.
sÿn_tbox_widg‘s
[0].
	$is_muÉi_»giÚ
()):

642 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_’abË_muÉi_»giÚ
(
True
)

644 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_’abË_muÉi_»giÚ
(
F®£
)

646 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_sh­e_lim™s
(
sh­e
=
¶Ù_™em_ty³
, 
lim™_def
=limit_def)

647 
£lf
.
¶ÙTabWidg‘
.
	`£tCu¼’tIndex
(
PLOTTER_IMAGES_TAB
)

649 
dx
 = 
MAIN_OBJ
.
	`deviû
(
DNM_DETECTOR_X
)

650 
dy
 = 
MAIN_OBJ
.
	`deviû
(
DNM_DETECTOR_Y
)

651 
ûÁ”s
 = (
dx
.
	`g‘_pos™iÚ
(), 
dy
.get_position())

652 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_ûÁ”_©_XY
(
ûÁ”s
, (500,500))

653 
£lf
.
sÿnTy³ToŞBox
.
cu¼’tChªged
.
	`cÚÃù
(£lf.
Ú_toŞbox_chªged
)

655 
wdg_com
 = 
£lf
.
sÿn_tbox_widg‘s
[0].
	`upd©e_d©a
()

656 
£lf
.
sÿn_´og»ss_bË
.
	`lßd_wdg_com
(
wdg_com
)

660 
def
 
	$Ú_sÿÁabË_roi_d–‘ed
(
£lf
, 
wdg_com
):

662 
	$Ú_sÿÁabË_roi_d–‘ed
(): 
desütiÚ


664 :
·¿m
 
wdg_com
: wdg_com 
desütiÚ


665 :
ty³
 
wdg_com
: wdg_comype

667 :
»tuºs
: 
NÚe


670 
the
 
SÿnTabËV›w
 
widg‘
 
has
 
d–‘ed
 
a
 
¥©Ÿl
 
row
, 
·ss
 
šfo
 
Ú
 
to
 
¶Ù‹r


671 
so
 
th©
 
the
 
sh­eI‹m
 
ÿn
 
®so
 
be
 
d–‘ed


673 #™em_id = 
	`dù_g‘
(
wdg_com
, 
SPDB_SCAN_PLUGIN_ITEM_ID
)

674 
™em_id
 = 
	`dù_g‘
(
wdg_com
, 
SPDB_ID_VAL
)

675 
¶Ù_™em_ty³
 = 
	`dù_g‘
(
wdg_com
, 
SPDB_PLOT_SHAPE_TYPE
)

677 
™em
 = 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`g‘Sh­ePlÙI‹m
(
™em_id
, 
™em_ty³
=
¶Ù_™em_ty³
)

678 if(
™em
):

679 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`blockSigÇls
(
True
)

680 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`d–PlÙI‹m
(
™em
, 
»¶Ù
=
True
)

681 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`blockSigÇls
(
F®£
)

684 
def
 
	$£t_cu¼’t_sÿn_¶uggš
(
£lf
, 
idx
):

685 #£lf.
sÿnTy³ToŞBox
.
	`blockSigÇls
(
True
)

686 
_logg”
.
	`debug
('£t_cu¼’t_sÿn_¶uggš: [%d]' % 
idx
)

687 
£lf
.
sÿn_·Ãl_idx
 = 
idx


688 
£lf
.
sÿnTy³ToŞBox
.
	`£tCu¼’tIndex
(£lf.
sÿn_·Ãl_idx
)

689 #£lf.
sÿnTy³ToŞBox
.
	`blockSigÇls
(
F®£
)

691 
def
 
	$Ú_sÿn_lßded
(
£lf
, 
wdg_com
):

693 
	$Ú_sÿn_lßded
(): 
This
 
is
 
a
 
¦Ù
 
to
 
£rviû
‡ 
sigÇl
 
emm™‹d
 
äom
 
the
 
PLOTTER
 
Úly


695 :
·¿m
 
wdg_com
: wdg_com 
desütiÚ


696 :
ty³
 
wdg_com
: wdg_comype

697 
£lf
.
	`d–Sh­ePlÙI‹ms
()

698 :
»tuºs
: 
NÚe


702 
¥_db
 = 
	`g‘_fœ¡_¥_db_äom_wdg_com
(
wdg_com
)

704 
£lf
.
sÿn_·Ãl_idx
 = (
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_PANEL_IDX
))

705 #if(
£lf
.
sÿn_·Ãl_idx
 > 100):

706 #£lf.
sÿn_·Ãl_idx
 = 
sÿn_·Ãl_Üd”
.
IMAGE_SCAN


708 
£lf
.
sÿnTy³ToŞBox
.
	`£tCu¼’tIndex
(£lf.
sÿn_·Ãl_idx
)

709 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`£t_zp_focus_mode
()

710 
time
.
	`¦“p
(0.15)

711 #£lf.
sÿn_tbox_widg‘s
[
£lf
.
sÿn_·Ãl_idx
].
	`blockSigÇls
(
True
)

712 #£lf.
sÿn_tbox_widg‘s
[
£lf
.
sÿn_·Ãl_idx
].
	`mod_roi
(
¥_db
, 
do_»ÿlc
=
F®£
)

713 if(
	$dù_g‘
(
¥_db
, 
SPDB_PLOT_IMAGE_TYPE
è
š
 [
image_ty³s
.
FOCUS
, image_ty³s.
OSAFOCUS
]):

714 #dÚˆ
®low
 
sigÇls
 
th©
 
would
 
ÿu£
 
a
 
¶Ù
 
£gm’t
 
to
 
be
 
ü—‹d


715 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`blockSigÇls
(
True
)

716 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`lßd_roi
(
wdg_com
)

717 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`blockSigÇls
(
F®£
)

719 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`lßd_roi
(
wdg_com
)

720 #£lf.
sÿn_tbox_widg‘s
[
£lf
.
sÿn_·Ãl_idx
].
	`blockSigÇls
(
F®£
)

722 
def
 
	$Ú_sÿÅluggš_roi_chªged
(
£lf
, 
wdg_com
):

724 
	$Ú_sÿÅluggš_roi_chªged
(): 
desütiÚ


726 :
·¿m
 
wdg_com
: wdg_com 
desütiÚ


727 :
ty³
 
wdg_com
: wdg_comype

729 :
»tuºs
: 
NÚe


731 #_logg”.
	`debug
('on_scanpluggin_roi_changed: called')

732 if(
wdg_com
[
WDGCOM_CMND
] =ğ
widg‘_com_cmnd_ty³s
.
LOAD_SCAN
):

733 #£lf.
sÿn_´og»ss_bË
.
	`£t_dœeùÜy_Ïb–
(
£lf
.
aùive_u£r
.
	`g‘_d©a_dœ
())

734 #£lf.
sÿn_´og»ss_bË
.
	`lßd_wdg_com
(
wdg_com
)

736 ##
—ch
 
¥©Ÿl
 
»giÚ
 
ü—‹
 
a
 
¶Ù™em


737 #¥_roi ğ
	`dù_g‘
(
wdg_com
, 
WDGCOM_SPATIAL_ROIS
)

738 #fÜ 
¥_id
 
š
 
¥_rois
.
	`keys
():

739 #¥_db = 
¥_rois
[
¥_id
]

740 #»ù = 
¥_db
[
SPDB_RECT
]

741 #sÿn_™em_ty³ = (
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
))

742 #¶Ù_™em_ty³ = (
	`dù_g‘
(
¥_db
, 
SPDB_PLOT_SHAPE_TYPE
))

743 #£lf.
lšeByLšeImageD©aWidg‘
.
	`addSh­ePlÙI‹m
((
¥_id
), 
»ù
, 
™em_ty³
=
¶Ù_™em_ty³
)

744 
·ss


747 
¥_rois
 = 
	`dù_g‘
(
wdg_com
, 
WDGCOM_SPATIAL_ROIS
)

748 #if(
¥_rois
 
is
 
NÚe
):

750 if((
¥_rois
 
is
 
NÚe
è
	`Ü
 (
	`Ën
(¥_rois.
	`keys
()) < 1)):

752 
¥_id
 
š
 
¥_rois
.
	$keys
():

753 #¥_id = 
¥_rois
.
	`keys
()[0]

754 
¥_db
 = 
¥_rois
[
¥_id
]

755 
sÿn_™em_ty³
 = (
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
))

756 
¶Ù_™em_ty³
 = (
	`dù_g‘
(
¥_db
, 
SPDB_PLOT_SHAPE_TYPE
))

757 
™em_id
 = (
	`dù_g‘
(
¥_db
, 
SPDB_ID_VAL
))

759 if(
¶Ù_™em_ty³
 =ğ
¥©Ÿl_ty³_´efix
.
PNT
):

760 
x1
 = 
x2
 = (
	`dù_g‘
(
¥_db
, 
SPDB_XCENTER
))

761 
y1
 = 
y2
 = (
	`dù_g‘
(
¥_db
, 
SPDB_YCENTER
))

764 
x1
 = (
	`dù_g‘
(
¥_db
, 
SPDB_XSTART
))

765 
y1
 = (
	`dù_g‘
(
¥_db
, 
SPDB_YSTART
))

766 
x2
 = (
	`dù_g‘
(
¥_db
, 
SPDB_XSTOP
))

767 
y2
 = (
	`dù_g‘
(
¥_db
, 
SPDB_YSTOP
))

769 #´šˆ'Ú_sÿÅluggš_roi_chªged: i‹m_id = %d' % 
™em_id


770 
™em
 = 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`g‘Sh­ePlÙI‹m
(
™em_id
, 
¶Ù_™em_ty³
)

771 #£lf.
lšeByLšeImageD©aWidg‘
.
	`£t_sh­e_™em_max_¿nge
(
™em
, 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_MAX_SCANRANGE
))

773 
»ù
 = (
x1
, 
y1
, 
x2
, 
y2
)

775 #´šˆ'Ú_sÿÅluggš_roi_chªged:„eù=' , (
»ù
)

776 
sk_li¡
 = [
sÿn_ty³s
.
SAMPLE_FOCUS
, sÿn_ty³s.
OSA_FOCUS
]

777 if(
™em
 
is
 
NÚe
):

778 if(
sÿn_™em_ty³
 
nÙ
 
š
 
sk_li¡
):

779 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`addSh­ePlÙI‹m
(
™em_id
, 
»ù
, 
™em_ty³
=
¶Ù_™em_ty³
)

781 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`blockSigÇls
(
True
)

782 if(
wdg_com
[
WDGCOM_CMND
] =ğ
widg‘_com_cmnd_ty³s
.
SELECT_ROI
):

783 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£ËùSh­ePlÙI‹m
(
™em_id
, 
£Ëù
=
True
, 
™em
=™em, 
™em_ty³
=
¶Ù_™em_ty³
)

785 
	$–if
(
wdg_com
[
WDGCOM_CMND
] =ğ
widg‘_com_cmnd_ty³s
.
ROI_CHANGED
):

786 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`»sizeSh­ePlÙI‹m
(
™em_id
, 
»ù
, 
™em
=™em, 
™em_ty³
=
¶Ù_™em_ty³
)

788 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`blockSigÇls
(
F®£
)

790 
£lf
.
sÿn_´og»ss_bË
.
	`lßd_wdg_com
(
wdg_com
)

792 
def
 
	$Ú_¶Ù™em_roi_chªged
(
£lf
, 
wdg_com
):

794 
	$Ú_¶Ù™em_roi_chªged
(): 
desütiÚ


796 :
·¿m
 
wdg_com
: wdg_com 
desütiÚ


797 :
ty³
 
wdg_com
: wdg_comype

799 :
»tuºs
: 
NÚe


802 #´šˆ'Ú_¶Ù™em_roi_chªged: ', 
dù


803 if(
£lf
.
sÿn_š_´og»ss
):

806 
nÚ_š‹¿ùive_¶Ùs
 = [
sÿn_·Ãl_Üd”
.
POSITIONER_SCAN
]

808 
sk_sÿn_q_bË_¶Ùs
 = [
sÿn_·Ãl_Üd”
.
OSA_FOCUS_SCAN
, sÿn_·Ãl_Üd”.
FOCUS_SCAN
]

810 
x1
 = 
	`dù_g‘
(
wdg_com
, 
SPDB_XSTART
)

811 
y1
 = 
	`dù_g‘
(
wdg_com
, 
SPDB_YSTART
)

812 
x2
 = 
	`dù_g‘
(
wdg_com
, 
SPDB_XSTOP
)

813 
y2
 = 
	`dù_g‘
(
wdg_com
, 
SPDB_YSTOP
)

814 
»ù
 = (
x1
, 
y1
, 
x2
, 
y2
)

815 #´šˆ'Ú_¶Ù™em_roi_chªged:„eù', 
»ù


817 if(
£lf
.
sÿn_·Ãl_idx
 
š
 
nÚ_š‹¿ùive_¶Ùs
):

820 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`blockSigÇls
(
True
)

821 if(
wdg_com
[
WDGCOM_CMND
] =ğ
widg‘_com_cmnd_ty³s
.
ROI_CHANGED
):

823 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`mod_roi
(
wdg_com
)

824 
wdg_com
 = 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`upd©e_d©a
()

826 if(
£lf
.
sÿn_·Ãl_idx
 
š
 
sk_sÿn_q_bË_¶Ùs
):

827 #ju¡ 
sk
 
beÿu£
 
this
 
´oduûs
 
a
 
lÙ
 
of
 
chªges
 
to
 
the
 
sÿn_q_bË
 
whcih
 
cu¼’y
 
¬e
 
v”y
 
¦ow
 
wh’
 
fœšg
‡†ot of

828 #sigÇl 
to
 
§y
 
the
 
¶Ù
 
roi
 
has
 
chÇged


829 
·ss


831 
£lf
.
sÿn_´og»ss_bË
.
	`lßd_wdg_com
(
wdg_com
)

833 
	$–if
(
wdg_com
[
WDGCOM_CMND
] =ğ
widg‘_com_cmnd_ty³s
.
ADD_ROI
):

834 #·s 
Ú
 
this
 
add™iÚ
 
»que¡


835 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`mod_roi
(
wdg_com
)

837 
	$–if
(
wdg_com
[
WDGCOM_CMND
] =ğ
widg‘_com_cmnd_ty³s
.
DEL_ROI
):

838 #·s 
Ú
 
this
 
d–‘iÚ
 
»que¡


839 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`mod_roi
(
wdg_com
)

841 
	$–if
(
wdg_com
[
WDGCOM_CMND
] =ğ
widg‘_com_cmnd_ty³s
.
SELECT_ROI
):

842 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`mod_roi
(
wdg_com
)

844 
	$–if
(
wdg_com
[
WDGCOM_CMND
] =ğ
widg‘_com_cmnd_ty³s
.
DESELECT_ROI
):

845 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`mod_roi
(
wdg_com
)

848 
_logg”
.
	`”rÜ
('Ú_¶Ù™em_roi_chªged: unsuµÜ‹d widg‘_com commªdy³' % 
wdg_com
[
WDGCOM_CMND
])

849 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`blockSigÇls
(
F®£
)

851 
def
 
	$Ú_ş—r_®l
(
£lf
):

853 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`blockSigÇls
(
True
)

854 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`d–Sh­ePlÙI‹ms
()

855 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`blockSigÇls
(
F®£
)

857 
def
 
	$Ú_¶Ù_d©a_lßded
(
£lf
, 
l
):

859 
	$Ú_¶Ù_d©a_lßded
(): 
desütiÚ


861 :
·¿m
 
d©a_dù
: d©a_dù 
desütiÚ


862 :
ty³
 
d©a_dù
: data_dctype

864 :
»tuºs
: 
NÚe


866 #(
âame
, 
ado_obj
èğ
l


867 #wdg_com = 
	`dù_g‘
(
ado_obj
, 
ADO_CFG_WDG_COM
)

868 (
âame
, 
wdg_com
, 
d©a
èğ
l


869 
¥_db
 = 
	`g‘_fœ¡_¥_db_äom_wdg_com
(
wdg_com
)

871 ##
—ch
 
¥©Ÿl
 
»giÚ
 
ü—‹
 
a
 
¶Ù™em


872 #¥_roi ğ
	`dù_g‘
(
wdg_com
, 
WDGCOM_SPATIAL_ROIS
)

873 #fÜ 
¥_id
 
š
 
¥_rois
.
	`keys
():

874 #¥_db = 
¥_rois
[
¥_id
]

875 #»ù = 
¥_db
[
SPDB_RECT
]

876 #sÿn_™em_ty³ = (
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
))

877 #¶Ù_™em_ty³ = (
	`dù_g‘
(
¥_db
, 
SPDB_PLOT_SHAPE_TYPE
))

878 #£lf.
lšeByLšeImageD©aWidg‘
.
	`addSh­ePlÙI‹m
((
¥_id
), 
»ù
, 
™em_ty³
=
¶Ù_™em_ty³
)

879 #
(
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
è
nÙ
 
š
 [
sÿn_ty³s
.
SAMPLE_POINT_SPECTRUM
, sÿn_ty³s.
GENERIC_SCAN
]):

880 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`blockSigÇls
(
True
)

881 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`d–Sh­ePlÙI‹ms
()

882 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`lßd_image_d©a
(
âame
, 
wdg_com
, 
d©a
)

884 #Úly 
®low
 
the
 
sÿn
 
·¿m
 
sh­es
 
to
 
be
 
ü—‹d
 
NOT
 
a
 
focus
 
ty³
 sÿÀ
image


885 if(
	$dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
è
nÙ
 
š
 [
sÿn_ty³s
.
OSA_FOCUS
, sÿn_ty³s.
SAMPLE_FOCUS
]):

886 
»ù
 = 
¥_db
[
SPDB_RECT
]

887 
¥_id
 = (
	`dù_g‘
(
¥_db
, 
SPDB_ID_VAL
))

888 #sÿn_™em_ty³ = (
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
))

889 
¶Ù_™em_ty³
 = (
	`dù_g‘
(
¥_db
, 
SPDB_PLOT_SHAPE_TYPE
))

890 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`addSh­ePlÙI‹m
((
¥_id
), 
»ù
, 
™em_ty³
=
¶Ù_™em_ty³
)

892 #mak
su»
 
¶Ù‹r
 
is
 
aw¬e
 
™
 i 
suµo£d
 
to
 
®low
 
mÜe
 
thª
 
Úe
 
Sh³I‹m


893 #if(
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`is_muÉi_»giÚ
()):

894 #£lf.
lšeByLšeImageD©aWidg‘
.
	`£t_’abË_muÉi_»giÚ
(
True
)

896 #£lf.
lšeByLšeImageD©aWidg‘
.
	`£t_’abË_muÉi_»giÚ
(
F®£
)

898 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`blockSigÇls
(
F®£
)

900 
def
 
	$£tup_image_¶Ù
(
£lf
):

902 
	$£tup_image_¶Ù
(): 
desütiÚ


904 :
»tuºs
: 
NÚe


906 
fg_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_forgrnd'])

907 
bg_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_bckgrnd'])

908 
mš_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_gridmaj'])

909 
maj_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_gridmin'])

911 #grid·¿m = {'fg_şr':
fg_şr
, 'bg_şr':
bg_şr
, 'mš_şr':
mš_şr
, 'maj_şr':
maj_şr
}

913 #£lf.
lšeByLšeImageD©aWidg‘
 = 
ImageWidg‘
(
£lf
, 
ftSŒ
 = "*.hdf5", 
ty³
='ª®yze', 
§m¶e_pos_mode
=sample_pos_mode,

914 
£lf
.
lšeByLšeImageD©aWidg‘
 = 
ImageWidg‘
(
·»Á
=
NÚe
, 
ftSŒ
 = "*.hdf5", 
ty³
=None,

915 
İtiÚs
=
diù
(
lock_a¥eù_¿tio
=
True
, 
show_cÚŒa¡
=True, 
show_x£ùiÚ
=True, 
show_y£ùiÚ
=True,

916 
xÏb–
=("miüÚs", ""), 
yÏb–
=("miüÚs", ""), 
cŞÜm­
="gist_gray"))

917 
£lf
.
lšeByLšeImageD©aWidg‘
.
£tObjeùName
("lineByLineImageDataWidget")

918 
£lf
.
lšeByLšeImageD©aWidg‘
.
»gi¡”_o§_ªd_§m¶ehldr_toŞ
(
§m¶e_pos_mode
)

919 #£lf.
lšeByLšeImageD©aWidg‘
.
£t_ŒªsfÜm_çùÜs
(0.333, 0.333, 0.333, 'um')

920 
£lf
.
lšeByLšeImageD©aWidg‘
.
£tMšimumSize
(600,600)

921 
£lf
.
lšeByLšeImageD©aWidg‘
.
£tMaximumSize
(1000,1000)

922 
£lf
.
lšeByLšeImageD©aWidg‘
.
’abË_toŞ_by_Çme
('StxmO³nFeToŞ', 
F®£
)

923 #£lf.
lšeByLšeImageD©aWidg‘
.
£t_§m¶e_pos™iÚšg_mode
(
§m¶e_pos_mode
)

924 
£lf
.
lšeByLšeImageD©aWidg‘
.
£t_d©aIO
(
BioxasD©aIo
)

926 #£lf.
lšeByLšeImageD©aWidg‘
.
addToŞ
('HLineSegmentTool')

928 
£lf
.
lšeByLšeImageD©aWidg‘
.
£t_grid_·¿m‘”s
(
bg_şr
, 
mš_şr
, 
maj_şr
)

929 
£lf
.
lšeByLšeImageD©aWidg‘
.
£t_cs_grid_·¿m‘”s
(
fg_şr
, 
bg_şr
, 
mš_şr
, 
maj_şr
)

931 
£lf
.
lšeByLšeImageD©aWidg‘
.
Ãw_roi_ûÁ”
.
cÚÃù
(£lf.
Ú_¶Ù™em_roi_chªged
)

932 
£lf
.
lšeByLšeImageD©aWidg‘
.
sÿn_lßded
.
cÚÃù
(£lf.
Ú_sÿn_lßded
)

934 
vbox
 = 
QtWidg‘s
.
QVBoxLayout
()

935 
vbox
.
addWidg‘
(
£lf
.
lšeByLšeImageD©aWidg‘
)

936 
£lf
.
imagePlÙF¿me
.
£tLayout
(
vbox
)

938 #£lf.
lšeByLšeImageD©aWidg‘
.
ü—‹_§m¶e_hŞd”
()

940 
£lf
.
lšeByLšeImageD©aWidg‘
.
£t_d©a_dœ
(£lf.
aùive_u£r
.
g‘_d©a_dœ
())

941 
MAIN_OBJ
.
£t
('IMAGE_WIDGET', 
£lf
.
lšeByLšeImageD©aWidg‘
)

944 
def
 
	$£tup_¥eù¿_¶Ù
(
£lf
):

946 
	$£tup_¥eù¿_¶Ù
(): 
desütiÚ


948 :
»tuºs
: 
NÚe


950 
vbox
 = 
QtWidg‘s
.
	`QVBoxLayout
()

951 #£lf.
¥eù¿Widg‘
 = 
	`CurveV›w”Widg‘
(
·»Á
 = 
£lf
, 
wšT™ËSŒ
 = "Spectra Data Viewer")

952 
£lf
.
¥eù¿Widg‘
 = 
	`CurveV›w”Widg‘
()

953 
£lf
.
¥eù¿Widg‘
.
	`£tObjeùName
("spectraWidget")

954 
£lf
.
¥eù¿Widg‘
.
	`add_Ëg’d
("TL")

956 
vbox
.
	`addWidg‘
(
£lf
.
¥eù¿Widg‘
)

957 
£lf
.
¥eù¿PlÙF¿me
.
	`£tLayout
(
vbox
)

960 
def
 
	$£tup_ÿlib_ÿm”a
(
£lf
):

962 
	$£tup_video_·Ãl
(): 
desütiÚ


964 :
»tuºs
: 
NÚe


965 
¶ÙTabWidg‘


966 
b3


968 
äom
 
şs
.
­¶iÿtiÚs
.
bioXasIM
.
widg‘s
.
ÿm”a_ruËr
 
impÜt
 
Cam”aRuËr
, 
ÿmruËr_mode


969 
vbox
 = 
QtWidg‘s
.
	`QVBoxLayout
()

970 #£lf.
¥eù¿Widg‘
 = 
	`CurveV›w”Widg‘
(
·»Á
 = 
£lf
, 
wšT™ËSŒ
 = "Spectra Data Viewer")

971 
£lf
.
ÿlibCamWidg‘
 = 
	`Cam”aRuËr
(
mode
=
ÿmruËr_mode
.
CLIENT
)

972 
£lf
.
ÿlibCamWidg‘
.
	`£tObjeùName
("calibCamWidget")

975 
vbox
.
	`addWidg‘
(
£lf
.
ÿlibCamWidg‘
)

976 
£lf
.
ÿlibCamPlÙF¿me
.
	`£tLayout
(
vbox
)

978 #deà
	`add_to_¶Ù_b_widg‘
(
£lf
, 
b_num
, 
b_t™Ë
, 
widg
):

979 #tw = 
£lf
.
	`_g‘_ba£_b_widg‘
()

980 #£lf.
¶ÙTabWidg‘
.
	`£tTabPos™iÚ
(
b_num
)

981 #£lf.
¶ÙTabWidg‘
.
	`£tTabText
(
b_t™Ë
)

982 #£lf.
¶ÙTabWidg‘
.

983 #
#deà
	`_g‘_ba£_b_widg‘
(
£lf
):

984 #tw = 
QtWidg‘s
.
	`QWidg‘
()

985 #tàğ
QtWidg‘s
.
	`QF¿me
()

986 #vbox = 
QtWidg‘s
.
	`QVBoxLayout
()

987 #vbox.
	`addWidg‘
(
tf
)

988 #tw.
	`£tLayout
(
vbox
)

989 #»tuº(
tw
)

992 
def
 
	$£tup_video_·Ãl
(
£lf
):

994 
	$£tup_video_·Ãl
(): 
desütiÚ


996 :
»tuºs
: 
NÚe


998 
·ss


999 #QWebS‘tšgs.
	`glob®S‘tšgs
().
	`£tA‰ribu‹
(
QWebS‘tšgs
.
PlugšsEÇbËd
, 
True
)

1000 #QWebS‘tšgs.
	`glob®S‘tšgs
().
	`£tA‰ribu‹
(
QWebS‘tšgs
.
AutoLßdImages
, 
True
)

1001 #£lf.
videoWebV›w
.
	`£tU¾
(
QtCÜe
.
	`QU¾
("http://ccd1608-500.clsi.ca/jpg/image.jpg"))

1002 #£lf.
videoWebV›w
.
	`lßd
(
QtCÜe
.
	`QU¾
("http://ccd1608-500.clsi.ca/jpg/image.jpg"))

1004 #£lf.
videoWebV›w
.
	`£tU¾
(
QtCÜe
.
	`QU¾
("http://v2e1602-101/axis-cgi/mjpg/video.cgi?camera=1"))

1005 #£lf.
videoWebV›w
.
	`lßd
(
QtCÜe
.
	`QU¾
("http://v2e1602-101/axis-cgi/mjpg/video.cgi?camera=1"))

1007 #£lf.
vidTim”
.
	`¡¬t
(250)

1009 #£lf.
videoPÏy”
.
	`lßd
(
PhÚÚ
.
	`MedŸSourû
('http://ccd1608-500.clsi.ca/view/index.shtml'))

1010 #£lf.
videoPÏy”
.
	`¶ay
()

1012 
def
 
	$Ú_video_tim”
(
£lf
):

1014 
	$Ú_video_tim”
(): 
desütiÚ


1016 :
»tuºs
: 
NÚe


1018 
£lf
.
videoWebV›w
.
	`lßd
(
QtCÜe
.
	`QU¾
("http://ccd1608-500.clsi.ca/jpg/image.jpg"))

1019 #£lf.
videoWebV›w
.
	`»lßd
()

1022 
def
 
	$£tup_šfo_dock
(
£lf
):

1024 
	$£tup_šfo_dock
(): 
desütiÚ


1026 :
»tuºs
: 
NÚe


1028 #n ğ{'maš': 
£lf
, 'widg‘': s–f, 'd‘_sÿn' : 
sÿns
[1]
	}
}

1029 
ns
 = {'maš': 
£lf
, 'pythÚSh–l': s–f.
pythÚsh–l
, 'g':
glob®s
() }

1031 
£lf
.
pythÚsh–l
 = 
Sh–lWidg‘
(
·»Á
=
NÚe
, 
Çme¥aû
=
ns
,
commªds
=[], 
muÉ™h»aded
=
True
)

1032 
£lf
.
pycÚsŞe_Ïyout
.
addWidg‘
(£lf.
pythÚsh–l
)

1033 #£lf.
­¶y_¡yËsh“t
(
£lf
.
pythÚsh–l
, s–f.
qssh“t
)

1035 
def
 
	$Ú_toŞbox_chªged
(
£lf
, 
idx
):

1037 
	$Ú_toŞbox_chªged
(): 
desütiÚ


1039 :
·¿m
 
idx
: idx 
desütiÚ


1040 :
ty³
 
idx
: idxype

1042 :
»tuºs
: 
NÚe


1044 
	`»£t_unique_roi_id
()

1045 
¿nges
 = (
NÚe
, None)

1046 #´šˆ'Ú_toŞbox_chªged: %d' % 
idx


1047 
¥eù¿_¶Ù_ty³s
 = [
sÿn_·Ãl_Üd”
.
POINT_SCAN
]

1048 
nÚ_š‹¿ùive_¶Ùs
 = [
sÿn_·Ãl_Üd”
.
POSITIONER_SCAN
]

1049 
muÉi_¥©Ÿl_sÿn_ty³s
 = [
sÿn_ty³s
.
SAMPLE_POINT_SPECTRUM
, sÿn_ty³s.
SAMPLE_LINE_SPECTRUM
, sÿn_ty³s.
SAMPLE_IMAGE
, \

1050 
sÿn_ty³s
.
SAMPLE_IMAGE_STACK
]

1052 
sk_li¡
 = [
sÿn_ty³s
.
SAMPLE_FOCUS
, sÿn_ty³s.
OSA_FOCUS
]

1054 
£lf
.
sÿn_·Ãl_idx
 = 
idx


1056 if(
	`Ën
(
£lf
.
sÿn_tbox_widg‘s
) > 0):

1057 
£lf
.
sÿn_´og»ss_bË
.
	`ş—r_bË
()

1058 
§m¶e_pos™iÚšg_mode
 = 
MAIN_OBJ
.
	`g‘_§m¶e_pos™iÚšg_mode
()

1060 
sÿn_¶uggš
 = 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
]

1061 
¿nges
 = 
sÿn_¶uggš
.
	`g‘_§ved_¿nge
()

1062 
ûÁ”s
 = 
sÿn_¶uggš
.
	`g‘_§ved_ûÁ”
()

1063 
axis_¡rs
 = 
sÿn_¶uggš
.
	`g‘_axis_¡rs
()

1064 
max_sÿn_¿nge
 = 
sÿn_¶uggš
.
	`g‘_¥©Ÿl_sÿn_¿nge
()

1065 
lim™_def
 = 
sÿn_¶uggš
.
	`g‘_max_sÿn_¿nge_lim™_def
()

1066 
¶Ù_™em_ty³
 = 
sÿn_¶uggš
.plot_item_type

1067 
’abË_muÉi_»giÚ
 = 
sÿn_¶uggš
.
	`is_muÉi_»giÚ
()

1068 
sÿn_ty³
 = 
sÿn_¶uggš
.
	`g‘_sÿn_ty³
()

1069 #wdg_com = 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`upd©e_d©a
()

1070 #£lf.
sÿn_´og»ss_bË
.
	`lßd_wdg_com
(
wdg_com
)

1072 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`d–Sh­ePlÙI‹ms
()

1073 if(
idx
 
š
 
¥eù¿_¶Ù_ty³s
):

1074 #£lf.
¶ÙTabWidg‘
.
	`£tCu¼’tIndex
(0)

1075 
£lf
.
¥eù¿Widg‘
.
	`£tPlÙAxisSŒs
(
axis_¡rs
[0],‡xis_strs[1])

1077 
£lf
.
¶ÙTabWidg‘
.
	`£tCu¼’tIndex
(
PLOTTER_IMAGES_TAB
)

1079 if((
¿nges
[0] 
is
 
nÙ
 
NÚe
è
	`ªd
 (ranges[1] is‚ot None)):

1081 if((
£lf
.
sÿn_·Ãl_idx
 =ğ
sÿn_·Ãl_Üd”
.
IMAGE_SCAN
è
	$ªd
 (
§m¶e_pos™iÚšg_mode
 =ğ
§m¶e_pos™iÚšg_modes
.
GONIOMETER
)):

1082 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_ûÁ”_©_XY
(
ûÁ”s
, 
¿nges
)

1084 
·ss


1085 #sx = 
MAIN_OBJ
.
	`deviû
(
DNM_SAMPLE_X
)

1086 #sy = 
MAIN_OBJ
.
	`deviû
(
DNM_SAMPLE_Y
)

1087 #ûÁ” ğ(
sx
.
	`g‘_pos™iÚ
(), 
sy
.get_position())

1088 #£lf.
lšeByLšeImageD©aWidg‘
.
	`£t_ûÁ”_©_XY
(
ûÁ”s
, 
¿nges
)

1091 #£lf.
lšeByLšeImageD©aWidg‘
.
	`£t_sh­e_lim™s
(
sh­e
=
¶Ù_™em_ty³
, 
lim™_def
=limit_def)

1092 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£tPlÙAxisSŒs
(
axis_¡rs
[0],‡xis_strs[1])

1094 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_max_sh­e_sizes
(
max_sÿn_¿nge
)

1095 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_’abË_muÉi_»giÚ
(
’abË_muÉi_»giÚ
)

1097 if(
£lf
.
sÿn_·Ãl_idx
 
š
 
nÚ_š‹¿ùive_¶Ùs
):

1098 #di§bË 
®l
 
roi
 
£ËùiÚ
 
toŞs


1099 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_sh­e_lim™s
(
sh­e
=
NÚe
, 
lim™_def
=None)

1101 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_sh­e_lim™s
(
sh­e
=
¶Ù_™em_ty³
, 
lim™_def
=limit_def)

1104 if(
	`Ën
(
£lf
.
sÿn_tbox_widg‘s
) > 0):

1105 #som
of
 
the
 
·¿ms
 
Ú
 
a
 
·¹icuÏr
 
toŞ
 
box
 
»ad
 
pv
's so make surehe 

1106 #focu 
ÿlc
 
mode
 
is
 
£t
 
cÜ»ùly
 
ªd
 
has
 
time
 
to
 
´oûss


1107 
sÿn_¶uggš
.
	`£t_zp_focus_mode
()

1108 
time
.
	`¦“p
(0.15)

1109 
sÿn_¶uggš
.
	`lßd_äom_deçuÉs
()

1111 #if(
sÿn_ty³
 
š
 
muÉi_¥©Ÿl_sÿn_ty³s
):

1112 
wdg_com
 = 
sÿn_¶uggš
.
	`upd©e_d©a
()

1114 #if(
wdg_com
):

1115 #if(
	`Ën
(
wdg_com
['SPATIAL_ROIS']) > 0):

1116 #£lf.
sÿn_´og»ss_bË
.
	`lßd_wdg_com
(
wdg_com
)

1119 
def
 
	$š™_¡©usb¬
(
£lf
):

1121 
	$š™_¡©usb¬
(): 
desütiÚ


1123 :
»tuºs
: 
NÚe


1125 
£lf
.
¡©us_li¡
 = []

1126 
t™Ë_cŞÜ
ğ
ma¡”_cŞÜs
['app_blue']

1127 
fbk_cŞÜ
 = 'white'

1128 
msg_cŞÜ
 = 
ma¡”_cŞÜs
['msg_color']

1129 
ma_cŞÜ
 = 
ma¡”_cŞÜs
['app_yellow']

1133 #£·¿tÜ = 
QtWidg‘s
.
	`QLab–
()

1134 #£·¿tÜ.
	`£tMaximumWidth
(5000)

1135 #£·¿tÜ.
	`£tSizePŞicy
(
QtWidg‘s
.
QSizePŞicy
.
Ex·ndšg
, QtWidgets.QSizePolicy.Expanding)

1136 #£lf.
¡©us_li¡
.
	`­³nd
(
£·¿tÜ
)

1138 #£lf.
¡©us_li¡
.
	`­³nd
(
	`ÿ_¡rLab–
(
MAIN_OBJ
.
	`deviû
('SRStus_msgL1'), 
hdrText
='SR Stus', 
t™Ë_cŞÜ
ñ™Ë_cŞÜ, 
v¬_şr
=
fbk_cŞÜ
))

1139 #£lf.
¡©us_li¡
.
	`­³nd
(
	`ÿ_¡rLab–
(
MAIN_OBJ
.
	`deviû
('SRStus_msgL2'), 
t™Ë_cŞÜ
ñ™Ë_cŞÜ, 
v¬_şr
=
fbk_cŞÜ
))

1140 #£lf.
¡©us_li¡
.
	`­³nd
(
	`ÿ_¡rLab–
(
MAIN_OBJ
.
	`deviû
('SRStus_msgL3'), 
t™Ë_cŞÜ
ñ™Ë_cŞÜ, 
v¬_şr
=
fbk_cŞÜ
))

1142 #£lf.
¡©us_li¡
.
	`­³nd
(
	`ÿ_aiLab–Widg‘
(
MAIN_OBJ
.
	`deviû
('MÚo_ev_fbk'), 
hdrText
='EÃrgy', 
egu
='eV', 
t™Ë_cŞÜ
ñ™Ë_cŞÜ, 
v¬_şr
=
fbk_cŞÜ
))

1143 #£lf.
¡©us_li¡
.
	`­³nd
(
	`ÿ_aiLab–Widg‘
(
MAIN_OBJ
.
	`deviû
('tick”'), 
hdrText
='I0', 
t™Ë_cŞÜ
ñ™Ë_cŞÜ, 
v¬_şr
=
fbk_cŞÜ
))

1144 
£lf
.
¡©us_li¡
.
	`­³nd
(
	`ÿ_mbbiLab–Widg‘
(
MAIN_OBJ
.
	`deviû
('SYSTEM:mode:fbk').
	`g‘_Çme
(), 
hdrText
='SR Mode', 
t™Ë_cŞÜ
ñ™Ë_cŞÜ, 
v¬_şr
=
fbk_cŞÜ
))

1145 
£lf
.
¡©us_li¡
.
	`­³nd
(
	`ÿ_aiLab–Widg‘
(
MAIN_OBJ
.
	`deviû
('StÜageRšgCu¼’t'), 
hdrText
='Ršg', 
egu
='mA', 
t™Ë_cŞÜ
ñ™Ë_cŞÜ, 
v¬_şr
=
fbk_cŞÜ
, 
®¬m
=5, 
w¬n
=20))

1146 
£lf
.
¡©us_li¡
.
	`­³nd
(
QtWidg‘s
.
	`QLab–
('B—mlše: ' + 
MAIN_OBJ
.
	`g‘_b—mlše_Çme
()))

1147 
£lf
.
¡©us_li¡
.
	`­³nd
(
QtWidg‘s
.
	`QLab–
('EndStiÚ: ' + 
MAIN_OBJ
.
	`g‘_’d¡©iÚ_Çme
()))

1149 
¡s
 
š
 
£lf
.
¡©us_li¡
:

1150 
£lf
.
	`¡©usB¬
().
	`addP”mª’tWidg‘
(
¡s
)

1151 #add 
a
 
£·¿tÜ


1152 
£lf
.
	`¡©usB¬
().
	`addP”mª’tWidg‘
(
QtWidg‘s
.
	`QLab–
('|'))

1155 #deà
	`add_lše_to_¶Ù
(
£lf
, 
row
, 
sÿn_d©a
):

1156 
def
 
	$add_lše_to_¶Ù
(
£lf
, 
couÁ”_to_¶Ù‹r_com_dù
):

1158 
	$add_lše_to_¶Ù
(): 
desütiÚ


1160 :
·¿m
 
row
:„ow 
desütiÚ


1161 :
ty³
 
row
:„owype

1163 :
·¿m
 
sÿn_d©a
: sÿn_d©¨
desütiÚ


1164 :
ty³
 
sÿn_d©a
: scan_dataype

1166 :
»tuºs
: 
NÚe


1169 
N“ded
 
a
 
æag
 
to
 
mÚ™Ü
 
wh’
Ø
¡¬t
‡ 
Ãw
 
image


1171 
CNTR2PLOT_TYPE_ID
 = 'ty³_id' #tØ
be
 
u£d
 
to
 
šdiÿ‹
 
wh©
 
kšd
 
of
 
couÁ”
/
sÿn
 
is
 
£ndšg
 
this
 
šfo


1172 
CNTR2PLOT_ROW
 = 'row' #¨
y
 
pos™iÚ


1173 
CNTR2PLOT_COL
 = 'cŞ' #ª 
x
 
pos™iÚ


1174 
CNTR2PLOT_VAL
 = 'v®' #th
pošt
 
Ü
 
¬¿y
 
of
 
d©a


1175 
CNTR2PLOT_IMG_CNTR
 = 'img_úŒ' #cu¼’ˆ
image
 
couÁ”


1176 
CNTR2PLOT_EV_CNTR
 = 'ev_idx' #cu¼’ˆ
’”gy
 
couÁ”


1177 
CNTR2PLOT_SP_ID
 = '¥_id' #¥©ŸÈ
id
 
this
 
d©a
 
b–Úgs
 
to


1178 
CNTR2PLOT_IS_POINT
 = 'is_pxp' #d©¨
is
 
äom
 
a
 
pošt
 
by
…ošˆ
sÿn


1179 
CNTR2PLOT_IS_LINE
 = 'is_lxl' #d©¨
isäom
 
a
 
lše
 
by
†š
sÿn


1181 #´šˆ'add_lše_to_¶Ù:„ow=%d' % 
row


1182 #´šˆ
couÁ”_to_¶Ù‹r_com_dù


1183 
row
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_ROW
]

1184 
cŞ
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_COL
]

1185 
lše_d©a
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_VAL
]

1186 
img_úŒ
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_IMG_CNTR
]

1187 
is_lše
 = 
couÁ”_to_¶Ù‹r_com_dù
[ 
CNTR2PLOT_IS_LINE
 ]

1188 
is_pošt
 = 
couÁ”_to_¶Ù‹r_com_dù
[ 
CNTR2PLOT_IS_POINT
 ]

1189 #£lf.
cur_image_idx
 = 
_dù
['img_idx']

1191 if(
£lf
.
	`g‘_cur_sÿn_ty³
(è=ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
):

1192 #if(
nÙ
 
£lf
.
image_¡¬‹d
 
	`ªd
 (
cŞ
 == 0)):

1193 #if(
nÙ
 
£lf
.
executšgSÿn
.
image_¡¬‹d
 
	`ªd
 (
cŞ
 == 0)):

1194 if(
is_pošt
):

1195 if(
nÙ
 
£lf
.
executšgSÿn
.
image_¡¬‹d
 
	`ªd
 (
cŞ
 =ğ0èªd (
row
 == 0)):

1196 
£lf
.
	`Ú_image_¡¬t
()

1197 if(
is_lše
):

1198 if(
nÙ
 
£lf
.
executšgSÿn
.
image_¡¬‹d
 
	`ªd
 (
cŞ
 == 0)):

1199 
£lf
.
	`Ú_image_¡¬t
()

1202 if(
cŞ
 > 0):

1203 #£lf.
image_¡¬‹d
 = 
F®£


1204 
£lf
.
executšgSÿn
.
image_¡¬‹d
 = 
F®£


1206 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`addV”tiÿlLše
(
cŞ
, 
lše_d©a
, 
True
)

1208 #if(
nÙ
 
£lf
.
image_¡¬‹d
 
	`ªd
 (
row
 == 0)):

1209 #if(
nÙ
 
£lf
.
executšgSÿn
.
image_¡¬‹d
 
	`ªd
 (
row
 == 0)):

1210 if(
is_pošt
):

1211 if(
nÙ
 
£lf
.
executšgSÿn
.
image_¡¬‹d
 
	`ªd
 (
cŞ
 =ğ0èªd (
row
 == 0)):

1212 
£lf
.
	`Ú_image_¡¬t
()

1214 if(
is_lše
):

1215 if(
nÙ
 
£lf
.
executšgSÿn
.
image_¡¬‹d
 
	`ªd
 (
row
 == 0)):

1216 
£lf
.
	`Ú_image_¡¬t
()

1219 if(
row
 > 0):

1220 #£lf.
image_¡¬‹d
 = 
F®£


1221 
£lf
.
executšgSÿn
.
image_¡¬‹d
 = 
F®£


1223 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`addLše
(0, 
row
, 
lše_d©a
, 
True
)

1227 #deà
	`add_pošt_to_¶Ù
(
£lf
, 
row
, 
l
):

1228 
def
 
	$add_pošt_to_¶Ù
(
£lf
, 
couÁ”_to_¶Ù‹r_com_dù
):

1230 
	$add_pošt_to_¶Ù
(): 
desütiÚ


1231 
CNTR2PLOT_TYPE_ID
 = 'ty³_id' #tØ
be
 
u£d
 
to
 
šdiÿ‹
 
wh©
 
kšd
 
of
 
couÁ”
/
sÿn
 
is
 
£ndšg
 
this
 
šfo


1232 
CNTR2PLOT_ROW
 = 'row' #¨
y
 
pos™iÚ


1233 
CNTR2PLOT_COL
 = 'cŞ' #ª 
x
 
pos™iÚ


1234 
CNTR2PLOT_VAL
 = 'v®' #th
pošt
 
Ü
 
¬¿y
 
of
 
d©a


1235 
CNTR2PLOT_IMG_CNTR
 = 'img_úŒ' #cu¼’ˆ
image
 
couÁ”


1236 
CNTR2PLOT_EV_CNTR
 = 'ev_idx' #cu¼’ˆ
’”gy
 
couÁ”


1237 
CNTR2PLOT_SP_ID
 = '¥_id' #¥©ŸÈ
id
 
this
 
d©a
 
b–Úgs
 
to


1238 
CNTR2PLOT_IS_POINT
 = 'is_pxp' #d©¨
is
 
äom
 
a
 
pošt
 
by
…ošˆ
sÿn


1239 
CNTR2PLOT_IS_LINE
 = 'is_lxl' #d©¨
isäom
 
a
 
lše
 
by
†š
sÿn


1241 :
·¿m
 
row
:„ow 
desütiÚ


1242 :
ty³
 
row
:„owype

1244 :
·¿m
 
l
:¶ 
desütiÚ


1245 :
ty³
 
l
:plype

1247 :
»tuºs
: 
NÚe


1250 
N“d
 
a
 
æag
 
to
 
mÚ™Ü
 
wh’
Ø
¡¬t
‡ 
Ãw
 
image


1253 #´šˆ
couÁ”_to_¶Ù‹r_com_dù


1254 
row
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_ROW
]

1255 
cŞ
 = 
pošt
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_COL
]

1256 
v®
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_VAL
]

1257 
img_úŒ
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_IMG_CNTR
]

1258 
ev_úŒ
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_EV_CNTR
]

1260 if(
£lf
.
	`g‘_cur_sÿn_ty³
(è=ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
):

1261 if(
nÙ
 
£lf
.
executšgSÿn
.
image_¡¬‹d
 
	`ªd
 (
ev_úŒ
 =ğ0èªd ((
cŞ
 =ğ0èªd (
row
 == 0))):

1262 
£lf
.
	`Ú_image_¡¬t
()

1264 if(
cŞ
 > 0):

1265 
£lf
.
executšgSÿn
.
image_¡¬‹d
 = 
F®£


1267 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`addPošt
(
row
, 
pošt
, 
v®
, 
True
)

1270 if(
nÙ
 
£lf
.
executšgSÿn
.
image_¡¬‹d
 
	`ªd
 (
row
 == 0)):

1271 
£lf
.
	`Ú_image_¡¬t
()

1273 #´šˆ'add_pošt_to_¶Ù:„ow=%d,…ošt=%d, v®=%d' % (
row
, 
pošt
, 
v®
)

1274 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`addPošt
(
row
, 
pošt
, 
v®
, 
True
)

1276 #deà
	`add_pošt_to_¥eù¿
(
£lf
, 
row
, 
l
):

1277 
def
 
	$add_pošt_to_¥eù¿
(
£lf
, 
couÁ”_to_¶Ù‹r_com_dù
):

1279 
	$add_pošt_to_¥eù¿
():

1280 
CNTR2PLOT_TYPE_ID
 = 'ty³_id' #tØ
be
 
u£d
 
to
 
šdiÿ‹
 
wh©
 
kšd
 
of
 
couÁ”
/
sÿn
 
is
 
£ndšg
 
this
 
šfo


1281 
CNTR2PLOT_ROW
 = 'row' #¨
y
 
pos™iÚ


1282 
CNTR2PLOT_COL
 = 'cŞ' #ª 
x
 
pos™iÚ


1283 
CNTR2PLOT_VAL
 = 'v®' #th
pošt
 
Ü
 
¬¿y
 
of
 
d©a


1284 
CNTR2PLOT_IMG_CNTR
 = 'img_úŒ' #cu¼’ˆ
image
 
couÁ”


1285 
CNTR2PLOT_EV_CNTR
 = 'ev_idx' #cu¼’ˆ
’”gy
 
couÁ”


1286 
CNTR2PLOT_SP_ID
 = '¥_id' #¥©ŸÈ
id
 
this
 
d©a
 
b–Úgs
 
to


1287 
CNTR2PLOT_IS_POINT
 = 'is_pxp' #d©¨
is
 
äom
 
a
 
pošt
 
by
…ošˆ
sÿn


1288 
CNTR2PLOT_IS_LINE
 = 'is_lxl' #d©¨
isäom
 
a
 
lše
 
by
†š
sÿn


1290 :
·¿m
 
row
:„ow 
desütiÚ


1291 :
ty³
 
row
:„owype

1293 :
·¿m
 
l
:¶ 
desütiÚ


1294 :
ty³
 
l
:plype

1296 :
»tuºs
: 
NÚe


1299 #_logg”.
	`debug
('add_point_to_spectra: called with„ow=%d,pl=')

1300 
¥_id
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_SP_ID
]

1301 
row
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_ROW
]

1302 
pošt
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_COL
]

1303 
v®
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_VAL
]

1306 #´šˆ'add_pošt_to_¥eù¿: sp_id=%d„ow=%d,…ošt=%d, v®=%d' % (
¥_id
, 
row
, 
pošt
, 
v®
)

1307 
£lf
.
¥eù¿Widg‘
.
	`addXYPošt
('¥_id_%d'%
¥_id
, 
pošt
, 
v®
, 
upd©e
=
True
)

1309 
def
 
	$»£t_image_¶Ù
(
£lf
):

1310 
£lf
.
image_¡¬‹d
 =ğ
F®£


1311 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`d–ImagePlÙI‹ms
()

1312 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`d–Sh­ePlÙI‹ms
()

1313 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_auto_cÚŒa¡
(
True
)

1315 
def
 
	`assign_d©afe_Çmes_to_¥_db
(
£lf
, 
¥_db
, 
d
, 
image_idx
=0):

1316 ''' d key ['
thumb_Çme
', '
´efix
', '
d©a_ext
', '
¡ack_dœ
', '
d©a_Çme
', '
thumb_ext
']

1318 
ado_obj
 = 
	`dù_g‘
(
¥_db
, 
SPDB_ACTIVE_DATA_OBJECT
)

1319 
	`dù_put
(
ado_obj
, 
ADO_CFG_DATA_DIR
, 
d
['data_dir'])

1320 
	`dù_put
(
ado_obj
, 
ADO_CFG_DATA_FILE_NAME
, 
d
['data_name'])

1321 
	`dù_put
(
ado_obj
, 
ADO_CFG_DATA_THUMB_NAME
, 
d
['thumb_name'])

1322 
	`dù_put
(
ado_obj
, 
ADO_CFG_PREFIX
, 
d
['prefix'])

1323 
	`dù_put
(
ado_obj
, 
ADO_CFG_DATA_EXT
, 
d
['data_ext'])

1324 
	`dù_put
(
ado_obj
, 
ADO_CFG_STACK_DIR
, 
d
['stack_dir'])

1325 
	`dù_put
(
ado_obj
, 
ADO_CFG_THUMB_EXT
, 
d
['thumb_ext'])

1326 
	`dù_put
(
ado_obj
, 
ADO_CFG_DATA_IMG_IDX
, 
image_idx
)

1329 
def
 
	$‹¡_ty³
(
£lf
, 
v®
, 
typ
):

1330 if((
v®
 
is
 
NÚe
è
	`Ü
 (
	`ty³
(v®è!ğ
typ
)):

1331 (
F®£
)

1333 (
True
)

1335 
def
 
	$‹¡_assign_d©afe_Çmes_to_¥_db
(
£lf
, 
wdg_com
):

1337 
to
  
Ú
Ø
the
 
sÿn
 
Ïss


1338 
d
 
keys
 ['thumb_name', 'prefix', 'data_ext', 'stack_dir', 'data_name', 'thumb_ext']

1340 
_l¡
 = []

1341 
¥_rois
 = 
	`dù_g‘
(
wdg_com
, 
WDGCOM_SPATIAL_ROIS
)

1342 
¥_ids
 = 
	`sÜ‹d
(
¥_rois
.
	`keys
())

1343 
¥_id
 
š
 
¥_ids
:

1344 
¥_db
 = 
¥_rois
[
¥_id
]

1345 
ado_obj
 = 
	`dù_g‘
(
¥_db
, 
SPDB_ACTIVE_DATA_OBJECT
)

1346 
_l¡
.
	`­³nd
(
£lf
.
	`‹¡_ty³
(
	`dù_g‘
(
ado_obj
, 
ADO_CFG_DATA_DIR
), 
¡r
))

1347 
_l¡
.
	`­³nd
(
£lf
.
	`‹¡_ty³
(
	`dù_g‘
(
ado_obj
, 
ADO_CFG_DATA_FILE_NAME
), 
¡r
))

1348 
_l¡
.
	`­³nd
(
£lf
.
	`‹¡_ty³
(
	`dù_g‘
(
ado_obj
, 
ADO_CFG_DATA_THUMB_NAME
), 
¡r
))

1349 
_l¡
.
	`­³nd
(
£lf
.
	`‹¡_ty³
(
	`dù_g‘
(
ado_obj
, 
ADO_CFG_PREFIX
), 
¡r
))

1350 
_l¡
.
	`­³nd
(
£lf
.
	`‹¡_ty³
(
	`dù_g‘
(
ado_obj
, 
ADO_CFG_DATA_EXT
), 
¡r
))

1351 
_l¡
.
	`­³nd
(
£lf
.
	`‹¡_ty³
(
	`dù_g‘
(
ado_obj
, 
ADO_CFG_STACK_DIR
), 
¡r
))

1352 
_l¡
.
	`­³nd
(
£lf
.
	`‹¡_ty³
(
	`dù_g‘
(
ado_obj
, 
ADO_CFG_THUMB_EXT
), 
¡r
))

1353 
_l¡
.
	`­³nd
(
£lf
.
	`‹¡_ty³
(
	`dù_g‘
(
ado_obj
, 
ADO_CFG_DATA_IMG_IDX
), ))

1355 
v
 
š
 
_l¡
:

1356 ifĞ
nÙ
 
v
):

1357 (
F®£
)

1359 (
True
)

1362 
def
 
	$d‘”mše_num_thumbÇ_images_»quœed
(
£lf
, 
wdg_com
):

1364 
	$d‘”mše_num_thumbÇ_images_»quœed
(): 
ke
 
a
 
li¡
 
of
 
¥©Ÿl
 
»giÚs
 
ªd
 
check
 
the
 
sÿn
 
ty³
‡nd 
»Œun


1365 
the
 
numb”
 
of
 
images
 
th©
 
wl
 
be
 
Ãeded


1367 :
·¿m
 
¥_rois
: sp_roi 
desütiÚ


1368 :
ty³
 
¥_rois
: sp_roisype

1370 :
»tuºs
: 
š‹g”
 
numb”
 
of
 
images
 
»quœed
 
the
 
sÿns


1372 
sšgË_image_sÿns
 = [
sÿn_ty³s
.
DETECTOR_IMAGE
, sÿn_ty³s.
OSA_FOCUS
, sÿn_ty³s.
OSA_IMAGE
, sÿn_ty³s.
SAMPLE_FOCUS
, \

1373 
sÿn_ty³s
.
SAMPLE_IMAGE
, sÿn_ty³s.
GENERIC_SCAN
, sÿn_ty³s.
SAMPLE_LINE_SPECTRUM
, sÿn_ty³s.
SAMPLE_POINT_SPECTRUM
]

1374 
¥_rois
 = 
	`dù_g‘
(
wdg_com
, 
WDGCOM_SPATIAL_ROIS
)

1375 
¥_ids
 = 
	`sÜ‹d
(
¥_rois
.
	`keys
())

1376 
n_imgs
 = []

1377 
_imgs
 = 0

1378 
¥_id
 
š
 
¥_ids
:

1379 
¥_db
 = 
¥_rois
[
¥_id
]

1380 
sÿn_ty³
 = 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
)

1381 if(
sÿn_ty³
 
š
 
sšgË_image_sÿns
):

1382 #n_imgs.
	`­³nd
(1)

1383 
_imgs
 = 1

1385 #n_imgs.
	`­³nd
(
£lf
.
	`g‘_num_ev_pošts
(
¥_db
[
SPDB_EV_ROIS
]))

1386 
_imgs
 = 
£lf
.
	`g‘_num_ev_pošts
(
¥_db
[
SPDB_EV_ROIS
])

1387 #n_img ğ
¥_db
[
SPDB_EV_NPOINTS
] * sp_db[
SPDB_POL_NPOINTS
]

1388 
n_imgs
.
	`­³nd
(
_imgs
)

1389  
n_imgs


1391 
def
 
	$g‘_num_ev_pošts
(
£lf
, 
ev_rois
):

1393 
make
 
su»
 
to
  
ª
 

1395 
n_ev
 = 0

1396 
_pŞ
 = 0

1397 
_ev
 = 0

1399 
ev_roi
 
š
 
ev_rois
:

1400 
_ev
 = 
ev_roi
['NPOINTS']

1401 
_pŞ
 = 
	`Ën
(
ev_roi
['EPU_POL_PNTS'])

1402 
n_ev
 +ğ
_ev
 * 
_pŞ


1403 ((
n_ev
))

1405 
def
 
	$­¶y_u£r_£‰šgs_to_sÿn
(
£lf
, 
sÿn
):

1407 
­¶y_u£r_£‰šgs_to_sÿn
: 
qu”y
 
the
 
­pCÚfig
 
£‰šgs
 
fe
 
ªd£t
 
ªy
 
æags
 
of
h
executšg
 
sÿn
 
h”e


1409 :
·¿m
 
sÿn
: 
This
 
is
 
the
 
cu¼’y
 
cÚfigu»d
 
executšg
 scan

1410 :
ty³
 
sÿn
: 
this
 
is
 
a
 sÿÀ
¶ugš
 
th©
 
has
 
SÿnP¬amWig‘
 
as
 
™s
 
·»Á
 
şass


1413 
­pCÚfig
.
	`upd©e
()

1414 #£ˆ
the
 
§ve
 
®l
 
d©a
 
æag


1415 
v®
 = 
­pCÚfig
.
	`g‘_boŞ_v®ue
('DATA', 'save_all_data')

1416 if(
v®
 
is
 
nÙ
 
NÚe
):

1417 
sÿn
.
	`£t_§ve_®l_d©a
(
v®
)

1419 
v®
 = 
­pCÚfig
.
	`g‘_boŞ_v®ue
('DATA', 'save_jpg_thumbnails')

1420 if(
v®
 
is
 
nÙ
 
NÚe
):

1421 
sÿn
.
	`£t_§ve_jpgs
(
v®
)

1424 #£ˆ
Ùh”s
 
b–ow


1428 
def
 
	$Ú_¡¬t_ssÿn
(
£lf
):

1430 
	$Ú_¡¬t_ssÿn
(): 
desütiÚ


1432 :
»tuºs
: 
NÚe


1434 #mak
su»
 
the
 
d©a
 
dœ
 
is
 
up
 
to
 
d©e
 
š
 th24 
hour
 
time
 
has
 
rŞËd
 
ov”


1435 
£lf
.
aùive_u£r
.
	`ü—‹_d©a_dœ
()

1437 #k“°
the
 
sÿn
 
¶ugš
 
äom
 
fœšg
 
ªy
 
sigÇls
 
th©
 
would
 
ÿu£
 
Ùh”
 
widg‘s
 
to
 
»¥Úd


1438 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`blockSigÇls
(
True
)

1439 
£lf
.
cur_wdg_com
 = s–f.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`g‘_roi
()

1440 if(
£lf
.
cur_wdg_com
 
is
 
NÚe
):

1441 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`blockSigÇls
(
F®£
)

1444 #£ˆ
maš
 
gui
 
widg‘s
 
up
 
ruÂšg
 
a
 
sÿn


1445 
£lf
.
	`£t_bu‰Ús_fÜ_sÿÂšg
()

1447 #š™ 
some
 
v¬ŸbËs


1448 
£lf
.
d©a
 = []

1449 
MAIN_OBJ
.
	`ş—r_sÿns
()

1450 
£lf
.
	`»£t_image_¶Ù
()

1451 
£lf
.
cur_ev_idx
 = 0

1452 
Ãw_¡ack_dœ
 = 
F®£


1454 #ok 
®low
 
the
 
sÿn
 
¶ugš
 
to
 
fœe
 
sigÇls
 
agaš


1455 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`blockSigÇls
(
F®£
)

1457 #assigÀ
the£
 
v®ues
 
th©
 
¬e
 
u£d
 
to
 
decide
 
which
 
GUI
 
sigÇls
Ø
cÚÃù
 
ªd
 
discÚÃù


1458 
£lf
.
	`£t_cur_sÿn_ty³
(£lf.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
ty³
)

1459 
£lf
.
	`£t_cur_sÿn_sub_ty³
(£lf.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
sub_ty³
)

1461 
sÿn_ty³
 = 
£lf
.
	`g‘_cur_sÿn_ty³
()

1462 
sÿn_sub_ty³
 = 
£lf
.
	`g‘_cur_sÿn_sub_ty³
()

1464 #g‘ 
ª
 
š¡ªû
 
of
 
the
 
aùu®
 
sÿn
 
şass


1465 
ssÿn
 = 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`g‘_ssÿn_š¡ªû
()

1466 
ssÿn
.
	`£t_aùive_u£r
(
£lf
.
aùive_u£r
)

1467 
ssÿn
.
sÿn_ty³
 = scan_type

1469 
£lf
.
	`­¶y_u£r_£‰šgs_to_sÿn
(
ssÿn
)

1470 
£lf
.
executšgSÿn
 = 
ssÿn


1472 #g¿b 
some
 
šfÜm©iÚ
 
u£d
 
by
 
®l
 
sÿns
 
b–ow


1473 
¥_rois
 = 
	`dù_g‘
(
£lf
.
cur_wdg_com
, 
WDGCOM_SPATIAL_ROIS
)

1474 
¥_ids
 = 
	`sÜ‹d
(
¥_rois
.
	`keys
())

1475 
£lf
.
cur_¥_rois
 = 
cİy
.
	`cİy
(
¥_rois
)

1477 #¨
li¡
 
of
 
basic
 
sÿns
 
th©
 
u£
 
the
 
§me
 
cÚfigu¿tiÚ
 
block
 
b–ow


1478 
_sim¶e_ty³s
 = [
sÿn_ty³s
.
DETECTOR_IMAGE
, sÿn_ty³s.
OSA_IMAGE
, sÿn_ty³s.
OSA_FOCUS
, sÿn_ty³s.
GENERIC_SCAN
, sÿn_ty³s.
SAMPLE_FOCUS
]

1479 
_muÉi¥©Ÿl_ty³s
 = [
sÿn_ty³s
.
SAMPLE_IMAGE
, sÿn_ty³s.
SAMPLE_LINE_SPECTRUM
, sÿn_ty³s.
SAMPLE_POINT_SPECTRUM
]

1481 if(
sÿn_ty³
 
š
 
_sim¶e_ty³s
):

1482 
¥_id
 = 
¥_ids
[0]

1483 
¥_db
 = 
¥_rois
[
¥_id
]

1484 
d
 = 
	`ma¡”_g‘_£q_Çmes
(
£lf
.
aùive_u£r
.
	`g‘_d©a_dœ
(), 
´efix_ch¬
='C', 
thumb_ext
='jpg', 
d©_ext
='hdf5', 
¡ack_dœ
=
F®£
, 
num_desœed_d©afes
=1)

1485 
£lf
.
	`assign_d©afe_Çmes_to_¥_db
(
¥_db
, 
d
[0])

1486 
ssÿn
.
	`£t_¥©Ÿl_id
(
¥_id
)

1487 
ssÿn
.
	`£t_d©afe_Çmes_diù
(
d
)

1488 
ssÿn
.
	`£t_¥©Ÿl_id_li¡
(
¥_ids
)

1489 
ssÿn
.
	`cÚfigu»
(
£lf
.
cur_wdg_com
, 
¥_id
=¥_id, 
lše
=
F®£
)

1490 if(
sÿn_ty³
 =ğ
sÿn_ty³s
.
GENERIC_SCAN
):

1491 
£lf
.
	`š™_pošt_¥eù¿
(
num_curves
=1)

1493 
	$–if
(
sÿn_ty³
 
š
 
_muÉi¥©Ÿl_ty³s
):

1494 
lše
=
True


1495 
num_images_l¡
 = 
£lf
.
	`d‘”mše_num_thumbÇ_images_»quœed
(£lf.
cur_wdg_com
)

1496 
d
 = 
	`ma¡”_g‘_£q_Çmes
(
£lf
.
aùive_u£r
.
	`g‘_d©a_dœ
(), 
´efix_ch¬
='C', 
thumb_ext
='jpg', 
d©_ext
='hdf5', 
¡ack_dœ
=
F®£
, 
num_desœed_d©afes
=
	`Ën
(
¥_ids
))

1497 
idx
 = 0

1498 
¥_id
 
š
 
¥_ids
:

1499 
¥_db
 = 
¥_rois
[
¥_id
]

1500 if(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_POINT_SPECTRUM
):

1501 #fÜ 
pošt
 
¥ec
 
®l
 
¥©Ÿl
 
»giÚs
 
u£
 
§me
 
d©afe
 
but
 
difã»Á
 
’Œys


1502 
£lf
.
	`assign_d©afe_Çmes_to_¥_db
(
¥_db
, 
d
[0], 
image_idx
=0)

1504 
£lf
.
	`assign_d©afe_Çmes_to_¥_db
(
¥_db
, 
d
[
idx
], 
image_idx
=idx)

1505 
idx
 += 1

1507 if(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_POINT_SPECTRUM
):

1508 #h”
I
 
Ãed
 
to
 
š™
 
™
 
w™h
 
the
 
numb”
 
of
 
	`¥_ids
 (
¥©Ÿl
 
pošts
)

1509 
£lf
.
	`š™_pošt_¥eù¿
(
num_curves
=
	`Ën
(
¥_ids
))

1510 
lše
 = 
F®£


1512 
£lf
.
	`£t_cur_sÿn_sub_ty³
(
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_SUBTYPE
))

1513 #ssÿn.
	`£t_d©afe_Çmes_diù
(
d
)

1514 
ssÿn
.
	`£t_¥©Ÿl_id_li¡
(
¥_ids
)

1515 
¥_id
 = 
ssÿn
.
	`g‘_Ãxt_¥©Ÿl_id
()

1516 
ssÿn
.
	`cÚfigu»
(
£lf
.
cur_wdg_com
, 
¥_id
=¥_id , 
ev_idx
=0, 
lše
=line)

1518 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE_STACK
):

1519 #u£ 
fœ¡
 
¥_DB
 
to
 
d‘”mše
 
pošt
 
by
…ošˆ
Ü
 
lše
 
unidœ


1520 
¥_db
 = 
¥_rois
[
¥_ids
[0]]

1521 #num_image ğ(
¥_db
[
SPDB_EV_NPOINTS
] * sp_db[
SPDB_POL_NPOINTS
] * 
	`Ën
(
¥_ids
))

1522 
num_images
 = 
£lf
.
	`d‘”mše_num_thumbÇ_images_»quœed
(£lf.
cur_wdg_com
)[0]

1523 
d
 = 
	`ma¡”_g‘_£q_Çmes
(
£lf
.
aùive_u£r
.
	`g‘_d©a_dœ
(), 
´efix_ch¬
='C', 
thumb_ext
='jpg', 
d©_ext
='hdf5', 
num_desœed_d©afes
=
num_images
, 
Ãw_¡ack_dœ
=
True
)

1524 if(
	`Ën
(
¥_ids
) > 1):

1525 #—ch 
¥©Ÿl
 
roi
 
Ãeds
 
a
 
f’ame
 
diù


1526 
i
 
š
 
	$¿nge
(
num_images
):

1527 
£lf
.
	`assign_d©afe_Çmes_to_¥_db
(
¥_rois
[
¥_ids
[
i
]], 
d
[i], 
image_idx
=
idx
)

1529 
£lf
.
	`assign_d©afe_Çmes_to_¥_db
(
¥_rois
[
¥_ids
[0]], 
d
[0])

1531 
£lf
.
	`£t_cur_sÿn_sub_ty³
(
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_SUBTYPE
))

1532 
ssÿn
.
	`£t_d©afe_Çmes_diù
(
d
)

1533 
ssÿn
.
	`£t_¥©Ÿl_id_li¡
(
¥_ids
)

1534 
¥_id
 = 
ssÿn
.
	`g‘_Ãxt_¥©Ÿl_id
()

1535 
ssÿn
.
	`cÚfigu»
(
£lf
.
cur_wdg_com
, 
¥_id
=¥_id , 
ev_idx
=0, 
lše
=
True
)

1539 
_logg”
.
	`”rÜ
('¡¬t_sÿn: unsuµÜ‹d sÿÀty³ [%d]' % 
sÿn_ty³
)

1540 
£lf
.
	`£t_bu‰Ús_fÜ_¡¬tšg
()

1543 
MAIN_OBJ
.
	`£t
('SCAN.CFG.WDG_COM', 
£lf
.
cur_wdg_com
)

1545 #mak
su»
 
®l
 
sÿns
 
have
 
£t
 
the
 
d©a
 
fe
 
Çmes
 
to
 
theœ
 
»¥eùive
 
aùive
 d©¨
objeùs
 
befÜe
 
®lowšg
 
sÿn


1546 #tØ
¡¬t


1547 if(
nÙ
 
£lf
.
	$‹¡_assign_d©afe_Çmes_to_¥_db
(
£lf
.
cur_wdg_com
)):

1548 
_logg”
.
	`”rÜ
('start_scan: incorrectly configured scan: data file‚ames‚ot‡ssignedo‡ctive data object')

1549 
£lf
.
	`£t_bu‰Ús_fÜ_¡¬tšg
()

1552 #ok 
®l
 
good
 
Ëts
 
run
 
the
 
sÿn


1553 
£lf
.
sÿn_´og»ss_bË
.
	`£t_queue_fe_li¡
(
	`g‘_thumb_fe_Çme_li¡
(
d
))

1554 
£lf
.
sÿn_´og»ss_bË
.
	`lßd_wdg_com
(£lf.
cur_wdg_com
)

1555 
£lf
.
	`cÚÃù_executšgSÿn_sigÇls
()

1556 
£lf
.
executšgSÿn
.
image_¡¬‹d
 = 
F®£


1557 
£lf
.
executšgSÿn
.
	`»£t_cÚ£cutive_sÿn_idx
()

1558 
£lf
.
executšgSÿn
.
	`¡¬t
()

1559 
£lf
.
¡¬t_time
 = 
time
.
	`time
()

1561 
def
 
	`š™_pošt_¥eù¿
(
£lf
, 
¥_id
=-1, 
num_curves
=1):

1563 
	$š™_pošt_¥eù¿
(): 
desütiÚ


1565 :
·¿m
 
¥_id
=-1: sp_id=-1 
desütiÚ


1566 :
ty³
 
¥_id
=-1: sp_id=-1ype

1568 :
»tuºs
: 
NÚe


1571 
£lf
.
¥eù¿Widg‘
.
	`ş—r_¶Ù
()

1573 
¥_ids
 = 
£lf
.
cur_¥_rois
.
	`keys
()

1575 
¥_id
 
š
 
¥_ids
:

1576 #£lf.
¥eù¿Widg‘
.
	`ü—‹_curve
('pošt_¥eù¿_%d' % 
i
,
curve_¡yË
='Lines')

1577 
şr
 = 
	`g‘_Ãxt_cŞÜ
(
u£_dæt
=
F®£
)

1578 
¡yË
 = 
	`g‘_basic_lše_¡yË
(
şr
)

1579 
£lf
.
¥eù¿Widg‘
.
	`ü—‹_curve
('¥_id_%d' % 
¥_id
, 
curve_¡yË
=
¡yË
)

1581 
def
 
	$cÚÃù_executšgSÿn_sigÇls
(
£lf
):

1583 
	$cÚÃù_executšgSÿn_sigÇls
(): 
desütiÚ


1585 :
»tuºs
: 
NÚe


1587 
sÿn_ty³
 = 
£lf
.
	`g‘_cur_sÿn_ty³
()

1588 
sÿn_sub_ty³
 = 
£lf
.
	`g‘_cur_sÿn_sub_ty³
()

1589 #_logg”.
	`šfo
('GUI: connect_executingScan_signals')

1590 if((
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
LINE_UNIDIR
è
Ü
 \

1591 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE_STACK
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
LINE_UNIDIR
è
Ü
 \

1592 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
LINE_UNIDIR
è
Ü
 \

1593 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_FOCUS
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
LINE_UNIDIR
)):

1594 
£lf
.
executšgSÿn
.
sigs
.
chªged
.
	`cÚÃù
(£lf.
add_lše_to_¶Ù
)

1596 if(
	$nÙ
 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
)):

1597 #dÚˆ
cÚÃù
 
this
 
lše_¥ec
 
sÿns
 
beÿu£
 
the
 
d©a
 
Ëv–
 
is
 
’”gy
 
which
 
would
 
ÿu£
 
a


1598 #Ãw 
image
 
—ch
 
’”gy
 
lše
 
which
 
is
 
nÙ
 
wh©
 
we
 
wªt


1599 
£lf
.
executšgSÿn
.
d©a_¡¬t
.
	`cÚÃù
(£lf.
Ú_image_¡¬t
)

1601 
	`–if
(((
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
POINT_BY_POINT
)è
Ü
 \

1602 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE_STACK
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
POINT_BY_POINT
è
Ü
 \

1603 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
DETECTOR_IMAGE
è
Ü
 \

1604 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
OSA_IMAGE
è
Ü
 \

1605 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
OSA_FOCUS
è
Ü
 \

1606 ((
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
POINT_BY_POINT
)è
Ü
 \

1607 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_FOCUS
è
Ü
 \

1608 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
ZP_IMAGE_SCAN
) ):

1609 
£lf
.
executšgSÿn
.
sigs
.
chªged
.
	`cÚÃù
(£lf.
add_pošt_to_¶Ù
)

1611 if(
	$nÙ
 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
)):

1612 #dÚˆ
cÚÃù
 
this
 
lše_¥ec
 
sÿns
 
beÿu£
 
the
 
d©a
 
Ëv–
 
is
 
’”gy
 
which
 
would
 
ÿu£
 
a


1613 #Ãw 
image
 
—ch
 
’”gy
 
lše
 
which
 
is
 
nÙ
 
wh©
 
we
 
wªt


1614 
£lf
.
executšgSÿn
.
d©a_¡¬t
.
	`cÚÃù
(£lf.
Ú_image_¡¬t
)

1617 
	`–if
((
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_POINT_SPECTRUM
è
Ü
 \

1618 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
GENERIC_SCAN
)):

1619 
£lf
.
executšgSÿn
.
sigs
.
chªged
.
	`cÚÃù
(£lf.
add_pošt_to_¥eù¿
)

1620 #£lf.
executšgSÿn
.
Ãw_¥©Ÿl_¡¬t
.
	`cÚÃù
(
£lf
.
š™_pošt_¥eù¿
)

1623 
_logg”
.
	`”rÜ
('cÚÃù_executšgSÿn_sigÇls:ƒxecutšgSÿÀty³ [%d]‚Ù suµÜ‹d', 
sÿn_ty³
)

1625 
£lf
.
executšgSÿn
.
sigs
.
¡©us
.
	`cÚÃù
(£lf.
Ú_sÿn_¡©us
)

1626 #£lf.
executšgSÿn
.
sigs
.
´og»ss
.
	`cÚÃù
(
£lf
.
Ú_sÿn_´og»ss
)

1627 
£lf
.
executšgSÿn
.
tİ_Ëv–_´og»ss
.
	`cÚÃù
(£lf.
Ú_tÙ®_sÿn_´og»ss
)

1628 
£lf
.
executšgSÿn
.
low_Ëv–_´og»ss
.
	`cÚÃù
(£lf.
Ú_sÿn_´og»ss
)

1629 
£lf
.
executšgSÿn
.
sigs_discÚÃùed
.
	`cÚÃù
(£lf.
Ú_executšg_sÿn_sigs_discÚ
)

1630 
£lf
.
executšgSÿn
.
sigs
.
abÜ‹d
.
	`cÚÃù
(£lf.
Ú_sÿn_dÚe
)

1631 
£lf
.
executšgSÿn
.
®l_dÚe
.
	`cÚÃù
(£lf.
Ú_sÿn_dÚe
)

1633 
£lf
.
executšgSÿn
.
§všg_d©a
.
	`cÚÃù
(£lf.
Ú_§všg_d©a
)

1635 #_logg”.
	`debug
('executingScan signals connected')

1637 
def
 
	$discÚÃù_executšgSÿn_sigÇls
(
£lf
):

1639 
	$discÚÃù_executšgSÿn_sigÇls
(): 
desütiÚ


1641 :
»tuºs
: 
NÚe


1643 
sÿn_ty³
 = 
£lf
.
	`g‘_cur_sÿn_ty³
()

1644 
sÿn_sub_ty³
 = 
£lf
.
	`g‘_cur_sÿn_sub_ty³
()

1646 #_logg”.
	`debug
('disconnect_executingScan_signals: TOP')

1647 if((
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
LINE_UNIDIR
è
Ü
 \

1648 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE_STACK
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
LINE_UNIDIR
è
Ü
 \

1649 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
LINE_UNIDIR
è
Ü
 \

1650 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_FOCUS
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
LINE_UNIDIR
)):

1651 
£lf
.
executšgSÿn
.
sigs
.
chªged
.
	`discÚÃù
(£lf.
add_lše_to_¶Ù
)

1653 if(
	$nÙ
 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
)):

1654 
£lf
.
executšgSÿn
.
d©a_¡¬t
.
	`discÚÃù
(£lf.
Ú_image_¡¬t
)

1656 
	`–if
(((
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
POINT_BY_POINT
)è
Ü
 \

1657 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE_STACK
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
POINT_BY_POINT
è
Ü
 \

1658 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
DETECTOR_IMAGE
è
Ü
 \

1659 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
OSA_IMAGE
è
Ü
 \

1660 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
OSA_FOCUS
è
Ü
 \

1661 ((
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
POINT_BY_POINT
)è
Ü
 \

1662 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_FOCUS
è
Ü
 \

1663 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
ZP_IMAGE_SCAN
) ):

1664 
£lf
.
executšgSÿn
.
sigs
.
chªged
.
	`discÚÃù
(£lf.
add_pošt_to_¶Ù
)

1666 if(
	$nÙ
 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
)):

1667 
£lf
.
executšgSÿn
.
d©a_¡¬t
.
	`discÚÃù
(£lf.
Ú_image_¡¬t
)

1669 
	`–if
((
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_POINT_SPECTRUM
è
Ü
 \

1670 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
GENERIC_SCAN
)):

1671 
£lf
.
executšgSÿn
.
sigs
.
chªged
.
	`discÚÃù
(£lf.
add_pošt_to_¥eù¿
)

1672 #£lf.
executšgSÿn
.
Ãw_¥©Ÿl_¡¬t
.
	`discÚÃù
(
£lf
.
š™_pošt_¥eù¿
)

1675 
_logg”
.
	`”rÜ
('discÚÃù_executšgSÿn_sigÇls:ƒxecutšgSÿÀty³ [%d]‚Ù suµÜ‹d', 
sÿn_ty³
)

1677 
£lf
.
executšgSÿn
.
sigs
.
¡©us
.
	`discÚÃù
(£lf.
Ú_sÿn_¡©us
)

1678 #£lf.
executšgSÿn
.
sigs
.
´og»ss
.
	`discÚÃù
(
£lf
.
Ú_sÿn_´og»ss
)

1679 
£lf
.
executšgSÿn
.
tİ_Ëv–_´og»ss
.
	`discÚÃù
(£lf.
Ú_tÙ®_sÿn_´og»ss
)

1680 
£lf
.
executšgSÿn
.
low_Ëv–_´og»ss
.
	`discÚÃù
(£lf.
Ú_sÿn_´og»ss
)

1681 
£lf
.
executšgSÿn
.
sigs_discÚÃùed
.
	`discÚÃù
(£lf.
Ú_executšg_sÿn_sigs_discÚ
)

1682 
£lf
.
executšgSÿn
.
sigs
.
abÜ‹d
.
	`discÚÃù
(£lf.
Ú_sÿn_dÚe
)

1683 
£lf
.
executšgSÿn
.
®l_dÚe
.
	`discÚÃù
(£lf.
Ú_sÿn_dÚe
)

1685 
£lf
.
executšgSÿn
.
§všg_d©a
.
	`discÚÃù
(£lf.
Ú_§všg_d©a
)

1688 
£lf
.
_£t_sÿn_bŠs
.
	`em™
('SET_FOR_STARTING')

1689 
£lf
.
	`Ú_sÿn_¡©us
('Idle')

1691 
def
 
	$Ú_§všg_d©a
(
£lf
, 
msg
):

1692 
£lf
.
sÿnAùiÚLbl
.
	`£tText
(
msg
)

1693 
_logg”
.
	`šfo
('% ...' % 
msg
)

1695 
def
 
	$Ú_image_¡¬t
(
£lf
, 
wdg_com
=
NÚe
):

1697 
	$Ú_image_¡¬t
(): 
ÿÎed
 
wh’
 
a
 
Ãw
 
image
 
¡¬ts


1699 :
·¿m
 
wdg_com
=
NÚe
: wdg_com=NÚ
desütiÚ


1700 :
ty³
 
wdg_com
=
NÚe
: wdg_com=Noneype

1702 :
»tuºs
: 
NÚe


1704 #Ú_image_¡¬ˆ
ÿn
 
be
 
ÿÎed
 
by
 
sšg®
 
·s£d
 
äom
 
sÿn
 
w™h
 
the
 
wdg_com
 
as
h
¬g


1705 #_logg”.
	`debug
('on_image_start called')

1706 if(
wdg_com
 
is
 
NÚe
):

1707 #u£ 
cu¼’t


1708 
wdg_com
 = 
£lf
.
cur_wdg_com


1710 
¥_id
 = 
£lf
.
executšgSÿn
.
	`g‘_¥©Ÿl_id
()

1711 if(
¥_id
 
nÙ
 
š
 
wdg_com
[
WDGCOM_SPATIAL_ROIS
].
	$keys
()):

1712 
_logg”
.
	`”rÜ
('Spatial ID does‚otƒxist in widget communication dict')

1715 
¥_db
 = 
wdg_com
[
WDGCOM_SPATIAL_ROIS
][
¥_id
]

1716 
sÿn_ty³
 = 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
)

1719 if(
£lf
.
executšgSÿn
.
image_¡¬‹d
 =ğ
True
):

1720 
£lf
.
executšgSÿn
.
image_¡¬‹d
 = 
F®£


1722 if(
£lf
.
executšgSÿn
.
image_¡¬‹d
 =ğ
F®£
):

1724 
numX
 = 
	`dù_g‘
(
¥_db
, 
SPDB_XNPOINTS
)

1725 
numY
 = 
	`dù_g‘
(
¥_db
, 
SPDB_YNPOINTS
)

1726 
numZ
 = 
	`dù_g‘
(
¥_db
, 
SPDB_ZNPOINTS
)

1727 #img_·rm ğ
	`dù_g‘
(
wdg_com
, 'CURRENT.SCAN.IMAGE_PARMS')

1728 
»ù
 = 
	`dù_g‘
(
¥_db
, 
SPDB_RECT
)

1729 
numE
 = 
	`dù_g‘
(
¥_db
, 
SPDB_EV_NPOINTS
)

1731 
x_roi
 = 
¥_db
['X']

1732 
y_roi
 = 
¥_db
['Y']

1734 #_logg”.
	`šfo
('Ú_image_¡¬t:„eù = (%.2f, %.2f, %.2f, %.2f)' % (
»ù
[0],„ect[1],„ect[2],„ect[3]))

1735 #_logg”.
	`šfo
('Ú_image_¡¬t:„oi (%.2f, %.2f, %.2f, %.2f)' % (
x_roi
['START'], 
y_roi
['START'], x_roi['STOP'], y_roi['STOP']))

1736 #_logg”.
	`debug
('GUI: on_image_start')

1737 if(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_FOCUS
):

1738 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`š™D©a
(
image_ty³s
.
FOCUS
, 
numZ
 , 
numX
, {
SPDB_RECT
: 
»ù
})

1739 
£lf
.
lšeByLšeImageD©aWidg‘
.
£t_autosÿË
(
fl_¶Ù_wšdow
=
True
)

1741 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
OSA_FOCUS
):

1742 #o§ 
focus
 
sÿn
 
Úly
 
s™s
 
©
 
a
 
sšgË
 
Y
 
pos™iÚ
 
ªd
 
so
 
wl
 
be
‡ 
	`squ¬e
 (
equ®
 
to
 
num
 
x
 
pošts
)

1743 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`š™D©a
(
image_ty³s
.
OSAFOCUS
, 
numZ
 , 
numX
, {
SPDB_RECT
: 
»ù
})

1744 
£lf
.
lšeByLšeImageD©aWidg‘
.
£t_autosÿË
(
fl_¶Ù_wšdow
=
True
)

1746 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
):

1747 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`š™D©a
(
image_ty³s
.
LINE_PLOT
, 
numX
 , 
numE
, {
SPDB_RECT
: 
»ù
})

1748 
£lf
.
lšeByLšeImageD©aWidg‘
.
£t_autosÿË
(
fl_¶Ù_wšdow
=
True
)

1751 
£lf
.
lšeByLšeImageD©aWidg‘
.
š™D©a
(
image_ty³s
.
IMAGE
, 
numY
 , 
numX
, {
SPDB_RECT
: 
»ù
})

1752 
£lf
.
lšeByLšeImageD©aWidg‘
.
£t_autosÿË
(
fl_¶Ù_wšdow
=
F®£
)

1754 
£lf
.
executšgSÿn
.
image_¡¬‹d
 = 
True


1755 
£lf
.
Ú_sÿn_¡¬t
()

1759 
def
 
	$Ú_¥eù¿_¡¬t
(
£lf
):

1761 
	$Ú_¥eù¿_¡¬t
(): 
desütiÚ


1763 :
»tuºs
: 
NÚe


1765 
´št
 'on_spectra_start'

1766 
£lf
.
¥eù¿Widg‘
.
	`ş—r_¶Ù
()

1769 
def
 
	$Ú_sÿn_¡¬t
(
£lf
):

1771 
	$Ú_sÿn_¡¬t
(): 
desütiÚ


1773 :
»tuºs
: 
NÚe


1775 #£lf.
sÿn_´og»ss_bË
.
	`£t_pixm­
(0, 
sÿn_¡©us_ty³s
.
RUNNING
)

1776 
·ss


1778 
def
 
	$Ú_sÿn_dÚe
(
£lf
):

1780 
	$Ú_sÿn_dÚe
(): 
desütiÚ


1782 :
»tuºs
: 
NÚe


1784 #idx = 
£lf
.
executšgSÿn
.
	`g‘_imgidx
()

1785 #_logg”.
	`šfo
('GUI: scan completed')

1786 #£lf.
sÿn_´og»ss_bË
.
	`£t_pixm­
(
£lf
.
cur_image_idx
, 
sÿn_¡©us_ty³s
.
DONE
)

1787 
·ss


1789 
def
 
	$Ú_executšg_sÿn_sigs_discÚ
(
£lf
):

1791 
	$Ú_executšg_sÿn_sigs_discÚ
(): 
desütiÚ


1793 :
»tuºs
: 
NÚe


1795 #_logg”.
	`šfo
('GUI: on_executing_scan_sigs_discon')

1796 if(
MAIN_OBJ
.
	`deviû
(
DNM_SHUTTER
).
	$is_auto
()):

1797 
MAIN_OBJ
.
	`deviû
(
DNM_SHUTTER
).
	`şo£
()

1798 #_logg”.
	`šfo
('scan completed')

1799 #£lf.
curImgProgB¬
.
	`£tV®ue
(0.0)

1800 
£lf
.
tÙ®ProgB¬
.
	`£tV®ue
(0.0)

1802 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_lock_a¥eù_¿tio
(
True
)

1803 if(
£lf
.
executšgSÿn
 
is
 
nÙ
 
NÚe
):

1804 
£lf
.
	`discÚÃù_executšgSÿn_sigÇls
()

1806 
def
 
	$£cÚdsToSŒ
(
£lf
, 
t
):

1808 
	$£cÚdsToSŒ
(): 
desütiÚ


1810 :
·¿m
 
t
: 
desütiÚ


1811 :
ty³
 
t
:ype

1813 :
»tuºs
: 
NÚe


1815 #»div = 
Ïmbda
 
Î
,
b
 : 
	`li¡
(
	`divmod
(ll[0],b)) +†l[1:]

1816 #»tuº "%d:%02d:%02d" % 
	`tu¶e
(
	`»duû
(
»div
,[[
t
*1000,], 1000,60]))

1817 #»tuº "%d:%02d:%02d" % 
	`tu¶e
(
	`»duû
(
»div
,[[
t
*1000,], 1000,60]))

1818 #–­£d_£øğ
’d_time
 - 
begš_time


1819 (
	`¡ráime
("%H:%M:%S", 
	`gmtime
(
t
)))

1822 
def
 
	$check_time
(
£lf
, 
cur_sÿn_´og»ss
):

1824 
	$check_time
(): 
desütiÚ


1826 :
·¿m
 
cur_sÿn_´og»ss
: cur_sÿn_´og»s 
desütiÚ


1827 :
ty³
 
cur_sÿn_´og»ss
: cur_scan_progressype

1829 :
»tuºs
: 
NÚe


1831 if(
cur_sÿn_´og»ss
 < 1.0):

1832 
cur_sÿn_´og»ss
 = 1

1833 if(
£lf
.
¡¬t_time
 
is
 
NÚe
):

1834 
£lf
.
¡¬t_time
 = 
time
.
	`time
()

1835 
£lf
.
–­£d_time
 = 
time
.
	`time
(è- s–f.
¡¬t_time


1836 
time_Ëá
 = ((100.0 / 
cur_sÿn_´og»ss
è* 
£lf
.
–­£d_time
) - self.elapsed_time

1837 #cs_¡s['–­£d_time'] = 
£lf
.
	`£cÚdsToSŒ
(£lf.
–­£d_time
)

1838 
£lf
.
–­£dTimeLbl
.
	`£tText
(£lf.
	`£cÚdsToSŒ
(£lf.
–­£d_time
))

1839 #cs_¡s['time_Ëá'] = 
£lf
.
	`£cÚdsToSŒ
(
time_Ëá
)

1840 
£lf
.
timeLeáLbl
.
	`£tText
(£lf.
	`£cÚdsToSŒ
(
time_Ëá
))

1842 
def
 
	$Ú_sÿn_¡©us
(
£lf
, 
msg
):

1844 
	$Ú_sÿn_¡©us
(): 
desütiÚ


1846 :
·¿m
 
msg
: msg 
desütiÚ


1847 :
ty³
 
msg
: msgype

1849 :
»tuºs
: 
NÚe


1851 
£lf
.
sÿnAùiÚLbl
.
	`£tText
(
msg
)

1853 
def
 
	$£t_cur_sÿn_ty³
(
£lf
, 
ty³
):

1854 
£lf
.
_sÿn_ty³
 = 
ty³


1856 
def
 
	$£t_cur_sÿn_sub_ty³
(
£lf
, 
ty³
):

1857 
£lf
.
_sÿn_sub_ty³
 = 
ty³


1859 
def
 
	$g‘_cur_sÿn_ty³
(
£lf
):

1860 (
£lf
.
_sÿn_ty³
)

1862 
def
 
	$g‘_cur_sÿn_sub_ty³
(
£lf
):

1863 (
£lf
.
_sÿn_sub_ty³
)

1865 
def
 
	$Ú_sÿn_´og»ss
(
£lf
, 
³rûÁ
):

1867 
	$Ú_sÿn_´og»ss
(): 
a
 
sigÇl
 
hªdËr
 
th©
 
fœes
 
wh’
 
the
 
´og»ss
 
pv
's have been updated, here clipheop ofhe scan

1868 
³rûÁage
 
©
 >ğ90.0, >ğ90.0 
ju¡
 
£t
 
™
 
to
 %100

1870 :
·¿m
 
³rûÁ
:…”ûÁ 
desütiÚ


1871 :
ty³
 
³rûÁ
:…ercentype

1873 :
»tuºs
: 
NÚe


1875 
idx
 = 
£lf
.
executšgSÿn
.
	`g‘_cÚ£cutive_sÿn_idx
()

1876 
¥_id
 = 
£lf
.
executšgSÿn
.
	`g‘_¥©Ÿl_id
()

1878 if(
£lf
.
	$g‘_cur_sÿn_ty³
(è
is
 
nÙ
 
sÿn_ty³s
.
SAMPLE_IMAGE_STACK
):

1879 
£t_pixm­
 = 
£lf
.
sÿn_´og»ss_bË
.
£t_pixm­_by_¥id


1880 
£t_´og»ss
 = 
£lf
.
sÿn_´og»ss_bË
.
£t_´og»ss_by_¥id


1881 
id
 = 
¥_id


1883 #™ 
a
 
¡ack


1884 
£t_pixm­
 = 
£lf
.
sÿn_´og»ss_bË
.set_pixmap

1885 
£t_´og»ss
 = 
£lf
.
sÿn_´og»ss_bË
.set_progress

1886 
id
 = 
idx


1888 if(
³rûÁ
 >= 90.0):

1889 
³rûÁ
 = 100.0

1890 #´šˆ'Ú_sÿn_´og»ss: sp_id [%d]‡ˆ%.2à dÚe' % (
idx
, 
³rûÁ
)

1892 
	`£t_´og»ss
(
id
, 
³rûÁ
)

1894 if(
³rûÁ
 >= 100.0):

1895 
	`£t_pixm­
(
id
, 
sÿn_¡©us_ty³s
.
DONE
)

1896 
	`–if
(
³rûÁ
 < 100.0):

1897 
	`£t_pixm­
(
id
, 
sÿn_¡©us_ty³s
.
RUNNING
)

1899 
	`£t_pixm­
(
id
, 
sÿn_¡©us_ty³s
.
STOPPED
)

1900 #£lf.
curImgProgB¬
.
	`£tV®ue
(
³rûÁ
)

1901 
£lf
.
	`check_time
(
³rûÁ
)

1903 
def
 
	$Ú_tÙ®_sÿn_´og»ss
(
£lf
, 
³rûÁ
):

1905 
	$Ú_tÙ®_sÿn_´og»ss
(): 
desütiÚ


1907 :
·¿m
 
³rûÁ
:…”ûÁ 
desütiÚ


1908 :
ty³
 
³rûÁ
:…ercentype

1910 :
»tuºs
: 
NÚe


1912 #´šˆ'Ú_tÙ®_sÿn_´og»ss: %.2f' % 
³rûÁ


1913 #£lf.
tÙ®ProgB¬
.
	`£tV®ue
(
³rûÁ
)

1914 #£lf.
sÿn_´og»ss_bË
.
	`£t_´og»ss
(
£lf
.
cur_image_idx
, 
³rûÁ
)

1915 
£lf
.
tÙ®ProgB¬
.
	`£tV®ue
(
³rûÁ
)

1917 
def
 
	$Ú_·u£
(
£lf
, 
chkd
):

1919 
	$Ú_·u£
(): 
desütiÚ


1921 :
·¿m
 
chkd
: chkd 
desütiÚ


1922 :
ty³
 
chkd
: chkdype

1924 :
»tuºs
: 
NÚe


1927 if(
£lf
.
executšgSÿn
):

1928 #idx = 
£lf
.
executšgSÿn
.
	`g‘_imgidx
()

1929 
idx
 = 
£lf
.
executšgSÿn
.
	`g‘_cÚ£cutive_sÿn_idx
()

1930 if(
chkd
):

1931 
£lf
.
executšgSÿn
.
	`·u£
()

1932 
£lf
.
sÿn_´og»ss_bË
.
	`£t_pixm­
(
idx
, 
sÿn_¡©us_ty³s
.
PAUSED
)

1934 
£lf
.
executšgSÿn
.
	`»sume
()

1935 
£lf
.
sÿn_´og»ss_bË
.
	`£t_pixm­
(
idx
, 
sÿn_¡©us_ty³s
.
RUNNING
)

1937 
def
 
	$Ú_¡İ
(
£lf
):

1939 
	$Ú_¡İ
(): 
desütiÚ


1941 :
»tuºs
: 
NÚe


1944 if(
£lf
.
executšgSÿn
):

1945 #idx = 
£lf
.
executšgSÿn
.
	`g‘_imgidx
()

1946 
idx
 = 
£lf
.
executšgSÿn
.
	`g‘_cÚ£cutive_sÿn_idx
()

1947 
£lf
.
executšgSÿn
.
	`¡İ
()

1948 
£lf
.
sÿn_´og»ss_bË
.
	`£t_pixm­
(
idx
, 
sÿn_¡©us_ty³s
.
ABORTED
)

1949 
£lf
.
¡İpšg
 = 
True


1950 
£lf
.
	`£t_bu‰Ús_fÜ_¡¬tšg
()

1952 
def
 
	$Ú_ex™
(
£lf
):

1954 
	$Ú_ex™
(): 
desütiÚ


1956 :
»tuºs
: 
NÚe


1958 
·ss


1959 #_logg”.
	`šfo
('Main GUI: on_exit')

1961 
def
 
	$go
():

1963 
	$go
(): 
desütiÚ


1965 :
·¿m
 
	`go
(: goĞ
desütiÚ


1966 :
ty³
 
	`go
(: go(ype

1968 :
»tuºs
: 
NÚe


1972 #ÿ.
	`th»ads_š™
()

1973 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

1974 
py¡xm_wš
 = 
	`bioxasMWšdow
()

1975 
py¡xm_wš
.
	`show
()

1976 
­p
.
	`exec_
()

1979 #ià
__Çme__
 == '__main__':

1980 #impÜˆ
´ofe


1981 #impÜˆ
p¡©s


1982 #
#ÿ.
	`th»ads_š™
()

1983 ##
mÙÜCfgObj
 = 
	`StxmMÙÜCÚfig
(
r
'C:\controls\py2.7\Beamlines\sm\stxm_control\StxmDir\Microscope Configuration\Motor.cfg')

1984 #­°ğ
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

1985 #
##
	`log_to_qt
()

1986 #absMŒ = 
	`bioxasMWšdow
()

1987 #absMŒ.
	`show
()

1988 #sys.
	`ex™
(
­p
.
	`exec_
())

1990 
def
 
	$d‘”mše_´ofe_bŸs_v®
():

1992 
	$d‘”mše_´ofe_bŸs_v®
(): 
desütiÚ


1994 :
·¿m
 
	`d‘”mše_´ofe_bŸs_v®
(: d‘”mše_´ofe_bŸs_v®Ğ
desütiÚ


1995 :
ty³
 
	`d‘”mše_´ofe_bŸs_v®
(: determine_profile_bias_val(ype

1997 :
»tuºs
: 
NÚe


1999 
´
 = 
´ofe
.
	`Profe
()

2000 
v
 = 0

2001 
v_t
 = 0

2002 
i
 
š
 
	`¿nge
(5):

2003 
v_t
 = 
´
.
	`ÿlib¿‹
(100000)

2004 
v
 +ğ
v_t


2005 
´št
 
v_t


2007 
bv®
 = 
v
 / 5.0

2008 
´št
 'bŸ v® = ' , 
bv®


2009 
´ofe
.
Profe
.
bŸs
 = 
bv®


2010  
bv®


2012 
def
 
	$´ofe_™
():

2014 
	$´ofe_™
(): 
desütiÚ


2016 :
·¿m
 
	`´ofe_™
(:…rofe_™Ğ
desütiÚ


2017 :
ty³
 
	`´ofe_™
(:…rofile_it(ype

2019 :
»tuºs
: 
NÚe


2024 
´ofe
.
Profe
.
bŸs
 = 1.36987840635e-05

2027 
´ofe
.
	`run
('go()', 'testprof.dat')

2029 
p
 = 
p¡©s
.
	`Sts
('testprof.dat')

2030 
p
.
	`sÜt_¡©s
('cumuÏtive').
	`´št_¡©s
(100)

2033 
__Çme__
 == '__main__':

2034 
impÜt
 
´ofe


2035 
impÜt
 
p¡©s


2038 #mÙÜCfgObj = 
	`StxmMÙÜCÚfig
(
r
'C:\controls\py2.7\Beamlines\sm\stxm_control\StxmDir\Microscope Configuration\Motor.cfg')

2039 #­°ğ
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

2040 
	`go
()

	@bioMain.py

2 
C»©ed
 
	gÚ
 2014-06-23

4 @
	gauthÜ
: 
b”gr


10 .. 
moduË
:: 
£±SÿnMašWšdow


11 :
¶©fÜm
: 
Wšdows


12 :
synİsis
: 
The
 
maš
 
moduË
 
pySTXM


13 .. 
moduËauthÜ
:: 
Russ
 
B”g
 <
russ
.
b”g
@
lightsourû
.
ÿ
>

16 
impÜt
 
Œaûback


17 
impÜt
 
time


18 
impÜt
 
d©‘ime


19 
äom
 
time
 
impÜt
 
mktime
, 
	g¡ráime
, 
	g¡½time
, 
	ggmtime


20 
impÜt
 
	gsys
, 
	gos


21 
impÜt
 
	gglob


22 
impÜt
 
numpy
 
as
 
	gÅ


23 
impÜt
 
	gQueue


24 
impÜt
 
	g©ex™


25 
impÜt
 
	gcİy


27 
äom
 
PyQt5
 
impÜt
 
	gQtCÜe
, 
	gQtGui
, 
	guic
, 
	gQtWidg‘s


28 
äom
 
	gguiqwt
.
cÚfig
 
impÜt
 
	g_


29 
äom
 
th»adšg
 
impÜt
 
	gLock


30 
impÜt
 
	gcİy


32 
äom
 
	gy­sy
.
PlugšMªag”
 
impÜt
 
	gPlugšMªag”


34 
impÜt
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	g£tup_’v


36 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	gd©a
.
bioxas_im_d©a_io
 
impÜt
 
	gBioxasD©aIo


38 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
bioXasIM
 
impÜt
 
	gabs_·th_to_ši_fe


39 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
bioxas_u£r
 
impÜt
 
	gu¤_acù_mªag”


41 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


42 
äom
 
	gşs
.
	guts
.
diù_uts
 
impÜt
 
	gdù_g‘
, 
	gdù_put


43 
äom
 
	gşs
.
	guts
.
roi_diù_defs
 
	gimpÜt
 *

44 
äom
 
	gşs
.
	guts
.
cfg·r£r
 
impÜt
 
	gCÚfigCÏss


45 
äom
 
	gşs
.
	guts
.
roi_uts
 
impÜt
 
	gwidg‘_com_cmnd_ty³s
, 
	gg‘_fœ¡_¥_db_äom_wdg_com
, 
	g»£t_unique_roi_id


46 
äom
 
	gşs
.
	guts
.
fe_sy¡em_toŞs
 
impÜt
 
	gma¡”_g‘_£q_Çmes
, 
	gg‘_thumb_fe_Çme_li¡


48 
äom
 
	gşs
.
	g¶ÙWidg‘s
.
imageWidg‘
 
impÜt
 
	gImageWidg‘


49 
äom
 
	gşs
.
	g¶ÙWidg‘s
.
	g¡rtoŞ
.
¡rToŞWidg‘
 
impÜt
 
	gSŒToŞWidg‘


50 
äom
 
	gşs
.
	g¶ÙWidg‘s
.
curveWidg‘
 
impÜt
 
	gCurveV›w”Widg‘
, 
	gg‘_Ãxt_cŞÜ
, 
	gg‘_basic_lše_¡yË


51 
äom
 
	gşs
.
	g¶ÙWidg‘s
.
uts
 
	gimpÜt
 *

54 
äom
 
	gşs
.
	gsÿÂšg
.
Ba£Sÿn
 
impÜt
 
	gLOAD_ALL


55 
äom
 
	gşs
.
	gsÿÂšg
.
d©aRecÜd”
 
impÜt
 
	gHdrD©a


56 
äom
 
	gşs
.
	gsÿÂšg
.
ty³s
 
impÜt
 
	gimage_ty³s
, 
	gsÿn_ty³s
, 
	gsÿn_·Ãl_Üd”
, 
	gsÿn_sub_ty³s
, \

57 
	g¥©Ÿl_ty³_´efix
, 
	g’”gy_sÿn_Üd”_ty³s
, 
	g§m¶e_fše_pos™iÚšg_modes
,\

58 
	g§m¶e_pos™iÚšg_modes
, 
	gsÿn_¡©us_ty³s
, 
	g’d¡©iÚ_id_ty³s


59 
äom
 
	gşs
.
	gsÿÂšg
.
ba£
 
impÜt
 
	gSÿnP¬amWidg‘


60 
äom
 
	gşs
.
	gÿWidg‘s
.
ÿLab–Widg‘
 
impÜt
 
	gÿ_aiLab–Widg‘
, 
	gÿ_mbbiLab–Widg‘
, 
	gÿ_¡rLab–
, 
	gÿ_biLab–Widg‘


62 
äom
 
	gşs
.
	g­pWidg‘s
.
	gu£r_accouÁ
.
logš
 
impÜt
 
	glogšWidg‘


63 #äom 
şs
.
­pWidg‘s
.
¥yd”_cÚsŞe
 
impÜt
 
Sh–lWidg‘
#, 
Sh–lDock


64 
äom
 
	gşs
.
	g­p_d©a
.
deçuÉs
 
impÜt
 
	gma¡”_cŞÜs
, 
	gg‘_¡yË
, 
	grgb_as_hex


66 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	gwidg‘s
.
mÙÜPª–
 
impÜt
 
	gPos™iÚ”sPª–


67 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	gwidg‘s
.
pvDi¥ÏyPª–
 
impÜt
 
	gPVsPª–


68 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	gwidg‘s
.
d‘eùÜsPª–
 
impÜt
 
	gD‘eùÜsPª–


70 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
bl07ID01
 
impÜt
 
	gMAIN_OBJ
, 
	gPOS_TYPE_BL
, 
	gPOS_TYPE_ES


71 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	gwidg‘s
.
sÿn_queue_bË
 
impÜt
 
	gSÿnQueueTabËWidg‘


74 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
deviû_Çmes
 
	gimpÜt
 *

76 #äom 
bcm
.
•ics
.
deviûs
 
impÜt
 
sÿn


77 
äom
 
	gbcm
.
	gdeviû
.
ba£
 
impÜt
 
	gBa£Deviû


78 
äom
 
	gbcm
.
	g•ics_deviûs
.
sÿn
 
impÜt
 
	gSÿn


82 #»ad 
the
 
ši
 
fe
 
ªd
 
lßd
h 
dœeùÜ›s


83 
	g­pCÚfig
 = 
CÚfigCÏss
(
abs_·th_to_ši_fe
)

84 
sÿnPlugšDœ
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'scanPluginDir')

85 
	gmajÜ_v”siÚ
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'major_version')

86 
	gmšÜ_v”siÚ
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'minor_version')

87 
	guiDœ
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'uiDir')

89 
	g§m¶e_pos_mode
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'sample_positioning_mode')

90 
	g§m¶e_fš•os_mode
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'fine_sample_positioning_mode')

92 if(
	g§m¶e_pos_mode
.
fšd
('COARSEXY') > -1):

93 
§m¶e_pos_mode
 = 
§m¶e_pos™iÚšg_modes
.
COARSEXY


94 
–if
(
§m¶e_pos_mode
.
fšd
('GONIOMETER') > -1):

95 
§m¶e_pos_mode
 = 
§m¶e_pos™iÚšg_modes
.
GONIOMETER


97 
§m¶e_pos_mode
 = 
§m¶e_pos™iÚšg_modes
.
SAMPLEXY


99 #£tu°
moduË
 
logg”
 
w™h
 
a
  do-
nÙhšg
 
hªdËr


100 
_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

102 
aùive_u£r
 = 
NÚe


104 
PLOTTER_IMAGES_TAB
 = 0

105 
PLOTTER_SPECTRA_TAB
 = 1

107 
NUM_POINTS_LOST_AFTER_EDIFF
 = 2

108 
DATA_OFFSET
 = 1

111 
ho¡Çme
 = 
os
.
g‘’v
('COMPUTERNAME')

112 if(
ho¡Çme
 == 'WKS-W001465'):

113 #th
Ãw
 
‹¡
 
compu‹r
 
š
 
Şd
 
magÃt
 
m­pšg
 
room


114 
FAKE_MARKER
=
F®£


115 
UNIT_SCALAR
 = 0.001

118 
VELO_SCALAR
 = 1000.0

119 
USE_PIEZO
 = 
True


120 
–if
(
ho¡Çme
 == 'NBK-W001021'):

121 #my 
nÙebook
 
compu‹r


122 
FAKE_MARKER
=
True


123 
UNIT_SCALAR
 = 1.0

124 
USE_PIEZO
 = 
F®£


126 #th
Şd
 
¡xm_cÚŒŞ
 
cÚmpu‹r


127 
FAKE_MARKER
 = 
F®£


128 
UNIT_SCALAR
 = 0.001

129 
VELO_SCALAR
 = 0.001

130 
USE_PIEZO
 = 
True


135 
şass
 
	$bioxasMWšdow
(
QtWidg‘s
.
QMašWšdow
):

137 
şassdocs


139 
_£t_sÿn_bŠs
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
)

140 #_check_fÜ_ªÙh”_sÿÀğ
QtCÜe
.
	`pyqtSigÇl
(
objeù
)

142 
def
 
	$__š™__
(
£lf
, 
·»Á
=
NÚe
):

144 
	$__š™__
(): 
desütiÚ


146 :
·¿m
 
·»Á
=
NÚe
:…¬’t=NÚ
desütiÚ


147 :
ty³
 
·»Á
=
NÚe
:…arent=Noneype

149 :
»tuºs
: 
NÚe


151 
	`su³r
(
bioxasMWšdow
, 
£lf
).
	`__š™__
(
·»Á
)

152 
uic
.
	`lßdUi
(
uiDœ
 + '//sÿnD‘as-mašWšdow-¶ugšs-d¬k.ui', 
£lf
)

153 #£lf.
	`£tWšdowT™Ë
('pyStxm %s.% CªadŸÀLighˆSourû Inc. ' % (
majÜ_v”siÚ
, 
mšÜ_v”siÚ
))

154 
£lf
.
	`£tWšdowT™Ë
('pyBioXa %s.% CªadŸÀLighˆSourû Inc. %s' % (
MAIN_OBJ
.
	`g‘
('APP.MAJOR_VER'), MAIN_OBJ.get('APP.MINOR_VER'), MAIN_OBJ.get('APP.DATE')))

156 
©ex™
.(
£lf
.
Ú_ex™
)

157 
£lf
.
	`£tGeom‘ry
(10,100,1900,1300)

158 
£lf
.
qssh“t
 = 
	`g‘_¡yË
('dark')

159 #£lf.
	`£tStyËSh“t
(
£lf
.
qssh“t
)

160 #£lf.
	`­¶y_¡yËsh“t
(
£lf
.
ûÁ¿lwidg‘
, s–f.
qssh“t
)

162 
auto_logš
 = 
True


163 
£lf
.
logšWdgt
 = 
	`logšWidg‘
(
u¤_acù_mªag”
, 
auto_logš
=auto_login)

164 if(
auto_logš
):

165 
£lf
.
aùive_u£r
 = s–f.
logšWdgt
.
	`g‘_u£r_obj
()

166 
´št
 '% sucûsfuÈlogged in' % 
£lf
.
aùive_u£r
.
	`g‘_u£ºame
()

167 
´št
 'Aùivu£¸d©¨dœ : %s' % 
£lf
.
aùive_u£r
.
	`g‘_d©a_dœ
()

169 
MAIN_OBJ
.
	`£t
('APP.USER', 
£lf
.
aùive_u£r
)

171 
Œy
:

172 
£lf
.
log
 = 
	`log_to_qt
()

173 #cÚÃù 
logg”


174 
£lf
.
log
.
Ãw_msg
.
	`cÚÃù
(£lf.
add_to_log
)

176 
£lf
.
upd©eStyËBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_upd©e_¡yË
)

177 #£lf.
sÿnTy³ToŞBox
.
cu¼’tChªged
.
	`cÚÃù
(
£lf
.
Ú_toŞbox_chªged
)

179 
£lf
.
_£t_sÿn_bŠs
.
	`cÚÃù
(£lf.
Ú_£t_sÿn_bŠs
)

180 #£lf.
_check_fÜ_ªÙh”_sÿn
.
	`cÚÃù
(
£lf
.
check_fÜ_mÜe_ev_»giÚs
)

181 
£lf
.
sšgË_’”gy
 = 
True


183 
£lf
.
d©a
 = []

184 
£lf
.
rvrsdd©a
 = []

185 
£lf
.
sÿn_tbox_widg‘s
 = []

187 
£lf
.
sÿn_š_´og»ss
 = 
F®£


188 
£lf
.
image_¡¬‹d
 = 
F®£


190 
£lf
.
vidTim”
 = 
QtCÜe
.
	`QTim”
()

191 
£lf
.
vidTim”
.
timeout
.
	`cÚÃù
(£lf.
Ú_video_tim”
)

193 
£lf
.
	`£tup_maš_gui
()

194 
£lf
.
	`£tup_image_¶Ù
()

195 
£lf
.
	`£tup_¥eù¿_¶Ù
()

196 #
#£lf.
shu‰”FbkLbl
 = 
	`ÿ_biLab–Widg‘
(
MAIN_OBJ
.
	`deviû
(
DNM_SHUTTER
).
	`g‘_Çme
(), 
Ïb–Widg‘
=
£lf
.shu‰”FbkLbÈ, 
hdrText
=DNM_SHUTTER,
t™Ë_cŞÜ
='wh™e', 
İtiÚs
ğ
	`diù
(
¡©e_şrs
=['black','blue']))

197 
£lf
.
¡©us_diù
 = {
	}
}

199 if(
LOAD_ALL
):

200 
£lf
.
š™_¡©usb¬
()

202 
£lf
.
sÿn
 = 
NÚe


203 
£lf
.
dw–l
 = 0

205 #¨
v¬ŸbË
 
to
 
hŞd
 
the
 
li¡
 
of
 
ev_rois
 
cu¼’t
 
sÿn


206 
£lf
.
ev_rois
 = 
NÚe


207 
£lf
.
cur_ev_idx
 = 0

208 
£lf
.
cur_¥_rois
 = {}

209 #£lf.
e_roi_queue
 = 
Queue
.Queue()

211 
£lf
.
yS‘pošts
 = 
NÚe


212 
£lf
.
xS‘pošts
 = 
NÚe


213 
£lf
.
ÅoštsX
 = 0

214 
£lf
.
ÅoštsY
 = 0

216 
£lf
.
accRªge
 = 0

217 
£lf
.
dccRªge
 = 0

218 
£lf
.
executšgSÿn
 = 
NÚe


220 
£lf
.
¡İpšg
 = 
F®£


222 
£lf
.
š™_®l_sÿns
()

224 
£lf
.
£t_bu‰Ús_fÜ_¡¬tšg
()

226 
£lf
.
´eviousSÿnTy³
 = 
NÚe


228 
£lf
.
£tup_sÿn_toŞbox
()

229 
£lf
.
sÿn_·Ãl_idx
 = s–f.
sÿnTy³ToŞBox
.
cu¼’tIndex
()

230 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
£t_zp_focus_mode
()

231 
£lf
.
_sÿn_ty³
 = s–f.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
ty³


232 
£lf
.
_sÿn_sub_ty³
 = s–f.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
sub_ty³


234 
£lf
.
tim”
 = 
QtCÜe
.
QTim”
()

235 
£lf
.
tim”
.
timeout
.
cÚÃù
(£lf.
Ú_upd©e_¡yË
)

236 
£lf
.
tim”
.
¡¬t
(100)

238 #£lf.
¡¬t_•ics_sks
()

239 #£lf.
£tup_šfo_dock
()

240 
£lf
.
lßdImageD©aBŠ
.
şicked
.
cÚÃù
(£lf.
lßd_simuÏ‹d_image_d©a
)

241 
exû±
:

242 
Œaûback
.
´št_exc
()

244 
def
 
	$lßd_simuÏ‹d_image_d©a
(
£lf
):

245 
glob®
 
SIMULATE_IMAGE_DATA
, 
SIM_DATA


247 
SIMULATE_IMAGE_DATA
 = 
True


248 
SIM_DATA
 = 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`g‘_cu¼’t_d©a
()

249 
_logg”
.
	`šfo
('Loaded Simulated data')

251 
def
 
	$¡¬t_•ics_sks
(
£lf
):

253 
	$¡¬t_•ics_sks
(): 
desütiÚ


255 :
»tuºs
: 
NÚe


257 
MAIN_OBJ
.
	`deviû
('Shu‰”TaskRun').
	`put
(1)

260 
def
 
	$Ú_upd©e_¡yË
(
£lf
):

262 
	$Ú_upd©e_¡yË
(): 
desütiÚ


264 :
»tuºs
: 
NÚe


267 
£lf
.
tim”
.
	`¡İ
()

268 
£lf
.
qssh“t
 = 
	`g‘_¡yË
('dark')

269 
£lf
.
	`£tStyËSh“t
(£lf.
qssh“t
)

270 
£lf
.
	`­¶y_¡yËsh“t
(£lf.
ûÁ¿lwidg‘
, s–f.
qssh“t
)

271 
£lf
.
	`upd©e_¶Ù_cŞÜs
()

274 
def
 
	$upd©e_¶Ù_cŞÜs
(
£lf
):

276 
	$upd©e_¶Ù_cŞÜs
(): 
desütiÚ


278 :
»tuºs
: 
NÚe


280 
fg_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_forgrnd'])

281 
bg_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_bckgrnd'])

282 
mš_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_gridmaj'])

283 
maj_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_gridmin'])

285 
£lf
.
evSÿÅlÙ
.
	`£t_grid_·¿m‘”s
(
bg_şr
, 
mš_şr
, 
maj_şr
)

286 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_grid_·¿m‘”s
(
bg_şr
, 
mš_şr
, 
maj_şr
)

287 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_cs_grid_·¿m‘”s
(
fg_şr
, 
bg_şr
, 
mš_şr
, 
maj_şr
)

288 
£lf
.
¥eù¿Widg‘
.
	`£t_grid_·¿m‘”s
(
bg_şr
, 
mš_şr
, 
maj_şr
)

291 
def
 
	$­¶y_¡yËsh“t
(
£lf
, 
widg‘
, 
ssh“t
):

293 
	$­¶y_¡yËsh“t
(): 
desütiÚ


295 :
·¿m
 
widg‘
: widg‘ 
desütiÚ


296 :
ty³
 
widg‘
: widgetype

298 :
·¿m
 
ssh“t
: ssh“ˆ
desütiÚ


299 :
ty³
 
ssh“t
: ssheetype

301 :
»tuºs
: 
NÚe


303 #fÜ 
some
 
»asÚ
 
the
 
¡ysh“t
 
i¢t
 
picked
 
up
 
by
h
ûÁ¿l
 
widg‘
 
ªd
 
ûÁ¿lF¿me
 
so
 
fÜû
 
™
 
h”e


304 
widg‘
.
	`£tStyËSh“t
(
ssh“t
)

309 
def
 
	$add_to_log
(
£lf
, 
şr
, 
msg
):

311 
	$add_to_log
(): 
desütiÚ


313 :
·¿m
 
şr
: cÌ 
desütiÚ


314 :
ty³
 
şr
: clrype

316 :
·¿m
 
msg
: msg 
desütiÚ


317 :
ty³
 
msg
: msgype

319 :
»tuºs
: 
NÚe


322 
This
 
is
 
a
 
sigÇl
 
hªdËr
 
th©
 i 
cÚÃùed
 
to
 
the
 
logg”
 
so
hat

323 
mes§ges
 
£Á
 
to
 
the
 
logg”
 
¬e
 
th’
 
di¥Ïyed
 
by
 
this
 
­ps
 
loggš


324 
widg‘
, 
cŞÜ
 
is
 
suµÜ‹d
 
the
 
v¬yšg
 
Ëv–s
 
of
 
mes§ge
 
logged


326 if(
şr
 
is
 
nÙ
 
NÚe
):

327 
£lf
.
logWšdow
.
	`£tTextCŞÜ
(
şr
)

328 
£lf
.
logWšdow
.
	`­³nd
(
msg
)

331 
def
 
	$lßd_dœ_v›w
(
£lf
):

333 
	$lßd_dœ_v›w
(): 
desütiÚ


335 :
»tuºs
: 
NÚe


337 
£lf
.
dœ_mod–
 = 
QtWidg‘s
.
	`QFeSy¡emMod–
()

338 
£lf
.
dœ_mod–
.
	`£tRoÙP©h
Ğ
QtCÜe
.
QDœ
.
	`cu¼’tP©h
() )

340 #£lf.
dœ_mod–
.
	`£tRoÙP©h
Ğ
QtCÜe
.
	`QSŒšg
(
MAIN_OBJ
.
	`g‘_£ssiÚ_šfo
().
	`g‘_d©a_dœ
()) )

341 
£lf
.
dœT»eV›w
.
	`£tMod–
(£lf.
dœ_mod–
)

342 
£lf
.
dœT»eV›w
.
şicked
.
	`cÚÃù
(£lf.
Ú_Œ“V›w_şicked
)

345 @
QtCÜe
.
	`pyqtSlÙ
(QtCÜe.
QMod–Index
)

346 
def
 
	$Ú_Œ“V›w_şicked
(
£lf
, 
šdex
):

348 
	$Ú_Œ“V›w_şicked
(): 
desütiÚ


350 :
·¿m
 
šdex
: index 
desütiÚ


351 :
ty³
 
šdex
: indexype

353 :
»tuºs
: 
NÚe


355 
šdexI‹m
 = 
£lf
.
dœ_mod–
.
	`šdex
(
šdex
.
	`row
(), 0, index.
	`·»Á
())

356 
feName
 = 
£lf
.
dœ_mod–
.
	`feName
(
šdexI‹m
)

357 
feP©h
 = 
£lf
.
dœ_mod–
.
	`feP©h
(
šdexI‹m
)

358 
´št
 '£Ëùed [%s]' % (
feP©h
)

360 
def
 
	$Ú_£t_sÿn_bŠs
(
£lf
, 
do_wh©
):

362 
	$Ú_£t_sÿn_bŠs
(): 
desütiÚ


364 :
·¿m
 
do_wh©
: do_wh© 
desütiÚ


365 :
ty³
 
do_wh©
: do_whatype

367 :
»tuºs
: 
NÚe


369 if(
do_wh©
 == 'SET_FOR_SCANNING'):

370 
£lf
.
	`£t_bu‰Ús_fÜ_sÿÂšg
()

371 
	`–if
(
do_wh©
 == 'SET_FOR_STARTING'):

372 
£lf
.
	`£t_bu‰Ús_fÜ_¡¬tšg
()

374 
·ss


376 
def
 
	$£t_bu‰Ús_fÜ_sÿÂšg
(
£lf
):

378 
	$£t_bu‰Ús_fÜ_sÿÂšg
(): 
desütiÚ


380 :
»tuºs
: 
NÚe


382 
£lf
.
sÿn_š_´og»ss
 = 
True


383 
£lf
.
¡¬tBŠ
.
	`£tEÇbËd
(
F®£
)

384 #£lf.
¡İBŠ
.
	`£tEÇbËd
(
True
)

385 
£lf
.
·u£BŠ
.
	`£tEÇbËd
(
True
)

386 
£lf
.
sÿnsF¿me
.
	`£tEÇbËd
(
F®£
)

387 #£lf.
sÿn_tbox_widg‘s
[
£lf
.
sÿn_·Ãl_idx
].
	`£t_»ad_Úly
()

388 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_’abË_drİ_ev’ts
(
F®£
)

390 
def
 
	$£t_bu‰Ús_fÜ_¡¬tšg
(
£lf
):

392 
	$£t_bu‰Ús_fÜ_¡¬tšg
(): 
desütiÚ


394 :
»tuºs
: 
NÚe


396 
£lf
.
sÿn_š_´og»ss
 = 
F®£


397 
£lf
.
¡¬tBŠ
.
	`£tEÇbËd
(
True
)

398 #£lf.
¡İBŠ
.
	`£tEÇbËd
(
F®£
)

399 
£lf
.
·u£BŠ
.
	`£tEÇbËd
(
F®£
)

400 
£lf
.
sÿnsF¿me
.
	`£tEÇbËd
(
True
)

401 #£lf.
sÿn_tbox_widg‘s
[
£lf
.
sÿn_·Ãl_idx
].
	`£t_ed™abË
()

402 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_’abË_drİ_ev’ts
(
True
)

404 
def
 
	$š™_®l_sÿns
(
£lf
):

406 
	$š™_®l_sÿns
(): 
desütiÚ


409 #’su» 
a
 
cÚÃùiÚ
 
to
 
dcs
 
v®ues
 
so
 
th©
 
the
 
fÜ¡
 
d©a
 
cŞËùiÚ
 
gÛs
 
smoÙh


410 
_logg”
.
	`šfo
('intializing DCS connections')

411 
deviûs
 = 
MAIN_OBJ
.
	`g‘_deviûs
()

412 
d
 = 
MAIN_OBJ
.
	`ke_pos™iÚ”_¢­shÙ
(
deviûs
['POSITIONERS'])

413 
d
 = 
MAIN_OBJ
.
	`ke_d‘eùÜs_¢­shÙ
(
deviûs
['DETECTORS'])

414 
d
 = 
MAIN_OBJ
.
	`ke_pvs_¢­shÙ
(
deviûs
['PVS'])

415 
_logg”
.
	`šfo
('intializing DCS connections: Done')

417 #£lf.
d‘SCAN
 = 
	`D‘eùÜSSCAN
()

418 #£lf.
imageSCAN
 = 
	`Sam¶eImageW™hEÃrgySSCAN
()

419 #£lf.
poštSCAN
 = 
£lf
.
imageSCAN


420 #£lf.
o§SCAN
 = 
	`O§SSCAN
()

421 #£lf.
o§FocusSCAN
 = 
	`O§FocusSSCAN
()

422 #£lf.
focusSCAN
 = 
	`FocusSSCAN
()

423 #£lf.
g’”icSCAN
 = 
	`Pos™iÚ”SSCAN
()

424 #£lf.
lšeS³cSCAN
 = 
	`LšeS³cSSCAN
()

425 #£lf.
zpTomoSCAN
 = 
	`ZÚePÏ‹Sam¶eImageW™hEÃrgySSCAN
()

427 #Ãed 
time
 
the£
 
¡škšg
 
pvs
 
to
 
cÚÃù


428 #time.
	`¦“p
(0.5)

430 #£lf.
imageSCAN
.
	`¡İ
()

431 #£lf.
poštSCAN
.
	`¡İ
()

432 #£lf.
focusSCAN
.
	`¡İ
()

434 
def
 
	$şo£Ev’t
(
£lf
,
ev’t
):

436 
	$şo£Ev’t
(): 
desütiÚ


438 :
·¿m
 
ev’t
:ƒv’ˆ
desütiÚ


439 :
ty³
 
ev’t
:ƒventype

441 :
»tuºs
: 
NÚe


443 
»suÉ
 = 
QtWidg‘s
.
QMes§geBox
.
	`que¡iÚ
(
£lf
,

446 
QtWidg‘s
.
QMes§geBox
.
Yes
| QtWidg‘s.QMes§geBox.
No
)

447 
ev’t
.
	`ignÜe
()

449 
»suÉ
 =ğ
QtWidg‘s
.
QMes§geBox
.
Yes
:

450 
ev’t
.
	`acû±
()

452 
def
 
	$Ú_ed™_zp_·¿ms
(
£lf
):

454 
	$Ú_ed™_zp_·¿ms
(): 
desütiÚ


456 :
»tuºs
: 
NÚe


459 
£lf
.
åFÜm
.
	`show
()

461 
def
 
	$£tup_maš_gui
(
£lf
):

463 
	$£tup_maš_gui
(): 
desütiÚ


465 :
»tuºs
: 
NÚe


467 #£lf.
¡©usB¬
 = 
QtWidg‘s
.
	`QStusB¬
()

468 #£lf.
	`Ïyout
().
	`addWidg‘
(
£lf
.
¡©usB¬
)

469 
£lf
.
	`£tMšimumSize
(1000,1000)

470 
£lf
.
	`£tMaximumSize
(2000,2000)

472 #£lf.
	`cÚÃù
(
£lf
.
aùiÚEx™
, 
QtCÜe
.
	`SIGNAL
('Œigg”ed()'), QtCÜe.
	`SLOT
('close()'))

473 
£lf
.
aùiÚEx™
.
Œigg”ed
.
	`cÚÃù
(£lf.
şo£
)

474 
£lf
.
aùiÚZP_P¬ams
.
Œigg”ed
.
	`cÚÃù
(£lf.
Ú_ed™_zp_·¿ms
)

476 
£lf
.
¡¬tBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_¡¬t_ssÿn
)

477 
£lf
.
·u£BŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_·u£
)

478 
£lf
.
¡İBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_¡İ
)

480 #»memb” 
th©
 
the
 
¡rtToŞWidg‘
 
u£s
h
pv
 
¥ecif›d
 
š
 
couÁ”s
.
ši


481 
£lf
.
evSÿÅlÙ
 = 
	`SŒToŞWidg‘
(1, 
pvLi¡
=[
MAIN_OBJ
.
	`deviû
('tick”').
	`g‘_Çme
()])

483 
£lf
.
’abË_d‘fbk
 = 
F®£


484 
£lf
.
’abË_o§fbk
 = 
F®£


486 if(
LOAD_ALL
):

488 
vbox2
 = 
QtWidg‘s
.
	`QVBoxLayout
()

489 
vbox2
.
	`addWidg‘
(
£lf
.
evSÿÅlÙ
)

490 
vbox2
.
	`£tCÚ‹ÁsM¬gšs
(1,1,1,1)

491 
£lf
.
couÁ”PlÙF¿me
.
	`£tLayout
(
vbox2
)

493 #’d¡©iÚ 
pos™iÚ”s
 
·Ãl


494 #thi 
exşude
 
li¡
 
is
 
a
 
hack
 
now
, 
this
 
Ãeds
 
to
 
»ãr
 
back
Ø
som‘hšg
 
š
 
the
 
BL
 
cÚfig
 
fe


495 
exşude_li¡
 = ['_ZonePlateZ_base', 'SampleFineX', 'SampleFineY', 'CoarseX.X', 'CoarseY.Y', 'AUX1','AUX2','Cff','PeemM3Trans']

496 
£lf
.
esPosPª–
 = 
	`Pos™iÚ”sPª–
(
POS_TYPE_ES
, 
exşude_li¡
)

497 
¥aûr
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(20,40,QtWidg‘s.
QSizePŞicy
.
Mšimum
,QtWidg‘s.QSizePŞicy.
Ex·ndšg
)

498 
vbox3
 = 
QtWidg‘s
.
	`QVBoxLayout
()

499 
vbox3
.
	`addWidg‘
(
£lf
.
esPosPª–
)

500 
vbox3
.
	`addI‹m
(
¥aûr
)

501 
£lf
.
’d¡©iÚPos™iÚ”sF¿me
.
	`£tLayout
(
vbox3
)

503 #b—mlš
pos™iÚ”s
 
·Ãl


504 
£lf
.
blPosPª–
 = 
	`Pos™iÚ”sPª–
(
POS_TYPE_BL
)

505 
¥aûr
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(20,40,QtWidg‘s.
QSizePŞicy
.
Mšimum
,QtWidg‘s.QSizePŞicy.
Ex·ndšg
)

506 
vbox4
 = 
QtWidg‘s
.
	`QVBoxLayout
()

507 
vbox4
.
	`addWidg‘
(
£lf
.
blPosPª–
)

508 
vbox4
.
	`addI‹m
(
¥aûr
)

509 
£lf
.
b—mlšePos™iÚ”sF¿me
.
	`£tLayout
(
vbox4
)

511 #‹m³¿tu» 
·Ãl


512 
dev_obj
 = 
MAIN_OBJ
.
	`g‘_deviû_obj
()

513 
‹mps
 = 
dev_obj
.
	`g‘_®l_‹m³¿tu»s
(
POS_TYPE_ES
)

514 
£lf
.
esTempPª–
 = 
	`PVsPª–
(
‹mps
, 
egu
='deg C')

515 #£lf.
esTempPª–
 = 
	`Tem³¿tu»sPª–
(
POS_TYPE_ES
)

516 
¥aûr
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(20,40,QtWidg‘s.
QSizePŞicy
.
Mšimum
,QtWidg‘s.QSizePŞicy.
Ex·ndšg
)

517 
vbox5
 = 
QtWidg‘s
.
	`QVBoxLayout
()

518 
vbox5
.
	`addWidg‘
(
£lf
.
esTempPª–
)

519 
vbox5
.
	`addI‹m
(
¥aûr
)

520 
£lf
.
esTempsF¿me
.
	`£tLayout
(
vbox5
)

522 #´essu» 
·Ãl


523 
dev_obj
 = 
MAIN_OBJ
.
	`g‘_deviû_obj
()

524 
´e¤s
 = 
dev_obj
.
	`g‘_®l_´essu»s
(
POS_TYPE_ES
)

525 
£lf
.
esP»ssPª–
 = 
	`PVsPª–
(
´e¤s
, 
egu
='TÜr', 
’gš“ršg_nÙ©iÚ
=
True
)

526 #£lf.
esTempPª–
 = 
	`Tem³¿tu»sPª–
(
POS_TYPE_ES
)

527 
¥aûr
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(20,40,QtWidg‘s.
QSizePŞicy
.
Mšimum
,QtWidg‘s.QSizePŞicy.
Ex·ndšg
)

528 
vbox6
 = 
QtWidg‘s
.
	`QVBoxLayout
()

529 
vbox6
.
	`addWidg‘
(
£lf
.
esP»ssPª–
)

530 
vbox6
.
	`addI‹m
(
¥aûr
)

531 
£lf
.
esP»ssu»sF¿me
.
	`£tLayout
(
vbox6
)

533 
£lf
.
d‘eùÜsPª–
 = 
	`D‘eùÜsPª–
()

534 
¥aûr
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(20, 20, QtWidg‘s.
QSizePŞicy
.
Mšimum
, QtWidg‘s.QSizePŞicy.
Ex·ndšg
)

535 
vbox5
 = 
QtWidg‘s
.
	`QVBoxLayout
()

536 
vbox5
.
	`addWidg‘
(
£lf
.
d‘eùÜsPª–
)

537 
vbox5
.
	`addI‹m
(
¥aûr
)

538 
£lf
.
d‘eùÜsF¿me
.
	`£tLayout
(
vbox5
)

541 
£lf
.
	`lßd_dœ_v›w
()

542 
£lf
.
pythÚsh–l
 = 
NÚe


544 
£lf
.
shu‰”CÁ¾ComboBox
.
cu¼’tIndexChªged
.
	`cÚÃù
(£lf.
Ú_shu‰”CÁ¾ComboBox
)

545 
idx
 = 
£lf
.
shu‰”CÁ¾ComboBox
.
	`cu¼’tIndex
()

546 
£lf
.
	`Ú_shu‰”CÁ¾ComboBox
(0) #Auto

548 
£lf
.
sÿn_´og»ss_bË
 =
	`SÿnQueueTabËWidg‘
()

549 
£lf
.
sÿn_q_Ïyout
.
	`addWidg‘
(£lf.
sÿn_´og»ss_bË
)

550 
£lf
.
	`š™_images_äame
()

552 
def
 
	$š™_images_äame
(
£lf
):

553 
äom
 
şs
.
­¶iÿtiÚs
.
bioXasIM
.
widg‘s
.
thumbÇV›w”
 
impÜt
 
CÚùSh“t


554 
£lf
.
images_wšdow
 = 
	`CÚùSh“t
(£lf.
aùive_u£r
.
	`g‘_d©a_dœ
())

556 
vbox
 = 
QtWidg‘s
.
	`QVBoxLayout
()

557 
vbox
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

558 
vbox
.
	`addWidg‘
(
£lf
.
images_wšdow
)

559 
£lf
.
imagesF¿me
.
	`£tLayout
(
vbox
)

561 
def
 
	$Ú_shu‰”CÁ¾ComboBox
(
£lf
, 
idx
):

563 
	$Ú_shu‰”CÁ¾ComboBox
(): 
desütiÚ


565 :
·¿m
 
idx
: idx 
desütiÚ


566 :
ty³
 
idx
: idxype

568 :
»tuºs
: 
NÚe


571 0 = 
Auto


572 1 = 
O³n


573 2 = 
Clo£


575 #idx = 
£lf
.
shu‰”CÁ¾ComboBox
.
	`cu¼’tIndex
()

577 #if(
idx
 == 0):

579 #MAIN_OBJ.
	`deviû
(
DNM_SHUTTER
).
	`şo£
()

580 #MAIN_OBJ.
	`deviû
(
DNM_SHUTTER
).
	`£t_to_auto
()

581 #
#–if(
idx
 == 1):

583 #MAIN_OBJ.
	`deviû
(
DNM_SHUTTER
).
	`£t_to_mªu®
()

584 #MAIN_OBJ.
	`deviû
(
DNM_SHUTTER
).
	`İ’
()

587 #MAIN_OBJ.
	`deviû
(
DNM_SHUTTER
).
	`£t_to_mªu®
()

588 #MAIN_OBJ.
	`deviû
(
DNM_SHUTTER
).
	`şo£
()

590 
def
 
	$£tup_sÿn_toŞbox
(
£lf
):

592 
	$£tup_sÿn_toŞbox
(): 
desütiÚ


594 :
»tuºs
: 
NÚe


596 #C»©
¶ugš
 
mªag”


597 
Ïyout
 = 
QtWidg‘s
.
	`QVBoxLayout
()

598 
Ïyout
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

599 
Ïyout
.
	`£tS·cšg
(0)

601 
£lf
.
sÿnTy³ToŞBox
 = 
QtWidg‘s
.
	`QToŞBox
()

602 
£lf
.
sÿnTy³ToŞBox
.
	`Ïyout
().
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

603 
£lf
.
sÿnTy³ToŞBox
.
	`Ïyout
().
	`£tS·cšg
(0)

604 #£lf.
sÿnTy³ToŞBox
.
	`£tStyËSh“t
(" QToolBox::tab {padding-left: 100px;} ")

605 
£lf
.
mªag”
 = 
	`PlugšMªag”
(
ÿ‹gÜ›s_f‹r
={ "Sÿns": 
SÿnP¬amWidg‘
})

606 
£lf
.
mªag”
.
£tPlugšPÏûs
(['scan_plugins'])

607 #Lßd 
¶ugšs


608 
£lf
.
mªag”
.
loÿ‹Plugšs
()

609 
£lf
.
mªag”
.
lßdPlugšs
()

611 
·ges
 = 0

612 
num_sÿns
 = 0

613 
sÿns
 = {}

615 #w®k 
the
 
¶ugš
 
dœeùÜy
 
lookšg
 
¶ugšs
 
of
 
ÿ‹gÜy
 
SÿnP¬amWidg‘


616 
¶ugš
 
š
 
£lf
.
mªag”
.
g‘PlugšsOfC©egÜy
("Scans"):

617 
´št
 "Found SCAN…lugš [%s]" % 
¶ugš
.
¶ugš_objeù
.
Çme


618 
sÿns
[
¶ugš
.
¶ugš_objeù
.
idx
] =…lugin.plugin_object

619 
num_sÿns
 += 1

621 #now 
š£¹
 
th’
 
š
 
the
 
Üd”
h
¶ugšs
 
idx
 
v®ue
 
§ys


622 
idx
 
š
 
	$¿nge
(
num_sÿns
):

623 #¶ugš.
¶ugš_objeù
 
is
 
ª
 
š¡ªû
 
of
 
the
 
¶ugš


624 #£lf.
d©afÜm©‹rsCombo
.
	`addI‹m
(
¶ugš
.
¶ugš_objeù
.
Çme
)

625 #£lf.
d©afÜm©‹rs
[
¶ugš
.
¶ugš_objeù
.
Çme
] =…lugin.plugin_object

626 
£lf
.
sÿnTy³ToŞBox
.
	`š£¹I‹m
(
·ges
, 
sÿns
[
idx
], sÿns[idx].
Çme
)

627 
sÿns
[
idx
].
roi_chªged
.
	`cÚÃù
(
£lf
.
Ú_sÿÅluggš_roi_chªged
)

628 
sÿns
[
idx
].
roi_d–‘ed
.
	`cÚÃù
(
£lf
.
Ú_sÿÁabË_roi_d–‘ed
)

629 
sÿns
[
idx
].
¶Ù_d©a
.
	`cÚÃù
(
£lf
.
Ú_¶Ù_d©a_lßded
)

630 
sÿns
[
idx
].
£Ëùed
.
	`cÚÃù
(
£lf
.
£t_cu¼’t_sÿn_¶uggš
)

631 
sÿns
[
idx
].
ş—r_®l_sig
.
	`cÚÃù
(
£lf
.
Ú_ş—r_®l
)

633 
£lf
.
sÿn_tbox_widg‘s
.
	`­³nd
(
sÿns
[
idx
])

634 
·ges
 += 1

636 
Ïyout
.
	`addWidg‘
(
£lf
.
sÿnTy³ToŞBox
)

637 
£lf
.
sÿnsF¿me
.
	`£tLayout
(
Ïyout
)

639 #####
_deàğ£lf.sÿn_tbox_widg‘s[0].g‘_max_sÿn_¿nge_lim™_def()

640 
¶Ù_™em_ty³
 = 
£lf
.
sÿn_tbox_widg‘s
[0].plot_item_type

641 if(
£lf
.
sÿn_tbox_widg‘s
[0].
	$is_muÉi_»giÚ
()):

642 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_’abË_muÉi_»giÚ
(
True
)

644 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_’abË_muÉi_»giÚ
(
F®£
)

646 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_sh­e_lim™s
(
sh­e
=
¶Ù_™em_ty³
, 
lim™_def
=limit_def)

647 
£lf
.
¶ÙTabWidg‘
.
	`£tCu¼’tIndex
(
PLOTTER_IMAGES_TAB
)

649 
dx
 = 
MAIN_OBJ
.
	`deviû
(
DNM_DETECTOR_X
)

650 
dy
 = 
MAIN_OBJ
.
	`deviû
(
DNM_DETECTOR_Y
)

651 
ûÁ”s
 = (
dx
.
	`g‘_pos™iÚ
(), 
dy
.get_position())

652 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_ûÁ”_©_XY
(
ûÁ”s
, (500,500))

653 
£lf
.
sÿnTy³ToŞBox
.
cu¼’tChªged
.
	`cÚÃù
(£lf.
Ú_toŞbox_chªged
)

655 
wdg_com
 = 
£lf
.
sÿn_tbox_widg‘s
[0].
	`upd©e_d©a
()

656 
£lf
.
sÿn_´og»ss_bË
.
	`lßd_wdg_com
(
wdg_com
)

660 
def
 
	$Ú_sÿÁabË_roi_d–‘ed
(
£lf
, 
wdg_com
):

662 
	$Ú_sÿÁabË_roi_d–‘ed
(): 
desütiÚ


664 :
·¿m
 
wdg_com
: wdg_com 
desütiÚ


665 :
ty³
 
wdg_com
: wdg_comype

667 :
»tuºs
: 
NÚe


670 
the
 
SÿnTabËV›w
 
widg‘
 
has
 
d–‘ed
 
a
 
¥©Ÿl
 
row
, 
·ss
 
šfo
 
Ú
 
to
 
¶Ù‹r


671 
so
 
th©
 
the
 
sh­eI‹m
 
ÿn
 
®so
 
be
 
d–‘ed


673 #™em_id = 
	`dù_g‘
(
wdg_com
, 
SPDB_SCAN_PLUGIN_ITEM_ID
)

674 
™em_id
 = 
	`dù_g‘
(
wdg_com
, 
SPDB_ID_VAL
)

675 
¶Ù_™em_ty³
 = 
	`dù_g‘
(
wdg_com
, 
SPDB_PLOT_SHAPE_TYPE
)

677 
™em
 = 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`g‘Sh­ePlÙI‹m
(
™em_id
, 
™em_ty³
=
¶Ù_™em_ty³
)

678 if(
™em
):

679 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`blockSigÇls
(
True
)

680 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`d–PlÙI‹m
(
™em
, 
»¶Ù
=
True
)

681 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`blockSigÇls
(
F®£
)

684 
def
 
	$£t_cu¼’t_sÿn_¶uggš
(
£lf
, 
idx
):

685 #£lf.
sÿnTy³ToŞBox
.
	`blockSigÇls
(
True
)

686 
_logg”
.
	`debug
('£t_cu¼’t_sÿn_¶uggš: [%d]' % 
idx
)

687 
£lf
.
sÿn_·Ãl_idx
 = 
idx


688 
£lf
.
sÿnTy³ToŞBox
.
	`£tCu¼’tIndex
(£lf.
sÿn_·Ãl_idx
)

689 #£lf.
sÿnTy³ToŞBox
.
	`blockSigÇls
(
F®£
)

691 
def
 
	$Ú_sÿn_lßded
(
£lf
, 
wdg_com
):

693 
	$Ú_sÿn_lßded
(): 
This
 
is
 
a
 
¦Ù
 
to
 
£rviû
‡ 
sigÇl
 
emm™‹d
 
äom
 
the
 
PLOTTER
 
Úly


695 :
·¿m
 
wdg_com
: wdg_com 
desütiÚ


696 :
ty³
 
wdg_com
: wdg_comype

697 
£lf
.
	`d–Sh­ePlÙI‹ms
()

698 :
»tuºs
: 
NÚe


702 
¥_db
 = 
	`g‘_fœ¡_¥_db_äom_wdg_com
(
wdg_com
)

704 
£lf
.
sÿn_·Ãl_idx
 = (
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_PANEL_IDX
))

705 #if(
£lf
.
sÿn_·Ãl_idx
 > 100):

706 #£lf.
sÿn_·Ãl_idx
 = 
sÿn_·Ãl_Üd”
.
IMAGE_SCAN


708 
£lf
.
sÿnTy³ToŞBox
.
	`£tCu¼’tIndex
(£lf.
sÿn_·Ãl_idx
)

709 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`£t_zp_focus_mode
()

710 
time
.
	`¦“p
(0.15)

711 #£lf.
sÿn_tbox_widg‘s
[
£lf
.
sÿn_·Ãl_idx
].
	`blockSigÇls
(
True
)

712 #£lf.
sÿn_tbox_widg‘s
[
£lf
.
sÿn_·Ãl_idx
].
	`mod_roi
(
¥_db
, 
do_»ÿlc
=
F®£
)

713 if(
	$dù_g‘
(
¥_db
, 
SPDB_PLOT_IMAGE_TYPE
è
š
 [
image_ty³s
.
FOCUS
, image_ty³s.
OSAFOCUS
]):

714 #dÚˆ
®low
 
sigÇls
 
th©
 
would
 
ÿu£
 
a
 
¶Ù
 
£gm’t
 
to
 
be
 
ü—‹d


715 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`blockSigÇls
(
True
)

716 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`lßd_roi
(
wdg_com
)

717 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`blockSigÇls
(
F®£
)

719 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`lßd_roi
(
wdg_com
)

720 #£lf.
sÿn_tbox_widg‘s
[
£lf
.
sÿn_·Ãl_idx
].
	`blockSigÇls
(
F®£
)

722 
def
 
	$Ú_sÿÅluggš_roi_chªged
(
£lf
, 
wdg_com
):

724 
	$Ú_sÿÅluggš_roi_chªged
(): 
desütiÚ


726 :
·¿m
 
wdg_com
: wdg_com 
desütiÚ


727 :
ty³
 
wdg_com
: wdg_comype

729 :
»tuºs
: 
NÚe


731 #_logg”.
	`debug
('on_scanpluggin_roi_changed: called')

732 if(
wdg_com
[
WDGCOM_CMND
] =ğ
widg‘_com_cmnd_ty³s
.
LOAD_SCAN
):

733 #£lf.
sÿn_´og»ss_bË
.
	`£t_dœeùÜy_Ïb–
(
£lf
.
aùive_u£r
.
	`g‘_d©a_dœ
())

734 #£lf.
sÿn_´og»ss_bË
.
	`lßd_wdg_com
(
wdg_com
)

736 ##
—ch
 
¥©Ÿl
 
»giÚ
 
ü—‹
 
a
 
¶Ù™em


737 #¥_roi ğ
	`dù_g‘
(
wdg_com
, 
WDGCOM_SPATIAL_ROIS
)

738 #fÜ 
¥_id
 
š
 
¥_rois
.
	`keys
():

739 #¥_db = 
¥_rois
[
¥_id
]

740 #»ù = 
¥_db
[
SPDB_RECT
]

741 #sÿn_™em_ty³ = (
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
))

742 #¶Ù_™em_ty³ = (
	`dù_g‘
(
¥_db
, 
SPDB_PLOT_SHAPE_TYPE
))

743 #£lf.
lšeByLšeImageD©aWidg‘
.
	`addSh­ePlÙI‹m
((
¥_id
), 
»ù
, 
™em_ty³
=
¶Ù_™em_ty³
)

744 
·ss


747 
¥_rois
 = 
	`dù_g‘
(
wdg_com
, 
WDGCOM_SPATIAL_ROIS
)

748 #if(
¥_rois
 
is
 
NÚe
):

750 if((
¥_rois
 
is
 
NÚe
è
	`Ü
 (
	`Ën
(¥_rois.
	`keys
()) < 1)):

752 
¥_id
 
š
 
¥_rois
.
	$keys
():

753 #¥_id = 
¥_rois
.
	`keys
()[0]

754 
¥_db
 = 
¥_rois
[
¥_id
]

755 
sÿn_™em_ty³
 = (
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
))

756 
¶Ù_™em_ty³
 = (
	`dù_g‘
(
¥_db
, 
SPDB_PLOT_SHAPE_TYPE
))

757 
™em_id
 = (
	`dù_g‘
(
¥_db
, 
SPDB_ID_VAL
))

759 if(
¶Ù_™em_ty³
 =ğ
¥©Ÿl_ty³_´efix
.
PNT
):

760 
x1
 = 
x2
 = (
	`dù_g‘
(
¥_db
, 
SPDB_XCENTER
))

761 
y1
 = 
y2
 = (
	`dù_g‘
(
¥_db
, 
SPDB_YCENTER
))

764 
x1
 = (
	`dù_g‘
(
¥_db
, 
SPDB_XSTART
))

765 
y1
 = (
	`dù_g‘
(
¥_db
, 
SPDB_YSTART
))

766 
x2
 = (
	`dù_g‘
(
¥_db
, 
SPDB_XSTOP
))

767 
y2
 = (
	`dù_g‘
(
¥_db
, 
SPDB_YSTOP
))

769 #´šˆ'Ú_sÿÅluggš_roi_chªged: i‹m_id = %d' % 
™em_id


770 
™em
 = 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`g‘Sh­ePlÙI‹m
(
™em_id
, 
¶Ù_™em_ty³
)

771 #£lf.
lšeByLšeImageD©aWidg‘
.
	`£t_sh­e_™em_max_¿nge
(
™em
, 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_MAX_SCANRANGE
))

773 
»ù
 = (
x1
, 
y1
, 
x2
, 
y2
)

775 #´šˆ'Ú_sÿÅluggš_roi_chªged:„eù=' , (
»ù
)

776 
sk_li¡
 = [
sÿn_ty³s
.
SAMPLE_FOCUS
, sÿn_ty³s.
OSA_FOCUS
]

777 if(
™em
 
is
 
NÚe
):

778 if(
sÿn_™em_ty³
 
nÙ
 
š
 
sk_li¡
):

779 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`addSh­ePlÙI‹m
(
™em_id
, 
»ù
, 
™em_ty³
=
¶Ù_™em_ty³
)

781 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`blockSigÇls
(
True
)

782 if(
wdg_com
[
WDGCOM_CMND
] =ğ
widg‘_com_cmnd_ty³s
.
SELECT_ROI
):

783 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£ËùSh­ePlÙI‹m
(
™em_id
, 
£Ëù
=
True
, 
™em
=™em, 
™em_ty³
=
¶Ù_™em_ty³
)

785 
	$–if
(
wdg_com
[
WDGCOM_CMND
] =ğ
widg‘_com_cmnd_ty³s
.
ROI_CHANGED
):

786 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`»sizeSh­ePlÙI‹m
(
™em_id
, 
»ù
, 
™em
=™em, 
™em_ty³
=
¶Ù_™em_ty³
)

788 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`blockSigÇls
(
F®£
)

790 
£lf
.
sÿn_´og»ss_bË
.
	`lßd_wdg_com
(
wdg_com
)

792 
def
 
	$Ú_¶Ù™em_roi_chªged
(
£lf
, 
wdg_com
):

794 
	$Ú_¶Ù™em_roi_chªged
(): 
desütiÚ


796 :
·¿m
 
wdg_com
: wdg_com 
desütiÚ


797 :
ty³
 
wdg_com
: wdg_comype

799 :
»tuºs
: 
NÚe


802 #´šˆ'Ú_¶Ù™em_roi_chªged: ', 
dù


803 if(
£lf
.
sÿn_š_´og»ss
):

806 
nÚ_š‹¿ùive_¶Ùs
 = [
sÿn_·Ãl_Üd”
.
POSITIONER_SCAN
]

808 
sk_sÿn_q_bË_¶Ùs
 = [
sÿn_·Ãl_Üd”
.
OSA_FOCUS_SCAN
, sÿn_·Ãl_Üd”.
FOCUS_SCAN
]

810 
x1
 = 
	`dù_g‘
(
wdg_com
, 
SPDB_XSTART
)

811 
y1
 = 
	`dù_g‘
(
wdg_com
, 
SPDB_YSTART
)

812 
x2
 = 
	`dù_g‘
(
wdg_com
, 
SPDB_XSTOP
)

813 
y2
 = 
	`dù_g‘
(
wdg_com
, 
SPDB_YSTOP
)

814 
»ù
 = (
x1
, 
y1
, 
x2
, 
y2
)

815 #´šˆ'Ú_¶Ù™em_roi_chªged:„eù', 
»ù


817 if(
£lf
.
sÿn_·Ãl_idx
 
š
 
nÚ_š‹¿ùive_¶Ùs
):

820 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`blockSigÇls
(
True
)

821 if(
wdg_com
[
WDGCOM_CMND
] =ğ
widg‘_com_cmnd_ty³s
.
ROI_CHANGED
):

823 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`mod_roi
(
wdg_com
)

824 
wdg_com
 = 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`upd©e_d©a
()

826 if(
£lf
.
sÿn_·Ãl_idx
 
š
 
sk_sÿn_q_bË_¶Ùs
):

827 #ju¡ 
sk
 
beÿu£
 
this
 
´oduûs
 
a
 
lÙ
 
of
 
chªges
 
to
 
the
 
sÿn_q_bË
 
whcih
 
cu¼’y
 
¬e
 
v”y
 
¦ow
 
wh’
 
fœšg
‡†ot of

828 #sigÇl 
to
 
§y
 
the
 
¶Ù
 
roi
 
has
 
chÇged


829 
·ss


831 
£lf
.
sÿn_´og»ss_bË
.
	`lßd_wdg_com
(
wdg_com
)

833 
	$–if
(
wdg_com
[
WDGCOM_CMND
] =ğ
widg‘_com_cmnd_ty³s
.
ADD_ROI
):

834 #·s 
Ú
 
this
 
add™iÚ
 
»que¡


835 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`mod_roi
(
wdg_com
)

837 
	$–if
(
wdg_com
[
WDGCOM_CMND
] =ğ
widg‘_com_cmnd_ty³s
.
DEL_ROI
):

838 #·s 
Ú
 
this
 
d–‘iÚ
 
»que¡


839 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`mod_roi
(
wdg_com
)

841 
	$–if
(
wdg_com
[
WDGCOM_CMND
] =ğ
widg‘_com_cmnd_ty³s
.
SELECT_ROI
):

842 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`mod_roi
(
wdg_com
)

844 
	$–if
(
wdg_com
[
WDGCOM_CMND
] =ğ
widg‘_com_cmnd_ty³s
.
DESELECT_ROI
):

845 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`mod_roi
(
wdg_com
)

848 
_logg”
.
	`”rÜ
('Ú_¶Ù™em_roi_chªged: unsuµÜ‹d widg‘_com commªdy³' % 
wdg_com
[
WDGCOM_CMND
])

849 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`blockSigÇls
(
F®£
)

851 
def
 
	$Ú_ş—r_®l
(
£lf
):

853 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`blockSigÇls
(
True
)

854 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`d–Sh­ePlÙI‹ms
()

855 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`blockSigÇls
(
F®£
)

857 
def
 
	$Ú_¶Ù_d©a_lßded
(
£lf
, 
l
):

859 
	$Ú_¶Ù_d©a_lßded
(): 
desütiÚ


861 :
·¿m
 
d©a_dù
: d©a_dù 
desütiÚ


862 :
ty³
 
d©a_dù
: data_dctype

864 :
»tuºs
: 
NÚe


866 #(
âame
, 
ado_obj
èğ
l


867 #wdg_com = 
	`dù_g‘
(
ado_obj
, 
ADO_CFG_WDG_COM
)

868 (
âame
, 
wdg_com
, 
d©a
èğ
l


869 
¥_db
 = 
	`g‘_fœ¡_¥_db_äom_wdg_com
(
wdg_com
)

871 ##
—ch
 
¥©Ÿl
 
»giÚ
 
ü—‹
 
a
 
¶Ù™em


872 #¥_roi ğ
	`dù_g‘
(
wdg_com
, 
WDGCOM_SPATIAL_ROIS
)

873 #fÜ 
¥_id
 
š
 
¥_rois
.
	`keys
():

874 #¥_db = 
¥_rois
[
¥_id
]

875 #»ù = 
¥_db
[
SPDB_RECT
]

876 #sÿn_™em_ty³ = (
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
))

877 #¶Ù_™em_ty³ = (
	`dù_g‘
(
¥_db
, 
SPDB_PLOT_SHAPE_TYPE
))

878 #£lf.
lšeByLšeImageD©aWidg‘
.
	`addSh­ePlÙI‹m
((
¥_id
), 
»ù
, 
™em_ty³
=
¶Ù_™em_ty³
)

879 #
(
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
è
nÙ
 
š
 [
sÿn_ty³s
.
SAMPLE_POINT_SPECTRUM
, sÿn_ty³s.
GENERIC_SCAN
]):

880 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`blockSigÇls
(
True
)

881 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`d–Sh­ePlÙI‹ms
()

882 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`lßd_image_d©a
(
âame
, 
wdg_com
, 
d©a
)

884 #Úly 
®low
 
the
 
sÿn
 
·¿m
 
sh­es
 
to
 
be
 
ü—‹d
 
NOT
 
a
 
focus
 
ty³
 sÿÀ
image


885 if(
	$dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
è
nÙ
 
š
 [
sÿn_ty³s
.
OSA_FOCUS
, sÿn_ty³s.
SAMPLE_FOCUS
]):

886 
»ù
 = 
¥_db
[
SPDB_RECT
]

887 
¥_id
 = (
	`dù_g‘
(
¥_db
, 
SPDB_ID_VAL
))

888 #sÿn_™em_ty³ = (
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
))

889 
¶Ù_™em_ty³
 = (
	`dù_g‘
(
¥_db
, 
SPDB_PLOT_SHAPE_TYPE
))

890 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`addSh­ePlÙI‹m
((
¥_id
), 
»ù
, 
™em_ty³
=
¶Ù_™em_ty³
)

892 #mak
su»
 
¶Ù‹r
 
is
 
aw¬e
 
™
 i 
suµo£d
 
to
 
®low
 
mÜe
 
thª
 
Úe
 
Sh³I‹m


893 #if(
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`is_muÉi_»giÚ
()):

894 #£lf.
lšeByLšeImageD©aWidg‘
.
	`£t_’abË_muÉi_»giÚ
(
True
)

896 #£lf.
lšeByLšeImageD©aWidg‘
.
	`£t_’abË_muÉi_»giÚ
(
F®£
)

898 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`blockSigÇls
(
F®£
)

900 
def
 
	$£tup_image_¶Ù
(
£lf
):

902 
	$£tup_image_¶Ù
(): 
desütiÚ


904 :
»tuºs
: 
NÚe


906 
fg_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_forgrnd'])

907 
bg_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_bckgrnd'])

908 
mš_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_gridmaj'])

909 
maj_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_gridmin'])

911 #grid·¿m = {'fg_şr':
fg_şr
, 'bg_şr':
bg_şr
, 'mš_şr':
mš_şr
, 'maj_şr':
maj_şr
}

913 #£lf.
lšeByLšeImageD©aWidg‘
 = 
ImageWidg‘
(
£lf
, 
ftSŒ
 = "*.hdf5", 
ty³
='ª®yze', 
§m¶e_pos_mode
=sample_pos_mode,

914 
£lf
.
lšeByLšeImageD©aWidg‘
 = 
ImageWidg‘
(
·»Á
=
NÚe
, 
ftSŒ
 = "*.hdf5", 
ty³
=None,

915 
İtiÚs
=
diù
(
lock_a¥eù_¿tio
=
True
, 
show_cÚŒa¡
=True, 
show_x£ùiÚ
=True, 
show_y£ùiÚ
=True,

916 
xÏb–
=("miüÚs", ""), 
yÏb–
=("miüÚs", ""), 
cŞÜm­
="gist_gray"))

917 
£lf
.
lšeByLšeImageD©aWidg‘
.
£tObjeùName
("lineByLineImageDataWidget")

918 
£lf
.
lšeByLšeImageD©aWidg‘
.
»gi¡”_o§_ªd_§m¶ehldr_toŞ
(
§m¶e_pos_mode
)

919 #£lf.
lšeByLšeImageD©aWidg‘
.
£t_ŒªsfÜm_çùÜs
(0.333, 0.333, 0.333, 'um')

920 
£lf
.
lšeByLšeImageD©aWidg‘
.
£tMšimumSize
(600,600)

921 
£lf
.
lšeByLšeImageD©aWidg‘
.
£tMaximumSize
(1000,1000)

922 
£lf
.
lšeByLšeImageD©aWidg‘
.
’abË_toŞ_by_Çme
('StxmO³nFeToŞ', 
F®£
)

923 #£lf.
lšeByLšeImageD©aWidg‘
.
£t_§m¶e_pos™iÚšg_mode
(
§m¶e_pos_mode
)

924 
£lf
.
lšeByLšeImageD©aWidg‘
.
£t_d©aIO
(
BioxasD©aIo
)

926 #£lf.
lšeByLšeImageD©aWidg‘
.
addToŞ
('HLineSegmentTool')

928 
£lf
.
lšeByLšeImageD©aWidg‘
.
£t_grid_·¿m‘”s
(
bg_şr
, 
mš_şr
, 
maj_şr
)

929 
£lf
.
lšeByLšeImageD©aWidg‘
.
£t_cs_grid_·¿m‘”s
(
fg_şr
, 
bg_şr
, 
mš_şr
, 
maj_şr
)

931 
£lf
.
lšeByLšeImageD©aWidg‘
.
Ãw_roi_ûÁ”
.
cÚÃù
(£lf.
Ú_¶Ù™em_roi_chªged
)

932 
£lf
.
lšeByLšeImageD©aWidg‘
.
sÿn_lßded
.
cÚÃù
(£lf.
Ú_sÿn_lßded
)

934 
vbox
 = 
QtWidg‘s
.
QVBoxLayout
()

935 
vbox
.
addWidg‘
(
£lf
.
lšeByLšeImageD©aWidg‘
)

936 
£lf
.
imagePlÙF¿me
.
£tLayout
(
vbox
)

938 #£lf.
lšeByLšeImageD©aWidg‘
.
ü—‹_§m¶e_hŞd”
()

940 
£lf
.
lšeByLšeImageD©aWidg‘
.
£t_d©a_dœ
(£lf.
aùive_u£r
.
g‘_d©a_dœ
())

941 
MAIN_OBJ
.
£t
('IMAGE_WIDGET', 
£lf
.
lšeByLšeImageD©aWidg‘
)

944 
def
 
	$£tup_¥eù¿_¶Ù
(
£lf
):

946 
	$£tup_¥eù¿_¶Ù
(): 
desütiÚ


948 :
»tuºs
: 
NÚe


950 
vbox
 = 
QtWidg‘s
.
	`QVBoxLayout
()

951 #£lf.
¥eù¿Widg‘
 = 
	`CurveV›w”Widg‘
(
·»Á
 = 
£lf
, 
wšT™ËSŒ
 = "Spectra Data Viewer")

952 
£lf
.
¥eù¿Widg‘
 = 
	`CurveV›w”Widg‘
()

953 
£lf
.
¥eù¿Widg‘
.
	`£tObjeùName
("spectraWidget")

954 
£lf
.
¥eù¿Widg‘
.
	`add_Ëg’d
("TL")

956 
vbox
.
	`addWidg‘
(
£lf
.
¥eù¿Widg‘
)

957 
£lf
.
¥eù¿PlÙF¿me
.
	`£tLayout
(
vbox
)

960 
def
 
	$£tup_ÿlib_ÿm”a
(
£lf
):

962 
	$£tup_video_·Ãl
(): 
desütiÚ


964 :
»tuºs
: 
NÚe


965 
¶ÙTabWidg‘


966 
b3


968 
äom
 
şs
.
­¶iÿtiÚs
.
bioXasIM
.
widg‘s
.
ÿm”a_ruËr
 
impÜt
 
Cam”aRuËr
, 
ÿmruËr_mode


969 
vbox
 = 
QtWidg‘s
.
	`QVBoxLayout
()

970 #£lf.
¥eù¿Widg‘
 = 
	`CurveV›w”Widg‘
(
·»Á
 = 
£lf
, 
wšT™ËSŒ
 = "Spectra Data Viewer")

971 
£lf
.
ÿlibCamWidg‘
 = 
	`Cam”aRuËr
(
mode
=
ÿmruËr_mode
.
CLIENT
)

972 
£lf
.
ÿlibCamWidg‘
.
	`£tObjeùName
("calibCamWidget")

975 
vbox
.
	`addWidg‘
(
£lf
.
ÿlibCamWidg‘
)

976 
£lf
.
ÿlibCamPlÙF¿me
.
	`£tLayout
(
vbox
)

978 #deà
	`add_to_¶Ù_b_widg‘
(
£lf
, 
b_num
, 
b_t™Ë
, 
widg
):

979 #tw = 
£lf
.
	`_g‘_ba£_b_widg‘
()

980 #£lf.
¶ÙTabWidg‘
.
	`£tTabPos™iÚ
(
b_num
)

981 #£lf.
¶ÙTabWidg‘
.
	`£tTabText
(
b_t™Ë
)

982 #£lf.
¶ÙTabWidg‘
.

983 #
#deà
	`_g‘_ba£_b_widg‘
(
£lf
):

984 #tw = 
QtWidg‘s
.
	`QWidg‘
()

985 #tàğ
QtWidg‘s
.
	`QF¿me
()

986 #vbox = 
QtWidg‘s
.
	`QVBoxLayout
()

987 #vbox.
	`addWidg‘
(
tf
)

988 #tw.
	`£tLayout
(
vbox
)

989 #»tuº(
tw
)

992 
def
 
	$£tup_video_·Ãl
(
£lf
):

994 
	$£tup_video_·Ãl
(): 
desütiÚ


996 :
»tuºs
: 
NÚe


998 
·ss


999 #QWebS‘tšgs.
	`glob®S‘tšgs
().
	`£tA‰ribu‹
(
QWebS‘tšgs
.
PlugšsEÇbËd
, 
True
)

1000 #QWebS‘tšgs.
	`glob®S‘tšgs
().
	`£tA‰ribu‹
(
QWebS‘tšgs
.
AutoLßdImages
, 
True
)

1001 #£lf.
videoWebV›w
.
	`£tU¾
(
QtCÜe
.
	`QU¾
("http://ccd1608-500.clsi.ca/jpg/image.jpg"))

1002 #£lf.
videoWebV›w
.
	`lßd
(
QtCÜe
.
	`QU¾
("http://ccd1608-500.clsi.ca/jpg/image.jpg"))

1004 #£lf.
videoWebV›w
.
	`£tU¾
(
QtCÜe
.
	`QU¾
("http://v2e1602-101/axis-cgi/mjpg/video.cgi?camera=1"))

1005 #£lf.
videoWebV›w
.
	`lßd
(
QtCÜe
.
	`QU¾
("http://v2e1602-101/axis-cgi/mjpg/video.cgi?camera=1"))

1007 #£lf.
vidTim”
.
	`¡¬t
(250)

1009 #£lf.
videoPÏy”
.
	`lßd
(
PhÚÚ
.
	`MedŸSourû
('http://ccd1608-500.clsi.ca/view/index.shtml'))

1010 #£lf.
videoPÏy”
.
	`¶ay
()

1012 
def
 
	$Ú_video_tim”
(
£lf
):

1014 
	$Ú_video_tim”
(): 
desütiÚ


1016 :
»tuºs
: 
NÚe


1018 
£lf
.
videoWebV›w
.
	`lßd
(
QtCÜe
.
	`QU¾
("http://ccd1608-500.clsi.ca/jpg/image.jpg"))

1019 #£lf.
videoWebV›w
.
	`»lßd
()

1022 
def
 
	$£tup_šfo_dock
(
£lf
):

1024 
	$£tup_šfo_dock
(): 
desütiÚ


1026 :
»tuºs
: 
NÚe


1028 #n ğ{'maš': 
£lf
, 'widg‘': s–f, 'd‘_sÿn' : 
sÿns
[1]
	}
}

1029 
ns
 = {'maš': 
£lf
, 'pythÚSh–l': s–f.
pythÚsh–l
, 'g':
glob®s
() }

1031 
£lf
.
pythÚsh–l
 = 
Sh–lWidg‘
(
·»Á
=
NÚe
, 
Çme¥aû
=
ns
,
commªds
=[], 
muÉ™h»aded
=
True
)

1032 
£lf
.
pycÚsŞe_Ïyout
.
addWidg‘
(£lf.
pythÚsh–l
)

1033 #£lf.
­¶y_¡yËsh“t
(
£lf
.
pythÚsh–l
, s–f.
qssh“t
)

1035 
def
 
	$Ú_toŞbox_chªged
(
£lf
, 
idx
):

1037 
	$Ú_toŞbox_chªged
(): 
desütiÚ


1039 :
·¿m
 
idx
: idx 
desütiÚ


1040 :
ty³
 
idx
: idxype

1042 :
»tuºs
: 
NÚe


1044 
	`»£t_unique_roi_id
()

1045 
¿nges
 = (
NÚe
, None)

1046 #´šˆ'Ú_toŞbox_chªged: %d' % 
idx


1047 
¥eù¿_¶Ù_ty³s
 = [
sÿn_·Ãl_Üd”
.
POINT_SCAN
]

1048 
nÚ_š‹¿ùive_¶Ùs
 = [
sÿn_·Ãl_Üd”
.
POSITIONER_SCAN
]

1049 
muÉi_¥©Ÿl_sÿn_ty³s
 = [
sÿn_ty³s
.
SAMPLE_POINT_SPECTRUM
, sÿn_ty³s.
SAMPLE_LINE_SPECTRUM
, sÿn_ty³s.
SAMPLE_IMAGE
, \

1050 
sÿn_ty³s
.
SAMPLE_IMAGE_STACK
]

1052 
sk_li¡
 = [
sÿn_ty³s
.
SAMPLE_FOCUS
, sÿn_ty³s.
OSA_FOCUS
]

1054 
£lf
.
sÿn_·Ãl_idx
 = 
idx


1056 if(
	`Ën
(
£lf
.
sÿn_tbox_widg‘s
) > 0):

1057 
£lf
.
sÿn_´og»ss_bË
.
	`ş—r_bË
()

1058 
§m¶e_pos™iÚšg_mode
 = 
MAIN_OBJ
.
	`g‘_§m¶e_pos™iÚšg_mode
()

1060 
sÿn_¶uggš
 = 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
]

1061 
¿nges
 = 
sÿn_¶uggš
.
	`g‘_§ved_¿nge
()

1062 
ûÁ”s
 = 
sÿn_¶uggš
.
	`g‘_§ved_ûÁ”
()

1063 
axis_¡rs
 = 
sÿn_¶uggš
.
	`g‘_axis_¡rs
()

1064 
max_sÿn_¿nge
 = 
sÿn_¶uggš
.
	`g‘_¥©Ÿl_sÿn_¿nge
()

1065 
lim™_def
 = 
sÿn_¶uggš
.
	`g‘_max_sÿn_¿nge_lim™_def
()

1066 
¶Ù_™em_ty³
 = 
sÿn_¶uggš
.plot_item_type

1067 
’abË_muÉi_»giÚ
 = 
sÿn_¶uggš
.
	`is_muÉi_»giÚ
()

1068 
sÿn_ty³
 = 
sÿn_¶uggš
.
	`g‘_sÿn_ty³
()

1069 #wdg_com = 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`upd©e_d©a
()

1070 #£lf.
sÿn_´og»ss_bË
.
	`lßd_wdg_com
(
wdg_com
)

1072 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`d–Sh­ePlÙI‹ms
()

1073 if(
idx
 
š
 
¥eù¿_¶Ù_ty³s
):

1074 #£lf.
¶ÙTabWidg‘
.
	`£tCu¼’tIndex
(0)

1075 
£lf
.
¥eù¿Widg‘
.
	`£tPlÙAxisSŒs
(
axis_¡rs
[0],‡xis_strs[1])

1077 
£lf
.
¶ÙTabWidg‘
.
	`£tCu¼’tIndex
(
PLOTTER_IMAGES_TAB
)

1079 if((
¿nges
[0] 
is
 
nÙ
 
NÚe
è
	`ªd
 (ranges[1] is‚ot None)):

1081 if((
£lf
.
sÿn_·Ãl_idx
 =ğ
sÿn_·Ãl_Üd”
.
IMAGE_SCAN
è
	$ªd
 (
§m¶e_pos™iÚšg_mode
 =ğ
§m¶e_pos™iÚšg_modes
.
GONIOMETER
)):

1082 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_ûÁ”_©_XY
(
ûÁ”s
, 
¿nges
)

1084 
·ss


1085 #sx = 
MAIN_OBJ
.
	`deviû
(
DNM_SAMPLE_X
)

1086 #sy = 
MAIN_OBJ
.
	`deviû
(
DNM_SAMPLE_Y
)

1087 #ûÁ” ğ(
sx
.
	`g‘_pos™iÚ
(), 
sy
.get_position())

1088 #£lf.
lšeByLšeImageD©aWidg‘
.
	`£t_ûÁ”_©_XY
(
ûÁ”s
, 
¿nges
)

1091 #£lf.
lšeByLšeImageD©aWidg‘
.
	`£t_sh­e_lim™s
(
sh­e
=
¶Ù_™em_ty³
, 
lim™_def
=limit_def)

1092 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£tPlÙAxisSŒs
(
axis_¡rs
[0],‡xis_strs[1])

1094 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_max_sh­e_sizes
(
max_sÿn_¿nge
)

1095 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_’abË_muÉi_»giÚ
(
’abË_muÉi_»giÚ
)

1097 if(
£lf
.
sÿn_·Ãl_idx
 
š
 
nÚ_š‹¿ùive_¶Ùs
):

1098 #di§bË 
®l
 
roi
 
£ËùiÚ
 
toŞs


1099 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_sh­e_lim™s
(
sh­e
=
NÚe
, 
lim™_def
=None)

1101 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_sh­e_lim™s
(
sh­e
=
¶Ù_™em_ty³
, 
lim™_def
=limit_def)

1104 if(
	`Ën
(
£lf
.
sÿn_tbox_widg‘s
) > 0):

1105 #som
of
 
the
 
·¿ms
 
Ú
 
a
 
·¹icuÏr
 
toŞ
 
box
 
»ad
 
pv
's so make surehe 

1106 #focu 
ÿlc
 
mode
 
is
 
£t
 
cÜ»ùly
 
ªd
 
has
 
time
 
to
 
´oûss


1107 
sÿn_¶uggš
.
	`£t_zp_focus_mode
()

1108 
time
.
	`¦“p
(0.15)

1109 
sÿn_¶uggš
.
	`lßd_äom_deçuÉs
()

1111 #if(
sÿn_ty³
 
š
 
muÉi_¥©Ÿl_sÿn_ty³s
):

1112 
wdg_com
 = 
sÿn_¶uggš
.
	`upd©e_d©a
()

1114 #if(
wdg_com
):

1115 #if(
	`Ën
(
wdg_com
['SPATIAL_ROIS']) > 0):

1116 #£lf.
sÿn_´og»ss_bË
.
	`lßd_wdg_com
(
wdg_com
)

1119 
def
 
	$š™_¡©usb¬
(
£lf
):

1121 
	$š™_¡©usb¬
(): 
desütiÚ


1123 :
»tuºs
: 
NÚe


1125 
£lf
.
¡©us_li¡
 = []

1126 
t™Ë_cŞÜ
ğ
ma¡”_cŞÜs
['app_blue']

1127 
fbk_cŞÜ
 = 'white'

1128 
msg_cŞÜ
 = 
ma¡”_cŞÜs
['msg_color']

1129 
ma_cŞÜ
 = 
ma¡”_cŞÜs
['app_yellow']

1133 #£·¿tÜ = 
QtWidg‘s
.
	`QLab–
()

1134 #£·¿tÜ.
	`£tMaximumWidth
(5000)

1135 #£·¿tÜ.
	`£tSizePŞicy
(
QtWidg‘s
.
QSizePŞicy
.
Ex·ndšg
, QtWidgets.QSizePolicy.Expanding)

1136 #£lf.
¡©us_li¡
.
	`­³nd
(
£·¿tÜ
)

1138 #£lf.
¡©us_li¡
.
	`­³nd
(
	`ÿ_¡rLab–
(
MAIN_OBJ
.
	`deviû
('SRStus_msgL1'), 
hdrText
='SR Stus', 
t™Ë_cŞÜ
ñ™Ë_cŞÜ, 
v¬_şr
=
fbk_cŞÜ
))

1139 #£lf.
¡©us_li¡
.
	`­³nd
(
	`ÿ_¡rLab–
(
MAIN_OBJ
.
	`deviû
('SRStus_msgL2'), 
t™Ë_cŞÜ
ñ™Ë_cŞÜ, 
v¬_şr
=
fbk_cŞÜ
))

1140 #£lf.
¡©us_li¡
.
	`­³nd
(
	`ÿ_¡rLab–
(
MAIN_OBJ
.
	`deviû
('SRStus_msgL3'), 
t™Ë_cŞÜ
ñ™Ë_cŞÜ, 
v¬_şr
=
fbk_cŞÜ
))

1142 #£lf.
¡©us_li¡
.
	`­³nd
(
	`ÿ_aiLab–Widg‘
(
MAIN_OBJ
.
	`deviû
('MÚo_ev_fbk'), 
hdrText
='EÃrgy', 
egu
='eV', 
t™Ë_cŞÜ
ñ™Ë_cŞÜ, 
v¬_şr
=
fbk_cŞÜ
))

1143 #£lf.
¡©us_li¡
.
	`­³nd
(
	`ÿ_aiLab–Widg‘
(
MAIN_OBJ
.
	`deviû
('tick”'), 
hdrText
='I0', 
t™Ë_cŞÜ
ñ™Ë_cŞÜ, 
v¬_şr
=
fbk_cŞÜ
))

1144 
£lf
.
¡©us_li¡
.
	`­³nd
(
	`ÿ_mbbiLab–Widg‘
(
MAIN_OBJ
.
	`deviû
('SYSTEM:mode:fbk').
	`g‘_Çme
(), 
hdrText
='SR Mode', 
t™Ë_cŞÜ
ñ™Ë_cŞÜ, 
v¬_şr
=
fbk_cŞÜ
))

1145 
£lf
.
¡©us_li¡
.
	`­³nd
(
	`ÿ_aiLab–Widg‘
(
MAIN_OBJ
.
	`deviû
('StÜageRšgCu¼’t'), 
hdrText
='Ršg', 
egu
='mA', 
t™Ë_cŞÜ
ñ™Ë_cŞÜ, 
v¬_şr
=
fbk_cŞÜ
, 
®¬m
=5, 
w¬n
=20))

1146 
£lf
.
¡©us_li¡
.
	`­³nd
(
QtWidg‘s
.
	`QLab–
('B—mlše: ' + 
MAIN_OBJ
.
	`g‘_b—mlše_Çme
()))

1147 
£lf
.
¡©us_li¡
.
	`­³nd
(
QtWidg‘s
.
	`QLab–
('EndStiÚ: ' + 
MAIN_OBJ
.
	`g‘_’d¡©iÚ_Çme
()))

1149 
¡s
 
š
 
£lf
.
¡©us_li¡
:

1150 
£lf
.
	`¡©usB¬
().
	`addP”mª’tWidg‘
(
¡s
)

1151 #add 
a
 
£·¿tÜ


1152 
£lf
.
	`¡©usB¬
().
	`addP”mª’tWidg‘
(
QtWidg‘s
.
	`QLab–
('|'))

1155 #deà
	`add_lše_to_¶Ù
(
£lf
, 
row
, 
sÿn_d©a
):

1156 
def
 
	$add_lše_to_¶Ù
(
£lf
, 
couÁ”_to_¶Ù‹r_com_dù
):

1158 
	$add_lše_to_¶Ù
(): 
desütiÚ


1160 :
·¿m
 
row
:„ow 
desütiÚ


1161 :
ty³
 
row
:„owype

1163 :
·¿m
 
sÿn_d©a
: sÿn_d©¨
desütiÚ


1164 :
ty³
 
sÿn_d©a
: scan_dataype

1166 :
»tuºs
: 
NÚe


1169 
N“ded
 
a
 
æag
 
to
 
mÚ™Ü
 
wh’
Ø
¡¬t
‡ 
Ãw
 
image


1171 
CNTR2PLOT_TYPE_ID
 = 'ty³_id' #tØ
be
 
u£d
 
to
 
šdiÿ‹
 
wh©
 
kšd
 
of
 
couÁ”
/
sÿn
 
is
 
£ndšg
 
this
 
šfo


1172 
CNTR2PLOT_ROW
 = 'row' #¨
y
 
pos™iÚ


1173 
CNTR2PLOT_COL
 = 'cŞ' #ª 
x
 
pos™iÚ


1174 
CNTR2PLOT_VAL
 = 'v®' #th
pošt
 
Ü
 
¬¿y
 
of
 
d©a


1175 
CNTR2PLOT_IMG_CNTR
 = 'img_úŒ' #cu¼’ˆ
image
 
couÁ”


1176 
CNTR2PLOT_EV_CNTR
 = 'ev_idx' #cu¼’ˆ
’”gy
 
couÁ”


1177 
CNTR2PLOT_SP_ID
 = '¥_id' #¥©ŸÈ
id
 
this
 
d©a
 
b–Úgs
 
to


1178 
CNTR2PLOT_IS_POINT
 = 'is_pxp' #d©¨
is
 
äom
 
a
 
pošt
 
by
…ošˆ
sÿn


1179 
CNTR2PLOT_IS_LINE
 = 'is_lxl' #d©¨
isäom
 
a
 
lše
 
by
†š
sÿn


1181 #´šˆ'add_lše_to_¶Ù:„ow=%d' % 
row


1182 #´šˆ
couÁ”_to_¶Ù‹r_com_dù


1183 
row
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_ROW
]

1184 
cŞ
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_COL
]

1185 
lše_d©a
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_VAL
]

1186 
img_úŒ
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_IMG_CNTR
]

1187 
is_lše
 = 
couÁ”_to_¶Ù‹r_com_dù
[ 
CNTR2PLOT_IS_LINE
 ]

1188 
is_pošt
 = 
couÁ”_to_¶Ù‹r_com_dù
[ 
CNTR2PLOT_IS_POINT
 ]

1189 #£lf.
cur_image_idx
 = 
_dù
['img_idx']

1191 if(
£lf
.
	`g‘_cur_sÿn_ty³
(è=ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
):

1192 #if(
nÙ
 
£lf
.
image_¡¬‹d
 
	`ªd
 (
cŞ
 == 0)):

1193 #if(
nÙ
 
£lf
.
executšgSÿn
.
image_¡¬‹d
 
	`ªd
 (
cŞ
 == 0)):

1194 if(
is_pošt
):

1195 if(
nÙ
 
£lf
.
executšgSÿn
.
image_¡¬‹d
 
	`ªd
 (
cŞ
 =ğ0èªd (
row
 == 0)):

1196 
£lf
.
	`Ú_image_¡¬t
()

1197 if(
is_lše
):

1198 if(
nÙ
 
£lf
.
executšgSÿn
.
image_¡¬‹d
 
	`ªd
 (
cŞ
 == 0)):

1199 
£lf
.
	`Ú_image_¡¬t
()

1202 if(
cŞ
 > 0):

1203 #£lf.
image_¡¬‹d
 = 
F®£


1204 
£lf
.
executšgSÿn
.
image_¡¬‹d
 = 
F®£


1206 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`addV”tiÿlLše
(
cŞ
, 
lše_d©a
, 
True
)

1208 #if(
nÙ
 
£lf
.
image_¡¬‹d
 
	`ªd
 (
row
 == 0)):

1209 #if(
nÙ
 
£lf
.
executšgSÿn
.
image_¡¬‹d
 
	`ªd
 (
row
 == 0)):

1210 if(
is_pošt
):

1211 if(
nÙ
 
£lf
.
executšgSÿn
.
image_¡¬‹d
 
	`ªd
 (
cŞ
 =ğ0èªd (
row
 == 0)):

1212 
£lf
.
	`Ú_image_¡¬t
()

1214 if(
is_lše
):

1215 if(
nÙ
 
£lf
.
executšgSÿn
.
image_¡¬‹d
 
	`ªd
 (
row
 == 0)):

1216 
£lf
.
	`Ú_image_¡¬t
()

1219 if(
row
 > 0):

1220 #£lf.
image_¡¬‹d
 = 
F®£


1221 
£lf
.
executšgSÿn
.
image_¡¬‹d
 = 
F®£


1223 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`addLše
(0, 
row
, 
lše_d©a
, 
True
)

1227 #deà
	`add_pošt_to_¶Ù
(
£lf
, 
row
, 
l
):

1228 
def
 
	$add_pošt_to_¶Ù
(
£lf
, 
couÁ”_to_¶Ù‹r_com_dù
):

1230 
	$add_pošt_to_¶Ù
(): 
desütiÚ


1231 
CNTR2PLOT_TYPE_ID
 = 'ty³_id' #tØ
be
 
u£d
 
to
 
šdiÿ‹
 
wh©
 
kšd
 
of
 
couÁ”
/
sÿn
 
is
 
£ndšg
 
this
 
šfo


1232 
CNTR2PLOT_ROW
 = 'row' #¨
y
 
pos™iÚ


1233 
CNTR2PLOT_COL
 = 'cŞ' #ª 
x
 
pos™iÚ


1234 
CNTR2PLOT_VAL
 = 'v®' #th
pošt
 
Ü
 
¬¿y
 
of
 
d©a


1235 
CNTR2PLOT_IMG_CNTR
 = 'img_úŒ' #cu¼’ˆ
image
 
couÁ”


1236 
CNTR2PLOT_EV_CNTR
 = 'ev_idx' #cu¼’ˆ
’”gy
 
couÁ”


1237 
CNTR2PLOT_SP_ID
 = '¥_id' #¥©ŸÈ
id
 
this
 
d©a
 
b–Úgs
 
to


1238 
CNTR2PLOT_IS_POINT
 = 'is_pxp' #d©¨
is
 
äom
 
a
 
pošt
 
by
…ošˆ
sÿn


1239 
CNTR2PLOT_IS_LINE
 = 'is_lxl' #d©¨
isäom
 
a
 
lše
 
by
†š
sÿn


1241 :
·¿m
 
row
:„ow 
desütiÚ


1242 :
ty³
 
row
:„owype

1244 :
·¿m
 
l
:¶ 
desütiÚ


1245 :
ty³
 
l
:plype

1247 :
»tuºs
: 
NÚe


1250 
N“d
 
a
 
æag
 
to
 
mÚ™Ü
 
wh’
Ø
¡¬t
‡ 
Ãw
 
image


1253 #´šˆ
couÁ”_to_¶Ù‹r_com_dù


1254 
row
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_ROW
]

1255 
cŞ
 = 
pošt
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_COL
]

1256 
v®
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_VAL
]

1257 
img_úŒ
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_IMG_CNTR
]

1258 
ev_úŒ
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_EV_CNTR
]

1260 if(
£lf
.
	`g‘_cur_sÿn_ty³
(è=ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
):

1261 if(
nÙ
 
£lf
.
executšgSÿn
.
image_¡¬‹d
 
	`ªd
 (
ev_úŒ
 =ğ0èªd ((
cŞ
 =ğ0èªd (
row
 == 0))):

1262 
£lf
.
	`Ú_image_¡¬t
()

1264 if(
cŞ
 > 0):

1265 
£lf
.
executšgSÿn
.
image_¡¬‹d
 = 
F®£


1267 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`addPošt
(
row
, 
pošt
, 
v®
, 
True
)

1270 if(
nÙ
 
£lf
.
executšgSÿn
.
image_¡¬‹d
 
	`ªd
 (
row
 == 0)):

1271 
£lf
.
	`Ú_image_¡¬t
()

1273 #´šˆ'add_pošt_to_¶Ù:„ow=%d,…ošt=%d, v®=%d' % (
row
, 
pošt
, 
v®
)

1274 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`addPošt
(
row
, 
pošt
, 
v®
, 
True
)

1276 #deà
	`add_pošt_to_¥eù¿
(
£lf
, 
row
, 
l
):

1277 
def
 
	$add_pošt_to_¥eù¿
(
£lf
, 
couÁ”_to_¶Ù‹r_com_dù
):

1279 
	$add_pošt_to_¥eù¿
():

1280 
CNTR2PLOT_TYPE_ID
 = 'ty³_id' #tØ
be
 
u£d
 
to
 
šdiÿ‹
 
wh©
 
kšd
 
of
 
couÁ”
/
sÿn
 
is
 
£ndšg
 
this
 
šfo


1281 
CNTR2PLOT_ROW
 = 'row' #¨
y
 
pos™iÚ


1282 
CNTR2PLOT_COL
 = 'cŞ' #ª 
x
 
pos™iÚ


1283 
CNTR2PLOT_VAL
 = 'v®' #th
pošt
 
Ü
 
¬¿y
 
of
 
d©a


1284 
CNTR2PLOT_IMG_CNTR
 = 'img_úŒ' #cu¼’ˆ
image
 
couÁ”


1285 
CNTR2PLOT_EV_CNTR
 = 'ev_idx' #cu¼’ˆ
’”gy
 
couÁ”


1286 
CNTR2PLOT_SP_ID
 = '¥_id' #¥©ŸÈ
id
 
this
 
d©a
 
b–Úgs
 
to


1287 
CNTR2PLOT_IS_POINT
 = 'is_pxp' #d©¨
is
 
äom
 
a
 
pošt
 
by
…ošˆ
sÿn


1288 
CNTR2PLOT_IS_LINE
 = 'is_lxl' #d©¨
isäom
 
a
 
lše
 
by
†š
sÿn


1290 :
·¿m
 
row
:„ow 
desütiÚ


1291 :
ty³
 
row
:„owype

1293 :
·¿m
 
l
:¶ 
desütiÚ


1294 :
ty³
 
l
:plype

1296 :
»tuºs
: 
NÚe


1299 #_logg”.
	`debug
('add_point_to_spectra: called with„ow=%d,pl=')

1300 
¥_id
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_SP_ID
]

1301 
row
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_ROW
]

1302 
pošt
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_COL
]

1303 
v®
 = 
couÁ”_to_¶Ù‹r_com_dù
[
CNTR2PLOT_VAL
]

1306 #´šˆ'add_pošt_to_¥eù¿: sp_id=%d„ow=%d,…ošt=%d, v®=%d' % (
¥_id
, 
row
, 
pošt
, 
v®
)

1307 
£lf
.
¥eù¿Widg‘
.
	`addXYPošt
('¥_id_%d'%
¥_id
, 
pošt
, 
v®
, 
upd©e
=
True
)

1309 
def
 
	$»£t_image_¶Ù
(
£lf
):

1310 
£lf
.
image_¡¬‹d
 =ğ
F®£


1311 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`d–ImagePlÙI‹ms
()

1312 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`d–Sh­ePlÙI‹ms
()

1313 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_auto_cÚŒa¡
(
True
)

1315 
def
 
	`assign_d©afe_Çmes_to_¥_db
(
£lf
, 
¥_db
, 
d
, 
image_idx
=0):

1316 ''' d key ['
thumb_Çme
', '
´efix
', '
d©a_ext
', '
¡ack_dœ
', '
d©a_Çme
', '
thumb_ext
']

1318 
ado_obj
 = 
	`dù_g‘
(
¥_db
, 
SPDB_ACTIVE_DATA_OBJECT
)

1319 
	`dù_put
(
ado_obj
, 
ADO_CFG_DATA_DIR
, 
d
['data_dir'])

1320 
	`dù_put
(
ado_obj
, 
ADO_CFG_DATA_FILE_NAME
, 
d
['data_name'])

1321 
	`dù_put
(
ado_obj
, 
ADO_CFG_DATA_THUMB_NAME
, 
d
['thumb_name'])

1322 
	`dù_put
(
ado_obj
, 
ADO_CFG_PREFIX
, 
d
['prefix'])

1323 
	`dù_put
(
ado_obj
, 
ADO_CFG_DATA_EXT
, 
d
['data_ext'])

1324 
	`dù_put
(
ado_obj
, 
ADO_CFG_STACK_DIR
, 
d
['stack_dir'])

1325 
	`dù_put
(
ado_obj
, 
ADO_CFG_THUMB_EXT
, 
d
['thumb_ext'])

1326 
	`dù_put
(
ado_obj
, 
ADO_CFG_DATA_IMG_IDX
, 
image_idx
)

1329 
def
 
	$‹¡_ty³
(
£lf
, 
v®
, 
typ
):

1330 if((
v®
 
is
 
NÚe
è
	`Ü
 (
	`ty³
(v®è!ğ
typ
)):

1331 (
F®£
)

1333 (
True
)

1335 
def
 
	$‹¡_assign_d©afe_Çmes_to_¥_db
(
£lf
, 
wdg_com
):

1337 
to
  
Ú
Ø
the
 
sÿn
 
Ïss


1338 
d
 
keys
 ['thumb_name', 'prefix', 'data_ext', 'stack_dir', 'data_name', 'thumb_ext']

1340 
_l¡
 = []

1341 
¥_rois
 = 
	`dù_g‘
(
wdg_com
, 
WDGCOM_SPATIAL_ROIS
)

1342 
¥_ids
 = 
	`sÜ‹d
(
¥_rois
.
	`keys
())

1343 
¥_id
 
š
 
¥_ids
:

1344 
¥_db
 = 
¥_rois
[
¥_id
]

1345 
ado_obj
 = 
	`dù_g‘
(
¥_db
, 
SPDB_ACTIVE_DATA_OBJECT
)

1346 
_l¡
.
	`­³nd
(
£lf
.
	`‹¡_ty³
(
	`dù_g‘
(
ado_obj
, 
ADO_CFG_DATA_DIR
), 
¡r
))

1347 
_l¡
.
	`­³nd
(
£lf
.
	`‹¡_ty³
(
	`dù_g‘
(
ado_obj
, 
ADO_CFG_DATA_FILE_NAME
), 
¡r
))

1348 
_l¡
.
	`­³nd
(
£lf
.
	`‹¡_ty³
(
	`dù_g‘
(
ado_obj
, 
ADO_CFG_DATA_THUMB_NAME
), 
¡r
))

1349 
_l¡
.
	`­³nd
(
£lf
.
	`‹¡_ty³
(
	`dù_g‘
(
ado_obj
, 
ADO_CFG_PREFIX
), 
¡r
))

1350 
_l¡
.
	`­³nd
(
£lf
.
	`‹¡_ty³
(
	`dù_g‘
(
ado_obj
, 
ADO_CFG_DATA_EXT
), 
¡r
))

1351 
_l¡
.
	`­³nd
(
£lf
.
	`‹¡_ty³
(
	`dù_g‘
(
ado_obj
, 
ADO_CFG_STACK_DIR
), 
¡r
))

1352 
_l¡
.
	`­³nd
(
£lf
.
	`‹¡_ty³
(
	`dù_g‘
(
ado_obj
, 
ADO_CFG_THUMB_EXT
), 
¡r
))

1353 
_l¡
.
	`­³nd
(
£lf
.
	`‹¡_ty³
(
	`dù_g‘
(
ado_obj
, 
ADO_CFG_DATA_IMG_IDX
), ))

1355 
v
 
š
 
_l¡
:

1356 ifĞ
nÙ
 
v
):

1357 (
F®£
)

1359 (
True
)

1362 
def
 
	$d‘”mše_num_thumbÇ_images_»quœed
(
£lf
, 
wdg_com
):

1364 
	$d‘”mše_num_thumbÇ_images_»quœed
(): 
ke
 
a
 
li¡
 
of
 
¥©Ÿl
 
»giÚs
 
ªd
 
check
 
the
 
sÿn
 
ty³
‡nd 
»Œun


1365 
the
 
numb”
 
of
 
images
 
th©
 
wl
 
be
 
Ãeded


1367 :
·¿m
 
¥_rois
: sp_roi 
desütiÚ


1368 :
ty³
 
¥_rois
: sp_roisype

1370 :
»tuºs
: 
š‹g”
 
numb”
 
of
 
images
 
»quœed
 
the
 
sÿns


1372 
sšgË_image_sÿns
 = [
sÿn_ty³s
.
DETECTOR_IMAGE
, sÿn_ty³s.
OSA_FOCUS
, sÿn_ty³s.
OSA_IMAGE
, sÿn_ty³s.
SAMPLE_FOCUS
, \

1373 
sÿn_ty³s
.
SAMPLE_IMAGE
, sÿn_ty³s.
GENERIC_SCAN
, sÿn_ty³s.
SAMPLE_LINE_SPECTRUM
, sÿn_ty³s.
SAMPLE_POINT_SPECTRUM
]

1374 
¥_rois
 = 
	`dù_g‘
(
wdg_com
, 
WDGCOM_SPATIAL_ROIS
)

1375 
¥_ids
 = 
	`sÜ‹d
(
¥_rois
.
	`keys
())

1376 
n_imgs
 = []

1377 
_imgs
 = 0

1378 
¥_id
 
š
 
¥_ids
:

1379 
¥_db
 = 
¥_rois
[
¥_id
]

1380 
sÿn_ty³
 = 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
)

1381 if(
sÿn_ty³
 
š
 
sšgË_image_sÿns
):

1382 #n_imgs.
	`­³nd
(1)

1383 
_imgs
 = 1

1385 #n_imgs.
	`­³nd
(
£lf
.
	`g‘_num_ev_pošts
(
¥_db
[
SPDB_EV_ROIS
]))

1386 
_imgs
 = 
£lf
.
	`g‘_num_ev_pošts
(
¥_db
[
SPDB_EV_ROIS
])

1387 #n_img ğ
¥_db
[
SPDB_EV_NPOINTS
] * sp_db[
SPDB_POL_NPOINTS
]

1388 
n_imgs
.
	`­³nd
(
_imgs
)

1389  
n_imgs


1391 
def
 
	$g‘_num_ev_pošts
(
£lf
, 
ev_rois
):

1393 
make
 
su»
 
to
  
ª
 

1395 
n_ev
 = 0

1396 
_pŞ
 = 0

1397 
_ev
 = 0

1399 
ev_roi
 
š
 
ev_rois
:

1400 
_ev
 = 
ev_roi
['NPOINTS']

1401 
_pŞ
 = 
	`Ën
(
ev_roi
['EPU_POL_PNTS'])

1402 
n_ev
 +ğ
_ev
 * 
_pŞ


1403 ((
n_ev
))

1405 
def
 
	$­¶y_u£r_£‰šgs_to_sÿn
(
£lf
, 
sÿn
):

1407 
­¶y_u£r_£‰šgs_to_sÿn
: 
qu”y
 
the
 
­pCÚfig
 
£‰šgs
 
fe
 
ªd£t
 
ªy
 
æags
 
of
h
executšg
 
sÿn
 
h”e


1409 :
·¿m
 
sÿn
: 
This
 
is
 
the
 
cu¼’y
 
cÚfigu»d
 
executšg
 scan

1410 :
ty³
 
sÿn
: 
this
 
is
 
a
 sÿÀ
¶ugš
 
th©
 
has
 
SÿnP¬amWig‘
 
as
 
™s
 
·»Á
 
şass


1413 
­pCÚfig
.
	`upd©e
()

1414 #£ˆ
the
 
§ve
 
®l
 
d©a
 
æag


1415 
v®
 = 
­pCÚfig
.
	`g‘_boŞ_v®ue
('DATA', 'save_all_data')

1416 if(
v®
 
is
 
nÙ
 
NÚe
):

1417 
sÿn
.
	`£t_§ve_®l_d©a
(
v®
)

1419 
v®
 = 
­pCÚfig
.
	`g‘_boŞ_v®ue
('DATA', 'save_jpg_thumbnails')

1420 if(
v®
 
is
 
nÙ
 
NÚe
):

1421 
sÿn
.
	`£t_§ve_jpgs
(
v®
)

1424 #£ˆ
Ùh”s
 
b–ow


1428 
def
 
	$Ú_¡¬t_ssÿn
(
£lf
):

1430 
	$Ú_¡¬t_ssÿn
(): 
desütiÚ


1432 :
»tuºs
: 
NÚe


1434 #mak
su»
 
the
 
d©a
 
dœ
 
is
 
up
 
to
 
d©e
 
š
 th24 
hour
 
time
 
has
 
rŞËd
 
ov”


1435 
£lf
.
aùive_u£r
.
	`ü—‹_d©a_dœ
()

1437 #k“°
the
 
sÿn
 
¶ugš
 
äom
 
fœšg
 
ªy
 
sigÇls
 
th©
 
would
 
ÿu£
 
Ùh”
 
widg‘s
 
to
 
»¥Úd


1438 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`blockSigÇls
(
True
)

1439 
£lf
.
cur_wdg_com
 = s–f.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`g‘_roi
()

1440 if(
£lf
.
cur_wdg_com
 
is
 
NÚe
):

1441 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`blockSigÇls
(
F®£
)

1444 #£ˆ
maš
 
gui
 
widg‘s
 
up
 
ruÂšg
 
a
 
sÿn


1445 
£lf
.
	`£t_bu‰Ús_fÜ_sÿÂšg
()

1447 #š™ 
some
 
v¬ŸbËs


1448 
£lf
.
d©a
 = []

1449 
MAIN_OBJ
.
	`ş—r_sÿns
()

1450 
£lf
.
	`»£t_image_¶Ù
()

1451 
£lf
.
cur_ev_idx
 = 0

1452 
Ãw_¡ack_dœ
 = 
F®£


1454 #ok 
®low
 
the
 
sÿn
 
¶ugš
 
to
 
fœe
 
sigÇls
 
agaš


1455 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`blockSigÇls
(
F®£
)

1457 #assigÀ
the£
 
v®ues
 
th©
 
¬e
 
u£d
 
to
 
decide
 
which
 
GUI
 
sigÇls
Ø
cÚÃù
 
ªd
 
discÚÃù


1458 
£lf
.
	`£t_cur_sÿn_ty³
(£lf.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
ty³
)

1459 
£lf
.
	`£t_cur_sÿn_sub_ty³
(£lf.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
sub_ty³
)

1461 
sÿn_ty³
 = 
£lf
.
	`g‘_cur_sÿn_ty³
()

1462 
sÿn_sub_ty³
 = 
£lf
.
	`g‘_cur_sÿn_sub_ty³
()

1464 #g‘ 
ª
 
š¡ªû
 
of
 
the
 
aùu®
 
sÿn
 
şass


1465 
ssÿn
 = 
£lf
.
sÿn_tbox_widg‘s
[£lf.
sÿn_·Ãl_idx
].
	`g‘_ssÿn_š¡ªû
()

1466 
ssÿn
.
	`£t_aùive_u£r
(
£lf
.
aùive_u£r
)

1467 
ssÿn
.
sÿn_ty³
 = scan_type

1469 
£lf
.
	`­¶y_u£r_£‰šgs_to_sÿn
(
ssÿn
)

1470 
£lf
.
executšgSÿn
 = 
ssÿn


1472 #g¿b 
some
 
šfÜm©iÚ
 
u£d
 
by
 
®l
 
sÿns
 
b–ow


1473 
¥_rois
 = 
	`dù_g‘
(
£lf
.
cur_wdg_com
, 
WDGCOM_SPATIAL_ROIS
)

1474 
¥_ids
 = 
	`sÜ‹d
(
¥_rois
.
	`keys
())

1475 
£lf
.
cur_¥_rois
 = 
cİy
.
	`cİy
(
¥_rois
)

1477 #¨
li¡
 
of
 
basic
 
sÿns
 
th©
 
u£
 
the
 
§me
 
cÚfigu¿tiÚ
 
block
 
b–ow


1478 
_sim¶e_ty³s
 = [
sÿn_ty³s
.
DETECTOR_IMAGE
, sÿn_ty³s.
OSA_IMAGE
, sÿn_ty³s.
OSA_FOCUS
, sÿn_ty³s.
GENERIC_SCAN
, sÿn_ty³s.
SAMPLE_FOCUS
]

1479 
_muÉi¥©Ÿl_ty³s
 = [
sÿn_ty³s
.
SAMPLE_IMAGE
, sÿn_ty³s.
SAMPLE_LINE_SPECTRUM
, sÿn_ty³s.
SAMPLE_POINT_SPECTRUM
]

1481 if(
sÿn_ty³
 
š
 
_sim¶e_ty³s
):

1482 
¥_id
 = 
¥_ids
[0]

1483 
¥_db
 = 
¥_rois
[
¥_id
]

1484 
d
 = 
	`ma¡”_g‘_£q_Çmes
(
£lf
.
aùive_u£r
.
	`g‘_d©a_dœ
(), 
´efix_ch¬
='C', 
thumb_ext
='jpg', 
d©_ext
='hdf5', 
¡ack_dœ
=
F®£
, 
num_desœed_d©afes
=1)

1485 
£lf
.
	`assign_d©afe_Çmes_to_¥_db
(
¥_db
, 
d
[0])

1486 
ssÿn
.
	`£t_¥©Ÿl_id
(
¥_id
)

1487 
ssÿn
.
	`£t_d©afe_Çmes_diù
(
d
)

1488 
ssÿn
.
	`£t_¥©Ÿl_id_li¡
(
¥_ids
)

1489 
ssÿn
.
	`cÚfigu»
(
£lf
.
cur_wdg_com
, 
¥_id
=¥_id, 
lše
=
F®£
)

1490 if(
sÿn_ty³
 =ğ
sÿn_ty³s
.
GENERIC_SCAN
):

1491 
£lf
.
	`š™_pošt_¥eù¿
(
num_curves
=1)

1493 
	$–if
(
sÿn_ty³
 
š
 
_muÉi¥©Ÿl_ty³s
):

1494 
lše
=
True


1495 
num_images_l¡
 = 
£lf
.
	`d‘”mše_num_thumbÇ_images_»quœed
(£lf.
cur_wdg_com
)

1496 
d
 = 
	`ma¡”_g‘_£q_Çmes
(
£lf
.
aùive_u£r
.
	`g‘_d©a_dœ
(), 
´efix_ch¬
='C', 
thumb_ext
='jpg', 
d©_ext
='hdf5', 
¡ack_dœ
=
F®£
, 
num_desœed_d©afes
=
	`Ën
(
¥_ids
))

1497 
idx
 = 0

1498 
¥_id
 
š
 
¥_ids
:

1499 
¥_db
 = 
¥_rois
[
¥_id
]

1500 if(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_POINT_SPECTRUM
):

1501 #fÜ 
pošt
 
¥ec
 
®l
 
¥©Ÿl
 
»giÚs
 
u£
 
§me
 
d©afe
 
but
 
difã»Á
 
’Œys


1502 
£lf
.
	`assign_d©afe_Çmes_to_¥_db
(
¥_db
, 
d
[0], 
image_idx
=0)

1504 
£lf
.
	`assign_d©afe_Çmes_to_¥_db
(
¥_db
, 
d
[
idx
], 
image_idx
=idx)

1505 
idx
 += 1

1507 if(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_POINT_SPECTRUM
):

1508 #h”
I
 
Ãed
 
to
 
š™
 
™
 
w™h
 
the
 
numb”
 
of
 
	`¥_ids
 (
¥©Ÿl
 
pošts
)

1509 
£lf
.
	`š™_pošt_¥eù¿
(
num_curves
=
	`Ën
(
¥_ids
))

1510 
lše
 = 
F®£


1512 
£lf
.
	`£t_cur_sÿn_sub_ty³
(
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_SUBTYPE
))

1513 #ssÿn.
	`£t_d©afe_Çmes_diù
(
d
)

1514 
ssÿn
.
	`£t_¥©Ÿl_id_li¡
(
¥_ids
)

1515 
¥_id
 = 
ssÿn
.
	`g‘_Ãxt_¥©Ÿl_id
()

1516 
ssÿn
.
	`cÚfigu»
(
£lf
.
cur_wdg_com
, 
¥_id
=¥_id , 
ev_idx
=0, 
lše
=line)

1518 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE_STACK
):

1519 #u£ 
fœ¡
 
¥_DB
 
to
 
d‘”mše
 
pošt
 
by
…ošˆ
Ü
 
lše
 
unidœ


1520 
¥_db
 = 
¥_rois
[
¥_ids
[0]]

1521 #num_image ğ(
¥_db
[
SPDB_EV_NPOINTS
] * sp_db[
SPDB_POL_NPOINTS
] * 
	`Ën
(
¥_ids
))

1522 
num_images
 = 
£lf
.
	`d‘”mše_num_thumbÇ_images_»quœed
(£lf.
cur_wdg_com
)[0]

1523 
d
 = 
	`ma¡”_g‘_£q_Çmes
(
£lf
.
aùive_u£r
.
	`g‘_d©a_dœ
(), 
´efix_ch¬
='C', 
thumb_ext
='jpg', 
d©_ext
='hdf5', 
num_desœed_d©afes
=
num_images
, 
Ãw_¡ack_dœ
=
True
)

1524 if(
	`Ën
(
¥_ids
) > 1):

1525 #—ch 
¥©Ÿl
 
roi
 
Ãeds
 
a
 
f’ame
 
diù


1526 
i
 
š
 
	$¿nge
(
num_images
):

1527 
£lf
.
	`assign_d©afe_Çmes_to_¥_db
(
¥_rois
[
¥_ids
[
i
]], 
d
[i], 
image_idx
=
idx
)

1529 
£lf
.
	`assign_d©afe_Çmes_to_¥_db
(
¥_rois
[
¥_ids
[0]], 
d
[0])

1531 
£lf
.
	`£t_cur_sÿn_sub_ty³
(
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_SUBTYPE
))

1532 
ssÿn
.
	`£t_d©afe_Çmes_diù
(
d
)

1533 
ssÿn
.
	`£t_¥©Ÿl_id_li¡
(
¥_ids
)

1534 
¥_id
 = 
ssÿn
.
	`g‘_Ãxt_¥©Ÿl_id
()

1535 
ssÿn
.
	`cÚfigu»
(
£lf
.
cur_wdg_com
, 
¥_id
=¥_id , 
ev_idx
=0, 
lše
=
True
)

1539 
_logg”
.
	`”rÜ
('¡¬t_sÿn: unsuµÜ‹d sÿÀty³ [%d]' % 
sÿn_ty³
)

1540 
£lf
.
	`£t_bu‰Ús_fÜ_¡¬tšg
()

1543 
MAIN_OBJ
.
	`£t
('SCAN.CFG.WDG_COM', 
£lf
.
cur_wdg_com
)

1545 #mak
su»
 
®l
 
sÿns
 
have
 
£t
 
the
 
d©a
 
fe
 
Çmes
 
to
 
theœ
 
»¥eùive
 
aùive
 d©¨
objeùs
 
befÜe
 
®lowšg
 
sÿn


1546 #tØ
¡¬t


1547 if(
nÙ
 
£lf
.
	$‹¡_assign_d©afe_Çmes_to_¥_db
(
£lf
.
cur_wdg_com
)):

1548 
_logg”
.
	`”rÜ
('start_scan: incorrectly configured scan: data file‚ames‚ot‡ssignedo‡ctive data object')

1549 
£lf
.
	`£t_bu‰Ús_fÜ_¡¬tšg
()

1552 #ok 
®l
 
good
 
Ëts
 
run
 
the
 
sÿn


1553 
£lf
.
sÿn_´og»ss_bË
.
	`£t_queue_fe_li¡
(
	`g‘_thumb_fe_Çme_li¡
(
d
))

1554 
£lf
.
sÿn_´og»ss_bË
.
	`lßd_wdg_com
(£lf.
cur_wdg_com
)

1555 
£lf
.
	`cÚÃù_executšgSÿn_sigÇls
()

1556 
£lf
.
executšgSÿn
.
image_¡¬‹d
 = 
F®£


1557 
£lf
.
executšgSÿn
.
	`»£t_cÚ£cutive_sÿn_idx
()

1558 
£lf
.
executšgSÿn
.
	`¡¬t
()

1559 
£lf
.
¡¬t_time
 = 
time
.
	`time
()

1561 
def
 
	`š™_pošt_¥eù¿
(
£lf
, 
¥_id
=-1, 
num_curves
=1):

1563 
	$š™_pošt_¥eù¿
(): 
desütiÚ


1565 :
·¿m
 
¥_id
=-1: sp_id=-1 
desütiÚ


1566 :
ty³
 
¥_id
=-1: sp_id=-1ype

1568 :
»tuºs
: 
NÚe


1571 
£lf
.
¥eù¿Widg‘
.
	`ş—r_¶Ù
()

1573 
¥_ids
 = 
£lf
.
cur_¥_rois
.
	`keys
()

1575 
¥_id
 
š
 
¥_ids
:

1576 #£lf.
¥eù¿Widg‘
.
	`ü—‹_curve
('pošt_¥eù¿_%d' % 
i
,
curve_¡yË
='Lines')

1577 
şr
 = 
	`g‘_Ãxt_cŞÜ
(
u£_dæt
=
F®£
)

1578 
¡yË
 = 
	`g‘_basic_lše_¡yË
(
şr
)

1579 
£lf
.
¥eù¿Widg‘
.
	`ü—‹_curve
('¥_id_%d' % 
¥_id
, 
curve_¡yË
=
¡yË
)

1581 
def
 
	$cÚÃù_executšgSÿn_sigÇls
(
£lf
):

1583 
	$cÚÃù_executšgSÿn_sigÇls
(): 
desütiÚ


1585 :
»tuºs
: 
NÚe


1587 
sÿn_ty³
 = 
£lf
.
	`g‘_cur_sÿn_ty³
()

1588 
sÿn_sub_ty³
 = 
£lf
.
	`g‘_cur_sÿn_sub_ty³
()

1589 #_logg”.
	`šfo
('GUI: connect_executingScan_signals')

1590 if((
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
LINE_UNIDIR
è
Ü
 \

1591 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE_STACK
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
LINE_UNIDIR
è
Ü
 \

1592 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
LINE_UNIDIR
è
Ü
 \

1593 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_FOCUS
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
LINE_UNIDIR
)):

1594 
£lf
.
executšgSÿn
.
sigs
.
chªged
.
	`cÚÃù
(£lf.
add_lše_to_¶Ù
)

1596 if(
	$nÙ
 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
)):

1597 #dÚˆ
cÚÃù
 
this
 
lše_¥ec
 
sÿns
 
beÿu£
 
the
 
d©a
 
Ëv–
 
is
 
’”gy
 
which
 
would
 
ÿu£
 
a


1598 #Ãw 
image
 
—ch
 
’”gy
 
lše
 
which
 
is
 
nÙ
 
wh©
 
we
 
wªt


1599 
£lf
.
executšgSÿn
.
d©a_¡¬t
.
	`cÚÃù
(£lf.
Ú_image_¡¬t
)

1601 
	`–if
(((
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
POINT_BY_POINT
)è
Ü
 \

1602 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE_STACK
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
POINT_BY_POINT
è
Ü
 \

1603 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
DETECTOR_IMAGE
è
Ü
 \

1604 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
OSA_IMAGE
è
Ü
 \

1605 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
OSA_FOCUS
è
Ü
 \

1606 ((
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
POINT_BY_POINT
)è
Ü
 \

1607 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_FOCUS
è
Ü
 \

1608 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
ZP_IMAGE_SCAN
) ):

1609 
£lf
.
executšgSÿn
.
sigs
.
chªged
.
	`cÚÃù
(£lf.
add_pošt_to_¶Ù
)

1611 if(
	$nÙ
 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
)):

1612 #dÚˆ
cÚÃù
 
this
 
lše_¥ec
 
sÿns
 
beÿu£
 
the
 
d©a
 
Ëv–
 
is
 
’”gy
 
which
 
would
 
ÿu£
 
a


1613 #Ãw 
image
 
—ch
 
’”gy
 
lše
 
which
 
is
 
nÙ
 
wh©
 
we
 
wªt


1614 
£lf
.
executšgSÿn
.
d©a_¡¬t
.
	`cÚÃù
(£lf.
Ú_image_¡¬t
)

1617 
	`–if
((
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_POINT_SPECTRUM
è
Ü
 \

1618 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
GENERIC_SCAN
)):

1619 
£lf
.
executšgSÿn
.
sigs
.
chªged
.
	`cÚÃù
(£lf.
add_pošt_to_¥eù¿
)

1620 #£lf.
executšgSÿn
.
Ãw_¥©Ÿl_¡¬t
.
	`cÚÃù
(
£lf
.
š™_pošt_¥eù¿
)

1623 
_logg”
.
	`”rÜ
('cÚÃù_executšgSÿn_sigÇls:ƒxecutšgSÿÀty³ [%d]‚Ù suµÜ‹d', 
sÿn_ty³
)

1625 
£lf
.
executšgSÿn
.
sigs
.
¡©us
.
	`cÚÃù
(£lf.
Ú_sÿn_¡©us
)

1626 #£lf.
executšgSÿn
.
sigs
.
´og»ss
.
	`cÚÃù
(
£lf
.
Ú_sÿn_´og»ss
)

1627 
£lf
.
executšgSÿn
.
tİ_Ëv–_´og»ss
.
	`cÚÃù
(£lf.
Ú_tÙ®_sÿn_´og»ss
)

1628 
£lf
.
executšgSÿn
.
low_Ëv–_´og»ss
.
	`cÚÃù
(£lf.
Ú_sÿn_´og»ss
)

1629 
£lf
.
executšgSÿn
.
sigs_discÚÃùed
.
	`cÚÃù
(£lf.
Ú_executšg_sÿn_sigs_discÚ
)

1630 
£lf
.
executšgSÿn
.
sigs
.
abÜ‹d
.
	`cÚÃù
(£lf.
Ú_sÿn_dÚe
)

1631 
£lf
.
executšgSÿn
.
®l_dÚe
.
	`cÚÃù
(£lf.
Ú_sÿn_dÚe
)

1633 
£lf
.
executšgSÿn
.
§všg_d©a
.
	`cÚÃù
(£lf.
Ú_§všg_d©a
)

1635 #_logg”.
	`debug
('executingScan signals connected')

1637 
def
 
	$discÚÃù_executšgSÿn_sigÇls
(
£lf
):

1639 
	$discÚÃù_executšgSÿn_sigÇls
(): 
desütiÚ


1641 :
»tuºs
: 
NÚe


1643 
sÿn_ty³
 = 
£lf
.
	`g‘_cur_sÿn_ty³
()

1644 
sÿn_sub_ty³
 = 
£lf
.
	`g‘_cur_sÿn_sub_ty³
()

1646 #_logg”.
	`debug
('disconnect_executingScan_signals: TOP')

1647 if((
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
LINE_UNIDIR
è
Ü
 \

1648 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE_STACK
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
LINE_UNIDIR
è
Ü
 \

1649 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
LINE_UNIDIR
è
Ü
 \

1650 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_FOCUS
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
LINE_UNIDIR
)):

1651 
£lf
.
executšgSÿn
.
sigs
.
chªged
.
	`discÚÃù
(£lf.
add_lše_to_¶Ù
)

1653 if(
	$nÙ
 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
)):

1654 
£lf
.
executšgSÿn
.
d©a_¡¬t
.
	`discÚÃù
(£lf.
Ú_image_¡¬t
)

1656 
	`–if
(((
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
POINT_BY_POINT
)è
Ü
 \

1657 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE_STACK
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
POINT_BY_POINT
è
Ü
 \

1658 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
DETECTOR_IMAGE
è
Ü
 \

1659 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
OSA_IMAGE
è
Ü
 \

1660 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
OSA_FOCUS
è
Ü
 \

1661 ((
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
è
	$ªd
 (
sÿn_sub_ty³
 =ğ
sÿn_sub_ty³s
.
POINT_BY_POINT
)è
Ü
 \

1662 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_FOCUS
è
Ü
 \

1663 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
ZP_IMAGE_SCAN
) ):

1664 
£lf
.
executšgSÿn
.
sigs
.
chªged
.
	`discÚÃù
(£lf.
add_pošt_to_¶Ù
)

1666 if(
	$nÙ
 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
)):

1667 
£lf
.
executšgSÿn
.
d©a_¡¬t
.
	`discÚÃù
(£lf.
Ú_image_¡¬t
)

1669 
	`–if
((
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_POINT_SPECTRUM
è
Ü
 \

1670 (
sÿn_ty³
 =ğ
sÿn_ty³s
.
GENERIC_SCAN
)):

1671 
£lf
.
executšgSÿn
.
sigs
.
chªged
.
	`discÚÃù
(£lf.
add_pošt_to_¥eù¿
)

1672 #£lf.
executšgSÿn
.
Ãw_¥©Ÿl_¡¬t
.
	`discÚÃù
(
£lf
.
š™_pošt_¥eù¿
)

1675 
_logg”
.
	`”rÜ
('discÚÃù_executšgSÿn_sigÇls:ƒxecutšgSÿÀty³ [%d]‚Ù suµÜ‹d', 
sÿn_ty³
)

1677 
£lf
.
executšgSÿn
.
sigs
.
¡©us
.
	`discÚÃù
(£lf.
Ú_sÿn_¡©us
)

1678 #£lf.
executšgSÿn
.
sigs
.
´og»ss
.
	`discÚÃù
(
£lf
.
Ú_sÿn_´og»ss
)

1679 
£lf
.
executšgSÿn
.
tİ_Ëv–_´og»ss
.
	`discÚÃù
(£lf.
Ú_tÙ®_sÿn_´og»ss
)

1680 
£lf
.
executšgSÿn
.
low_Ëv–_´og»ss
.
	`discÚÃù
(£lf.
Ú_sÿn_´og»ss
)

1681 
£lf
.
executšgSÿn
.
sigs_discÚÃùed
.
	`discÚÃù
(£lf.
Ú_executšg_sÿn_sigs_discÚ
)

1682 
£lf
.
executšgSÿn
.
sigs
.
abÜ‹d
.
	`discÚÃù
(£lf.
Ú_sÿn_dÚe
)

1683 
£lf
.
executšgSÿn
.
®l_dÚe
.
	`discÚÃù
(£lf.
Ú_sÿn_dÚe
)

1685 
£lf
.
executšgSÿn
.
§všg_d©a
.
	`discÚÃù
(£lf.
Ú_§všg_d©a
)

1688 
£lf
.
_£t_sÿn_bŠs
.
	`em™
('SET_FOR_STARTING')

1689 
£lf
.
	`Ú_sÿn_¡©us
('Idle')

1691 
def
 
	$Ú_§všg_d©a
(
£lf
, 
msg
):

1692 
£lf
.
sÿnAùiÚLbl
.
	`£tText
(
msg
)

1693 
_logg”
.
	`šfo
('% ...' % 
msg
)

1695 
def
 
	$Ú_image_¡¬t
(
£lf
, 
wdg_com
=
NÚe
):

1697 
	$Ú_image_¡¬t
(): 
ÿÎed
 
wh’
 
a
 
Ãw
 
image
 
¡¬ts


1699 :
·¿m
 
wdg_com
=
NÚe
: wdg_com=NÚ
desütiÚ


1700 :
ty³
 
wdg_com
=
NÚe
: wdg_com=Noneype

1702 :
»tuºs
: 
NÚe


1704 #Ú_image_¡¬ˆ
ÿn
 
be
 
ÿÎed
 
by
 
sšg®
 
·s£d
 
äom
 
sÿn
 
w™h
 
the
 
wdg_com
 
as
h
¬g


1705 #_logg”.
	`debug
('on_image_start called')

1706 if(
wdg_com
 
is
 
NÚe
):

1707 #u£ 
cu¼’t


1708 
wdg_com
 = 
£lf
.
cur_wdg_com


1710 
¥_id
 = 
£lf
.
executšgSÿn
.
	`g‘_¥©Ÿl_id
()

1711 if(
¥_id
 
nÙ
 
š
 
wdg_com
[
WDGCOM_SPATIAL_ROIS
].
	$keys
()):

1712 
_logg”
.
	`”rÜ
('Spatial ID does‚otƒxist in widget communication dict')

1715 
¥_db
 = 
wdg_com
[
WDGCOM_SPATIAL_ROIS
][
¥_id
]

1716 
sÿn_ty³
 = 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
)

1719 if(
£lf
.
executšgSÿn
.
image_¡¬‹d
 =ğ
True
):

1720 
£lf
.
executšgSÿn
.
image_¡¬‹d
 = 
F®£


1722 if(
£lf
.
executšgSÿn
.
image_¡¬‹d
 =ğ
F®£
):

1724 
numX
 = 
	`dù_g‘
(
¥_db
, 
SPDB_XNPOINTS
)

1725 
numY
 = 
	`dù_g‘
(
¥_db
, 
SPDB_YNPOINTS
)

1726 
numZ
 = 
	`dù_g‘
(
¥_db
, 
SPDB_ZNPOINTS
)

1727 #img_·rm ğ
	`dù_g‘
(
wdg_com
, 'CURRENT.SCAN.IMAGE_PARMS')

1728 
»ù
 = 
	`dù_g‘
(
¥_db
, 
SPDB_RECT
)

1729 
numE
 = 
	`dù_g‘
(
¥_db
, 
SPDB_EV_NPOINTS
)

1731 
x_roi
 = 
¥_db
['X']

1732 
y_roi
 = 
¥_db
['Y']

1734 #_logg”.
	`šfo
('Ú_image_¡¬t:„eù = (%.2f, %.2f, %.2f, %.2f)' % (
»ù
[0],„ect[1],„ect[2],„ect[3]))

1735 #_logg”.
	`šfo
('Ú_image_¡¬t:„oi (%.2f, %.2f, %.2f, %.2f)' % (
x_roi
['START'], 
y_roi
['START'], x_roi['STOP'], y_roi['STOP']))

1736 #_logg”.
	`debug
('GUI: on_image_start')

1737 if(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_FOCUS
):

1738 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`š™D©a
(
image_ty³s
.
FOCUS
, 
numZ
 , 
numX
, {
SPDB_RECT
: 
»ù
})

1739 
£lf
.
lšeByLšeImageD©aWidg‘
.
£t_autosÿË
(
fl_¶Ù_wšdow
=
True
)

1741 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
OSA_FOCUS
):

1742 #o§ 
focus
 
sÿn
 
Úly
 
s™s
 
©
 
a
 
sšgË
 
Y
 
pos™iÚ
 
ªd
 
so
 
wl
 
be
‡ 
	`squ¬e
 (
equ®
 
to
 
num
 
x
 
pošts
)

1743 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`š™D©a
(
image_ty³s
.
OSAFOCUS
, 
numZ
 , 
numX
, {
SPDB_RECT
: 
»ù
})

1744 
£lf
.
lšeByLšeImageD©aWidg‘
.
£t_autosÿË
(
fl_¶Ù_wšdow
=
True
)

1746 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
):

1747 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`š™D©a
(
image_ty³s
.
LINE_PLOT
, 
numX
 , 
numE
, {
SPDB_RECT
: 
»ù
})

1748 
£lf
.
lšeByLšeImageD©aWidg‘
.
£t_autosÿË
(
fl_¶Ù_wšdow
=
True
)

1751 
£lf
.
lšeByLšeImageD©aWidg‘
.
š™D©a
(
image_ty³s
.
IMAGE
, 
numY
 , 
numX
, {
SPDB_RECT
: 
»ù
})

1752 
£lf
.
lšeByLšeImageD©aWidg‘
.
£t_autosÿË
(
fl_¶Ù_wšdow
=
F®£
)

1754 
£lf
.
executšgSÿn
.
image_¡¬‹d
 = 
True


1755 
£lf
.
Ú_sÿn_¡¬t
()

1759 
def
 
	$Ú_¥eù¿_¡¬t
(
£lf
):

1761 
	$Ú_¥eù¿_¡¬t
(): 
desütiÚ


1763 :
»tuºs
: 
NÚe


1765 
´št
 'on_spectra_start'

1766 
£lf
.
¥eù¿Widg‘
.
	`ş—r_¶Ù
()

1769 
def
 
	$Ú_sÿn_¡¬t
(
£lf
):

1771 
	$Ú_sÿn_¡¬t
(): 
desütiÚ


1773 :
»tuºs
: 
NÚe


1775 #£lf.
sÿn_´og»ss_bË
.
	`£t_pixm­
(0, 
sÿn_¡©us_ty³s
.
RUNNING
)

1776 
·ss


1778 
def
 
	$Ú_sÿn_dÚe
(
£lf
):

1780 
	$Ú_sÿn_dÚe
(): 
desütiÚ


1782 :
»tuºs
: 
NÚe


1784 #idx = 
£lf
.
executšgSÿn
.
	`g‘_imgidx
()

1785 #_logg”.
	`šfo
('GUI: scan completed')

1786 #£lf.
sÿn_´og»ss_bË
.
	`£t_pixm­
(
£lf
.
cur_image_idx
, 
sÿn_¡©us_ty³s
.
DONE
)

1787 
·ss


1789 
def
 
	$Ú_executšg_sÿn_sigs_discÚ
(
£lf
):

1791 
	$Ú_executšg_sÿn_sigs_discÚ
(): 
desütiÚ


1793 :
»tuºs
: 
NÚe


1795 #_logg”.
	`šfo
('GUI: on_executing_scan_sigs_discon')

1796 if(
MAIN_OBJ
.
	`deviû
(
DNM_SHUTTER
).
	$is_auto
()):

1797 
MAIN_OBJ
.
	`deviû
(
DNM_SHUTTER
).
	`şo£
()

1798 #_logg”.
	`šfo
('scan completed')

1799 #£lf.
curImgProgB¬
.
	`£tV®ue
(0.0)

1800 
£lf
.
tÙ®ProgB¬
.
	`£tV®ue
(0.0)

1802 
£lf
.
lšeByLšeImageD©aWidg‘
.
	`£t_lock_a¥eù_¿tio
(
True
)

1803 if(
£lf
.
executšgSÿn
 
is
 
nÙ
 
NÚe
):

1804 
£lf
.
	`discÚÃù_executšgSÿn_sigÇls
()

1806 
def
 
	$£cÚdsToSŒ
(
£lf
, 
t
):

1808 
	$£cÚdsToSŒ
(): 
desütiÚ


1810 :
·¿m
 
t
: 
desütiÚ


1811 :
ty³
 
t
:ype

1813 :
»tuºs
: 
NÚe


1815 #»div = 
Ïmbda
 
Î
,
b
 : 
	`li¡
(
	`divmod
(ll[0],b)) +†l[1:]

1816 #»tuº "%d:%02d:%02d" % 
	`tu¶e
(
	`»duû
(
»div
,[[
t
*1000,], 1000,60]))

1817 #»tuº "%d:%02d:%02d" % 
	`tu¶e
(
	`»duû
(
»div
,[[
t
*1000,], 1000,60]))

1818 #–­£d_£øğ
’d_time
 - 
begš_time


1819 (
	`¡ráime
("%H:%M:%S", 
	`gmtime
(
t
)))

1822 
def
 
	$check_time
(
£lf
, 
cur_sÿn_´og»ss
):

1824 
	$check_time
(): 
desütiÚ


1826 :
·¿m
 
cur_sÿn_´og»ss
: cur_sÿn_´og»s 
desütiÚ


1827 :
ty³
 
cur_sÿn_´og»ss
: cur_scan_progressype

1829 :
»tuºs
: 
NÚe


1831 if(
cur_sÿn_´og»ss
 < 1.0):

1832 
cur_sÿn_´og»ss
 = 1

1833 if(
£lf
.
¡¬t_time
 
is
 
NÚe
):

1834 
£lf
.
¡¬t_time
 = 
time
.
	`time
()

1835 
£lf
.
–­£d_time
 = 
time
.
	`time
(è- s–f.
¡¬t_time


1836 
time_Ëá
 = ((100.0 / 
cur_sÿn_´og»ss
è* 
£lf
.
–­£d_time
) - self.elapsed_time

1837 #cs_¡s['–­£d_time'] = 
£lf
.
	`£cÚdsToSŒ
(£lf.
–­£d_time
)

1838 
£lf
.
–­£dTimeLbl
.
	`£tText
(£lf.
	`£cÚdsToSŒ
(£lf.
–­£d_time
))

1839 #cs_¡s['time_Ëá'] = 
£lf
.
	`£cÚdsToSŒ
(
time_Ëá
)

1840 
£lf
.
timeLeáLbl
.
	`£tText
(£lf.
	`£cÚdsToSŒ
(
time_Ëá
))

1842 
def
 
	$Ú_sÿn_¡©us
(
£lf
, 
msg
):

1844 
	$Ú_sÿn_¡©us
(): 
desütiÚ


1846 :
·¿m
 
msg
: msg 
desütiÚ


1847 :
ty³
 
msg
: msgype

1849 :
»tuºs
: 
NÚe


1851 
£lf
.
sÿnAùiÚLbl
.
	`£tText
(
msg
)

1853 
def
 
	$£t_cur_sÿn_ty³
(
£lf
, 
ty³
):

1854 
£lf
.
_sÿn_ty³
 = 
ty³


1856 
def
 
	$£t_cur_sÿn_sub_ty³
(
£lf
, 
ty³
):

1857 
£lf
.
_sÿn_sub_ty³
 = 
ty³


1859 
def
 
	$g‘_cur_sÿn_ty³
(
£lf
):

1860 (
£lf
.
_sÿn_ty³
)

1862 
def
 
	$g‘_cur_sÿn_sub_ty³
(
£lf
):

1863 (
£lf
.
_sÿn_sub_ty³
)

1865 
def
 
	$Ú_sÿn_´og»ss
(
£lf
, 
³rûÁ
):

1867 
	$Ú_sÿn_´og»ss
(): 
a
 
sigÇl
 
hªdËr
 
th©
 
fœes
 
wh’
 
the
 
´og»ss
 
pv
's have been updated, here clipheop ofhe scan

1868 
³rûÁage
 
©
 >ğ90.0, >ğ90.0 
ju¡
 
£t
 
™
 
to
 %100

1870 :
·¿m
 
³rûÁ
:…”ûÁ 
desütiÚ


1871 :
ty³
 
³rûÁ
:…ercentype

1873 :
»tuºs
: 
NÚe


1875 
idx
 = 
£lf
.
executšgSÿn
.
	`g‘_cÚ£cutive_sÿn_idx
()

1876 
¥_id
 = 
£lf
.
executšgSÿn
.
	`g‘_¥©Ÿl_id
()

1878 if(
£lf
.
	$g‘_cur_sÿn_ty³
(è
is
 
nÙ
 
sÿn_ty³s
.
SAMPLE_IMAGE_STACK
):

1879 
£t_pixm­
 = 
£lf
.
sÿn_´og»ss_bË
.
£t_pixm­_by_¥id


1880 
£t_´og»ss
 = 
£lf
.
sÿn_´og»ss_bË
.
£t_´og»ss_by_¥id


1881 
id
 = 
¥_id


1883 #™ 
a
 
¡ack


1884 
£t_pixm­
 = 
£lf
.
sÿn_´og»ss_bË
.set_pixmap

1885 
£t_´og»ss
 = 
£lf
.
sÿn_´og»ss_bË
.set_progress

1886 
id
 = 
idx


1888 if(
³rûÁ
 >= 90.0):

1889 
³rûÁ
 = 100.0

1890 #´šˆ'Ú_sÿn_´og»ss: sp_id [%d]‡ˆ%.2à dÚe' % (
idx
, 
³rûÁ
)

1892 
	`£t_´og»ss
(
id
, 
³rûÁ
)

1894 if(
³rûÁ
 >= 100.0):

1895 
	`£t_pixm­
(
id
, 
sÿn_¡©us_ty³s
.
DONE
)

1896 
	`–if
(
³rûÁ
 < 100.0):

1897 
	`£t_pixm­
(
id
, 
sÿn_¡©us_ty³s
.
RUNNING
)

1899 
	`£t_pixm­
(
id
, 
sÿn_¡©us_ty³s
.
STOPPED
)

1900 #£lf.
curImgProgB¬
.
	`£tV®ue
(
³rûÁ
)

1901 
£lf
.
	`check_time
(
³rûÁ
)

1903 
def
 
	$Ú_tÙ®_sÿn_´og»ss
(
£lf
, 
³rûÁ
):

1905 
	$Ú_tÙ®_sÿn_´og»ss
(): 
desütiÚ


1907 :
·¿m
 
³rûÁ
:…”ûÁ 
desütiÚ


1908 :
ty³
 
³rûÁ
:…ercentype

1910 :
»tuºs
: 
NÚe


1912 #´šˆ'Ú_tÙ®_sÿn_´og»ss: %.2f' % 
³rûÁ


1913 #£lf.
tÙ®ProgB¬
.
	`£tV®ue
(
³rûÁ
)

1914 #£lf.
sÿn_´og»ss_bË
.
	`£t_´og»ss
(
£lf
.
cur_image_idx
, 
³rûÁ
)

1915 
£lf
.
tÙ®ProgB¬
.
	`£tV®ue
(
³rûÁ
)

1917 
def
 
	$Ú_·u£
(
£lf
, 
chkd
):

1919 
	$Ú_·u£
(): 
desütiÚ


1921 :
·¿m
 
chkd
: chkd 
desütiÚ


1922 :
ty³
 
chkd
: chkdype

1924 :
»tuºs
: 
NÚe


1927 if(
£lf
.
executšgSÿn
):

1928 #idx = 
£lf
.
executšgSÿn
.
	`g‘_imgidx
()

1929 
idx
 = 
£lf
.
executšgSÿn
.
	`g‘_cÚ£cutive_sÿn_idx
()

1930 if(
chkd
):

1931 
£lf
.
executšgSÿn
.
	`·u£
()

1932 
£lf
.
sÿn_´og»ss_bË
.
	`£t_pixm­
(
idx
, 
sÿn_¡©us_ty³s
.
PAUSED
)

1934 
£lf
.
executšgSÿn
.
	`»sume
()

1935 
£lf
.
sÿn_´og»ss_bË
.
	`£t_pixm­
(
idx
, 
sÿn_¡©us_ty³s
.
RUNNING
)

1937 
def
 
	$Ú_¡İ
(
£lf
):

1939 
	$Ú_¡İ
(): 
desütiÚ


1941 :
»tuºs
: 
NÚe


1944 if(
£lf
.
executšgSÿn
):

1945 #idx = 
£lf
.
executšgSÿn
.
	`g‘_imgidx
()

1946 
idx
 = 
£lf
.
executšgSÿn
.
	`g‘_cÚ£cutive_sÿn_idx
()

1947 
£lf
.
executšgSÿn
.
	`¡İ
()

1948 
£lf
.
sÿn_´og»ss_bË
.
	`£t_pixm­
(
idx
, 
sÿn_¡©us_ty³s
.
ABORTED
)

1949 
£lf
.
¡İpšg
 = 
True


1950 
£lf
.
	`£t_bu‰Ús_fÜ_¡¬tšg
()

1952 
def
 
	$Ú_ex™
(
£lf
):

1954 
	$Ú_ex™
(): 
desütiÚ


1956 :
»tuºs
: 
NÚe


1958 
·ss


1959 #_logg”.
	`šfo
('Main GUI: on_exit')

1961 
def
 
	$go
():

1963 
	$go
(): 
desütiÚ


1965 :
·¿m
 
	`go
(: goĞ
desütiÚ


1966 :
ty³
 
	`go
(: go(ype

1968 :
»tuºs
: 
NÚe


1972 #ÿ.
	`th»ads_š™
()

1973 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

1974 
py¡xm_wš
 = 
	`bioxasMWšdow
()

1975 
py¡xm_wš
.
	`show
()

1976 
­p
.
	`exec_
()

1979 #ià
__Çme__
 == '__main__':

1980 #impÜˆ
´ofe


1981 #impÜˆ
p¡©s


1982 #
#ÿ.
	`th»ads_š™
()

1983 ##
mÙÜCfgObj
 = 
	`StxmMÙÜCÚfig
(
r
'C:\controls\py2.7\Beamlines\sm\stxm_control\StxmDir\Microscope Configuration\Motor.cfg')

1984 #­°ğ
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

1985 #
##
	`log_to_qt
()

1986 #absMŒ = 
	`bioxasMWšdow
()

1987 #absMŒ.
	`show
()

1988 #sys.
	`ex™
(
­p
.
	`exec_
())

1990 
def
 
	$d‘”mše_´ofe_bŸs_v®
():

1992 
	$d‘”mše_´ofe_bŸs_v®
(): 
desütiÚ


1994 :
·¿m
 
	`d‘”mše_´ofe_bŸs_v®
(: d‘”mše_´ofe_bŸs_v®Ğ
desütiÚ


1995 :
ty³
 
	`d‘”mše_´ofe_bŸs_v®
(: determine_profile_bias_val(ype

1997 :
»tuºs
: 
NÚe


1999 
´
 = 
´ofe
.
	`Profe
()

2000 
v
 = 0

2001 
v_t
 = 0

2002 
i
 
š
 
	`¿nge
(5):

2003 
v_t
 = 
´
.
	`ÿlib¿‹
(100000)

2004 
v
 +ğ
v_t


2005 
´št
 
v_t


2007 
bv®
 = 
v
 / 5.0

2008 
´št
 'bŸ v® = ' , 
bv®


2009 
´ofe
.
Profe
.
bŸs
 = 
bv®


2010  
bv®


2012 
def
 
	$´ofe_™
():

2014 
	$´ofe_™
(): 
desütiÚ


2016 :
·¿m
 
	`´ofe_™
(:…rofe_™Ğ
desütiÚ


2017 :
ty³
 
	`´ofe_™
(:…rofile_it(ype

2019 :
»tuºs
: 
NÚe


2024 
´ofe
.
Profe
.
bŸs
 = 1.36987840635e-05

2027 
´ofe
.
	`run
('go()', 'testprof.dat')

2029 
p
 = 
p¡©s
.
	`Sts
('testprof.dat')

2030 
p
.
	`sÜt_¡©s
('cumuÏtive').
	`´št_¡©s
(100)

2033 
__Çme__
 == '__main__':

2034 
impÜt
 
´ofe


2035 
impÜt
 
p¡©s


2038 #mÙÜCfgObj = 
	`StxmMÙÜCÚfig
(
r
'C:\controls\py2.7\Beamlines\sm\stxm_control\StxmDir\Microscope Configuration\Motor.cfg')

2039 #­°ğ
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

2040 
	`go
()

	@bioxas_user.py

1 #-*- 
codšg
: 
utf
-8 -*-

4 
impÜt
 
	gos


5 
äom
 
	gşs
.
	g­pWidg‘s
.
	gu£r_accouÁ
.
u£r_acù_uts
 
impÜt
 
	gu£r_acút_mgr


7 #ü—‹ 
a
 
u£r
 
accouÁ
 
mªag”


8 
	gu¤_acù_mªag”
 = 
u£r_acút_mgr
(
os
.
·th
.
dœÇme
(
__fe__
))

10 
__®l__
 = ['usr_acct_mgr']

	@bioxas_user.py

1 #-*- 
codšg
: 
utf
-8 -*-

4 
impÜt
 
	gos


5 
äom
 
	gşs
.
	g­pWidg‘s
.
	gu£r_accouÁ
.
u£r_acù_uts
 
impÜt
 
	gu£r_acút_mgr


7 #ü—‹ 
a
 
u£r
 
accouÁ
 
mªag”


8 
	gu¤_acù_mªag”
 = 
u£r_acút_mgr
(
os
.
·th
.
dœÇme
(
__fe__
))

10 
__®l__
 = ['usr_acct_mgr']

	@bl07ID01.py

2 
C»©ed
 
Ú
 
	gNov
 19, 2015

4 @
	gauthÜ
: 
b”gr


8 
C»©ed
 
Ú
 2012-05-16

10 @
authÜ
: 
b”gr


12 #BCM 
GLOBAL
 
S‘tšgs
 
¡xm


13 
impÜt
 
š™_qt


14 
impÜt
 
os


15 
impÜt
 
time


16 
impÜt
 
cİy


17 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
	gQtWidg‘s


19 #äom 
twi¡ed
.
pythÚ
.
compÚ’ts
 
impÜt
 
glob®Regi¡ry


21 
äom
 
	gbcm
.
£‰šgs
 
	gimpÜt
 *

22 
äom
 
	gbcm
.
	gb—mlše
.
š‹rçûs
 
impÜt
 
	gIB—mlše


23 
äom
 
	gbcm
.
	gdeviû
.
couÁ”
 
impÜt
 
	gSimCouÁ”
, 
	gDAQmxLšeCouÁ”
, 
	gCouÁ”
, 
	gEpicsPv
, 
	gEpicsPvCouÁ”
, 
	gBa£G©e
, 
	gBa£CouÁ”
, 
	gBa£DIO


24 
äom
 
	gbcm
.
	gdeviû
.
shu‰”
 
impÜt
 
	gPvShu‰”


25 
äom
 
	gbcm
.
	gdeviû
.
v®ve
 
impÜt
 
	gPvV®ve


26 #äom 
bcm
.
deviû
.
driv”s
.
¡xmMÙÜ
.
lßdMŒCÚfig
 
impÜt
 
StxmMÙÜCÚfig


28 #äom 
•ics
.
mÙÜ
 
impÜt
 
MÙÜ
 
as
 
­sMÙÜ


29 
äom
 
	gbcm
.
	g•ics_deviûs
.
mÙÜ_v2
 
impÜt
 
MÙÜ_V2
 
as
 
	g­sMÙÜ


30 
äom
 
	gbcm
.
	g•ics_deviûs
.
ai
 
impÜt
 
	gai


32 
äom
 
	gbcm
.
	g•ics_deviûs
.
¡xm_§m¶e_mŒ
 
impÜt
 
	g§m¶e_mÙÜ
, 
	g§m¶e_ab¡¿ù_mÙÜ


33 
äom
 
	gbcm
.
	g•ics_deviûs
.
mbbi
 
impÜt
 
	gMbbi


34 
äom
 
	gbcm
.
	g•ics_deviûs
.
mbbo
 
impÜt
 
	gMbbo


36 
äom
 
	gbcm
.
	g•ics_deviûs
.
ÿm”a
 
impÜt
 
	gÿm”a


37 
äom
 
	gbcm
.
	g•ics_deviûs
.
sÿn
 
impÜt
 
	gSÿn


38 
äom
 
	gbcm
.
	g•ics_deviûs
.
ŒªsfÜm
 
impÜt
 
	gT¿nsfÜm


40 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
deviû_Çmes
 
	gimpÜt
 *

42 
äom
 
	gşs
.
	g­pWidg‘s
.
maš_objeù
 
impÜt
 
	gg’_£ssiÚ_obj
, 
	gmaš_objeù_ba£
, 
	gdev_cÚfig_ba£
, 
	gPOS_TYPE_BL
, 
	gPOS_TYPE_ES


43 
äom
 
	gşs
.
	guts
.
dœli¡
 
impÜt
 
	gdœli¡


44 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


45 
äom
 
	gşs
.
	guts
.
diù_uts
 
impÜt
 
	gdù_g‘
, 
	gdù_put
, 
	gdù_m”ge


46 
äom
 
	gşs
.
	g­p_d©a
.
deçuÉs
 
impÜt
 
	gDeçuÉs


47 
äom
 
	gşs
.
	gsÿÂšg
.
bioxasTy³s
 
impÜt
 
	g§m¶e_pos™iÚšg_modes
, 
	g§m¶e_fše_pos™iÚšg_modes
, 
	g’d¡©iÚ_id_ty³s


49 
impÜt
 
	gzmq


50 
äom
 
	gşs
.
	gz”omq
.
	g•ics
.
•ics_­i
 
	gimpÜt
 *

51 
äom
 
	gşs
.
	guts
.
jsÚ_th»ad§ve
 
impÜt
 
	gjsÚ_¡ršg_to_dù


52 
äom
 
	gşs
.
	g­pWidg‘s
.
g‘_mks_´j_»v
 
impÜt
 
	gg‘_mks_´ojeù_»v


53 #impÜˆ
sim¶ejsÚ
 
as
 
jsÚ


55 
	g__v”siÚ__
 = '1.0.0'

58 
BEAMLINE_NAME
 = '07ID-1'

59 
BEAMLINE_TYPE
 = 'BIOXAS'

60 
BEAMLINE_ENERGY_RANGE
 = (4.0, 18.5)

62 
	gUSE_ZMQ
 = 
F®£


65 
şass
 
	$dev_cÚfig_bioxas
(
dev_cÚfig_ba£
):

66 
def
 
	$__š™__
(
£lf
, 
¥Ïsh
=
NÚe
):

67 
	`su³r
(
dev_cÚfig_bioxas
, 
£lf
).
	`__š™__
()

68 
´št
 'Using BIOXAS DEVICES'

69 
£lf
.
b—mlše
 = 'BIOXAS Imaging 07ID1'

70 
£lf
.
ssÿn_»c_´fx
 = 'bioxas'

71 
£lf
.
es_id
 = 
’d¡©iÚ_id_ty³s
.
IMAG


72 
£lf
.
¥Ïsh
 = splash

73 
£lf
.
dÚe
 = 
F®£


74 #£lf.
tim”
 = 
QtCÜe
.
	`QTim”
()

75 #£lf.
tim”
.
timeout
.
	`cÚÃù
(
£lf
.
Ú_tim”
)

76 
£lf
.
	`š™_deviûs
()

77 
£lf
.
	`š™_´e£ts
()

78 #š™_po¢”_¢­shÙ_cbs(
£lf
.
deviûs
['POSITIONERS'])

81 
def
 
	$š™_´e£ts
(
£lf
):

82 #£lf.
deviûs
['PRESETS']['MAX_SCAN_RANGE_X'] = 98

83 #£lf.
deviûs
['PRESETS']['MAX_SCAN_RANGE_Y'] = 98

85 
£lf
.
deviûs
['PRESETS']['MAX_SCAN_RANGE_X'] = 70

86 
£lf
.
deviûs
['PRESETS']['MAX_SCAN_RANGE_Y'] = 70

88 
£lf
.
deviûs
['PRESETS']['MAX_ZP_SCAN_RANGE_X'] = 98

89 
£lf
.
deviûs
['PRESETS']['MAX_ZP_SCAN_RANGE_Y'] = 98

91 #fÜ 
now


92 #£lf.
deviûs
['PRESETS']['MAX_ZP_SCAN_RANGE_X'] = 11

93 #£lf.
deviûs
['PRESETS']['MAX_ZP_SCAN_RANGE_Y'] = 11

95 
£lf
.
deviûs
['PRESETS']['MAX_ZP_SUBSCAN_RANGE_X'] = 98

96 
£lf
.
deviûs
['PRESETS']['MAX_ZP_SUBSCAN_RANGE_Y'] = 98

98 #£lf.
deviûs
['PVS']['EÃrgy_’abË'].
	`put
(0)

101 
def
 
	$š™_deviûs
(
£lf
):

103 #I 
dÚ
't have‡nƒlegant way yeto createhese‡nd‡lsoƒmit‡ signalohe splash screen

104 #sØ
this
 
is
 
a
 
fœ¡
 
©‹m±


105 #£lf.
tim”
.
	`¡¬t
(100)

106 #m­ 
Çmes
 
to
 
deviû
 
objeùs


107 #£lf.
deviûs
['POSITIONERS'][
DNM_SAMPLE_FINE_X
] = 
	`­sMÙÜ
('IOC:m100',
pos_£t
=
POS_TYPE_ES
)

108 #£lf.
deviûs
['POSITIONERS'][
DNM_SAMPLE_FINE_Y
] = 
	`­sMÙÜ
('IOC:m101',
pos_£t
=
POS_TYPE_ES
)

109 
´fx
 = 
£lf
.
ssÿn_»c_´fx


111 
£lf
.
deviûs
['POSITIONERS'][
DNM_PFIL1607_5_I10_01
] = 
	`­sMÙÜ
('BIOXAS:m100',
pos_£t
=
POS_TYPE_ES
)

112 
£lf
.
deviûs
['POSITIONERS'][
DNM_PFIL1607_5_I10_02
] = 
	`­sMÙÜ
('BIOXAS:m101',
pos_£t
=
POS_TYPE_ES
)

114 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M1_VERT_PªdR_IN_UP
] = 
	`­sMÙÜ
('BIOXAS:m102',
pos_£t
=
POS_TYPE_ES
)

115 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M1_VERT_PªdR_OUT_UP
 ] = 
	`­sMÙÜ
('BIOXAS:m103',
pos_£t
=
POS_TYPE_ES
)

116 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M1_VERT_PªdR_DOWN
] = 
	`­sMÙÜ
('BIOXAS:m104',
pos_£t
=
POS_TYPE_ES
)

117 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M1_HORZ_STRIPE_SEL
] = 
	`­sMÙÜ
('BIOXAS:m105',
pos_£t
=
POS_TYPE_ES
)

118 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M1_YAW
] = 
	`­sMÙÜ
('BIOXAS:m106',
pos_£t
=
POS_TYPE_ES
)

119 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M1_BENDER_UPSTREAM
] = 
	`­sMÙÜ
('BIOXAS:m107',
pos_£t
=
POS_TYPE_ES
)

120 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M1_BENDER_DOWNSTREAM
] = 
	`­sMÙÜ
('BIOXAS:m108',
pos_£t
=
POS_TYPE_ES
)

122 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M2_VERT_PªdR_IN_UP
] = 
	`­sMÙÜ
('BIOXAS:m109',
pos_£t
=
POS_TYPE_ES
)

123 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M2_VERT_PªdR_OUT_UP
] = 
	`­sMÙÜ
('BIOXAS:m110',
pos_£t
=
POS_TYPE_ES
)

124 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M2_VERT_PªdR_DOWN
] = 
	`­sMÙÜ
('BIOXAS:m111',
pos_£t
=
POS_TYPE_ES
)

125 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M2_HORZ_STRIPE_SEL
] = 
	`­sMÙÜ
('BIOXAS:m112',
pos_£t
=
POS_TYPE_ES
)

126 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M2_YAW
] = 
	`­sMÙÜ
('BIOXAS:m113',
pos_£t
=
POS_TYPE_ES
)

127 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M2_BENDER_UPSTREAM
] = 
	`­sMÙÜ
('BIOXAS:m114',
pos_£t
=
POS_TYPE_ES
)

128 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M2_BENDER_DOWNSTREAM
] = 
	`­sMÙÜ
('BIOXAS:m115',
pos_£t
=
POS_TYPE_ES
)

129 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_MONO_BRAGG
] = 
	`­sMÙÜ
('BIOXAS:m116',
pos_£t
=
POS_TYPE_ES
)

131 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_VM_UPPER_BLADE
] = 
	`­sMÙÜ
('BIOXAS:m117',
pos_£t
=
POS_TYPE_ES
)

132 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_VM_LOWER_BLADE
] = 
	`­sMÙÜ
('BIOXAS:m118',
pos_£t
=
POS_TYPE_ES
)

133 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_MONO_CRYSTAL_2_Z2
] = 
	`­sMÙÜ
('BIOXAS:m119',
pos_£t
=
POS_TYPE_ES
)

134 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_MONO_CRYSTAL_2_Y2
] = 
	`­sMÙÜ
('BIOXAS:m120',
pos_£t
=
POS_TYPE_ES
)

135 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_MONO_CRYSTAL_2_Th‘a2
] = 
	`­sMÙÜ
('BIOXAS:m121',
pos_£t
=
POS_TYPE_ES
)

136 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_MONO_CRYSTAL_2_CHI_2
] = 
	`­sMÙÜ
('BIOXAS:m122',
pos_£t
=
POS_TYPE_ES
)

137 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_MONO_TABLE_VERT_Y
] = 
	`­sMÙÜ
('BIOXAS:m123',
pos_£t
=
POS_TYPE_ES
)

138 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_MONO_TABLE_HORZ_X
 ] = 
	`­sMÙÜ
('BIOXAS:m124',
pos_£t
=
POS_TYPE_ES
)

140 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_TABLE_VERTICAL_1
] = 
	`­sMÙÜ
('BIOXAS:m125',
pos_£t
=
POS_TYPE_ES
)

141 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_TABLE_VERTICAL_2
] = 
	`­sMÙÜ
('BIOXAS:m126',
pos_£t
=
POS_TYPE_ES
)

142 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_TABLE_VERTICAL_3
] = 
	`­sMÙÜ
('BIOXAS:m127',
pos_£t
=
POS_TYPE_ES
)

143 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_TABLE_HORIZONTAL_1
] = 
	`­sMÙÜ
('BIOXAS:m128',
pos_£t
=
POS_TYPE_ES
)

144 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_TABLE_HORIZONTAL_2
] = 
	`­sMÙÜ
('BIOXAS:m129',
pos_£t
=
POS_TYPE_ES
)

146 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_JJ_SLIT_US_VERT_GAP
] = 
	`­sMÙÜ
('BIOXAS:m130',
pos_£t
=
POS_TYPE_ES
)

147 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_JJ_SLIT_US_VERT_CENTER
] = 
	`­sMÙÜ
('BIOXAS:m131',
pos_£t
=
POS_TYPE_ES
)

148 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_JJ_SLIT_US_HOR_GAP
] = 
	`­sMÙÜ
('BIOXAS:m132',
pos_£t
=
POS_TYPE_ES
)

149 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_JJ_SLIT_US_HOR_CENTER
] = 
	`­sMÙÜ
('BIOXAS:m133',
pos_£t
=
POS_TYPE_ES
)

150 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_HORIZ_KB_BENDER_1
] = 
	`­sMÙÜ
('BIOXAS:m134',
pos_£t
=
POS_TYPE_ES
)

151 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_HORIZ_KB_BENDER_2
] = 
	`­sMÙÜ
('BIOXAS:m135',
pos_£t
=
POS_TYPE_ES
)

152 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_HORIZ_KB_VERTICAL
] = 
	`­sMÙÜ
('BIOXAS:m136',
pos_£t
=
POS_TYPE_ES
)

153 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_HORIZ_KB_TILT
] = 
	`­sMÙÜ
('BIOXAS:m137',
pos_£t
=
POS_TYPE_ES
)

155 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_VERT_KB_BENDER_1
] = 
	`­sMÙÜ
('BIOXAS:m138',
pos_£t
=
POS_TYPE_ES
)

156 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_VERT_KB_BENDER_2
] = 
	`­sMÙÜ
('BIOXAS:m139',
pos_£t
=
POS_TYPE_ES
)

157 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_VERT_KB_VERTICAL
] = 
	`­sMÙÜ
('BIOXAS:m140',
pos_£t
=
POS_TYPE_ES
)

158 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_VERT_KB_TILT
] = 
	`­sMÙÜ
('BIOXAS:m141',
pos_£t
=
POS_TYPE_ES
)

159 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_DETECTOR_1_VERTICAL
] = 
	`­sMÙÜ
('BIOXAS:m142',
pos_£t
=
POS_TYPE_ES
)

160 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_DETECTOR_1_LATERAL
] = 
	`­sMÙÜ
('BIOXAS:m143',
pos_£t
=
POS_TYPE_ES
)

161 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_DETECTOR_2_VERTICAL
] = 
	`­sMÙÜ
('BIOXAS:m144',
pos_£t
=
POS_TYPE_ES
)

162 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_DETECTOR_2_LATERAL
] = 
	`­sMÙÜ
('BIOXAS:m145',
pos_£t
=
POS_TYPE_ES
)

164 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_SAMPLE_ROTARY_STAGE
] = 
	`­sMÙÜ
('BIOXAS:m146',
pos_£t
=
POS_TYPE_ES
)

165 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_ZONE_PLATE_X
] = 
	`­sMÙÜ
('BIOXAS:m147',
pos_£t
=
POS_TYPE_ES
)

166 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_ZONE_PLATE_Y
] = 
	`­sMÙÜ
('BIOXAS:m148',
pos_£t
=
POS_TYPE_ES
)

167 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_ZONE_PLATE_Z
] = 
	`­sMÙÜ
('BIOXAS:m149',
pos_£t
=
POS_TYPE_ES
)

168 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_ZONE_PLATE_PITCH
] = 
	`­sMÙÜ
('BIOXAS:m150',
pos_£t
=
POS_TYPE_ES
)

169 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_ZONE_PLATE_YAW
] = 
	`­sMÙÜ
('BIOXAS:m151',
pos_£t
=
POS_TYPE_ES
)

170 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_OPTICAL_SAMPLE_VERT
 ] = 
	`­sMÙÜ
('BIOXAS:m152',
pos_£t
=
POS_TYPE_ES
)

172 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_JJ_SLIT_DS_VERT_GAP
] = 
	`­sMÙÜ
('BIOXAS:m153',
pos_£t
=
POS_TYPE_ES
)

173 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_JJ_SLIT_DS_VERT_CENTER
] = 
	`­sMÙÜ
('BIOXAS:m154',
pos_£t
=
POS_TYPE_ES
)

174 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_JJ_SLIT_DS_HOR_GAP
] = 
	`­sMÙÜ
('BIOXAS:m155',
pos_£t
=
POS_TYPE_ES
)

175 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_JJ_SLIT_DS_HOR_CENTER
] = 
	`­sMÙÜ
('BIOXAS:m156',
pos_£t
=
POS_TYPE_ES
)

176 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_MACRO_STAGE_UP_DOWN
] = 
	`­sMÙÜ
('BIOXAS:m157',
pos_£t
=
POS_TYPE_ES
)

177 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_MACRO_STAGE_HORIZ
] = 
	`­sMÙÜ
('BIOXAS:m158',
pos_£t
=
POS_TYPE_ES
)

178 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_MACRO_STAGE_VERT
] = 
	`­sMÙÜ
('BIOXAS:m159',
pos_£t
=
POS_TYPE_ES
)

179 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_VISUALIZATION_VERT
] = 
	`­sMÙÜ
('BIOXAS:m160',
pos_£t
=
POS_TYPE_ES
)

183 
	`cÚÃù_¡ªd¬d_b—mlše_pos™iÚ”s
(
£lf
.
deviûs
, 
´fx
)

184 
	`cÚÃù_deviûs
(
£lf
.
deviûs
, 
´fx
)

186 #key, 
v®ue
 
š
 
£lf
.
deviûs
.
	`™”™ems
():

187 #´šˆ
key
,
v®ue


188 
´št
 'finished connectingo devices'

189 
£lf
.
dÚe
 = 
True


191 
def
 
	`cÚÃù_¡ªd¬d_b—mlše_pos™iÚ”s
(
dev_dù
, 
´fx
='bioxas'):

194 #dev_dù['POSITIONERS'][
DNM_ENERGY
] = 
	`­sMÙÜ
('BL1607-I10:ENERGY',
pos_£t
=
POS_TYPE_ES
)

195 #dev_dù['POSITIONERS'][
DNM_SLIT_X
] = 
	`­sMÙÜ
('BL1607-I10:¦™X',
pos_£t
=
POS_TYPE_BL
)

196 #dev_dù['POSITIONERS'][
DNM_SLIT_Y
] = 
	`­sMÙÜ
('BL1607-I10:¦™Y',
pos_£t
=
POS_TYPE_BL
)

197 #dev_dù['POSITIONERS'][
DNM_M3_PITCH
] = 
	`­sMÙÜ
('BL1607-I10:m3STXMP™ch',
pos_£t
=
POS_TYPE_BL
)

198 #dev_dù['POSITIONERS'][
DNM_EPU_GAP
] = 
	`­sMÙÜ
('BL1607-I10:•uG­',
pos_£t
=
POS_TYPE_BL
)

199 #dev_dù['POSITIONERS'][
DNM_EPU_OFFSET
] = 
	`­sMÙÜ
('BL1607-I10:•uOff£t',
pos_£t
=
POS_TYPE_BL
)

200 #dev_dù['POSITIONERS'][
DNM_EPU_HARMONIC
] = 
	`­sMÙÜ
('BL1607-I10:•uH¬mÚic',
pos_£t
=
POS_TYPE_BL
)

201 #dev_dù['POSITIONERS'][
DNM_EPU_POLARIZATION
] = 
	`­sMÙÜ
('BL1607-I10:•uPŞ¬iz©iÚ',
pos_£t
=
POS_TYPE_BL
)

202 #dev_dù['POSITIONERS'][
DNM_EPU_ANGLE
] = 
	`­sMÙÜ
('BL1607-I10:•uAngË',
pos_£t
=
POS_TYPE_BL
)

204 
def
 
	`cÚÃù_deviûs
(
dev_dù
, 
´fx
='bioxas'):

206 
PVS
: 
sšguÏr
 
PV
 
cÚÃùiÚs


207 
DETECTORS
: 
deviûs
 
th©
  
d©a


208 
SSCANS
:

209 
PVS_DONT_RECORD
:

210 
TEMPERATURES
:

211 
PRESSURES
:

216 
dev_dù
['PVS']['SYSTEM:mode:fbk'] = 
	`EpicsPv
('SYSTEM:mode:fbk')

217 
dev_dù
['PVS_DONT_RECORD']['tick”'] = 
	`EpicsPv
('TRG2400:cycles')

218 
dev_dù
['PVS']['SRStus_shu‰”s'] = 
	`EpicsPv
('SRStatus:shutters')

220 
dev_dù
['DETECTORS']['StÜageRšgCu¼’t'] = 
	`EpicsPv
('PCT1402-01:mA:fbk')

222 #dev_dù['DIO'][
DNM_GATE
] = 
	`Ba£G©e
('%sCO:g©e' % 
´fx
)

223 #dev_dù['DIO'][
DNM_SHUTTER
] = 
	`PvShu‰”
('%sDIO:shu‰”:ùl' % 
´fx
)

224 #dev_dù['DIO']['Shu‰”TaskRun'] = 
	`EpicsPv
('%sDIO:shu‰”:Run' % 
´fx
)

225 #
#dev_dù['DETECTORS'][
DNM_COUNTER_APD
] = 
	`Ba£CouÁ”
('%sCI:couÁ”' % 
´fx
)

226 ##
dev_dù
['DETECTORS']['D‘_CÁr'] = 
	`EpicsPvCouÁ”
('%sPMT:ùr:SšgËV®ue_RBV' % 
´fx
)

227 #dev_dù['DETECTORS'][
DNM_PMT
] = 
	`EpicsPv
('%sPMT:ùr:SšgËV®ue_RBV' % 
´fx
)

228 #
#dev_dù['DETECTORS_NO_RECORD']['D‘CÁr_SÇpshÙ'] = 
	`EpicsPvCouÁ”
('%sPMT:d‘_¢­shÙ_RBV' % 
´fx
)

229 #dev_dù['DETECTORS_NO_RECORD']['O§CÁr_SÇpshÙ'] = 
	`EpicsPvCouÁ”
('%sPMT:o§_¢­shÙ_RBV' % 
´fx
)

230 #
#dev_dù['PVS']['Id—l_A0'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:zp:fbk:Œ.K' % 
´fx
)

231 #dev_dù['PVS']['C®cd_Zpz'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:zp:fbk:Œ.L' % 
´fx
)

232 #
#dev_dù['PVS']['Zpz_sÿnModeFÏg'] = 
	`Mbbo
('BL1607-I10:ENERGY:%s:zp:sÿn£læag' % 
´fx
è#u£d 
to
 
cÚŒŞ
 
which
 
v®ue
 
g‘s
 
£Á
Ø
Zpz
, 
æ
 
Ü
 fÈ- 
A0


233 ##
u£d
 
to
 
adju¡
 
the
 
cu¼’t
 
focus
 
v®ue
,h
d–
 
»´e£Ás
h
»Ïtive
 
miüÚs
 
zpz
Ø
move
Ø
Ãw
 focu 
pos™iÚ


234 #dev_dù['PVS']['D–_Zpz'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:d–_zpz' % 
´fx
)

235 #dev_dù['PVS']['Foÿl_L’gth'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:zp:FL' % 
´fx
)

236 #dev_dù['PVS']['A0'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:A0' % 
´fx
)

237 #dev_dù['PVS']['A0Max'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:A0Max' % 
´fx
)

238 #
#dev_dù['PVS']['Zpz_pos'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:zp:zpz_pos' % 
´fx
)

239 #dev_dù['PVS']['Zp_def'] = 
	`T¿nsfÜm
('BL1607-I10:ENERGY:%s:zp:def' % 
´fx
)

240 #dev_dù['PVS']['OSA_def'] = 
	`T¿nsfÜm
('BL1607-I10:ENERGY:%s:o§:def' % 
´fx
)

241 #
#dev_dù['PVS']['Zp_£Ëù'] = 
	`Mbbo
('BL1607-I10:ENERGY:%s:zp' % 
´fx
)

242 #dev_dù['PVS']['OSA_£Ëù'] = 
	`Mbbo
('BL1607-I10:ENERGY:%s:o§' % 
´fx
)

243 #
#dev_dù['PVS']['EÃrgy_’abË'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:’abËd' % 
´fx
)

244 #dev_dù['PVS']['ENERGY_RBV'] = 
	`EpicsPv
('BL1607-I10:ENERGY.RBV')

245 #dev_dù['PVS']['Zp_def.A'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:zp:def.A' % 
´fx
)

246 #
#
#dev_dù['PVS']['Zp_def1_A'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:zp1:def.A' % 
´fx
)

247 #dev_dù['PVS']['Zp_def2_A'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:zp2:def.A' % 
´fx
)

248 #dev_dù['PVS']['Zp_def3_A'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:zp3:def.A' % 
´fx
)

249 #dev_dù['PVS']['Zp_def4_A'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:zp4:def.A' % 
´fx
)

250 #dev_dù['PVS']['Zp_def5_A'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:zp5:def.A' % 
´fx
)

251 #
##
dev_dù
['PVS']['SRStus_msgL1'] = 
	`EpicsPv
('SRStatus:msg:tL1')

252 ##
dev_dù
['PVS']['SRStus_msgL2'] = 
	`EpicsPv
('SRStatus:msg:tL2')

253 ##
dev_dù
['PVS']['SRStus_msgL3'] = 
	`EpicsPv
('SRStatus:msg:tL3')

254 #
#
#dev_dù['PVS']['MÚo_ev_fbk'] = 
	`EpicsPv
('MONO1610-I10-01:energy:fbk')

255 #dev_dù['PVS']['Epu_pŞ_fbk'] = 
	`Mbbi
('UND1410-01:polarization')

256 #dev_dù['PVS']['Epu_pŞ_ªgË'] = 
	`EpicsPv
('UND1410-01:polarAngle')

257 #dev_dù['PVS']['Epu_g­_fbk'] = 
	`EpicsPv
('UND1410-01:gap:mm:fbk')

258 #dev_dù['PVS']['Epu_g­_off£t'] = 
	`EpicsPv
('UND1410-01:gap:offset')

259 #dev_dù['PVS']['Epu_h¬mÚic'] = 
	`EpicsPv
('UND1410-01:harmonic')

260 #
#
#
#dev_dù['PVS_DONT_RECORD']['CX_auto_di§bË_pow”'] = 
	`EpicsPv
('IOC:m112:XPS_AUTO_DISABLE_MODE')

261 #dev_dù['PVS_DONT_RECORD']['CY_auto_di§bË_pow”'] = 
	`EpicsPv
('IOC:m113:XPS_AUTO_DISABLE_MODE')

262 #dev_dù['PVS_DONT_RECORD']['DX_auto_di§bË_pow”'] = 
	`EpicsPv
('IOC:m114:XPS_AUTO_DISABLE_MODE')

263 #dev_dù['PVS_DONT_RECORD']['DY_auto_di§bË_pow”'] = 
	`EpicsPv
('IOC:m115:XPS_AUTO_DISABLE_MODE')

264 #
#dev_dù['PVS_DONT_RECORD']['accRªge'] = 
	`EpicsPv
('uhvTestSIG:signal:MaxPoints')

265 #
#dev_dù['PVS_DONT_RECORD']['FX_fÜû_dÚe'] = 
	`EpicsPv
('IOC:m100:ForceDone')

266 #dev_dù['PVS_DONT_RECORD']['FY_fÜû_dÚe'] = 
	`EpicsPv
('IOC:m101:ForceDone')

267 #
#dev_dù['PVS_DONT_RECORD']['OX_fÜû_dÚe'] = 
	`EpicsPv
('IOC:m104:ForceDone')

268 #dev_dù['PVS_DONT_RECORD']['OY_fÜû_dÚe'] = 
	`EpicsPv
('IOC:m105:ForceDone')

269 #
#dev_dù['PVS_DONT_RECORD']['OX_Œackšg_’abËd'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:o§x_Œack_’abËd' % 
´fx
)

270 #dev_dù['PVS_DONT_RECORD']['OY_Œackšg_’abËd'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:o§y_Œack_’abËd' % 
´fx
)

271 #dev_dù['PVS_DONT_RECORD']['OZ_Œackšg_’abËd'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:o§z_Œack_’abËd' % 
´fx
)

272 #
#dev_dù['PVS_DONT_RECORD']['OSAXYZ_lockpos™iÚ_’abËd'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:o§xyz_lockpos_’abËd' % 
´fx
)

273 #
#dev_dù['PVS_DONT_RECORD']['OSAXY_gÙo_lockpos™iÚ'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:o§xy_gÙo_lockpos' % 
´fx
)

274 #dev_dù['PVS_DONT_RECORD']['OSAZ_gÙo_lockpos™iÚ'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:o§z_gÙo_lockpos' % 
´fx
)

275 #
#dev_dù['PVS_DONT_RECORD']['S‘_XY_lockpos™iÚ'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:£t_xy:lock_po¢' % 
´fx
)

276 #dev_dù['PVS_DONT_RECORD']['S‘_Z_lockpos™iÚ'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:£t_z:lock_po¢' % 
´fx
)

278 #fÜ 
POL
, 
OFF
 
ªd
 
ANGLE


279 
dev_dù
['PVS_DONT_RECORD']['%s:image:cmd_fe' % 
´fx
] = 
	`EpicsPv
('%s:image:cmd_file' %…rfx)

280 
dev_dù
['PVS_DONT_RECORD']['%s:image:³rûÁDÚe' % 
´fx
] = 
	`EpicsPv
('%s:image:percentDone' %…rfx)

281 
dev_dù
['PVS_DONT_RECORD']['%s:image:sšgË_´og»ss' % 
´fx
] = 
	`EpicsPv
('%s:image:single_progress' %…rfx)

283 
dev_dù
['PVS_DONT_RECORD']['%s:image:»maššgTimeSŒ' % 
´fx
] = 
	`EpicsPv
('%s:image:remainingTimeStr' %…rfx)

284 
dev_dù
['PVS_DONT_RECORD']['%s:image:’dšgTimeSŒ' % 
´fx
] = 
	`EpicsPv
('%s:image:endingTimeStr' %…rfx)

285 
dev_dù
['PVS_DONT_RECORD']['%s:image:tÙ®EÏp£dTimeSŒ' % 
´fx
] = 
	`EpicsPv
('%s:image:totalElapsedTimeStr' %…rfx)

288 
dev_dù
['SSCANS']['%s:image:sÿn1' % 
´fx
] = 
	`Sÿn
('%s:image:scan1' %…rfx)

289 
dev_dù
['SSCANS']['%s:image:sÿn2' % 
´fx
] = 
	`Sÿn
('%s:image:scan2' %…rfx)

290 
dev_dù
['SSCANS']['%s:image:sÿn3' % 
´fx
] = 
	`Sÿn
('%s:image:scan3' %…rfx)

291 
dev_dù
['SSCANS']['%s:image:sÿn4' % 
´fx
] = 
	`Sÿn
('%s:image:scan4' %…rfx)

292 
dev_dù
['SSCANS']['%s:image:sÿn5' % 
´fx
] = 
	`Sÿn
('%s:image:scan5' %…rfx)

296 #ES = 
’d¡©iÚ
 
‹m³¿tu»s


297 #dev_dù['TEMPERATURES'][
POS_TYPE_ES
]['TM1610-3-I12-01'] = 
	`ai
('TM1610-3-I12-01', 
desc
='Turbo cooling water')

298 #dev_dù['TEMPERATURES'][
POS_TYPE_ES
]['TM1610-3-I12-30'] = 
	`ai
('TM1610-3-I12-30', 
desc
='Sample Coarse Y')

299 #dev_dù['TEMPERATURES'][
POS_TYPE_ES
]['TM1610-3-I12-32'] = 
	`ai
('TM1610-3-I12-32', 
desc
='Detector Y')

300 #dev_dù['TEMPERATURES'][
POS_TYPE_ES
]['TM1610-3-I12-21'] = 
	`ai
('TM1610-3-I12-21', 
desc
='Chamberemp #1')

301 #dev_dù['TEMPERATURES'][
POS_TYPE_ES
]['TM1610-3-I12-22'] = 
	`ai
('TM1610-3-I12-22', 
desc
='Chamberemp #2')

302 #dev_dù['TEMPERATURES'][
POS_TYPE_ES
]['TM1610-3-I12-23'] = 
	`ai
('TM1610-3-I12-23', 
desc
='Chamberemp #3')

303 #dev_dù['TEMPERATURES'][
POS_TYPE_ES
]['TM1610-3-I12-24'] = 
	`ai
('TM1610-3-I12-24', 
desc
='Chamberemp #4')

304 #
#
##
´essu»s


305 #dev_dù['PRESSURES'][
POS_TYPE_ES
]['FRG1610-3-I12-01:vac:p'] = 
	`ai
('FRG1610-3-I12-01:vac:p', 
desc
='Chamber…ressure')

306 #dev_dù['PRESSURES'][
POS_TYPE_ES
]['TCG1610-3-I12-03:vac:p'] = 
	`ai
('TCG1610-3-I12-03:vac:p', 
desc
='Turbo backing…ressure')

307 #dev_dù['PRESSURES'][
POS_TYPE_ES
]['TCG1610-3-I12-04:vac:p'] = 
	`ai
('TCG1610-3-I12-04:vac:p', 
desc
='Load†ock…ressure')

308 #dev_dù['PRESSURES'][
POS_TYPE_ES
]['TCG1610-3-I12-05:vac:p'] = 
	`ai
('TCG1610-3-I12-05:vac:p', 
desc
='Rough†ine…ressure')

310 
	`cÚÃù_ES_deviûs
(
dev_dù
, 
´fx
)

311 
	`cÚÃù_BL_deviûs
(
dev_dù
, 
´fx
)

314 
def
 
	`cÚÃù_ES_deviûs
(
dev_dù
, 
´fx
='bioxas'):

316 #if(
´fx
.
	`fšd
('uhv') > -1):

317 #dev_dù['TEMPERATURES'][
POS_TYPE_ES
]['CCTL1610-I10:‹mp:fbk'] = 
	`ai
('CCTL1610-I10:‹mp:fbk', 
desc
='Gatan„odemp')

321 
def
 
	`cÚÃù_BL_deviûs
(
dev_dù
, 
´fx
='bioxas'):

324 
MAIN_OBJ
 = 
NÚe


325 
DEVICE_CFG
 = 
NÚe


327 
MAIN_OBJ
 = 
	`maš_objeù_ba£
('CLS BioXAS 07ID1','IMAG')

328 
MAIN_OBJ
.
	`£t_§m¶e_pos™iÚšg_mode
(
§m¶e_pos™iÚšg_modes
.
GONIOMETER
)

329 
MAIN_OBJ
.
	`£t_fše_§m¶e_pos™iÚšg_mode
(
§m¶e_fše_pos™iÚšg_modes
.
ZONEPLATE
)

331 
MAIN_OBJ
.
	`£t_d©afe_´efix
('I')

332 
MAIN_OBJ
.
	`£t_thumbfe_suffix
('jpg')

333 
DEVICE_CFG
 = 
	`dev_cÚfig_bioxas
()

334 
MAIN_OBJ
.
	`£t_deviûs
(
DEVICE_CFG
)

335 
DEFAULTS
 = 
	`DeçuÉs
('bioxas_dæts.jsÚ', 
Ãw
=
True
)

339 
__Çme__
 == '__main__':

	@bl07ID01.py

2 
C»©ed
 
Ú
 
	gNov
 19, 2015

4 @
	gauthÜ
: 
b”gr


8 
C»©ed
 
Ú
 2012-05-16

10 @
authÜ
: 
b”gr


12 #BCM 
GLOBAL
 
S‘tšgs
 
¡xm


13 
impÜt
 
š™_qt


14 
impÜt
 
os


15 
impÜt
 
time


16 
impÜt
 
cİy


17 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
	gQtWidg‘s


19 #äom 
twi¡ed
.
pythÚ
.
compÚ’ts
 
impÜt
 
glob®Regi¡ry


21 
äom
 
	gbcm
.
£‰šgs
 
	gimpÜt
 *

22 
äom
 
	gbcm
.
	gb—mlše
.
š‹rçûs
 
impÜt
 
	gIB—mlše


23 
äom
 
	gbcm
.
	gdeviû
.
couÁ”
 
impÜt
 
	gSimCouÁ”
, 
	gDAQmxLšeCouÁ”
, 
	gCouÁ”
, 
	gEpicsPv
, 
	gEpicsPvCouÁ”
, 
	gBa£G©e
, 
	gBa£CouÁ”
, 
	gBa£DIO


24 
äom
 
	gbcm
.
	gdeviû
.
shu‰”
 
impÜt
 
	gPvShu‰”


25 
äom
 
	gbcm
.
	gdeviû
.
v®ve
 
impÜt
 
	gPvV®ve


26 #äom 
bcm
.
deviû
.
driv”s
.
¡xmMÙÜ
.
lßdMŒCÚfig
 
impÜt
 
StxmMÙÜCÚfig


28 #äom 
•ics
.
mÙÜ
 
impÜt
 
MÙÜ
 
as
 
­sMÙÜ


29 
äom
 
	gbcm
.
	g•ics_deviûs
.
mÙÜ_v2
 
impÜt
 
MÙÜ_V2
 
as
 
	g­sMÙÜ


30 
äom
 
	gbcm
.
	g•ics_deviûs
.
ai
 
impÜt
 
	gai


32 
äom
 
	gbcm
.
	g•ics_deviûs
.
¡xm_§m¶e_mŒ
 
impÜt
 
	g§m¶e_mÙÜ
, 
	g§m¶e_ab¡¿ù_mÙÜ


33 
äom
 
	gbcm
.
	g•ics_deviûs
.
mbbi
 
impÜt
 
	gMbbi


34 
äom
 
	gbcm
.
	g•ics_deviûs
.
mbbo
 
impÜt
 
	gMbbo


36 
äom
 
	gbcm
.
	g•ics_deviûs
.
ÿm”a
 
impÜt
 
	gÿm”a


37 
äom
 
	gbcm
.
	g•ics_deviûs
.
sÿn
 
impÜt
 
	gSÿn


38 
äom
 
	gbcm
.
	g•ics_deviûs
.
ŒªsfÜm
 
impÜt
 
	gT¿nsfÜm


40 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
deviû_Çmes
 
	gimpÜt
 *

42 
äom
 
	gşs
.
	g­pWidg‘s
.
maš_objeù
 
impÜt
 
	gg’_£ssiÚ_obj
, 
	gmaš_objeù_ba£
, 
	gdev_cÚfig_ba£
, 
	gPOS_TYPE_BL
, 
	gPOS_TYPE_ES


43 
äom
 
	gşs
.
	guts
.
dœli¡
 
impÜt
 
	gdœli¡


44 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


45 
äom
 
	gşs
.
	guts
.
diù_uts
 
impÜt
 
	gdù_g‘
, 
	gdù_put
, 
	gdù_m”ge


46 
äom
 
	gşs
.
	g­p_d©a
.
deçuÉs
 
impÜt
 
	gDeçuÉs


47 
äom
 
	gşs
.
	gsÿÂšg
.
bioxasTy³s
 
impÜt
 
	g§m¶e_pos™iÚšg_modes
, 
	g§m¶e_fše_pos™iÚšg_modes
, 
	g’d¡©iÚ_id_ty³s


49 
impÜt
 
	gzmq


50 
äom
 
	gşs
.
	gz”omq
.
	g•ics
.
•ics_­i
 
	gimpÜt
 *

51 
äom
 
	gşs
.
	guts
.
jsÚ_th»ad§ve
 
impÜt
 
	gjsÚ_¡ršg_to_dù


52 
äom
 
	gşs
.
	g­pWidg‘s
.
g‘_mks_´j_»v
 
impÜt
 
	gg‘_mks_´ojeù_»v


53 #impÜˆ
sim¶ejsÚ
 
as
 
jsÚ


55 
	g__v”siÚ__
 = '1.0.0'

58 
BEAMLINE_NAME
 = '07ID-1'

59 
BEAMLINE_TYPE
 = 'BIOXAS'

60 
BEAMLINE_ENERGY_RANGE
 = (4.0, 18.5)

62 
	gUSE_ZMQ
 = 
F®£


65 
şass
 
	$dev_cÚfig_bioxas
(
dev_cÚfig_ba£
):

66 
def
 
	$__š™__
(
£lf
, 
¥Ïsh
=
NÚe
):

67 
	`su³r
(
dev_cÚfig_bioxas
, 
£lf
).
	`__š™__
()

68 
´št
 'Using BIOXAS DEVICES'

69 
£lf
.
b—mlše
 = 'BIOXAS Imaging 07ID1'

70 
£lf
.
ssÿn_»c_´fx
 = 'bioxas'

71 
£lf
.
es_id
 = 
’d¡©iÚ_id_ty³s
.
IMAG


72 
£lf
.
¥Ïsh
 = splash

73 
£lf
.
dÚe
 = 
F®£


74 #£lf.
tim”
 = 
QtCÜe
.
	`QTim”
()

75 #£lf.
tim”
.
timeout
.
	`cÚÃù
(
£lf
.
Ú_tim”
)

76 
£lf
.
	`š™_deviûs
()

77 
£lf
.
	`š™_´e£ts
()

78 #š™_po¢”_¢­shÙ_cbs(
£lf
.
deviûs
['POSITIONERS'])

81 
def
 
	$š™_´e£ts
(
£lf
):

82 #£lf.
deviûs
['PRESETS']['MAX_SCAN_RANGE_X'] = 98

83 #£lf.
deviûs
['PRESETS']['MAX_SCAN_RANGE_Y'] = 98

85 
£lf
.
deviûs
['PRESETS']['MAX_SCAN_RANGE_X'] = 70

86 
£lf
.
deviûs
['PRESETS']['MAX_SCAN_RANGE_Y'] = 70

88 
£lf
.
deviûs
['PRESETS']['MAX_ZP_SCAN_RANGE_X'] = 98

89 
£lf
.
deviûs
['PRESETS']['MAX_ZP_SCAN_RANGE_Y'] = 98

91 #fÜ 
now


92 #£lf.
deviûs
['PRESETS']['MAX_ZP_SCAN_RANGE_X'] = 11

93 #£lf.
deviûs
['PRESETS']['MAX_ZP_SCAN_RANGE_Y'] = 11

95 
£lf
.
deviûs
['PRESETS']['MAX_ZP_SUBSCAN_RANGE_X'] = 98

96 
£lf
.
deviûs
['PRESETS']['MAX_ZP_SUBSCAN_RANGE_Y'] = 98

98 #£lf.
deviûs
['PVS']['EÃrgy_’abË'].
	`put
(0)

101 
def
 
	$š™_deviûs
(
£lf
):

103 #I 
dÚ
't have‡nƒlegant way yeto createhese‡nd‡lsoƒmit‡ signalohe splash screen

104 #sØ
this
 
is
 
a
 
fœ¡
 
©‹m±


105 #£lf.
tim”
.
	`¡¬t
(100)

106 #m­ 
Çmes
 
to
 
deviû
 
objeùs


107 #£lf.
deviûs
['POSITIONERS'][
DNM_SAMPLE_FINE_X
] = 
	`­sMÙÜ
('IOC:m100',
pos_£t
=
POS_TYPE_ES
)

108 #£lf.
deviûs
['POSITIONERS'][
DNM_SAMPLE_FINE_Y
] = 
	`­sMÙÜ
('IOC:m101',
pos_£t
=
POS_TYPE_ES
)

109 
´fx
 = 
£lf
.
ssÿn_»c_´fx


111 
£lf
.
deviûs
['POSITIONERS'][
DNM_PFIL1607_5_I10_01
] = 
	`­sMÙÜ
('BIOXAS:m100',
pos_£t
=
POS_TYPE_ES
)

112 
£lf
.
deviûs
['POSITIONERS'][
DNM_PFIL1607_5_I10_02
] = 
	`­sMÙÜ
('BIOXAS:m101',
pos_£t
=
POS_TYPE_ES
)

114 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M1_VERT_PªdR_IN_UP
] = 
	`­sMÙÜ
('BIOXAS:m102',
pos_£t
=
POS_TYPE_ES
)

115 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M1_VERT_PªdR_OUT_UP
 ] = 
	`­sMÙÜ
('BIOXAS:m103',
pos_£t
=
POS_TYPE_ES
)

116 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M1_VERT_PªdR_DOWN
] = 
	`­sMÙÜ
('BIOXAS:m104',
pos_£t
=
POS_TYPE_ES
)

117 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M1_HORZ_STRIPE_SEL
] = 
	`­sMÙÜ
('BIOXAS:m105',
pos_£t
=
POS_TYPE_ES
)

118 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M1_YAW
] = 
	`­sMÙÜ
('BIOXAS:m106',
pos_£t
=
POS_TYPE_ES
)

119 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M1_BENDER_UPSTREAM
] = 
	`­sMÙÜ
('BIOXAS:m107',
pos_£t
=
POS_TYPE_ES
)

120 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M1_BENDER_DOWNSTREAM
] = 
	`­sMÙÜ
('BIOXAS:m108',
pos_£t
=
POS_TYPE_ES
)

122 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M2_VERT_PªdR_IN_UP
] = 
	`­sMÙÜ
('BIOXAS:m109',
pos_£t
=
POS_TYPE_ES
)

123 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M2_VERT_PªdR_OUT_UP
] = 
	`­sMÙÜ
('BIOXAS:m110',
pos_£t
=
POS_TYPE_ES
)

124 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M2_VERT_PªdR_DOWN
] = 
	`­sMÙÜ
('BIOXAS:m111',
pos_£t
=
POS_TYPE_ES
)

125 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M2_HORZ_STRIPE_SEL
] = 
	`­sMÙÜ
('BIOXAS:m112',
pos_£t
=
POS_TYPE_ES
)

126 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M2_YAW
] = 
	`­sMÙÜ
('BIOXAS:m113',
pos_£t
=
POS_TYPE_ES
)

127 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M2_BENDER_UPSTREAM
] = 
	`­sMÙÜ
('BIOXAS:m114',
pos_£t
=
POS_TYPE_ES
)

128 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_M2_BENDER_DOWNSTREAM
] = 
	`­sMÙÜ
('BIOXAS:m115',
pos_£t
=
POS_TYPE_ES
)

129 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_MONO_BRAGG
] = 
	`­sMÙÜ
('BIOXAS:m116',
pos_£t
=
POS_TYPE_ES
)

131 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_VM_UPPER_BLADE
] = 
	`­sMÙÜ
('BIOXAS:m117',
pos_£t
=
POS_TYPE_ES
)

132 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_VM_LOWER_BLADE
] = 
	`­sMÙÜ
('BIOXAS:m118',
pos_£t
=
POS_TYPE_ES
)

133 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_MONO_CRYSTAL_2_Z2
] = 
	`­sMÙÜ
('BIOXAS:m119',
pos_£t
=
POS_TYPE_ES
)

134 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_MONO_CRYSTAL_2_Y2
] = 
	`­sMÙÜ
('BIOXAS:m120',
pos_£t
=
POS_TYPE_ES
)

135 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_MONO_CRYSTAL_2_Th‘a2
] = 
	`­sMÙÜ
('BIOXAS:m121',
pos_£t
=
POS_TYPE_ES
)

136 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_MONO_CRYSTAL_2_CHI_2
] = 
	`­sMÙÜ
('BIOXAS:m122',
pos_£t
=
POS_TYPE_ES
)

137 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_MONO_TABLE_VERT_Y
] = 
	`­sMÙÜ
('BIOXAS:m123',
pos_£t
=
POS_TYPE_ES
)

138 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_MONO_TABLE_HORZ_X
 ] = 
	`­sMÙÜ
('BIOXAS:m124',
pos_£t
=
POS_TYPE_ES
)

140 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_TABLE_VERTICAL_1
] = 
	`­sMÙÜ
('BIOXAS:m125',
pos_£t
=
POS_TYPE_ES
)

141 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_TABLE_VERTICAL_2
] = 
	`­sMÙÜ
('BIOXAS:m126',
pos_£t
=
POS_TYPE_ES
)

142 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_TABLE_VERTICAL_3
] = 
	`­sMÙÜ
('BIOXAS:m127',
pos_£t
=
POS_TYPE_ES
)

143 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_TABLE_HORIZONTAL_1
] = 
	`­sMÙÜ
('BIOXAS:m128',
pos_£t
=
POS_TYPE_ES
)

144 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_TABLE_HORIZONTAL_2
] = 
	`­sMÙÜ
('BIOXAS:m129',
pos_£t
=
POS_TYPE_ES
)

146 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_JJ_SLIT_US_VERT_GAP
] = 
	`­sMÙÜ
('BIOXAS:m130',
pos_£t
=
POS_TYPE_ES
)

147 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_JJ_SLIT_US_VERT_CENTER
] = 
	`­sMÙÜ
('BIOXAS:m131',
pos_£t
=
POS_TYPE_ES
)

148 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_JJ_SLIT_US_HOR_GAP
] = 
	`­sMÙÜ
('BIOXAS:m132',
pos_£t
=
POS_TYPE_ES
)

149 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_JJ_SLIT_US_HOR_CENTER
] = 
	`­sMÙÜ
('BIOXAS:m133',
pos_£t
=
POS_TYPE_ES
)

150 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_HORIZ_KB_BENDER_1
] = 
	`­sMÙÜ
('BIOXAS:m134',
pos_£t
=
POS_TYPE_ES
)

151 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_HORIZ_KB_BENDER_2
] = 
	`­sMÙÜ
('BIOXAS:m135',
pos_£t
=
POS_TYPE_ES
)

152 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_HORIZ_KB_VERTICAL
] = 
	`­sMÙÜ
('BIOXAS:m136',
pos_£t
=
POS_TYPE_ES
)

153 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_HORIZ_KB_TILT
] = 
	`­sMÙÜ
('BIOXAS:m137',
pos_£t
=
POS_TYPE_ES
)

155 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_VERT_KB_BENDER_1
] = 
	`­sMÙÜ
('BIOXAS:m138',
pos_£t
=
POS_TYPE_ES
)

156 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_VERT_KB_BENDER_2
] = 
	`­sMÙÜ
('BIOXAS:m139',
pos_£t
=
POS_TYPE_ES
)

157 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_VERT_KB_VERTICAL
] = 
	`­sMÙÜ
('BIOXAS:m140',
pos_£t
=
POS_TYPE_ES
)

158 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_VERT_KB_TILT
] = 
	`­sMÙÜ
('BIOXAS:m141',
pos_£t
=
POS_TYPE_ES
)

159 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_DETECTOR_1_VERTICAL
] = 
	`­sMÙÜ
('BIOXAS:m142',
pos_£t
=
POS_TYPE_ES
)

160 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_DETECTOR_1_LATERAL
] = 
	`­sMÙÜ
('BIOXAS:m143',
pos_£t
=
POS_TYPE_ES
)

161 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_DETECTOR_2_VERTICAL
] = 
	`­sMÙÜ
('BIOXAS:m144',
pos_£t
=
POS_TYPE_ES
)

162 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_DETECTOR_2_LATERAL
] = 
	`­sMÙÜ
('BIOXAS:m145',
pos_£t
=
POS_TYPE_ES
)

164 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_SAMPLE_ROTARY_STAGE
] = 
	`­sMÙÜ
('BIOXAS:m146',
pos_£t
=
POS_TYPE_ES
)

165 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_ZONE_PLATE_X
] = 
	`­sMÙÜ
('BIOXAS:m147',
pos_£t
=
POS_TYPE_ES
)

166 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_ZONE_PLATE_Y
] = 
	`­sMÙÜ
('BIOXAS:m148',
pos_£t
=
POS_TYPE_ES
)

167 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_ZONE_PLATE_Z
] = 
	`­sMÙÜ
('BIOXAS:m149',
pos_£t
=
POS_TYPE_ES
)

168 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_ZONE_PLATE_PITCH
] = 
	`­sMÙÜ
('BIOXAS:m150',
pos_£t
=
POS_TYPE_ES
)

169 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_ZONE_PLATE_YAW
] = 
	`­sMÙÜ
('BIOXAS:m151',
pos_£t
=
POS_TYPE_ES
)

170 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_OPTICAL_SAMPLE_VERT
 ] = 
	`­sMÙÜ
('BIOXAS:m152',
pos_£t
=
POS_TYPE_ES
)

172 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_JJ_SLIT_DS_VERT_GAP
] = 
	`­sMÙÜ
('BIOXAS:m153',
pos_£t
=
POS_TYPE_ES
)

173 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_JJ_SLIT_DS_VERT_CENTER
] = 
	`­sMÙÜ
('BIOXAS:m154',
pos_£t
=
POS_TYPE_ES
)

174 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_JJ_SLIT_DS_HOR_GAP
] = 
	`­sMÙÜ
('BIOXAS:m155',
pos_£t
=
POS_TYPE_ES
)

175 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_JJ_SLIT_DS_HOR_CENTER
] = 
	`­sMÙÜ
('BIOXAS:m156',
pos_£t
=
POS_TYPE_ES
)

176 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_MACRO_STAGE_UP_DOWN
] = 
	`­sMÙÜ
('BIOXAS:m157',
pos_£t
=
POS_TYPE_ES
)

177 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_MACRO_STAGE_HORIZ
] = 
	`­sMÙÜ
('BIOXAS:m158',
pos_£t
=
POS_TYPE_ES
)

178 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_MACRO_STAGE_VERT
] = 
	`­sMÙÜ
('BIOXAS:m159',
pos_£t
=
POS_TYPE_ES
)

179 
£lf
.
deviûs
['POSITIONERS'][
DNM_IMAG_VISUALIZATION_VERT
] = 
	`­sMÙÜ
('BIOXAS:m160',
pos_£t
=
POS_TYPE_ES
)

183 
	`cÚÃù_¡ªd¬d_b—mlše_pos™iÚ”s
(
£lf
.
deviûs
, 
´fx
)

184 
	`cÚÃù_deviûs
(
£lf
.
deviûs
, 
´fx
)

186 #key, 
v®ue
 
š
 
£lf
.
deviûs
.
	`™”™ems
():

187 #´šˆ
key
,
v®ue


188 
´št
 'finished connectingo devices'

189 
£lf
.
dÚe
 = 
True


191 
def
 
	`cÚÃù_¡ªd¬d_b—mlše_pos™iÚ”s
(
dev_dù
, 
´fx
='bioxas'):

194 #dev_dù['POSITIONERS'][
DNM_ENERGY
] = 
	`­sMÙÜ
('BL1607-I10:ENERGY',
pos_£t
=
POS_TYPE_ES
)

195 #dev_dù['POSITIONERS'][
DNM_SLIT_X
] = 
	`­sMÙÜ
('BL1607-I10:¦™X',
pos_£t
=
POS_TYPE_BL
)

196 #dev_dù['POSITIONERS'][
DNM_SLIT_Y
] = 
	`­sMÙÜ
('BL1607-I10:¦™Y',
pos_£t
=
POS_TYPE_BL
)

197 #dev_dù['POSITIONERS'][
DNM_M3_PITCH
] = 
	`­sMÙÜ
('BL1607-I10:m3STXMP™ch',
pos_£t
=
POS_TYPE_BL
)

198 #dev_dù['POSITIONERS'][
DNM_EPU_GAP
] = 
	`­sMÙÜ
('BL1607-I10:•uG­',
pos_£t
=
POS_TYPE_BL
)

199 #dev_dù['POSITIONERS'][
DNM_EPU_OFFSET
] = 
	`­sMÙÜ
('BL1607-I10:•uOff£t',
pos_£t
=
POS_TYPE_BL
)

200 #dev_dù['POSITIONERS'][
DNM_EPU_HARMONIC
] = 
	`­sMÙÜ
('BL1607-I10:•uH¬mÚic',
pos_£t
=
POS_TYPE_BL
)

201 #dev_dù['POSITIONERS'][
DNM_EPU_POLARIZATION
] = 
	`­sMÙÜ
('BL1607-I10:•uPŞ¬iz©iÚ',
pos_£t
=
POS_TYPE_BL
)

202 #dev_dù['POSITIONERS'][
DNM_EPU_ANGLE
] = 
	`­sMÙÜ
('BL1607-I10:•uAngË',
pos_£t
=
POS_TYPE_BL
)

204 
def
 
	`cÚÃù_deviûs
(
dev_dù
, 
´fx
='bioxas'):

206 
PVS
: 
sšguÏr
 
PV
 
cÚÃùiÚs


207 
DETECTORS
: 
deviûs
 
th©
  
d©a


208 
SSCANS
:

209 
PVS_DONT_RECORD
:

210 
TEMPERATURES
:

211 
PRESSURES
:

216 
dev_dù
['PVS']['SYSTEM:mode:fbk'] = 
	`EpicsPv
('SYSTEM:mode:fbk')

217 
dev_dù
['PVS_DONT_RECORD']['tick”'] = 
	`EpicsPv
('TRG2400:cycles')

218 
dev_dù
['PVS']['SRStus_shu‰”s'] = 
	`EpicsPv
('SRStatus:shutters')

220 
dev_dù
['DETECTORS']['StÜageRšgCu¼’t'] = 
	`EpicsPv
('PCT1402-01:mA:fbk')

222 #dev_dù['DIO'][
DNM_GATE
] = 
	`Ba£G©e
('%sCO:g©e' % 
´fx
)

223 #dev_dù['DIO'][
DNM_SHUTTER
] = 
	`PvShu‰”
('%sDIO:shu‰”:ùl' % 
´fx
)

224 #dev_dù['DIO']['Shu‰”TaskRun'] = 
	`EpicsPv
('%sDIO:shu‰”:Run' % 
´fx
)

225 #
#dev_dù['DETECTORS'][
DNM_COUNTER_APD
] = 
	`Ba£CouÁ”
('%sCI:couÁ”' % 
´fx
)

226 ##
dev_dù
['DETECTORS']['D‘_CÁr'] = 
	`EpicsPvCouÁ”
('%sPMT:ùr:SšgËV®ue_RBV' % 
´fx
)

227 #dev_dù['DETECTORS'][
DNM_PMT
] = 
	`EpicsPv
('%sPMT:ùr:SšgËV®ue_RBV' % 
´fx
)

228 #
#dev_dù['DETECTORS_NO_RECORD']['D‘CÁr_SÇpshÙ'] = 
	`EpicsPvCouÁ”
('%sPMT:d‘_¢­shÙ_RBV' % 
´fx
)

229 #dev_dù['DETECTORS_NO_RECORD']['O§CÁr_SÇpshÙ'] = 
	`EpicsPvCouÁ”
('%sPMT:o§_¢­shÙ_RBV' % 
´fx
)

230 #
#dev_dù['PVS']['Id—l_A0'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:zp:fbk:Œ.K' % 
´fx
)

231 #dev_dù['PVS']['C®cd_Zpz'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:zp:fbk:Œ.L' % 
´fx
)

232 #
#dev_dù['PVS']['Zpz_sÿnModeFÏg'] = 
	`Mbbo
('BL1607-I10:ENERGY:%s:zp:sÿn£læag' % 
´fx
è#u£d 
to
 
cÚŒŞ
 
which
 
v®ue
 
g‘s
 
£Á
Ø
Zpz
, 
æ
 
Ü
 fÈ- 
A0


233 ##
u£d
 
to
 
adju¡
 
the
 
cu¼’t
 
focus
 
v®ue
,h
d–
 
»´e£Ás
h
»Ïtive
 
miüÚs
 
zpz
Ø
move
Ø
Ãw
 focu 
pos™iÚ


234 #dev_dù['PVS']['D–_Zpz'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:d–_zpz' % 
´fx
)

235 #dev_dù['PVS']['Foÿl_L’gth'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:zp:FL' % 
´fx
)

236 #dev_dù['PVS']['A0'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:A0' % 
´fx
)

237 #dev_dù['PVS']['A0Max'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:A0Max' % 
´fx
)

238 #
#dev_dù['PVS']['Zpz_pos'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:zp:zpz_pos' % 
´fx
)

239 #dev_dù['PVS']['Zp_def'] = 
	`T¿nsfÜm
('BL1607-I10:ENERGY:%s:zp:def' % 
´fx
)

240 #dev_dù['PVS']['OSA_def'] = 
	`T¿nsfÜm
('BL1607-I10:ENERGY:%s:o§:def' % 
´fx
)

241 #
#dev_dù['PVS']['Zp_£Ëù'] = 
	`Mbbo
('BL1607-I10:ENERGY:%s:zp' % 
´fx
)

242 #dev_dù['PVS']['OSA_£Ëù'] = 
	`Mbbo
('BL1607-I10:ENERGY:%s:o§' % 
´fx
)

243 #
#dev_dù['PVS']['EÃrgy_’abË'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:’abËd' % 
´fx
)

244 #dev_dù['PVS']['ENERGY_RBV'] = 
	`EpicsPv
('BL1607-I10:ENERGY.RBV')

245 #dev_dù['PVS']['Zp_def.A'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:zp:def.A' % 
´fx
)

246 #
#
#dev_dù['PVS']['Zp_def1_A'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:zp1:def.A' % 
´fx
)

247 #dev_dù['PVS']['Zp_def2_A'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:zp2:def.A' % 
´fx
)

248 #dev_dù['PVS']['Zp_def3_A'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:zp3:def.A' % 
´fx
)

249 #dev_dù['PVS']['Zp_def4_A'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:zp4:def.A' % 
´fx
)

250 #dev_dù['PVS']['Zp_def5_A'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:zp5:def.A' % 
´fx
)

251 #
##
dev_dù
['PVS']['SRStus_msgL1'] = 
	`EpicsPv
('SRStatus:msg:tL1')

252 ##
dev_dù
['PVS']['SRStus_msgL2'] = 
	`EpicsPv
('SRStatus:msg:tL2')

253 ##
dev_dù
['PVS']['SRStus_msgL3'] = 
	`EpicsPv
('SRStatus:msg:tL3')

254 #
#
#dev_dù['PVS']['MÚo_ev_fbk'] = 
	`EpicsPv
('MONO1610-I10-01:energy:fbk')

255 #dev_dù['PVS']['Epu_pŞ_fbk'] = 
	`Mbbi
('UND1410-01:polarization')

256 #dev_dù['PVS']['Epu_pŞ_ªgË'] = 
	`EpicsPv
('UND1410-01:polarAngle')

257 #dev_dù['PVS']['Epu_g­_fbk'] = 
	`EpicsPv
('UND1410-01:gap:mm:fbk')

258 #dev_dù['PVS']['Epu_g­_off£t'] = 
	`EpicsPv
('UND1410-01:gap:offset')

259 #dev_dù['PVS']['Epu_h¬mÚic'] = 
	`EpicsPv
('UND1410-01:harmonic')

260 #
#
#
#dev_dù['PVS_DONT_RECORD']['CX_auto_di§bË_pow”'] = 
	`EpicsPv
('IOC:m112:XPS_AUTO_DISABLE_MODE')

261 #dev_dù['PVS_DONT_RECORD']['CY_auto_di§bË_pow”'] = 
	`EpicsPv
('IOC:m113:XPS_AUTO_DISABLE_MODE')

262 #dev_dù['PVS_DONT_RECORD']['DX_auto_di§bË_pow”'] = 
	`EpicsPv
('IOC:m114:XPS_AUTO_DISABLE_MODE')

263 #dev_dù['PVS_DONT_RECORD']['DY_auto_di§bË_pow”'] = 
	`EpicsPv
('IOC:m115:XPS_AUTO_DISABLE_MODE')

264 #
#dev_dù['PVS_DONT_RECORD']['accRªge'] = 
	`EpicsPv
('uhvTestSIG:signal:MaxPoints')

265 #
#dev_dù['PVS_DONT_RECORD']['FX_fÜû_dÚe'] = 
	`EpicsPv
('IOC:m100:ForceDone')

266 #dev_dù['PVS_DONT_RECORD']['FY_fÜû_dÚe'] = 
	`EpicsPv
('IOC:m101:ForceDone')

267 #
#dev_dù['PVS_DONT_RECORD']['OX_fÜû_dÚe'] = 
	`EpicsPv
('IOC:m104:ForceDone')

268 #dev_dù['PVS_DONT_RECORD']['OY_fÜû_dÚe'] = 
	`EpicsPv
('IOC:m105:ForceDone')

269 #
#dev_dù['PVS_DONT_RECORD']['OX_Œackšg_’abËd'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:o§x_Œack_’abËd' % 
´fx
)

270 #dev_dù['PVS_DONT_RECORD']['OY_Œackšg_’abËd'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:o§y_Œack_’abËd' % 
´fx
)

271 #dev_dù['PVS_DONT_RECORD']['OZ_Œackšg_’abËd'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:o§z_Œack_’abËd' % 
´fx
)

272 #
#dev_dù['PVS_DONT_RECORD']['OSAXYZ_lockpos™iÚ_’abËd'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:o§xyz_lockpos_’abËd' % 
´fx
)

273 #
#dev_dù['PVS_DONT_RECORD']['OSAXY_gÙo_lockpos™iÚ'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:o§xy_gÙo_lockpos' % 
´fx
)

274 #dev_dù['PVS_DONT_RECORD']['OSAZ_gÙo_lockpos™iÚ'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:o§z_gÙo_lockpos' % 
´fx
)

275 #
#dev_dù['PVS_DONT_RECORD']['S‘_XY_lockpos™iÚ'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:£t_xy:lock_po¢' % 
´fx
)

276 #dev_dù['PVS_DONT_RECORD']['S‘_Z_lockpos™iÚ'] = 
	`EpicsPv
('BL1607-I10:ENERGY:%s:£t_z:lock_po¢' % 
´fx
)

278 #fÜ 
POL
, 
OFF
 
ªd
 
ANGLE


279 
dev_dù
['PVS_DONT_RECORD']['%s:image:cmd_fe' % 
´fx
] = 
	`EpicsPv
('%s:image:cmd_file' %…rfx)

280 
dev_dù
['PVS_DONT_RECORD']['%s:image:³rûÁDÚe' % 
´fx
] = 
	`EpicsPv
('%s:image:percentDone' %…rfx)

281 
dev_dù
['PVS_DONT_RECORD']['%s:image:sšgË_´og»ss' % 
´fx
] = 
	`EpicsPv
('%s:image:single_progress' %…rfx)

283 
dev_dù
['PVS_DONT_RECORD']['%s:image:»maššgTimeSŒ' % 
´fx
] = 
	`EpicsPv
('%s:image:remainingTimeStr' %…rfx)

284 
dev_dù
['PVS_DONT_RECORD']['%s:image:’dšgTimeSŒ' % 
´fx
] = 
	`EpicsPv
('%s:image:endingTimeStr' %…rfx)

285 
dev_dù
['PVS_DONT_RECORD']['%s:image:tÙ®EÏp£dTimeSŒ' % 
´fx
] = 
	`EpicsPv
('%s:image:totalElapsedTimeStr' %…rfx)

288 
dev_dù
['SSCANS']['%s:image:sÿn1' % 
´fx
] = 
	`Sÿn
('%s:image:scan1' %…rfx)

289 
dev_dù
['SSCANS']['%s:image:sÿn2' % 
´fx
] = 
	`Sÿn
('%s:image:scan2' %…rfx)

290 
dev_dù
['SSCANS']['%s:image:sÿn3' % 
´fx
] = 
	`Sÿn
('%s:image:scan3' %…rfx)

291 
dev_dù
['SSCANS']['%s:image:sÿn4' % 
´fx
] = 
	`Sÿn
('%s:image:scan4' %…rfx)

292 
dev_dù
['SSCANS']['%s:image:sÿn5' % 
´fx
] = 
	`Sÿn
('%s:image:scan5' %…rfx)

296 #ES = 
’d¡©iÚ
 
‹m³¿tu»s


297 #dev_dù['TEMPERATURES'][
POS_TYPE_ES
]['TM1610-3-I12-01'] = 
	`ai
('TM1610-3-I12-01', 
desc
='Turbo cooling water')

298 #dev_dù['TEMPERATURES'][
POS_TYPE_ES
]['TM1610-3-I12-30'] = 
	`ai
('TM1610-3-I12-30', 
desc
='Sample Coarse Y')

299 #dev_dù['TEMPERATURES'][
POS_TYPE_ES
]['TM1610-3-I12-32'] = 
	`ai
('TM1610-3-I12-32', 
desc
='Detector Y')

300 #dev_dù['TEMPERATURES'][
POS_TYPE_ES
]['TM1610-3-I12-21'] = 
	`ai
('TM1610-3-I12-21', 
desc
='Chamberemp #1')

301 #dev_dù['TEMPERATURES'][
POS_TYPE_ES
]['TM1610-3-I12-22'] = 
	`ai
('TM1610-3-I12-22', 
desc
='Chamberemp #2')

302 #dev_dù['TEMPERATURES'][
POS_TYPE_ES
]['TM1610-3-I12-23'] = 
	`ai
('TM1610-3-I12-23', 
desc
='Chamberemp #3')

303 #dev_dù['TEMPERATURES'][
POS_TYPE_ES
]['TM1610-3-I12-24'] = 
	`ai
('TM1610-3-I12-24', 
desc
='Chamberemp #4')

304 #
#
##
´essu»s


305 #dev_dù['PRESSURES'][
POS_TYPE_ES
]['FRG1610-3-I12-01:vac:p'] = 
	`ai
('FRG1610-3-I12-01:vac:p', 
desc
='Chamber…ressure')

306 #dev_dù['PRESSURES'][
POS_TYPE_ES
]['TCG1610-3-I12-03:vac:p'] = 
	`ai
('TCG1610-3-I12-03:vac:p', 
desc
='Turbo backing…ressure')

307 #dev_dù['PRESSURES'][
POS_TYPE_ES
]['TCG1610-3-I12-04:vac:p'] = 
	`ai
('TCG1610-3-I12-04:vac:p', 
desc
='Load†ock…ressure')

308 #dev_dù['PRESSURES'][
POS_TYPE_ES
]['TCG1610-3-I12-05:vac:p'] = 
	`ai
('TCG1610-3-I12-05:vac:p', 
desc
='Rough†ine…ressure')

310 
	`cÚÃù_ES_deviûs
(
dev_dù
, 
´fx
)

311 
	`cÚÃù_BL_deviûs
(
dev_dù
, 
´fx
)

314 
def
 
	`cÚÃù_ES_deviûs
(
dev_dù
, 
´fx
='bioxas'):

316 #if(
´fx
.
	`fšd
('uhv') > -1):

317 #dev_dù['TEMPERATURES'][
POS_TYPE_ES
]['CCTL1610-I10:‹mp:fbk'] = 
	`ai
('CCTL1610-I10:‹mp:fbk', 
desc
='Gatan„odemp')

321 
def
 
	`cÚÃù_BL_deviûs
(
dev_dù
, 
´fx
='bioxas'):

324 
MAIN_OBJ
 = 
NÚe


325 
DEVICE_CFG
 = 
NÚe


327 
MAIN_OBJ
 = 
	`maš_objeù_ba£
('CLS BioXAS 07ID1','IMAG')

328 
MAIN_OBJ
.
	`£t_§m¶e_pos™iÚšg_mode
(
§m¶e_pos™iÚšg_modes
.
GONIOMETER
)

329 
MAIN_OBJ
.
	`£t_fše_§m¶e_pos™iÚšg_mode
(
§m¶e_fše_pos™iÚšg_modes
.
ZONEPLATE
)

331 
MAIN_OBJ
.
	`£t_d©afe_´efix
('I')

332 
MAIN_OBJ
.
	`£t_thumbfe_suffix
('jpg')

333 
DEVICE_CFG
 = 
	`dev_cÚfig_bioxas
()

334 
MAIN_OBJ
.
	`£t_deviûs
(
DEVICE_CFG
)

335 
DEFAULTS
 = 
	`DeçuÉs
('bioxas_dæts.jsÚ', 
Ãw
=
True
)

339 
__Çme__
 == '__main__':

	@counters.ini

1 [
DEFAULT
]

2 
	gtİ
 = 
C
:/
cÚŒŞs
/
g™_»po
/
§ndbox
/
py2
.7/
şs
/
¶ÙWidg‘s
/
¡rtoŞ


3 
dœ¦ash
=/

4 
­pDœ
 = %(
tİ
)
s
/

5 
d©aDœ
 = %(
tİ
)
s
/
d©a


6 
uiDœ
 = %(
­pDœ
)
s
/
ui


7 
cfgDœ
 = %(
­pDœ
)
s
/
cfgs


8 
autoSaveD©a
 = 
Œue


10 [
PV
]

11 #pvLi¡ = 
uhvPMT
:
ùr
:
SšgËV®ue_RBV


12 
pvLi¡
 = 
ambPMT
:
ùr
:SingleValue_RBV

	@data/__init__.py

	@data/__init__.py

	@data/bioxas_im_data_io.py

2 
C»©ed
 
Ú
 
	gFeb
 13, 2017

4 @
	gauthÜ
: 
b”gr


7 
äom
 
şs
.
uts
.
log
 
impÜt
 
g‘_moduË_logg”


8 
äom
 
şs
.
sÿÂšg
.
d©aRecÜd”
 
impÜt
 
D©aIo


9 
äom
 
şs
.
sÿÂšg
.
Ãxus
.
nx¡xm
 
impÜt
 
g‘_NXd©as_äom_’Œy
, 
	gg‘_wdg_com_äom_’Œy
, 
	gg‘_d©a_äom_NXd©as
, 
	gupd©e_d©a_w™h_İ’şo£


11 
	g_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

13 
şass
 
	$BioxasD©aIo
(
D©aIo
):

15 
A
 
şass
 
to
 
’ÿpsuÏ‹
 
the
 
š‹rçû
 
b‘w“n
h
­¶iÿtiÚ
 
ªd
h
d©a
 
Ú
 
disk
 
th©
 
is
 
¥ecific


16 
to
 
STXM
 
d©a
, 
ªy
 
¥ecifics
 
should
 
ov”ride
 
the
 
D©aIo
 
defš™iÚs
 
h”e


19 
def
 
	$__š™__
(
£lf
, 
d©a_dœ
, 
fe_´efix
):

20 
İtiÚs
={'¡ªd¬d': 'Ãxus', 'def': 'nxxas'
	}
}

21 
su³r
(
BioxasD©aIo
, 
£lf
).
__š™__
(
d©a_dœ
, 
fe_´efix
, 
İtiÚs
=options)

23 
def
 
	$g‘_d©a_äom_NXd©as
(
£lf
, 
nx_d©as
, 
couÁ”_Çme
):

25 
d©a
 = 
	`g‘_d©a_äom_NXd©as
(
nx_d©as
, 
couÁ”_Çme
)

26 (
d©a
)

28 
def
 
	$g‘_NXd©as_äom_’Œy
(
£lf
, 
’Œy_dù
, 
’Œy_Çme
):

30 
d©a
 = 
	`g‘_NXd©as_äom_’Œy
(
’Œy_dù
, 
’Œy_nm
=
’Œy_Çme
)

31 (
d©a
)

33 
def
 
	$g‘_wdg_com_äom_’Œy
(
£lf
, 
’Œy_dù
, 
’Œy_Çme
):

35 
wdg_com
 = 
	`g‘_wdg_com_äom_’Œy
(
’Œy_dù
, 
’Œy_nm
=
’Œy_Çme
)

36 (
wdg_com
)

38 
def
 
	$upd©e_d©a_Úly
(
£lf
, 
d©a_dù
):

40 
ÿÎ
:

41 
impÜ‹r
.
	`upd©e
()

43 if(
d©a_dù
['ID'] != 'ACTIVE_DATA_DICT'):

44 
_logg”
.
	`”rÜ
('Inv®id d©¨diùiÚ¬yy³ [%s] should bty³ ACTIVE_DATA_DICT' % 
d©a_dù
['ID'])

45 
”r
 = 
NÚe


46 if(
£lf
.
d©a_io
 
is
 
nÙ
 
NÚe
):

47 
”r
 = 
£lf
.
d©a_io
.
	`upd©e
(
d©a_dù
)

48 (
”r
)

50 
def
 
	`upd©e_d©a
(
£lf
, 
’Œy
, 
d©a
, 
couÁ”
='couÁ”0', 
u£_tmpfe
=
F®£
):

51 if(
£lf
.
d©a_io
 
is
 
nÙ
 
NÚe
):

52 
£lf
.
d©a_io
.
	`upd©e_d©a
(
’Œy
, 
d©a
, 
couÁ”
=couÁ”, 
u£_tmpfe
=use_tmpfile)

54 
def
 
	$g‘_axes_li¡_äom_NXd©a
(
£lf
, 
nx_d©as
, 
couÁ”_Çme
):

56 
	$g‘_axes_li¡_äom_NXd©a
(): 
cÚv’›nû
 
funùiÚ
 
to
 
puÎ
 
the
 
axes
 
li¡
 
š
he

57 
Üd”
 
th©
 
they
 
w”e
 
wr™‹n
 
ªd
  
™


59 :
·¿m
 
nx_d©as
: 
a
 
diù
 
th©
 
is
 
»tuºed
 
äom
‡ 
ÿÎ
 
to
 
	`g‘_NXd©as_äom_’Œy
()

60 :
ty³
 
nx_d©as
: 
diù


62 :
·¿m
 
couÁ”_Çme
: 
Çme
 
of
 
couÁ”
 
š
 
the
 
nx_d©as
 
diù


63 :
ty³
 
couÁ”_Çme
: 
¡ršg


65 :
»tuºs
: 
a
 
li¡
 
of
 
axes
 
Çmes


67 
axes
 = 
nx_d©as
[
couÁ”_Çme
]['axes']

68 (
axes
)

70 
def
 
	$g‘_axes_d©a_by_šdex_š_NXd©a
(
£lf
, 
nx_d©as
, 
couÁ”_Çme
, 
šdex
):

72 
	$g‘_axes_d©a_by_šdex_š_NXd©a
(): 
cÚv’›nû
 
funùiÚ
 
to
 
puÎ
 
the
 
d©a
 
äom


73 
ª
 
šdex
 
što
 
the
 
li¡
 
v”siÚ
 
of
h
d©a
 
found
 
š
h
NXd©as
 
diù


75 :
·¿m
 
nx_d©as
: 
a
 
diù
 
th©
 
is
 
»tuºed
 
äom
‡ 
ÿÎ
 
to
 
	`g‘_NXd©as_äom_’Œy
()

76 :
ty³
 
nx_d©as
: 
diù


78 :
·¿m
 
couÁ”_Çme
: 
Çme
 
of
 
couÁ”
 
š
 
the
 
nx_d©as
 
diù


79 :
ty³
 
couÁ”_Çme
: 
¡ršg


81 :
·¿m
 
šdex
: index 
što
 
the
 
li¡
 
of
 
d©a


82 :
ty³
 
šdex
: 
š‹g”


84 :
»tuºs
: 
¬¿y
 
of
 
d©a


86 
d©a
 = 
nx_d©as
[
couÁ”_Çme
]['axes_d©a'][
šdex
]

87 (
d©a
)

89 
def
 
	$g‘_sigÇl_d©a_äom_NXd©a
(
£lf
, 
nx_d©as
, 
couÁ”_Çme
):

91 
	$g‘_sigÇl_d©a_äom_NXd©a
(): 
cÚv’›nû
 
funùiÚ
 
to
 
puÎ
 
the
 
sigÇl
 
d©a
 
äom


92 
the
 
d©a
 
found
 
š
h
NXd©as
 
diù


94 :
·¿m
 
nx_d©as
: 
a
 
diù
 
th©
 
is
 
»tuºed
 
äom
‡ 
ÿÎ
 
to
 
	`g‘_NXd©as_äom_’Œy
()

95 :
ty³
 
nx_d©as
: 
diù


97 :
·¿m
 
couÁ”_Çme
: 
Çme
 
of
 
couÁ”
 
š
 
the
 
nx_d©as
 
diù


98 :
ty³
 
couÁ”_Çme
: 
¡ršg


100 :
»tuºs
: 
¬¿y
 
of
 
d©a


102 
d©a
 = 
nx_d©as
[
couÁ”_Çme
]['signal']

103 (
d©a
)

	@data/bioxas_im_data_io.py

2 
C»©ed
 
Ú
 
	gFeb
 13, 2017

4 @
	gauthÜ
: 
b”gr


7 
äom
 
şs
.
uts
.
log
 
impÜt
 
g‘_moduË_logg”


8 
äom
 
şs
.
sÿÂšg
.
d©aRecÜd”
 
impÜt
 
D©aIo


9 
äom
 
şs
.
sÿÂšg
.
Ãxus
.
nx¡xm
 
impÜt
 
g‘_NXd©as_äom_’Œy
, 
	gg‘_wdg_com_äom_’Œy
, 
	gg‘_d©a_äom_NXd©as
, 
	gupd©e_d©a_w™h_İ’şo£


11 
	g_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

13 
şass
 
	$BioxasD©aIo
(
D©aIo
):

15 
A
 
şass
 
to
 
’ÿpsuÏ‹
 
the
 
š‹rçû
 
b‘w“n
h
­¶iÿtiÚ
 
ªd
h
d©a
 
Ú
 
disk
 
th©
 
is
 
¥ecific


16 
to
 
STXM
 
d©a
, 
ªy
 
¥ecifics
 
should
 
ov”ride
 
the
 
D©aIo
 
defš™iÚs
 
h”e


19 
def
 
	$__š™__
(
£lf
, 
d©a_dœ
, 
fe_´efix
):

20 
İtiÚs
={'¡ªd¬d': 'Ãxus', 'def': 'nxxas'
	}
}

21 
su³r
(
BioxasD©aIo
, 
£lf
).
__š™__
(
d©a_dœ
, 
fe_´efix
, 
İtiÚs
=options)

23 
def
 
	$g‘_d©a_äom_NXd©as
(
£lf
, 
nx_d©as
, 
couÁ”_Çme
):

25 
d©a
 = 
	`g‘_d©a_äom_NXd©as
(
nx_d©as
, 
couÁ”_Çme
)

26 (
d©a
)

28 
def
 
	$g‘_NXd©as_äom_’Œy
(
£lf
, 
’Œy_dù
, 
’Œy_Çme
):

30 
d©a
 = 
	`g‘_NXd©as_äom_’Œy
(
’Œy_dù
, 
’Œy_nm
=
’Œy_Çme
)

31 (
d©a
)

33 
def
 
	$g‘_wdg_com_äom_’Œy
(
£lf
, 
’Œy_dù
, 
’Œy_Çme
):

35 
wdg_com
 = 
	`g‘_wdg_com_äom_’Œy
(
’Œy_dù
, 
’Œy_nm
=
’Œy_Çme
)

36 (
wdg_com
)

38 
def
 
	$upd©e_d©a_Úly
(
£lf
, 
d©a_dù
):

40 
ÿÎ
:

41 
impÜ‹r
.
	`upd©e
()

43 if(
d©a_dù
['ID'] != 'ACTIVE_DATA_DICT'):

44 
_logg”
.
	`”rÜ
('Inv®id d©¨diùiÚ¬yy³ [%s] should bty³ ACTIVE_DATA_DICT' % 
d©a_dù
['ID'])

45 
”r
 = 
NÚe


46 if(
£lf
.
d©a_io
 
is
 
nÙ
 
NÚe
):

47 
”r
 = 
£lf
.
d©a_io
.
	`upd©e
(
d©a_dù
)

48 (
”r
)

50 
def
 
	`upd©e_d©a
(
£lf
, 
’Œy
, 
d©a
, 
couÁ”
='couÁ”0', 
u£_tmpfe
=
F®£
):

51 if(
£lf
.
d©a_io
 
is
 
nÙ
 
NÚe
):

52 
£lf
.
d©a_io
.
	`upd©e_d©a
(
’Œy
, 
d©a
, 
couÁ”
=couÁ”, 
u£_tmpfe
=use_tmpfile)

54 
def
 
	$g‘_axes_li¡_äom_NXd©a
(
£lf
, 
nx_d©as
, 
couÁ”_Çme
):

56 
	$g‘_axes_li¡_äom_NXd©a
(): 
cÚv’›nû
 
funùiÚ
 
to
 
puÎ
 
the
 
axes
 
li¡
 
š
he

57 
Üd”
 
th©
 
they
 
w”e
 
wr™‹n
 
ªd
  
™


59 :
·¿m
 
nx_d©as
: 
a
 
diù
 
th©
 
is
 
»tuºed
 
äom
‡ 
ÿÎ
 
to
 
	`g‘_NXd©as_äom_’Œy
()

60 :
ty³
 
nx_d©as
: 
diù


62 :
·¿m
 
couÁ”_Çme
: 
Çme
 
of
 
couÁ”
 
š
 
the
 
nx_d©as
 
diù


63 :
ty³
 
couÁ”_Çme
: 
¡ršg


65 :
»tuºs
: 
a
 
li¡
 
of
 
axes
 
Çmes


67 
axes
 = 
nx_d©as
[
couÁ”_Çme
]['axes']

68 (
axes
)

70 
def
 
	$g‘_axes_d©a_by_šdex_š_NXd©a
(
£lf
, 
nx_d©as
, 
couÁ”_Çme
, 
šdex
):

72 
	$g‘_axes_d©a_by_šdex_š_NXd©a
(): 
cÚv’›nû
 
funùiÚ
 
to
 
puÎ
 
the
 
d©a
 
äom


73 
ª
 
šdex
 
što
 
the
 
li¡
 
v”siÚ
 
of
h
d©a
 
found
 
š
h
NXd©as
 
diù


75 :
·¿m
 
nx_d©as
: 
a
 
diù
 
th©
 
is
 
»tuºed
 
äom
‡ 
ÿÎ
 
to
 
	`g‘_NXd©as_äom_’Œy
()

76 :
ty³
 
nx_d©as
: 
diù


78 :
·¿m
 
couÁ”_Çme
: 
Çme
 
of
 
couÁ”
 
š
 
the
 
nx_d©as
 
diù


79 :
ty³
 
couÁ”_Çme
: 
¡ršg


81 :
·¿m
 
šdex
: index 
što
 
the
 
li¡
 
of
 
d©a


82 :
ty³
 
šdex
: 
š‹g”


84 :
»tuºs
: 
¬¿y
 
of
 
d©a


86 
d©a
 = 
nx_d©as
[
couÁ”_Çme
]['axes_d©a'][
šdex
]

87 (
d©a
)

89 
def
 
	$g‘_sigÇl_d©a_äom_NXd©a
(
£lf
, 
nx_d©as
, 
couÁ”_Çme
):

91 
	$g‘_sigÇl_d©a_äom_NXd©a
(): 
cÚv’›nû
 
funùiÚ
 
to
 
puÎ
 
the
 
sigÇl
 
d©a
 
äom


92 
the
 
d©a
 
found
 
š
h
NXd©as
 
diù


94 :
·¿m
 
nx_d©as
: 
a
 
diù
 
th©
 
is
 
»tuºed
 
äom
‡ 
ÿÎ
 
to
 
	`g‘_NXd©as_äom_’Œy
()

95 :
ty³
 
nx_d©as
: 
diù


97 :
·¿m
 
couÁ”_Çme
: 
Çme
 
of
 
couÁ”
 
š
 
the
 
nx_d©as
 
diù


98 :
ty³
 
couÁ”_Çme
: 
¡ršg


100 :
»tuºs
: 
¬¿y
 
of
 
d©a


102 
d©a
 = 
nx_d©as
[
couÁ”_Çme
]['signal']

103 (
d©a
)

	@device_names.py

2 
C»©ed
 
Ú
 
	gOù
 14, 2015

4 @
	gauthÜ
: 
b”gr


6 
The
 
Çmes
 
defšed
 
h”e
 
¬e
 
to
 
be
 
u£d
Ø
»ãr
Ø
the
 
maš
 
objeù
 
diù
 
deviûs
 
ªd
 
pos™iÚ”s


8 
DNM_PFIL1607_5_I10_01
 = "PFIL1607_5_I10_01"

9 
DNM_PFIL1607_5_I10_02
 = "PFIL1607_5_I10_02"

11 
DNM_IMAG_M1_VERT_PªdR_IN_UP
 = "IMAG_M1_VERT_PandR_IN_UP"

12 
DNM_IMAG_M1_VERT_PªdR_OUT_UP
 = "IMAG_M1_VERT_PandR_OUT_UP"

13 
DNM_IMAG_M1_VERT_PªdR_DOWN
 = "IMAG_M1_VERT_PandR_DOWN"

14 
DNM_IMAG_M1_HORZ_STRIPE_SEL
 = "IMAG_M1_HORZ_STRIPE_SEL"

15 
DNM_IMAG_M1_YAW
 = "IMAG_M1_YAW"

16 
DNM_IMAG_M1_BENDER_UPSTREAM
 = "IMAG_M1_BENDER_UPSTREAM"

17 
DNM_IMAG_M1_BENDER_DOWNSTREAM
 = "IMAG_M1_BENDER_DOWNSTREAM"

19 
DNM_IMAG_M2_VERT_PªdR_IN_UP
 = "IMAG_M2_VERT_PandR_IN_UP"

20 
DNM_IMAG_M2_VERT_PªdR_OUT_UP
 = "IMAG_M2_VERT_PandR_OUT_UP"

21 
DNM_IMAG_M2_VERT_PªdR_DOWN
 = "IMAG_M2_VERT_PandR_DOWN"

22 
DNM_IMAG_M2_HORZ_STRIPE_SEL
 = "IMAG_M2_HORZ_STRIPE_SEL"

23 
DNM_IMAG_M2_YAW
 = "IMAG_M2_YAW"

24 
DNM_IMAG_M2_BENDER_UPSTREAM
 = "IMAG_M2_BENDER_UPSTREAM"

25 
DNM_IMAG_M2_BENDER_DOWNSTREAM
 = "IMAG_M2_BENDER_DOWNSTREAM"

26 
DNM_IMAG_MONO_BRAGG
 = "IMAG_MONO_BRAGG"

28 
DNM_IMAG_VM_UPPER_BLADE
 = "IMAG_VM_UPPER_BLADE"

29 
DNM_IMAG_VM_LOWER_BLADE
 = "IMAG_VM_LOWER_BLADE"

30 
DNM_IMAG_MONO_CRYSTAL_2_Z2
 = "IMAG_MONO_CRYSTAL_2_Z2"

31 
DNM_IMAG_MONO_CRYSTAL_2_Y2
 = "IMAG_MONO_CRYSTAL_2_Y2"

32 
DNM_IMAG_MONO_CRYSTAL_2_Th‘a2
 = "IMAG_MONO_CRYSTAL_2_Theta2"

33 
DNM_IMAG_MONO_CRYSTAL_2_CHI_2
 = "IMAG_MONO_CRYSTAL_2_CHI_2"

34 
DNM_IMAG_MONO_TABLE_VERT_Y
 = "IMAG_MONO_TABLE_VERT_Y"

35 
DNM_IMAG_MONO_TABLE_HORZ_X
 = "IMAG_MONO_TABLE_HORZ_X"

37 
DNM_IMAG_TABLE_VERTICAL_1
 = "IMAG_TABLE_VERTICAL_1"

38 
DNM_IMAG_TABLE_VERTICAL_2
 = "IMAG_TABLE_VERTICAL_2"

39 
DNM_IMAG_TABLE_VERTICAL_3
 = "IMAG_TABLE_VERTICAL_3"

40 
DNM_IMAG_TABLE_HORIZONTAL_1
 = "IMAG_TABLE_HORIZONTAL_1"

41 
DNM_IMAG_TABLE_HORIZONTAL_2
 = "IMAG_TABLE_HORIZONTAL_2"

43 
DNM_IMAG_JJ_SLIT_US_VERT_GAP
 = "IMAG_JJ_SLIT_US_VERT_GAP"

44 
DNM_IMAG_JJ_SLIT_US_VERT_CENTER
 = "IMAG_JJ_SLIT_US_VERT_CENTER"

45 
DNM_IMAG_JJ_SLIT_US_HOR_GAP
 = "IMAG_JJ_SLIT_US_HOR_GAP"

46 
DNM_IMAG_JJ_SLIT_US_HOR_CENTER
 = "IMAG_JJ_SLIT_US_HOR_CENTER"

47 
DNM_IMAG_HORIZ_KB_BENDER_1
 = "IMAG_HORIZ_KB_BENDER_1"

48 
DNM_IMAG_HORIZ_KB_BENDER_2
 = "IMAG_HORIZ_KB_BENDER_2"

49 
DNM_IMAG_HORIZ_KB_VERTICAL
 = "IMAG_HORIZ_KB_VERTICAL"

50 
DNM_IMAG_HORIZ_KB_TILT
 = "IMAG_HORIZ_KB_TILT"

52 
DNM_IMAG_VERT_KB_BENDER_1
 = "IMAG_VERT_KB_BENDER_1"

53 
DNM_IMAG_VERT_KB_BENDER_2
 = "IMAG_VERT_KB_BENDER_2"

54 
DNM_IMAG_VERT_KB_VERTICAL
 = "IMAG_VERT_KB_VERTICAL"

55 
DNM_IMAG_VERT_KB_TILT
 = "IMAG_VERT_KB_TILT"

56 
DNM_IMAG_DETECTOR_1_VERTICAL
 = "IMAG_DETECTOR_1_VERTICAL"

57 
DNM_IMAG_DETECTOR_1_LATERAL
 = "IMAG_DETECTOR_1_LATERAL"

58 
DNM_IMAG_DETECTOR_2_VERTICAL
 = "IMAG_DETECTOR_2_VERTICAL"

59 
DNM_IMAG_DETECTOR_2_LATERAL
 = "IMAG_DETECTOR_2_LATERAL"

61 
DNM_IMAG_SAMPLE_ROTARY_STAGE
 = "IMAG_SAMPLE_ROTARY_STAGE"

62 
DNM_IMAG_ZONE_PLATE_X
 = "IMAG_ZONE_PLATE_X"

63 
DNM_IMAG_ZONE_PLATE_Y
 = "IMAG_ZONE_PLATE_Y"

64 
DNM_IMAG_ZONE_PLATE_Z
 = "IMAG_ZONE_PLATE_Z"

65 
DNM_IMAG_ZONE_PLATE_PITCH
 = "IMAG_ZONE_PLATE_PITCH"

66 
DNM_IMAG_ZONE_PLATE_YAW
 = "IMAG_ZONE_PLATE_YAW"

67 
DNM_IMAG_OPTICAL_SAMPLE_VERT
 = "IMAG_OPTICAL_SAMPLE_VERT"

69 
DNM_IMAG_JJ_SLIT_DS_VERT_GAP
 = "IMAG_JJ_SLIT_DS_VERT_GAP"

70 
DNM_IMAG_JJ_SLIT_DS_VERT_CENTER
 = "IMAG_JJ_SLIT_DS_VERT_CENTER"

71 
DNM_IMAG_JJ_SLIT_DS_HOR_GAP
 = "IMAG_JJ_SLIT_DS_HOR_GAP"

72 
DNM_IMAG_JJ_SLIT_DS_HOR_CENTER
 = "IMAG_JJ_SLIT_DS_HOR_CENTER"

73 
DNM_IMAG_MACRO_STAGE_UP_DOWN
 = "IMAG_MACRO_STAGE_UP_DOWN"

74 
DNM_IMAG_MACRO_STAGE_HORIZ
 = "IMAG_MACRO_STAGE_HORIZ"

75 
DNM_IMAG_MACRO_STAGE_VERT
 = "IMAG_MACRO_STAGE_VERT"

76 
DNM_IMAG_VISUALIZATION_VERT
 = "IMAG_VISUALIZATION_VERT"

	@device_names.py

2 
C»©ed
 
Ú
 
	gOù
 14, 2015

4 @
	gauthÜ
: 
b”gr


6 
The
 
Çmes
 
defšed
 
h”e
 
¬e
 
to
 
be
 
u£d
Ø
»ãr
Ø
the
 
maš
 
objeù
 
diù
 
deviûs
 
ªd
 
pos™iÚ”s


8 
DNM_PFIL1607_5_I10_01
 = "PFIL1607_5_I10_01"

9 
DNM_PFIL1607_5_I10_02
 = "PFIL1607_5_I10_02"

11 
DNM_IMAG_M1_VERT_PªdR_IN_UP
 = "IMAG_M1_VERT_PandR_IN_UP"

12 
DNM_IMAG_M1_VERT_PªdR_OUT_UP
 = "IMAG_M1_VERT_PandR_OUT_UP"

13 
DNM_IMAG_M1_VERT_PªdR_DOWN
 = "IMAG_M1_VERT_PandR_DOWN"

14 
DNM_IMAG_M1_HORZ_STRIPE_SEL
 = "IMAG_M1_HORZ_STRIPE_SEL"

15 
DNM_IMAG_M1_YAW
 = "IMAG_M1_YAW"

16 
DNM_IMAG_M1_BENDER_UPSTREAM
 = "IMAG_M1_BENDER_UPSTREAM"

17 
DNM_IMAG_M1_BENDER_DOWNSTREAM
 = "IMAG_M1_BENDER_DOWNSTREAM"

19 
DNM_IMAG_M2_VERT_PªdR_IN_UP
 = "IMAG_M2_VERT_PandR_IN_UP"

20 
DNM_IMAG_M2_VERT_PªdR_OUT_UP
 = "IMAG_M2_VERT_PandR_OUT_UP"

21 
DNM_IMAG_M2_VERT_PªdR_DOWN
 = "IMAG_M2_VERT_PandR_DOWN"

22 
DNM_IMAG_M2_HORZ_STRIPE_SEL
 = "IMAG_M2_HORZ_STRIPE_SEL"

23 
DNM_IMAG_M2_YAW
 = "IMAG_M2_YAW"

24 
DNM_IMAG_M2_BENDER_UPSTREAM
 = "IMAG_M2_BENDER_UPSTREAM"

25 
DNM_IMAG_M2_BENDER_DOWNSTREAM
 = "IMAG_M2_BENDER_DOWNSTREAM"

26 
DNM_IMAG_MONO_BRAGG
 = "IMAG_MONO_BRAGG"

28 
DNM_IMAG_VM_UPPER_BLADE
 = "IMAG_VM_UPPER_BLADE"

29 
DNM_IMAG_VM_LOWER_BLADE
 = "IMAG_VM_LOWER_BLADE"

30 
DNM_IMAG_MONO_CRYSTAL_2_Z2
 = "IMAG_MONO_CRYSTAL_2_Z2"

31 
DNM_IMAG_MONO_CRYSTAL_2_Y2
 = "IMAG_MONO_CRYSTAL_2_Y2"

32 
DNM_IMAG_MONO_CRYSTAL_2_Th‘a2
 = "IMAG_MONO_CRYSTAL_2_Theta2"

33 
DNM_IMAG_MONO_CRYSTAL_2_CHI_2
 = "IMAG_MONO_CRYSTAL_2_CHI_2"

34 
DNM_IMAG_MONO_TABLE_VERT_Y
 = "IMAG_MONO_TABLE_VERT_Y"

35 
DNM_IMAG_MONO_TABLE_HORZ_X
 = "IMAG_MONO_TABLE_HORZ_X"

37 
DNM_IMAG_TABLE_VERTICAL_1
 = "IMAG_TABLE_VERTICAL_1"

38 
DNM_IMAG_TABLE_VERTICAL_2
 = "IMAG_TABLE_VERTICAL_2"

39 
DNM_IMAG_TABLE_VERTICAL_3
 = "IMAG_TABLE_VERTICAL_3"

40 
DNM_IMAG_TABLE_HORIZONTAL_1
 = "IMAG_TABLE_HORIZONTAL_1"

41 
DNM_IMAG_TABLE_HORIZONTAL_2
 = "IMAG_TABLE_HORIZONTAL_2"

43 
DNM_IMAG_JJ_SLIT_US_VERT_GAP
 = "IMAG_JJ_SLIT_US_VERT_GAP"

44 
DNM_IMAG_JJ_SLIT_US_VERT_CENTER
 = "IMAG_JJ_SLIT_US_VERT_CENTER"

45 
DNM_IMAG_JJ_SLIT_US_HOR_GAP
 = "IMAG_JJ_SLIT_US_HOR_GAP"

46 
DNM_IMAG_JJ_SLIT_US_HOR_CENTER
 = "IMAG_JJ_SLIT_US_HOR_CENTER"

47 
DNM_IMAG_HORIZ_KB_BENDER_1
 = "IMAG_HORIZ_KB_BENDER_1"

48 
DNM_IMAG_HORIZ_KB_BENDER_2
 = "IMAG_HORIZ_KB_BENDER_2"

49 
DNM_IMAG_HORIZ_KB_VERTICAL
 = "IMAG_HORIZ_KB_VERTICAL"

50 
DNM_IMAG_HORIZ_KB_TILT
 = "IMAG_HORIZ_KB_TILT"

52 
DNM_IMAG_VERT_KB_BENDER_1
 = "IMAG_VERT_KB_BENDER_1"

53 
DNM_IMAG_VERT_KB_BENDER_2
 = "IMAG_VERT_KB_BENDER_2"

54 
DNM_IMAG_VERT_KB_VERTICAL
 = "IMAG_VERT_KB_VERTICAL"

55 
DNM_IMAG_VERT_KB_TILT
 = "IMAG_VERT_KB_TILT"

56 
DNM_IMAG_DETECTOR_1_VERTICAL
 = "IMAG_DETECTOR_1_VERTICAL"

57 
DNM_IMAG_DETECTOR_1_LATERAL
 = "IMAG_DETECTOR_1_LATERAL"

58 
DNM_IMAG_DETECTOR_2_VERTICAL
 = "IMAG_DETECTOR_2_VERTICAL"

59 
DNM_IMAG_DETECTOR_2_LATERAL
 = "IMAG_DETECTOR_2_LATERAL"

61 
DNM_IMAG_SAMPLE_ROTARY_STAGE
 = "IMAG_SAMPLE_ROTARY_STAGE"

62 
DNM_IMAG_ZONE_PLATE_X
 = "IMAG_ZONE_PLATE_X"

63 
DNM_IMAG_ZONE_PLATE_Y
 = "IMAG_ZONE_PLATE_Y"

64 
DNM_IMAG_ZONE_PLATE_Z
 = "IMAG_ZONE_PLATE_Z"

65 
DNM_IMAG_ZONE_PLATE_PITCH
 = "IMAG_ZONE_PLATE_PITCH"

66 
DNM_IMAG_ZONE_PLATE_YAW
 = "IMAG_ZONE_PLATE_YAW"

67 
DNM_IMAG_OPTICAL_SAMPLE_VERT
 = "IMAG_OPTICAL_SAMPLE_VERT"

69 
DNM_IMAG_JJ_SLIT_DS_VERT_GAP
 = "IMAG_JJ_SLIT_DS_VERT_GAP"

70 
DNM_IMAG_JJ_SLIT_DS_VERT_CENTER
 = "IMAG_JJ_SLIT_DS_VERT_CENTER"

71 
DNM_IMAG_JJ_SLIT_DS_HOR_GAP
 = "IMAG_JJ_SLIT_DS_HOR_GAP"

72 
DNM_IMAG_JJ_SLIT_DS_HOR_CENTER
 = "IMAG_JJ_SLIT_DS_HOR_CENTER"

73 
DNM_IMAG_MACRO_STAGE_UP_DOWN
 = "IMAG_MACRO_STAGE_UP_DOWN"

74 
DNM_IMAG_MACRO_STAGE_HORIZ
 = "IMAG_MACRO_STAGE_HORIZ"

75 
DNM_IMAG_MACRO_STAGE_VERT
 = "IMAG_MACRO_STAGE_VERT"

76 
DNM_IMAG_VISUALIZATION_VERT
 = "IMAG_VISUALIZATION_VERT"

	@init_qt.py

2 
C»©ed
 
	gÚ
 2012-05-23

4 @
	gauthÜ
: 
b”gr


6 
glob®
 
­p


7 
impÜt
 
guid©a


8 
­p
 = 
guid©a
.
q­¶iÿtiÚ
()

10 #ev’ˆ
loİ
 
wl
 
be
 
execu‹d
 
š
 stxmMain

	@init_qt.py

2 
C»©ed
 
	gÚ
 2012-05-23

4 @
	gauthÜ
: 
b”gr


6 
glob®
 
­p


7 
impÜt
 
guid©a


8 
­p
 = 
guid©a
.
q­¶iÿtiÚ
()

10 #ev’ˆ
loİ
 
wl
 
be
 
execu‹d
 
š
 stxmMain

	@scan_plugins/DetectorSSCAN.py

2 
C»©ed
 
Ú
 
	gS•
 26, 2016

4 @
	gauthÜ
: 
b”gr


7 
äom
 
şs
.
­¶iÿtiÚs
.
bioXasIM
.
deviû_Çmes
 
impÜt
 *

9 
äom
 
şs
.
­¶iÿtiÚs
.
bioXasIM
.
bl07ID01
 
impÜt
 
MAIN_OBJ


10 
äom
 
şs
.
sÿÂšg
.
Ba£Sÿn
 
impÜt
 BaseScan

11 
äom
 
şs
.
sÿÂšg
.
SSÿnCÏss
 
impÜt
 SScanClass

12 
äom
 
şs
.
sÿÂšg
.
sÿn_cfg_uts
 
impÜt
 
£t_deviûs_fÜ_pošt_sÿn


13 
äom
 
şs
.
uts
.
roi_diù_defs
 
impÜt
 *

14 
äom
 
şs
.
uts
.
log
 
impÜt
 
g‘_moduË_logg”


17 
_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

20 
şass
 
	$D‘eùÜSSCAN
(
Ba£Sÿn
):

23 
def
 
	$__š™__
(
£lf
):

25 
	$__š™__
():

27 :
»tuºs
: 
NÚe


29 
	`su³r
(
D‘eùÜSSCAN
, 
£lf
).
	`__š™__
('%s:image' % 
MAIN_OBJ
.
	`g‘_ssÿn_´efix
(), 
SPDB_XY
, 
maš_obj
=MAIN_OBJ)

32 
def
 
	$š™_ssÿns
(
£lf
):

33 
£lf
.
´fx
 = 
MAIN_OBJ
.
	`g‘_ssÿn_´efix
()

34 
£lf
.
ySÿn
 = 
	`SSÿnCÏss
('%s:image:sÿn2' % s–f.
´fx
, 
SPDB_Y
, 
maš_obj
=
MAIN_OBJ
)

35 
£lf
.
xSÿn
 = 
	`SSÿnCÏss
('%s:image:sÿn1' % s–f.
´fx
, 
SPDB_X
, 
maš_obj
=
MAIN_OBJ
)

37 
xmŒ
 = 
MAIN_OBJ
.
	`deviû
(
DNM_IMAG_M1_VERT_PªdR_IN_UP
)

38 
ymŒ
 = 
MAIN_OBJ
.
	`deviû
(
DNM_IMAG_M1_VERT_PªdR_DOWN
)

40 
£lf
.
xSÿn
.
	`£t_pos™iÚ”
(1, 
xmŒ
)

41 
£lf
.
ySÿn
.
	`£t_pos™iÚ”
(1, 
ymŒ
)

43 
£lf
.
sÿÆi¡
 = [£lf.
xSÿn
 , s–f.
ySÿn
]

44 
£lf
.
mŒ_li¡
 = [ 
xmŒ
 , 
ymŒ
]

46 
def
 
	$š™_£t_sÿn_Ëv–s
(
£lf
):

47 
£lf
.
	`£t_tİ_Ëv–_sÿn
(£lf.
ySÿn
)

48 
£lf
.
	`£t_d©a_Ëv–_sÿn
(£lf.
ySÿn
)

49 
£lf
.
	`£t_btm_Ëv–_sÿn
(£lf.
xSÿn
)

51 
def
 
	$š™_sigÇls
(
£lf
):

52 
£lf
.
	`£t_cÚfig_deviûs_func
(£lf.
Ú_this_dev_cfg
)

53 
£lf
.
	`£t_Ú_couÁ”_chªged_func
(£lf.
Ú_x_y_couÁ”_chªged
)

54 
£lf
.
	`£t_Ú_sÿn_dÚe_func
(£lf.
Ú_this_sÿn_dÚe
)

56 
def
 
	$Ú_this_sÿn_dÚe
(
£lf
):

58 
	$Ú_this_sÿn_dÚe
(): 
desütiÚ


60 :
»tuºs
: 
NÚe


62 #¡İ 
g©e
 
ªd
 
couÁ”
 
šput
 
sks


63 
£lf
.
g©e
.
	`¡İ
()

64 
£lf
.
couÁ”
.
	`¡İ
()

65 
£lf
.
	`Ú_this_d©a_Ëv–_dÚe
()

66 #£lf.
	`§ve_ma¡”
()

68 
def
 
	`cÚfigu»
(
£lf
, 
wdg_com
, 
¥_id
=0, 
lše
=
True
, 
»¡Üe
=True, 
z_’abËd
=
F®£
):

70 
	$cÚfigu»
(): 
desütiÚ


72 :
·¿m
 
¥_db
: sp_db 
desütiÚ


73 :
ty³
 
¥_db
: sp_dbype

75 :
·¿m
 
lše
=
True
:†še=Tru
desütiÚ


76 :
ty³
 
lše
=
True
:†ine=Trueype

78 :
·¿m
 
»¡Üe
=
True
:„e¡Üe=Tru
desütiÚ


79 :
ty³
 
»¡Üe
=
True
:„estore=Trueype

81 :
·¿m
 
z_’abËd
=
F®£
: z_’abËd=F®£ 
desütiÚ


82 :
ty³
 
z_’abËd
=
F®£
: z_enabled=Falseype

84 :
»tuºs
: 
NÚe


86 #u£ 
ba£
 
cÚfigu»
 
x
 
y
 
mÙÜ
 
sÿn


87 
£lf
.
busy_§všg
 = 
F®£


88 
£lf
.
¡ack
 = 
F®£


89 
£lf
.
ySÿn
.
	`»lßd_ba£_sÿn_cÚfig
()

90 
sim
 = (
£lf
.
xSÿn
.
P1
.
	`g‘
('DESC').
	`fšd
('SIM') > -1)

91 #ifĞ
nÙ
 
SIMULATE_IMAGE_DATA
 
Ü
‚Ù 
sim
):

92 #if(
nÙ
 
sim
):

93 #MAIN_OBJ.
	`deviû
Ğ'DX_auto_di§bË_pow”' ).
	`put
(0)

94 #MAIN_OBJ.
	`deviû
Ğ'DY_auto_di§bË_pow”' ).
	`put
(0)

95 
£lf
.
	`cÚfigu»_x_y_z_sÿn_LINEAR
(
wdg_com
, 
¥_id
=¥_id, 
lše
öše, 
z_’abËd
=
F®£
)

97 
def
 
	$Ú_this_d©a_Ëv–_dÚe
(
£lf
):

99 
	$Ú_this_d©a_Ëv–_dÚe
(): 
desütiÚ


101 :
»tuºs
: 
NÚe


104 
this
 
is
 
ª
 
API
 
¦Ù
 
th©
 
g‘s
 
fœed
 
wh’
 
the
 
d©a
 
Ëv–
 
sÿn_dÚe
 
sigÇl


106 
The
 
fš®
 
d©a
 
diù
 
should
 
have
 
the
 
maš
 
keys
 
of
:

107 
®l_d©a
['SSCANS'] - 
®l
 
f›lds
 
of
 
—ch
 
ssÿn
 
»cÜd
, 
this
 
wl
 
be
 
a
 
li¡
 oà
ssÿns


108 
®l_d©a
['SCAN_CFG'] - 
®l
 
·¿ms
 
äom
 
the
 
GUI
 
this
 
sÿn
, 
ûÁ”
, 
¿nge
 
‘c
, 
®so
 
ªy
 
æags
 
such
 
as
 
XMCD
=
True
 
th©
 
»Ï‹
 
to
 
how
Ø
execu‹
his scan

109 
®l_d©a
['DATA'] - 
couÁ”
 
d©a
 
cŞËùed
 
duršg
 
sÿn
, 
images
 
this
 
wl
 
be
 
a
 2d 
¬¿y
, 
pošt
 
sÿns
his will be‡ 1d‡rray

111 
The
 
gßl
 
of
 
®l_d©a
 
diù
 
is
 
to
 
wr™e
 
the
 diù 
out
Ø
disk
 
š
 <
d©a
 
dœ
>/
ma¡”
.
jsÚ
. 
Onû
 
™
 
has
 
b“n
 
»cÜded
Ødiskhd©¨
»cÜd”


112 
moduË
 
ÿn
 
İ’
 
™
 
as
 
a
 
jsÚ
 
objeù
 
ªd
 
expÜt
 iˆ
ba£d
 
Ú
 
the
 
sÿn
 
ty³
 
so
 
th©
 iˆÿÀ
pick
‡nd 
choo£
 
wh©
 
to
 
puÎ
 
out
‡nd 
wr™e
Øth
h—d”
 
fe
.

115 #_logg”.
	`debug
('Detector: on_data_level_done:')

116 #MAIN_OBJ.
	`deviû
Ğ'DX_auto_di§bË_pow”' ).
	`put
(1è#’abË 
agaš


117 #MAIN_OBJ.
	`deviû
Ğ'DY_auto_di§bË_pow”' ).
	`put
(1)

118 
£lf
.
	`Ú_x_y_sÿn_d©a_Ëv–_dÚe
()

120 
def
 
	$Ú_this_dev_cfg
(
£lf
):

122 
	$Ú_this_dev_cfg
(): 
desütiÚ


124 :
»tuºs
: 
NÚe


127 
this
 
is
 
ª
 
API
 
m‘hod
 
to
 
cÚfigu»
 
the
 
g©e
, 
shu‰”
 
ªd
 
couÁ”
 
deviûs
 thi 
sÿn


129 
	`£t_deviûs_fÜ_pošt_sÿn
(
£lf
.
sÿn_ty³
, s–f.
dw–l
, s–f.
numE
, s–f.
numX
, s–f.
g©e
, s–f.
couÁ”
, s–f.
shu‰”
)

	@scan_plugins/DetectorSSCAN.py

2 
C»©ed
 
Ú
 
	gS•
 26, 2016

4 @
	gauthÜ
: 
b”gr


7 
äom
 
şs
.
­¶iÿtiÚs
.
bioXasIM
.
deviû_Çmes
 
impÜt
 *

9 
äom
 
şs
.
­¶iÿtiÚs
.
bioXasIM
.
bl07ID01
 
impÜt
 
MAIN_OBJ


10 
äom
 
şs
.
sÿÂšg
.
Ba£Sÿn
 
impÜt
 BaseScan

11 
äom
 
şs
.
sÿÂšg
.
SSÿnCÏss
 
impÜt
 SScanClass

12 
äom
 
şs
.
sÿÂšg
.
sÿn_cfg_uts
 
impÜt
 
£t_deviûs_fÜ_pošt_sÿn


13 
äom
 
şs
.
uts
.
roi_diù_defs
 
impÜt
 *

14 
äom
 
şs
.
uts
.
log
 
impÜt
 
g‘_moduË_logg”


17 
_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

20 
şass
 
	$D‘eùÜSSCAN
(
Ba£Sÿn
):

23 
def
 
	$__š™__
(
£lf
):

25 
	$__š™__
():

27 :
»tuºs
: 
NÚe


29 
	`su³r
(
D‘eùÜSSCAN
, 
£lf
).
	`__š™__
('%s:image' % 
MAIN_OBJ
.
	`g‘_ssÿn_´efix
(), 
SPDB_XY
, 
maš_obj
=MAIN_OBJ)

32 
def
 
	$š™_ssÿns
(
£lf
):

33 
£lf
.
´fx
 = 
MAIN_OBJ
.
	`g‘_ssÿn_´efix
()

34 
£lf
.
ySÿn
 = 
	`SSÿnCÏss
('%s:image:sÿn2' % s–f.
´fx
, 
SPDB_Y
, 
maš_obj
=
MAIN_OBJ
)

35 
£lf
.
xSÿn
 = 
	`SSÿnCÏss
('%s:image:sÿn1' % s–f.
´fx
, 
SPDB_X
, 
maš_obj
=
MAIN_OBJ
)

37 
xmŒ
 = 
MAIN_OBJ
.
	`deviû
(
DNM_IMAG_M1_VERT_PªdR_IN_UP
)

38 
ymŒ
 = 
MAIN_OBJ
.
	`deviû
(
DNM_IMAG_M1_VERT_PªdR_DOWN
)

40 
£lf
.
xSÿn
.
	`£t_pos™iÚ”
(1, 
xmŒ
)

41 
£lf
.
ySÿn
.
	`£t_pos™iÚ”
(1, 
ymŒ
)

43 
£lf
.
sÿÆi¡
 = [£lf.
xSÿn
 , s–f.
ySÿn
]

44 
£lf
.
mŒ_li¡
 = [ 
xmŒ
 , 
ymŒ
]

46 
def
 
	$š™_£t_sÿn_Ëv–s
(
£lf
):

47 
£lf
.
	`£t_tİ_Ëv–_sÿn
(£lf.
ySÿn
)

48 
£lf
.
	`£t_d©a_Ëv–_sÿn
(£lf.
ySÿn
)

49 
£lf
.
	`£t_btm_Ëv–_sÿn
(£lf.
xSÿn
)

51 
def
 
	$š™_sigÇls
(
£lf
):

52 
£lf
.
	`£t_cÚfig_deviûs_func
(£lf.
Ú_this_dev_cfg
)

53 
£lf
.
	`£t_Ú_couÁ”_chªged_func
(£lf.
Ú_x_y_couÁ”_chªged
)

54 
£lf
.
	`£t_Ú_sÿn_dÚe_func
(£lf.
Ú_this_sÿn_dÚe
)

56 
def
 
	$Ú_this_sÿn_dÚe
(
£lf
):

58 
	$Ú_this_sÿn_dÚe
(): 
desütiÚ


60 :
»tuºs
: 
NÚe


62 #¡İ 
g©e
 
ªd
 
couÁ”
 
šput
 
sks


63 
£lf
.
g©e
.
	`¡İ
()

64 
£lf
.
couÁ”
.
	`¡İ
()

65 
£lf
.
	`Ú_this_d©a_Ëv–_dÚe
()

66 #£lf.
	`§ve_ma¡”
()

68 
def
 
	`cÚfigu»
(
£lf
, 
wdg_com
, 
¥_id
=0, 
lše
=
True
, 
»¡Üe
=True, 
z_’abËd
=
F®£
):

70 
	$cÚfigu»
(): 
desütiÚ


72 :
·¿m
 
¥_db
: sp_db 
desütiÚ


73 :
ty³
 
¥_db
: sp_dbype

75 :
·¿m
 
lše
=
True
:†še=Tru
desütiÚ


76 :
ty³
 
lše
=
True
:†ine=Trueype

78 :
·¿m
 
»¡Üe
=
True
:„e¡Üe=Tru
desütiÚ


79 :
ty³
 
»¡Üe
=
True
:„estore=Trueype

81 :
·¿m
 
z_’abËd
=
F®£
: z_’abËd=F®£ 
desütiÚ


82 :
ty³
 
z_’abËd
=
F®£
: z_enabled=Falseype

84 :
»tuºs
: 
NÚe


86 #u£ 
ba£
 
cÚfigu»
 
x
 
y
 
mÙÜ
 
sÿn


87 
£lf
.
busy_§všg
 = 
F®£


88 
£lf
.
¡ack
 = 
F®£


89 
£lf
.
ySÿn
.
	`»lßd_ba£_sÿn_cÚfig
()

90 
sim
 = (
£lf
.
xSÿn
.
P1
.
	`g‘
('DESC').
	`fšd
('SIM') > -1)

91 #ifĞ
nÙ
 
SIMULATE_IMAGE_DATA
 
Ü
‚Ù 
sim
):

92 #if(
nÙ
 
sim
):

93 #MAIN_OBJ.
	`deviû
Ğ'DX_auto_di§bË_pow”' ).
	`put
(0)

94 #MAIN_OBJ.
	`deviû
Ğ'DY_auto_di§bË_pow”' ).
	`put
(0)

95 
£lf
.
	`cÚfigu»_x_y_z_sÿn_LINEAR
(
wdg_com
, 
¥_id
=¥_id, 
lše
öše, 
z_’abËd
=
F®£
)

97 
def
 
	$Ú_this_d©a_Ëv–_dÚe
(
£lf
):

99 
	$Ú_this_d©a_Ëv–_dÚe
(): 
desütiÚ


101 :
»tuºs
: 
NÚe


104 
this
 
is
 
ª
 
API
 
¦Ù
 
th©
 
g‘s
 
fœed
 
wh’
 
the
 
d©a
 
Ëv–
 
sÿn_dÚe
 
sigÇl


106 
The
 
fš®
 
d©a
 
diù
 
should
 
have
 
the
 
maš
 
keys
 
of
:

107 
®l_d©a
['SSCANS'] - 
®l
 
f›lds
 
of
 
—ch
 
ssÿn
 
»cÜd
, 
this
 
wl
 
be
 
a
 
li¡
 oà
ssÿns


108 
®l_d©a
['SCAN_CFG'] - 
®l
 
·¿ms
 
äom
 
the
 
GUI
 
this
 
sÿn
, 
ûÁ”
, 
¿nge
 
‘c
, 
®so
 
ªy
 
æags
 
such
 
as
 
XMCD
=
True
 
th©
 
»Ï‹
 
to
 
how
Ø
execu‹
his scan

109 
®l_d©a
['DATA'] - 
couÁ”
 
d©a
 
cŞËùed
 
duršg
 
sÿn
, 
images
 
this
 
wl
 
be
 
a
 2d 
¬¿y
, 
pošt
 
sÿns
his will be‡ 1d‡rray

111 
The
 
gßl
 
of
 
®l_d©a
 
diù
 
is
 
to
 
wr™e
 
the
 diù 
out
Ø
disk
 
š
 <
d©a
 
dœ
>/
ma¡”
.
jsÚ
. 
Onû
 
™
 
has
 
b“n
 
»cÜded
Ødiskhd©¨
»cÜd”


112 
moduË
 
ÿn
 
İ’
 
™
 
as
 
a
 
jsÚ
 
objeù
 
ªd
 
expÜt
 iˆ
ba£d
 
Ú
 
the
 
sÿn
 
ty³
 
so
 
th©
 iˆÿÀ
pick
‡nd 
choo£
 
wh©
 
to
 
puÎ
 
out
‡nd 
wr™e
Øth
h—d”
 
fe
.

115 #_logg”.
	`debug
('Detector: on_data_level_done:')

116 #MAIN_OBJ.
	`deviû
Ğ'DX_auto_di§bË_pow”' ).
	`put
(1è#’abË 
agaš


117 #MAIN_OBJ.
	`deviû
Ğ'DY_auto_di§bË_pow”' ).
	`put
(1)

118 
£lf
.
	`Ú_x_y_sÿn_d©a_Ëv–_dÚe
()

120 
def
 
	$Ú_this_dev_cfg
(
£lf
):

122 
	$Ú_this_dev_cfg
(): 
desütiÚ


124 :
»tuºs
: 
NÚe


127 
this
 
is
 
ª
 
API
 
m‘hod
 
to
 
cÚfigu»
 
the
 
g©e
, 
shu‰”
 
ªd
 
couÁ”
 
deviûs
 thi 
sÿn


129 
	`£t_deviûs_fÜ_pošt_sÿn
(
£lf
.
sÿn_ty³
, s–f.
dw–l
, s–f.
numE
, s–f.
numX
, s–f.
g©e
, s–f.
couÁ”
, s–f.
shu‰”
)

	@scan_plugins/__init__.py

2 
C»©ed
 
	gÚ
 2013-05-13

4 @
	gauthÜ
: 
b”gr


6 
impÜt
 
os


8 
äom
 
D‘eùÜSSCAN
 
impÜt
 DetectorSSCAN

9 #äom 
Pos™iÚ”SSCAN
 
impÜt
 PositionerSSCAN

11 
¶ugš_dœ
 = 
os
.
·th
.
dœÇme
(os.·th.
	$»®·th
(
__fe__
))

14 
__®l__
=['plugin_dir', 'DetectorSSCAN']

	@scan_plugins/__init__.py

2 
C»©ed
 
	gÚ
 2013-05-13

4 @
	gauthÜ
: 
b”gr


6 
impÜt
 
os


8 
äom
 
D‘eùÜSSCAN
 
impÜt
 DetectorSSCAN

9 #äom 
Pos™iÚ”SSCAN
 
impÜt
 PositionerSSCAN

11 
¶ugš_dœ
 = 
os
.
·th
.
dœÇme
(os.·th.
	$»®·th
(
__fe__
))

14 
__®l__
=['plugin_dir', 'DetectorSSCAN']

	@scan_plugins/det_scan.py

2 
C»©ed
 
Ú
 
	gAug
 25, 2014

4 @
	gauthÜ
: 
b”gr


7 
C»©ed
 
Ú
 
Aug
 25, 2014

9 @
	gauthÜ
: 
b”gr


11 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
QtGui


12 
äom
 
PyQt5
 
impÜt
 
uic


14 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
bl07ID01
 
impÜt
 
	gMAIN_OBJ
, 
DEFAULTS


15 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
sÿn_¶ugšs
 
impÜt
 
¶ugš_dœ


16 
äom
 
	gşs
.
	gsÿÂšg
.
·¿mLšeEd™
 
impÜt
 
	gštLšeEd™P¬amObj
, 
dblLšeEd™P¬amObj


17 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
deviû_Çmes
 
impÜt
 *

18 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	gsÿn_¶ugšs
.
D‘eùÜSSCAN
 
impÜt
 DetectorSSCAN

19 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	gd©a
.
bioxas_im_d©a_io
 
impÜt
 
BioxasD©aIo


21 
äom
 
	gşs
.
	guts
.
roi_uts
 
impÜt
 
	gg‘_ba£_roi
, 
	gg‘_ba£_’”gy_roi
, 
	gmake_¥©Ÿl_db_diù
, 
	gwidg‘_com_cmnd_ty³s
, 
	gÚ_¿nge_chªged
, 
Ú_ûÁ”_chªged


23 
äom
 
	gşs
.
	gsÿÂšg
.
ba£
 
impÜt
 
	gSÿnP¬amWidg‘
, 
zp_focus_modes


24 
äom
 
	gşs
.
	gsÿÂšg
.
ty³s
 
impÜt
 
	gsÿn_ty³s
, 
	gsÿn_·Ãl_Üd”
, 
	g¥©Ÿl_ty³_´efix
, 
image_ty³s


26 
äom
 
	gşs
.
	g¶ÙWidg‘s
.
sh­e_»¡riùiÚs
 
impÜt
 
	gROILim™Obj
, 
ROILim™Def


27 
äom
 
	gşs
.
	g¶ÙWidg‘s
.
cŞÜ_def
 
impÜt
 
	gg‘_nÜm®_şr
, 
	gg‘_w¬n_şr
, 
	gg‘_®¬m_şr
, 
	gg‘_nÜm®_fl_·‰”n
, 
	gg‘_w¬n_fl_·‰”n
, 
g‘_®¬m_fl_·‰”n


29 
äom
 
	gşs
.
	guts
.
diù_uts
 
impÜt
 
	gdù_g‘
, 
dù_put


30 
äom
 
	gşs
.
	guts
.
roi_diù_defs
 
impÜt
 *

31 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
g‘_moduË_logg”


34 
	g_logg”
 = 
	$g‘_moduË_logg”
(
__Çme__
)

36 
şass
 
	$D‘eùÜSÿnP¬am
(
SÿnP¬amWidg‘
):

37 
Çme
 = "Detector Scan"

38 
idx
 = 
sÿn_·Ãl_Üd”
.
DETECTOR_SCAN


39 
ty³
 = 
sÿn_ty³s
.
DETECTOR_IMAGE


40 
£ùiÚ_id
 = 'DETECTOR'

41 
axis_¡ršgs
 = ['Det Y microns', 'Det X microns', '', '']

42 
zp_focus_mode
 = 
zp_focus_modes
.
FL


44 
d©a_fe_pfx
 = 
MAIN_OBJ
.
	$g‘_d©afe_´efix
()

45 
¶Ù_™em_ty³
 = 
¥©Ÿl_ty³_´efix
.
ROI


47 
d©a
 = {
	}
}

49 
def
 
	$__š™__
(
£lf
, 
·»Á
=
NÚe
):

50 
SÿnP¬amWidg‘
.
	$__š™__
(
£lf
, 
maš_obj
=
MAIN_OBJ
, 
d©a_io
=
BioxasD©aIo
, 
dæts
=
DEFAULTS
)

51 
£lf
.
_·»Á
 = 
·»Á


52 
uic
.
	`lßdUi
(
¶ugš_dœ
 + '/d‘_sÿn.ui', 
£lf
)

54 
£lf
.
ssÿn_şass
 = 
	$D‘eùÜSSCAN
()

56 
£lf
.
süibbËrBŠ
.
	$£tVisibË
(
True
)

58 
£lf
.
süibbËr_’abËd
 = 
F®£


59 
£lf
.
¶ÙWidg‘
 = 
NÚe


60 #upd©
şib¿‹d
 
po¢


61 #mŒx = 
MAIN_OBJ
.
	`deviû
(
DNM_DETECTOR_X
)

62 #mŒy = 
MAIN_OBJ
.
	`deviû
(
DNM_DETECTOR_Y
)

63 #ûÁ = 
DEFAULTS
.
	`g‘
('PRESETS.DETECTOR.CALIBPOSN')

64 #if(
ûÁ
 !ğ
NÚe
):

65 #mŒx.
	`£t_ÿlib¿‹d_pos™iÚ
(
ûÁ
[0])

66 #mŒy.
	`£t_ÿlib¿‹d_pos™iÚ
(
ûÁ
[1])

68 #ÿlX = 
mŒx
.
	`g‘
('calibPosn')

69 #ÿlY = 
mŒy
.
	`g‘
('calibPosn')

70 #DEFAULTS.
	`£t
('PRESETS.DETECTOR.CALIBPOSN', (
ÿlX
, 
ÿlY
))

71 #DEFAULTS.
	`upd©e
()

72 #£lf.
	`£tup_d‘eùÜ_¶Ù
()

73 #£lf.
d©a
 = {
	}
}

74 
	g£lf
.
	gsüibbËrBŠ
.
	gşicked
.
	$cÚÃù
(
£lf
.
Ú_do_süibbËr
)

75 
£lf
.
o§OutBŠ
.
şicked
.
	$cÚÃù
(
£lf
.
Ú_o§_out
)

76 
£lf
.
£tC’‹rBŠ
.
şicked
.
	$cÚÃù
(
£lf
.
Ú_£t_ûÁ”
)

77 
£lf
.
lßdSÿnBŠ
.
şicked
.
	$cÚÃù
(
£lf
.
lßd_sÿn
)

79 
£lf
.
¥_db
 = 
NÚe


80 
£lf
.
	$lßd_äom_deçuÉs
()

81 
£lf
.
	$š™_¥_db
()

82 
£lf
.
	$cÚÃù_·¿mf›ld_sigÇls
()

83 
£lf
.
	$Ú_sšgË_¥©Ÿl_Åošts_chªged
()

86 
def
 
	$cÚÃù_·¿mf›ld_sigÇls
(
£lf
):

88 
mŒ_x
 = 
MAIN_OBJ
.
	$deviû
(
DNM_DETECTOR_X
)

89 
mŒ_y
 = 
MAIN_OBJ
.
	$deviû
(
DNM_DETECTOR_Y
)

91 
xÎm
 = 
mŒ_x
.
	`g‘
('LLM')

92 
xhlm
 = 
mŒ_x
.
	`g‘
('HLM')

93 
yÎm
 = 
mŒ_y
.
	`g‘
('LLM')

94 
yhlm
 = 
mŒ_y
.
	`g‘
('HLM')

96 
rx
 = 
xhlm
 - 
xÎm


97 
ry
 = 
yhlm
 - 
yÎm


99 
lim_dù
 = {
	}
}

100 
lim_dù
['X'] = {'Îm':
xÎm
, 'hlm': 
xhlm
, 'ºg':
rx
}

101 
lim_dù
['Y'] = {'Îm':
yÎm
, 'hlm': 
yhlm
, 'ºg':
ry
}

103 
£lf
.
	$cÚÃù_·¿m_æds_to_v®id©Ü
(
lim_dù
)

105 ##
£lf
.
dw–lFld
 = 
	`dblP¬amLšeEd™
('dw–lFld', 0.0, 10000.0, 2, 
æd
=self.dwellFld)

106 ##
£lf
.
dw–lFld
.
v®id_»tuºP»s£d
.
	`cÚÃù
(£lf.
upd©e_d©a
)

107 #£lf.
dw–lFld
.
dpo
 = 
	`dblLšeEd™P¬amObj
('dw–lFld', 0.0, 10000.0, 3, 
·»Á
=
£lf
.dwellFld)

108 #£lf.
dw–lFld
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(
£lf
.
upd©e_d©a
)

109 #
##
£lf
.
ûÁ”XFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_sšgË_¥©Ÿl_ûÁ”_chªged
)

110 #£lf.
ûÁ”XFld
.
dpo
 = 
	`dblLšeEd™P¬amObj
('ûÁ”XFld', 
xÎm
, 
xhlm
, 3, 
·»Á
=
£lf
.centerXFld)

111 #£lf.
ûÁ”XFld
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(
£lf
.
Ú_sšgË_¥©Ÿl_ûÁ”_chªged
)

112 #
##
£lf
.
¿ngeXFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_sšgË_¥©Ÿl_¿nge_chªged
)

113 #£lf.
¿ngeXFld
.
dpo
 = 
	`dblLšeEd™P¬amObj
('¿ngeXFld', -0.5*
rx
, 0.5*rx, 3, 
·»Á
=
£lf
.rangeXFld)

114 #£lf.
¿ngeXFld
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(
£lf
.
Ú_sšgË_¥©Ÿl_¿nge_chªged
)

115 #
##
£lf
.
ÅoštsXFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_sšgË_¥©Ÿl_Åošts_chªged
)

116 #£lf.
ÅoštsXFld
.
dpo
 = 
	`štLšeEd™P¬amObj
('ÅoštsXFld', 0, 10000, 0, 
·»Á
=
£lf
.npointsXFld)

117 #£lf.
ÅoštsXFld
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(
£lf
.
Ú_sšgË_¥©Ÿl_Åošts_chªged
)

118 #
##
£lf
.
¡•XFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_sšgË_¥©Ÿl_¡•size_chªged
)

119 #£lf.
¡•XFld
.
dpo
 = 
	`dblLšeEd™P¬amObj
('¡•XFld', 0.0, 10000.0, 3, 
·»Á
=
£lf
.stepXFld)

120 #£lf.
¡•XFld
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(
£lf
.
Ú_sšgË_¥©Ÿl_¡•size_chªged
)

121 #
##
£lf
.
ûÁ”YFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_sšgË_¥©Ÿl_ûÁ”_chªged
)

122 #£lf.
ûÁ”YFld
.
dpo
 = 
	`dblLšeEd™P¬amObj
('ûÁ”YFld', 
yÎm
, 
yhlm
, 3, 
·»Á
=
£lf
.centerYFld)

123 #£lf.
ûÁ”YFld
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(
£lf
.
Ú_sšgË_¥©Ÿl_ûÁ”_chªged
)

124 #
##
£lf
.
¿ngeYFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_sšgË_¥©Ÿl_¿nge_chªged
)

125 #£lf.
¿ngeYFld
.
dpo
 = 
	`dblLšeEd™P¬amObj
('¿ngeYFld', -0.5*
ry
, 0.5*ry, 3, 
·»Á
=
£lf
.rangeYFld)

126 #£lf.
¿ngeYFld
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(
£lf
.
Ú_sšgË_¥©Ÿl_¿nge_chªged
)

127 #
##
£lf
.
ÅoštsYFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_sšgË_¥©Ÿl_Åošts_chªged
)

128 #£lf.
ÅoštsYFld
.
dpo
 = 
	`štLšeEd™P¬amObj
('ÅoštsYFld', 0, 10000, 0, 
·»Á
=
£lf
.npointsYFld)

129 #£lf.
ÅoštsYFld
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(
£lf
.
Ú_sšgË_¥©Ÿl_Åošts_chªged
)

130 #
##
£lf
.
¡•YFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_sšgË_¥©Ÿl_¡•size_chªged
)

131 #£lf.
¡•YFld
.
dpo
 = 
	`dblLšeEd™P¬amObj
('¡•YFld', 0.0, 10000.0, 3, 
·»Á
=
£lf
.stepYFld)

132 #£lf.
¡•YFld
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(
£lf
.
Ú_sšgË_¥©Ÿl_¡•size_chªged
)

136 
def
 
	$g’_max_sÿn_¿nge_lim™_def
(
£lf
):

139 
mŒ_x
 = 
MAIN_OBJ
.
	$deviû
(
DNM_DETECTOR_X
)

140 
mŒ_y
 = 
MAIN_OBJ
.
	$deviû
(
DNM_DETECTOR_Y
)

142 
xÎm
 = 
mŒ_x
.
	`g‘
('LLM')

143 
xhlm
 = 
mŒ_x
.
	`g‘
('HLM')

144 
yÎm
 = 
mŒ_y
.
	`g‘
('LLM')

145 
yhlm
 = 
mŒ_y
.
	`g‘
('HLM')

147 
boundšg_q»ù
 = 
QtCÜe
.
	`QReùF
(QtCÜe.
	`QPoštF
(
xÎm
, 
yhlm
), QtCÜe.
	$QPoštF
(
xhlm
, 
yÎm
))

148 
w¬n_q»ù
 = 
£lf
.
	`g‘_³rûÁage_of_q»ù
(
boundšg_q»ù
, 0.80è#%80 
of
 
max


149 
®¬m_q»ù
 = 
£lf
.
	`g‘_³rûÁage_of_q»ù
(
boundšg_q»ù
, 0.95è#%95 
of
 
max


151 
boundšg
 = 
	`ROILim™Obj
(
boundšg_q»ù
, 
	`g‘_®¬m_şr
(255), 'Rªgi beyÚd D‘eùÜ C­ab™›s', 
	$g‘_®¬m_fl_·‰”n
())

152 
nÜm®
 = 
	`ROILim™Obj
(
boundšg_q»ù
, 
	`g‘_nÜm®_şr
(45), 'D‘eùÜ Sÿn', 
	$g‘_nÜm®_fl_·‰”n
())

153 
w¬n
 = 
	`ROILim™Obj
(
w¬n_q»ù
, 
	`g‘_w¬n_şr
(150), 'N—ršg max RªgoàD‘eùÜ X/Y', 
	$g‘_w¬n_fl_·‰”n
())

154 
®¬m
 = 
	`ROILim™Obj
(
®¬m_q»ù
, 
	`g‘_®¬m_şr
(255), 'BeyÚd„ªgoàD‘eùÜ X/Y', 
	$g‘_®¬m_fl_·‰”n
())

156 
£lf
.
roi_lim™_def
 = 
	$ROILim™Def
(
boundšg
, 
nÜm®
, 
w¬n
, 
®¬m
)

158 
def
 
	$š™_¥_db
(
£lf
):

160 
š™_¥_db
 
¡ªd¬d
 
funùiÚ
 
suµÜ‹d
 
by
 
®l
 
sÿn
 
¶uggšs
 
to
 
š™Ÿlize
 
the
 
loÿl
 
widg‘_com
 
diù
Ø
wh©ev”
he

161 
GUI
 
is
 
cu¼’y
 
di¥Ïyšg
, 
this
 i 
usu®ly
 
ÿÎed
 
aá”
 
the
 
ÿÎ
 
to
 
£lf
.
	$lßd_äom_deçuÉs
()

163 :
»tuºs
: 
NÚe


166 
cx
 = (
	`¡r
(
£lf
.
ûÁ”XFld
.
	$‹xt
()))

167 
rx
 = (
	`¡r
(
£lf
.
¿ngeXFld
.
	$‹xt
()))

168 
cy
 = (
	`¡r
(
£lf
.
ûÁ”YFld
.
	$‹xt
()))

169 
ry
 = (
	`¡r
(
£lf
.
¿ngeYFld
.
	$‹xt
()))

170 
dw–l
 = (
	`¡r
(
£lf
.
dw–lFld
.
	$‹xt
()))

171 
nx
 = (
	`¡r
(
£lf
.
ÅoštsXFld
.
	$‹xt
()))

172 
ny
 = (
	`¡r
(
£lf
.
ÅoštsYFld
.
	$‹xt
()))

173 
sx
 = (
	`¡r
(
£lf
.
¡•XFld
.
	$‹xt
()))

174 
sy
 = (
	`¡r
(
£lf
.
¡•YFld
.
	$‹xt
()))

175 #now 
ü—‹
 
the
 
mod–
 
th©
 
this
 
¶uggš
 
wl
 
u£
 
to
 
»cÜd
 
™s
 
·¿ms


176 
x_roi
 = 
	$g‘_ba£_roi
(
SPDB_X
, 
DNM_DETECTOR_X
, 
cx
, 
rx
, 
nx
, 
sx
)

177 
y_roi
 = 
	$g‘_ba£_roi
(
SPDB_Y
, 
DNM_DETECTOR_Y
, 
cy
, 
ry
, 
ny
, 
sy
)

178 
z_roi
 = 
	`g‘_ba£_roi
(
SPDB_Z
, 
DNM_DETECTOR_Z
, 0, 0, 0, 
’abË
=
F®£
)

180 
’”gy_pos
 = 
MAIN_OBJ
.
	`deviû
(
DNM_ENERGY
).
	`g‘
('RBV')

181 
e_roi
 = 
	`g‘_ba£_’”gy_roi
(
SPDB_EV
, 
DNM_ENERGY
, 
’”gy_pos
,ƒÃrgy_pos, 0, 1, 
dw–l
, 
NÚe
, 
’abË
=
F®£
 )

183 
£lf
.
¥_db
 = 
	$make_¥©Ÿl_db_diù
(
x_roi
=x_roi, 
y_roi
=y_roi, 
z_roi
=z_roi, 
e_roi
=e_roi)

185 
def
 
	$check_sÿn_lim™s
(
£lf
):

187 
checks
 
the
 
sÿn
 
·¿m‘”s
 
agaš¡
h
soá
 
lim™s
 
of
he

188 
pos™iÚ”s
, 
®l
 
is
 
w–l
  
Œue
 
çl£


190 
This
 
funùiÚ
 
should
 
´ovide
 
ª
 
ex¶ic™
 
”rÜ
 
log
 
msg
 
to
 
aide
 
the
 
u£r


192 
»t
 = 
£lf
.
	$check_ûÁ”_¿nge_xy_sÿn_lim™s
(
DNM_DETECTOR_X
, 
DNM_DETECTOR_Y
)

193 (
»t
)

195 
def
 
	$Ú_£t_ûÁ”
(
£lf
):

196 
ûÁX
 = (
	`¡r
(
£lf
.
ûÁ”XFld
.
	$‹xt
()))

197 
ûÁY
 = (
	`¡r
(
£lf
.
ûÁ”YFld
.
	$‹xt
()))

199 
mŒx
 = 
MAIN_OBJ
.
	$deviû
(
DNM_DETECTOR_X
)

200 
mŒy
 = 
MAIN_OBJ
.
	$deviû
(
DNM_DETECTOR_Y
)

202 #DRBV + 
CENTX


203 #pÿlX = 
mŒx
.
	`g‘
('calibPosn')

204 #pÿlY = 
mŒy
.
	`g‘
('calibPosn')

206 #mŒx.
	`£t_ÿlib¿‹d_pos™iÚ
(
ûÁX
 + 
pÿlX
)

207 #mŒy.
	`£t_ÿlib¿‹d_pos™iÚ
(
ûÁY
 + 
pÿlY
)

209 
£lf
.
¥_db
[
SPDB_X
]['CENTER'] = 0.0

210 
	$Ú_ûÁ”_chªged
(
£lf
.
¥_db
[
SPDB_X
])

211 
£lf
.
¥_db
[
SPDB_Y
]['CENTER'] = 0.0

212 
	$Ú_ûÁ”_chªged
(
£lf
.
¥_db
[
SPDB_Y
])

214 
mŒx
.
	$move
(
ûÁX
)

215 
mŒy
.
	$move
(
ûÁY
)

217 
mŒx
.
	$wa™_fÜ_¡İ³d_ªd_z”o
()

218 
mŒy
.
	$wa™_fÜ_¡İ³d_ªd_z”o
()

220 
roi
 = {
	}
}

221 
roi
['CENTER'] = (0.0, 0.0, 0.0, 0.0)

222 
	groi
['RANGE'] = (
NÚe
, 
	gNÚe
, None, None)

223 
	groi
['NPOINTS'] = (
NÚe
, 
	gNÚe
, None, None)

224 
	groi
['STEP'] = (
NÚe
, 
	gNÚe
, None, None)

225 
	g£lf
.
	$£t_roi
(
roi
)

227 
DEFAULTS
.
	`£t
('PRESETS.DETECTOR.CALIBPOSN', (
ûÁX
, 
ûÁY
))

228 
DEFAULTS
.
	`£t
('PRESETS.DETECTOR.CENTER', (0.0, 0.0))

229 
DEFAULTS
.
	$upd©e
()

232 
def
 
	$Ú_o§_out
(
£lf
):

233 
o§_mŒ
 = 
MAIN_OBJ
.
	$deviû
(
DNM_OSA_X
)

234 
o§_mŒ
.
	`move
(
DEFAULTS
.
	`g‘
('PRESETS.OSA.OUT')[0])

236 
def
 
	$Ú_do_süibbËr
(
£lf
, 
checked
):

237 if(
checked
):

239 
sizex
 = 2000

240 
sizey
 = 2000

241 
£lf
.
süibbËr_’abËd
 = 
True


242 #£lf.
¶ÙWidg‘
 = 
MAIN_OBJ
.
	`g‘
('IMAGE_WIDGET')

243 #£lf.
¶ÙWidg‘
.
	`š™D©a
(
image_ty³s
.
IMAGE
, 
sizex
*2.0 , 
sizey
*2.0, {
SPDB_RECT
: (-1*sizex, -1*sizey, sizex, sizey)
	}
})

244 #£lf.
¶ÙWidg‘
.
£t_autosÿË
(
fl_¶Ù_wšdow
=
True
)

246 #MAIN_OBJ.
deviû
('D‘CÁr_SÇpshÙ').
chªged
.
cÚÃù
(
£lf
.
Ú_Ãw_d‘_d©a
)

249 
£lf
.
süibbËr_’abËd
 = 
F®£


250 #MAIN_OBJ.
deviû
('D‘CÁr_SÇpshÙ').
chªged
.
discÚÃù
(
£lf
.
Ú_Ãw_d‘_d©a
)

251 #£lf.
¶ÙWidg‘
.
d–ImagePlÙI‹ms
()

253 
def
 
	$Ú_Ãw_d‘_d©a
(
£lf
, 
¬r
):

254 if(
£lf
.
süibbËr_’abËd
):

255 
couÁs
 = 
¬r
[0]

256 
x
 = 
¬r
[1]

257 
y
 = 
¬r
[2]

258 
£lf
.
¶ÙWidg‘
.
	`addPix–
(
x
, 
y
, 
couÁs
, 50, 
True
)

259 
£lf
.
fbk_úŒ
 = 0

261 
£lf
.
fbk_úŒ
 += 1

263 
def
 
	$move_d‘xy_mŒs
(
£lf
, 
xpos
, 
ypos
):

264 
MAIN_OBJ
.
	`deviû
(
DNM_DETECTOR_X
).
	$move
(
xpos
)

265 
MAIN_OBJ
.
	`deviû
(
DNM_DETECTOR_Y
).
	$move
(
ypos
)

267 
def
 
	$£t_dw–l
(
£lf
, 
dw–l
):

268 
£lf
.
	$£t_·rm
(
£lf
.
dw–lFld
, 
dw–l
)

269 
£lf
.
	$upd©e_d©a
()

271 
def
 
	$£t_roi
(
£lf
, 
roi
):

273 
£t_roi
 
¡ªd¬d
 
funùiÚ
 
suµÜ‹d
 
by
 
®l
 
sÿn
 
¶uggšs
 
to
 
š™Ÿlize
 
the
 
GUI
 
this
 sÿÀ
w™h
 
v®ues


274 
¡Üed
 
š
 
the
 
deçuÉs
 
lib¿ry


276 :
·¿m
 
roi
: 
is
 
a
 
¡ªd¬d
 
diù
 
»tuºed
 
äom
 
the
 
ÿÎ
 
to
 
DEFAULTS
.
	$g‘_deçuÉs
()

277 :
ty³
 
roi
: 
diù
.

279 :
»tuºs
: 
NÚe


282 #´šˆ'd‘_sÿn: s‘_roi: ' , 
roi


283 (
cx
, 
cy
, 
cz
, 
c0
èğ
roi
['CENTER']

284 (
rx
, 
ry
, 
rz
, 
s0
èğ
roi
['RANGE']

285 (
nx
, 
ny
, 
nz
, 
n0
èğ
roi
['NPOINTS']

286 (
sx
, 
sy
, 
sz
, 
s0
èğ
roi
['STEP']

288 if('DWELL' 
š
 
roi
):

289 
£lf
.
	`£t_·rm
(£lf.
dw–lFld
, 
roi
['DWELL'])

291 
£lf
.
	$£t_·rm
(
£lf
.
ûÁ”XFld
, 
cx
)

292 
£lf
.
	$£t_·rm
(
£lf
.
ûÁ”YFld
, 
cy
)

294 if(
rx
 !ğ
NÚe
):

295 
£lf
.
	$£t_·rm
(
£lf
.
¿ngeXFld
, 
rx
)

296 if(
ry
 !ğ
NÚe
):

297 
£lf
.
	$£t_·rm
(
£lf
.
¿ngeYFld
, 
ry
)

299 if(
nx
 !ğ
NÚe
):

300 
£lf
.
	`£t_·rm
(£lf.
ÅoštsXFld
, 
nx
, 
ty³
='št', 
æoÜ
=2)

302 if(
ny
 !ğ
NÚe
):

303 
£lf
.
	`£t_·rm
(£lf.
ÅoštsYFld
, 
ny
, 
ty³
='št', 
æoÜ
=2)

305 if(
sx
 !ğ
NÚe
):

306 
£lf
.
	`£t_·rm
(£lf.
¡•XFld
, 
sx
, 
ty³
='æßt', 
æoÜ
=0)

308 if(
sy
 !ğ
NÚe
):

309 
£lf
.
	`£t_·rm
(£lf.
¡•YFld
, 
sy
, 
ty³
='æßt', 
æoÜ
=0)

313 
def
 
	$mod_roi
(
£lf
, 
¥_db
, 
do_»ÿlc
=
True
):

315 
¥_db
 
is
 
a
 
widg‘_com
 
diù


316 
The
 
pu½o£
 
of
 
the
 
	$mod_roi
(è
funùiÚ
 
is
 
to
 
upd©e
 
the
 
f›lds
 
š
h
GUI
 
w™h
h
cÜ»ù
 
v®ues


317 
™
 
ÿn
 
be
 
ÿÎed
 
by
 
e™h”
 
a
 
sigÇl
 
äom
 
Úe
 
of
 
the
 
ed™
 
	`f›lds
 (
ex
: 
£lf
.
ûÁ”XFld
è
Ü


318 
by
 
a
 
sigÇl
 
äom
‡ 
	$¶Ù‹r
 (
vŸ
 
the
 
maš
 
gui
 
th©
 
is
 
cÚÃùed
 
to
h
¶Ù‹r
è
so
h© 
as
 
a
 
u£r


319 
g¿bs
 
a
 
»giÚ
 
of
 
š‹»¡
 
m¬k”
 
š
 
the
 
¶Ù
 
ªd
 
e™h”
 
moves
 
Ü
 
»sizes
 
™
, 
tho£
 
Ãw
 
ûÁ”
‡nd 
size


320 
v®ues
 
wl
 
be
 
d–iv”ed
 
h”e
 
ªd
, 
»quœed
, 
the
 
¡•sizes
 wÈb
»ÿlcuÏ‹d


323 :
·¿m
 
¥_db
: 
is
 
a
 
¡ªd¬d
 
diù
 
»tuºed
 
äom
 
the
 
ÿÎ
 
to
 
sm
.
¡xm_cÚŒŞ
.
¡xm_uts
.
roi_uts
.
	$make_¥©Ÿl_db_diù
()

324 :
ty³
 
¥_db
: 
diù
.

326 :
·¿m
 
do_»ÿlc
: 
£Ëùiv–y
 
the
 
STEP
 
of
h
ROI
's for X‡nd Y can be„ecalculated ifhe‚umber of…oints or„ange have changed

327 :
ty³
 
do_»ÿlc
: 
æag
.

329 :
»tuºs
: 
NÚe


332 if(
¥_db
['CMND'] =ğ
widg‘_com_cmnd_ty³s
.
DEL_ROI
):

335 if(
£lf
.
süibbËr_’abËd
):

336 
x_roi
 = 
¥_db
[
SPDB_X
]

337 
y_roi
 = 
¥_db
[
SPDB_Y
]

338 
£lf
.
	`move_d‘xy_mŒs
(
x_roi
['CENTER'], 
y_roi
['CENTER'])

341 if(
¥_db
['CMND'] =ğ
widg‘_com_cmnd_ty³s
.
LOAD_SCAN
):

342 
£lf
.
¥_db
 = sp_db

344 if(
¥_db
['CMND'] =ğ
widg‘_com_cmnd_ty³s
.
SELECT_ROI
):

345 #dù_put(
£lf
.
¥_db
, 
SPDB_SCAN_PLUGIN_ITEM_ID
, 
	`dù_g‘
(¥_db, 
SPDB_PLOT_ITEM_ID
))

346 
	`dù_put
(
£lf
.
¥_db
, 
SPDB_ID_VAL
, 
	$dù_g‘
(
¥_db
, 
SPDB_PLOT_ITEM_ID
))

348 
£lf
.
¥_db
[
SPDB_X
]['CENTER'] = sp_db[SPDB_X]['CENTER']

350 if(
¥_db
[
SPDB_X
]['RANGE'] != 0):

351 
£lf
.
¥_db
[
SPDB_X
]['RANGE'] = sp_db[SPDB_X]['RANGE']

353 
£lf
.
¥_db
[
SPDB_Y
]['CENTER'] = sp_db[SPDB_Y]['CENTER']

355 if(
¥_db
[
SPDB_Y
]['RANGE'] != 0):

356 
£lf
.
¥_db
[
SPDB_Y
]['RANGE'] = sp_db[SPDB_Y]['RANGE']

358 
x_roi
 = 
£lf
.
¥_db
[
SPDB_X
]

359 
y_roi
 = 
£lf
.
¥_db
[
SPDB_Y
]

360 
e_rois
 = 
£lf
.
¥_db
[
SPDB_EV_ROIS
]

362 #ià
do_»ÿlc
 
th’
 
™
 
is
 
beÿu£
 
	`mod_roi
(è
has
 
b“n
 
ÿÎed
 
by
 
a
 
sigÇl
 
th©
 
the


363 #¶ÙWidg‘‹¸
has
 
»sized
/
moved
 
the
 
ROI
,h
»ÿlc
 
of
 
x
/
y
 
wh’
h
numb”
 oà
pošts


364 #i 
chªged
 
is
 
hªdËd
 
above
 
š
 
the
 
sigÇl
 th
ÅoštsFld


365 if(
do_»ÿlc
):

366 
	$Ú_¿nge_chªged
(
x_roi
)

367 
	$Ú_¿nge_chªged
(
y_roi
)

369 
£lf
.
	`£t_·rm
(£lf.
ûÁ”XFld
, 
x_roi
['CENTER'])

370 
£lf
.
	`£t_·rm
(£lf.
ûÁ”YFld
, 
y_roi
['CENTER'])

372 if(
e_rois
[0]['DWELL'] !ğ
NÚe
):

373 
£lf
.
	`£t_·rm
(£lf.
dw–lFld
, 
e_rois
[0]['DWELL'])

375 if(
x_roi
['RANGE'] !ğ
NÚe
):

376 
£lf
.
	`£t_·rm
(£lf.
¿ngeXFld
, 
x_roi
['RANGE'])

377 if(
y_roi
['RANGE'] !ğ
NÚe
):

378 
£lf
.
	`£t_·rm
(£lf.
¿ngeYFld
, 
y_roi
['RANGE'])

380 if(
x_roi
['NPOINTS'] !ğ
NÚe
):

381 
£lf
.
	`£t_·rm
(£lf.
ÅoštsXFld
, 
x_roi
['NPOINTS'], 
ty³
='št', 
æoÜ
=2)

383 if(
y_roi
['NPOINTS'] !ğ
NÚe
):

384 
£lf
.
	`£t_·rm
(£lf.
ÅoštsYFld
, 
y_roi
['NPOINTS'], 
ty³
='št', 
æoÜ
=2)

386 if(
x_roi
['STEP'] !ğ
NÚe
):

387 
£lf
.
	`£t_·rm
(£lf.
¡•XFld
, 
x_roi
['STEP'], 
ty³
='æßt', 
æoÜ
=0)

389 if(
y_roi
['STEP'] !ğ
NÚe
):

390 
£lf
.
	`£t_·rm
(£lf.
¡•YFld
, 
y_roi
['STEP'], 
ty³
='æßt', 
æoÜ
=0)

392 if(
¥_db
['CMND'] =ğ
widg‘_com_cmnd_ty³s
.
SELECT_ROI
):

393 
£lf
.
	$upd©e_Ï¡_£‰šgs
()

395 
def
 
	$upd©e_Ï¡_£‰šgs
(
£lf
):

398 
x_roi
 = 
£lf
.
¥_db
[
SPDB_X
]

399 
y_roi
 = 
£lf
.
¥_db
[
SPDB_Y
]

400 
e_rois
 = 
£lf
.
¥_db
[
SPDB_EV_ROIS
]

402 
DEFAULTS
.
	`£t
('SCAN.DETECTOR.CENTER', (
x_roi
['CENTER'], 
y_roi
['CENTER'], 0, 0))

403 
DEFAULTS
.
	`£t
('SCAN.DETECTOR.RANGE', (
x_roi
['RANGE'], 
y_roi
['RANGE'], 0, 0))

404 
DEFAULTS
.
	`£t
('SCAN.DETECTOR.NPOINTS', (
x_roi
['NPOINTS'], 
y_roi
['NPOINTS'], 0, 0))

405 
DEFAULTS
.
	`£t
('SCAN.DETECTOR.STEP', (
x_roi
['STEP'], 
y_roi
['STEP'], 0, 0))

406 
DEFAULTS
.
	`£t
('SCAN.DETECTOR.DWELL', 
e_rois
[0]['DWELL'])

407 
DEFAULTS
.
	$upd©e
()

409 
def
 
	$upd©e_d©a
(
£lf
):

411 
This
 
is
 
a
 
¡ªd¬d
 
funùiÚ
 
th©
 
®l
 
sÿn
 
¶uggšs
 
have
h© i 
ÿÎed
 
to


412 
g‘
 
the
 
d©a
 
äom
h
¶uggšs
 
UI
 
widg‘s
 
ªd
 
wr™e
 
them
 
što
 
a
 
diù
 
»tuºed
 
by


413 
	`g‘_ba£_sÿÅ¬am_roi
(), 
this
 
diù
 
is
 
em™‹d
 
by
 
®l
 
sÿn
 
¶uggšs
 
to
 
be
 
u£d
 by

414 
the
 
sÿn
 
şas£s
 
	$cÚfigu»
(è
funùiÚs


416 :
»tuºs
: 
NÚe


419 #upd©
loÿl
 
widg‘_com
 
diù


420 
wdg_com
 = 
£lf
.
	$upd©e_sšgË_¥©Ÿl_wdg_com
()

422 
£lf
.
	$upd©e_Ï¡_£‰šgs
()

424 
£lf
.
roi_chªged
.
	$em™
(
wdg_com
)

425 (
wdg_com
)

	@scan_plugins/det_scan.py

2 
C»©ed
 
Ú
 
	gAug
 25, 2014

4 @
	gauthÜ
: 
b”gr


7 
C»©ed
 
Ú
 
Aug
 25, 2014

9 @
	gauthÜ
: 
b”gr


11 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
QtGui


12 
äom
 
PyQt5
 
impÜt
 
uic


14 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
bl07ID01
 
impÜt
 
	gMAIN_OBJ
, 
DEFAULTS


15 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
sÿn_¶ugšs
 
impÜt
 
¶ugš_dœ


16 
äom
 
	gşs
.
	gsÿÂšg
.
·¿mLšeEd™
 
impÜt
 
	gštLšeEd™P¬amObj
, 
dblLšeEd™P¬amObj


17 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
deviû_Çmes
 
impÜt
 *

18 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	gsÿn_¶ugšs
.
D‘eùÜSSCAN
 
impÜt
 DetectorSSCAN

19 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	gd©a
.
bioxas_im_d©a_io
 
impÜt
 
BioxasD©aIo


21 
äom
 
	gşs
.
	guts
.
roi_uts
 
impÜt
 
	gg‘_ba£_roi
, 
	gg‘_ba£_’”gy_roi
, 
	gmake_¥©Ÿl_db_diù
, 
	gwidg‘_com_cmnd_ty³s
, 
	gÚ_¿nge_chªged
, 
Ú_ûÁ”_chªged


23 
äom
 
	gşs
.
	gsÿÂšg
.
ba£
 
impÜt
 
	gSÿnP¬amWidg‘
, 
zp_focus_modes


24 
äom
 
	gşs
.
	gsÿÂšg
.
ty³s
 
impÜt
 
	gsÿn_ty³s
, 
	gsÿn_·Ãl_Üd”
, 
	g¥©Ÿl_ty³_´efix
, 
image_ty³s


26 
äom
 
	gşs
.
	g¶ÙWidg‘s
.
sh­e_»¡riùiÚs
 
impÜt
 
	gROILim™Obj
, 
ROILim™Def


27 
äom
 
	gşs
.
	g¶ÙWidg‘s
.
cŞÜ_def
 
impÜt
 
	gg‘_nÜm®_şr
, 
	gg‘_w¬n_şr
, 
	gg‘_®¬m_şr
, 
	gg‘_nÜm®_fl_·‰”n
, 
	gg‘_w¬n_fl_·‰”n
, 
g‘_®¬m_fl_·‰”n


29 
äom
 
	gşs
.
	guts
.
diù_uts
 
impÜt
 
	gdù_g‘
, 
dù_put


30 
äom
 
	gşs
.
	guts
.
roi_diù_defs
 
impÜt
 *

31 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
g‘_moduË_logg”


34 
	g_logg”
 = 
	$g‘_moduË_logg”
(
__Çme__
)

36 
şass
 
	$D‘eùÜSÿnP¬am
(
SÿnP¬amWidg‘
):

37 
Çme
 = "Detector Scan"

38 
idx
 = 
sÿn_·Ãl_Üd”
.
DETECTOR_SCAN


39 
ty³
 = 
sÿn_ty³s
.
DETECTOR_IMAGE


40 
£ùiÚ_id
 = 'DETECTOR'

41 
axis_¡ršgs
 = ['Det Y microns', 'Det X microns', '', '']

42 
zp_focus_mode
 = 
zp_focus_modes
.
FL


44 
d©a_fe_pfx
 = 
MAIN_OBJ
.
	$g‘_d©afe_´efix
()

45 
¶Ù_™em_ty³
 = 
¥©Ÿl_ty³_´efix
.
ROI


47 
d©a
 = {
	}
}

49 
def
 
	$__š™__
(
£lf
, 
·»Á
=
NÚe
):

50 
SÿnP¬amWidg‘
.
	$__š™__
(
£lf
, 
maš_obj
=
MAIN_OBJ
, 
d©a_io
=
BioxasD©aIo
, 
dæts
=
DEFAULTS
)

51 
£lf
.
_·»Á
 = 
·»Á


52 
uic
.
	`lßdUi
(
¶ugš_dœ
 + '/d‘_sÿn.ui', 
£lf
)

54 
£lf
.
ssÿn_şass
 = 
	$D‘eùÜSSCAN
()

56 
£lf
.
süibbËrBŠ
.
	$£tVisibË
(
True
)

58 
£lf
.
süibbËr_’abËd
 = 
F®£


59 
£lf
.
¶ÙWidg‘
 = 
NÚe


60 #upd©
şib¿‹d
 
po¢


61 #mŒx = 
MAIN_OBJ
.
	`deviû
(
DNM_DETECTOR_X
)

62 #mŒy = 
MAIN_OBJ
.
	`deviû
(
DNM_DETECTOR_Y
)

63 #ûÁ = 
DEFAULTS
.
	`g‘
('PRESETS.DETECTOR.CALIBPOSN')

64 #if(
ûÁ
 !ğ
NÚe
):

65 #mŒx.
	`£t_ÿlib¿‹d_pos™iÚ
(
ûÁ
[0])

66 #mŒy.
	`£t_ÿlib¿‹d_pos™iÚ
(
ûÁ
[1])

68 #ÿlX = 
mŒx
.
	`g‘
('calibPosn')

69 #ÿlY = 
mŒy
.
	`g‘
('calibPosn')

70 #DEFAULTS.
	`£t
('PRESETS.DETECTOR.CALIBPOSN', (
ÿlX
, 
ÿlY
))

71 #DEFAULTS.
	`upd©e
()

72 #£lf.
	`£tup_d‘eùÜ_¶Ù
()

73 #£lf.
d©a
 = {
	}
}

74 
	g£lf
.
	gsüibbËrBŠ
.
	gşicked
.
	$cÚÃù
(
£lf
.
Ú_do_süibbËr
)

75 
£lf
.
o§OutBŠ
.
şicked
.
	$cÚÃù
(
£lf
.
Ú_o§_out
)

76 
£lf
.
£tC’‹rBŠ
.
şicked
.
	$cÚÃù
(
£lf
.
Ú_£t_ûÁ”
)

77 
£lf
.
lßdSÿnBŠ
.
şicked
.
	$cÚÃù
(
£lf
.
lßd_sÿn
)

79 
£lf
.
¥_db
 = 
NÚe


80 
£lf
.
	$lßd_äom_deçuÉs
()

81 
£lf
.
	$š™_¥_db
()

82 
£lf
.
	$cÚÃù_·¿mf›ld_sigÇls
()

83 
£lf
.
	$Ú_sšgË_¥©Ÿl_Åošts_chªged
()

86 
def
 
	$cÚÃù_·¿mf›ld_sigÇls
(
£lf
):

88 
mŒ_x
 = 
MAIN_OBJ
.
	$deviû
(
DNM_DETECTOR_X
)

89 
mŒ_y
 = 
MAIN_OBJ
.
	$deviû
(
DNM_DETECTOR_Y
)

91 
xÎm
 = 
mŒ_x
.
	`g‘
('LLM')

92 
xhlm
 = 
mŒ_x
.
	`g‘
('HLM')

93 
yÎm
 = 
mŒ_y
.
	`g‘
('LLM')

94 
yhlm
 = 
mŒ_y
.
	`g‘
('HLM')

96 
rx
 = 
xhlm
 - 
xÎm


97 
ry
 = 
yhlm
 - 
yÎm


99 
lim_dù
 = {
	}
}

100 
lim_dù
['X'] = {'Îm':
xÎm
, 'hlm': 
xhlm
, 'ºg':
rx
}

101 
lim_dù
['Y'] = {'Îm':
yÎm
, 'hlm': 
yhlm
, 'ºg':
ry
}

103 
£lf
.
	$cÚÃù_·¿m_æds_to_v®id©Ü
(
lim_dù
)

105 ##
£lf
.
dw–lFld
 = 
	`dblP¬amLšeEd™
('dw–lFld', 0.0, 10000.0, 2, 
æd
=self.dwellFld)

106 ##
£lf
.
dw–lFld
.
v®id_»tuºP»s£d
.
	`cÚÃù
(£lf.
upd©e_d©a
)

107 #£lf.
dw–lFld
.
dpo
 = 
	`dblLšeEd™P¬amObj
('dw–lFld', 0.0, 10000.0, 3, 
·»Á
=
£lf
.dwellFld)

108 #£lf.
dw–lFld
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(
£lf
.
upd©e_d©a
)

109 #
##
£lf
.
ûÁ”XFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_sšgË_¥©Ÿl_ûÁ”_chªged
)

110 #£lf.
ûÁ”XFld
.
dpo
 = 
	`dblLšeEd™P¬amObj
('ûÁ”XFld', 
xÎm
, 
xhlm
, 3, 
·»Á
=
£lf
.centerXFld)

111 #£lf.
ûÁ”XFld
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(
£lf
.
Ú_sšgË_¥©Ÿl_ûÁ”_chªged
)

112 #
##
£lf
.
¿ngeXFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_sšgË_¥©Ÿl_¿nge_chªged
)

113 #£lf.
¿ngeXFld
.
dpo
 = 
	`dblLšeEd™P¬amObj
('¿ngeXFld', -0.5*
rx
, 0.5*rx, 3, 
·»Á
=
£lf
.rangeXFld)

114 #£lf.
¿ngeXFld
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(
£lf
.
Ú_sšgË_¥©Ÿl_¿nge_chªged
)

115 #
##
£lf
.
ÅoštsXFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_sšgË_¥©Ÿl_Åošts_chªged
)

116 #£lf.
ÅoštsXFld
.
dpo
 = 
	`štLšeEd™P¬amObj
('ÅoštsXFld', 0, 10000, 0, 
·»Á
=
£lf
.npointsXFld)

117 #£lf.
ÅoštsXFld
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(
£lf
.
Ú_sšgË_¥©Ÿl_Åošts_chªged
)

118 #
##
£lf
.
¡•XFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_sšgË_¥©Ÿl_¡•size_chªged
)

119 #£lf.
¡•XFld
.
dpo
 = 
	`dblLšeEd™P¬amObj
('¡•XFld', 0.0, 10000.0, 3, 
·»Á
=
£lf
.stepXFld)

120 #£lf.
¡•XFld
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(
£lf
.
Ú_sšgË_¥©Ÿl_¡•size_chªged
)

121 #
##
£lf
.
ûÁ”YFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_sšgË_¥©Ÿl_ûÁ”_chªged
)

122 #£lf.
ûÁ”YFld
.
dpo
 = 
	`dblLšeEd™P¬amObj
('ûÁ”YFld', 
yÎm
, 
yhlm
, 3, 
·»Á
=
£lf
.centerYFld)

123 #£lf.
ûÁ”YFld
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(
£lf
.
Ú_sšgË_¥©Ÿl_ûÁ”_chªged
)

124 #
##
£lf
.
¿ngeYFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_sšgË_¥©Ÿl_¿nge_chªged
)

125 #£lf.
¿ngeYFld
.
dpo
 = 
	`dblLšeEd™P¬amObj
('¿ngeYFld', -0.5*
ry
, 0.5*ry, 3, 
·»Á
=
£lf
.rangeYFld)

126 #£lf.
¿ngeYFld
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(
£lf
.
Ú_sšgË_¥©Ÿl_¿nge_chªged
)

127 #
##
£lf
.
ÅoštsYFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_sšgË_¥©Ÿl_Åošts_chªged
)

128 #£lf.
ÅoštsYFld
.
dpo
 = 
	`štLšeEd™P¬amObj
('ÅoštsYFld', 0, 10000, 0, 
·»Á
=
£lf
.npointsYFld)

129 #£lf.
ÅoštsYFld
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(
£lf
.
Ú_sšgË_¥©Ÿl_Åošts_chªged
)

130 #
##
£lf
.
¡•YFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_sšgË_¥©Ÿl_¡•size_chªged
)

131 #£lf.
¡•YFld
.
dpo
 = 
	`dblLšeEd™P¬amObj
('¡•YFld', 0.0, 10000.0, 3, 
·»Á
=
£lf
.stepYFld)

132 #£lf.
¡•YFld
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(
£lf
.
Ú_sšgË_¥©Ÿl_¡•size_chªged
)

136 
def
 
	$g’_max_sÿn_¿nge_lim™_def
(
£lf
):

139 
mŒ_x
 = 
MAIN_OBJ
.
	$deviû
(
DNM_DETECTOR_X
)

140 
mŒ_y
 = 
MAIN_OBJ
.
	$deviû
(
DNM_DETECTOR_Y
)

142 
xÎm
 = 
mŒ_x
.
	`g‘
('LLM')

143 
xhlm
 = 
mŒ_x
.
	`g‘
('HLM')

144 
yÎm
 = 
mŒ_y
.
	`g‘
('LLM')

145 
yhlm
 = 
mŒ_y
.
	`g‘
('HLM')

147 
boundšg_q»ù
 = 
QtCÜe
.
	`QReùF
(QtCÜe.
	`QPoštF
(
xÎm
, 
yhlm
), QtCÜe.
	$QPoštF
(
xhlm
, 
yÎm
))

148 
w¬n_q»ù
 = 
£lf
.
	`g‘_³rûÁage_of_q»ù
(
boundšg_q»ù
, 0.80è#%80 
of
 
max


149 
®¬m_q»ù
 = 
£lf
.
	`g‘_³rûÁage_of_q»ù
(
boundšg_q»ù
, 0.95è#%95 
of
 
max


151 
boundšg
 = 
	`ROILim™Obj
(
boundšg_q»ù
, 
	`g‘_®¬m_şr
(255), 'Rªgi beyÚd D‘eùÜ C­ab™›s', 
	$g‘_®¬m_fl_·‰”n
())

152 
nÜm®
 = 
	`ROILim™Obj
(
boundšg_q»ù
, 
	`g‘_nÜm®_şr
(45), 'D‘eùÜ Sÿn', 
	$g‘_nÜm®_fl_·‰”n
())

153 
w¬n
 = 
	`ROILim™Obj
(
w¬n_q»ù
, 
	`g‘_w¬n_şr
(150), 'N—ršg max RªgoàD‘eùÜ X/Y', 
	$g‘_w¬n_fl_·‰”n
())

154 
®¬m
 = 
	`ROILim™Obj
(
®¬m_q»ù
, 
	`g‘_®¬m_şr
(255), 'BeyÚd„ªgoàD‘eùÜ X/Y', 
	$g‘_®¬m_fl_·‰”n
())

156 
£lf
.
roi_lim™_def
 = 
	$ROILim™Def
(
boundšg
, 
nÜm®
, 
w¬n
, 
®¬m
)

158 
def
 
	$š™_¥_db
(
£lf
):

160 
š™_¥_db
 
¡ªd¬d
 
funùiÚ
 
suµÜ‹d
 
by
 
®l
 
sÿn
 
¶uggšs
 
to
 
š™Ÿlize
 
the
 
loÿl
 
widg‘_com
 
diù
Ø
wh©ev”
he

161 
GUI
 
is
 
cu¼’y
 
di¥Ïyšg
, 
this
 i 
usu®ly
 
ÿÎed
 
aá”
 
the
 
ÿÎ
 
to
 
£lf
.
	$lßd_äom_deçuÉs
()

163 :
»tuºs
: 
NÚe


166 
cx
 = (
	`¡r
(
£lf
.
ûÁ”XFld
.
	$‹xt
()))

167 
rx
 = (
	`¡r
(
£lf
.
¿ngeXFld
.
	$‹xt
()))

168 
cy
 = (
	`¡r
(
£lf
.
ûÁ”YFld
.
	$‹xt
()))

169 
ry
 = (
	`¡r
(
£lf
.
¿ngeYFld
.
	$‹xt
()))

170 
dw–l
 = (
	`¡r
(
£lf
.
dw–lFld
.
	$‹xt
()))

171 
nx
 = (
	`¡r
(
£lf
.
ÅoštsXFld
.
	$‹xt
()))

172 
ny
 = (
	`¡r
(
£lf
.
ÅoštsYFld
.
	$‹xt
()))

173 
sx
 = (
	`¡r
(
£lf
.
¡•XFld
.
	$‹xt
()))

174 
sy
 = (
	`¡r
(
£lf
.
¡•YFld
.
	$‹xt
()))

175 #now 
ü—‹
 
the
 
mod–
 
th©
 
this
 
¶uggš
 
wl
 
u£
 
to
 
»cÜd
 
™s
 
·¿ms


176 
x_roi
 = 
	$g‘_ba£_roi
(
SPDB_X
, 
DNM_DETECTOR_X
, 
cx
, 
rx
, 
nx
, 
sx
)

177 
y_roi
 = 
	$g‘_ba£_roi
(
SPDB_Y
, 
DNM_DETECTOR_Y
, 
cy
, 
ry
, 
ny
, 
sy
)

178 
z_roi
 = 
	`g‘_ba£_roi
(
SPDB_Z
, 
DNM_DETECTOR_Z
, 0, 0, 0, 
’abË
=
F®£
)

180 
’”gy_pos
 = 
MAIN_OBJ
.
	`deviû
(
DNM_ENERGY
).
	`g‘
('RBV')

181 
e_roi
 = 
	`g‘_ba£_’”gy_roi
(
SPDB_EV
, 
DNM_ENERGY
, 
’”gy_pos
,ƒÃrgy_pos, 0, 1, 
dw–l
, 
NÚe
, 
’abË
=
F®£
 )

183 
£lf
.
¥_db
 = 
	$make_¥©Ÿl_db_diù
(
x_roi
=x_roi, 
y_roi
=y_roi, 
z_roi
=z_roi, 
e_roi
=e_roi)

185 
def
 
	$check_sÿn_lim™s
(
£lf
):

187 
checks
 
the
 
sÿn
 
·¿m‘”s
 
agaš¡
h
soá
 
lim™s
 
of
he

188 
pos™iÚ”s
, 
®l
 
is
 
w–l
  
Œue
 
çl£


190 
This
 
funùiÚ
 
should
 
´ovide
 
ª
 
ex¶ic™
 
”rÜ
 
log
 
msg
 
to
 
aide
 
the
 
u£r


192 
»t
 = 
£lf
.
	$check_ûÁ”_¿nge_xy_sÿn_lim™s
(
DNM_DETECTOR_X
, 
DNM_DETECTOR_Y
)

193 (
»t
)

195 
def
 
	$Ú_£t_ûÁ”
(
£lf
):

196 
ûÁX
 = (
	`¡r
(
£lf
.
ûÁ”XFld
.
	$‹xt
()))

197 
ûÁY
 = (
	`¡r
(
£lf
.
ûÁ”YFld
.
	$‹xt
()))

199 
mŒx
 = 
MAIN_OBJ
.
	$deviû
(
DNM_DETECTOR_X
)

200 
mŒy
 = 
MAIN_OBJ
.
	$deviû
(
DNM_DETECTOR_Y
)

202 #DRBV + 
CENTX


203 #pÿlX = 
mŒx
.
	`g‘
('calibPosn')

204 #pÿlY = 
mŒy
.
	`g‘
('calibPosn')

206 #mŒx.
	`£t_ÿlib¿‹d_pos™iÚ
(
ûÁX
 + 
pÿlX
)

207 #mŒy.
	`£t_ÿlib¿‹d_pos™iÚ
(
ûÁY
 + 
pÿlY
)

209 
£lf
.
¥_db
[
SPDB_X
]['CENTER'] = 0.0

210 
	$Ú_ûÁ”_chªged
(
£lf
.
¥_db
[
SPDB_X
])

211 
£lf
.
¥_db
[
SPDB_Y
]['CENTER'] = 0.0

212 
	$Ú_ûÁ”_chªged
(
£lf
.
¥_db
[
SPDB_Y
])

214 
mŒx
.
	$move
(
ûÁX
)

215 
mŒy
.
	$move
(
ûÁY
)

217 
mŒx
.
	$wa™_fÜ_¡İ³d_ªd_z”o
()

218 
mŒy
.
	$wa™_fÜ_¡İ³d_ªd_z”o
()

220 
roi
 = {
	}
}

221 
roi
['CENTER'] = (0.0, 0.0, 0.0, 0.0)

222 
	groi
['RANGE'] = (
NÚe
, 
	gNÚe
, None, None)

223 
	groi
['NPOINTS'] = (
NÚe
, 
	gNÚe
, None, None)

224 
	groi
['STEP'] = (
NÚe
, 
	gNÚe
, None, None)

225 
	g£lf
.
	$£t_roi
(
roi
)

227 
DEFAULTS
.
	`£t
('PRESETS.DETECTOR.CALIBPOSN', (
ûÁX
, 
ûÁY
))

228 
DEFAULTS
.
	`£t
('PRESETS.DETECTOR.CENTER', (0.0, 0.0))

229 
DEFAULTS
.
	$upd©e
()

232 
def
 
	$Ú_o§_out
(
£lf
):

233 
o§_mŒ
 = 
MAIN_OBJ
.
	$deviû
(
DNM_OSA_X
)

234 
o§_mŒ
.
	`move
(
DEFAULTS
.
	`g‘
('PRESETS.OSA.OUT')[0])

236 
def
 
	$Ú_do_süibbËr
(
£lf
, 
checked
):

237 if(
checked
):

239 
sizex
 = 2000

240 
sizey
 = 2000

241 
£lf
.
süibbËr_’abËd
 = 
True


242 #£lf.
¶ÙWidg‘
 = 
MAIN_OBJ
.
	`g‘
('IMAGE_WIDGET')

243 #£lf.
¶ÙWidg‘
.
	`š™D©a
(
image_ty³s
.
IMAGE
, 
sizex
*2.0 , 
sizey
*2.0, {
SPDB_RECT
: (-1*sizex, -1*sizey, sizex, sizey)
	}
})

244 #£lf.
¶ÙWidg‘
.
£t_autosÿË
(
fl_¶Ù_wšdow
=
True
)

246 #MAIN_OBJ.
deviû
('D‘CÁr_SÇpshÙ').
chªged
.
cÚÃù
(
£lf
.
Ú_Ãw_d‘_d©a
)

249 
£lf
.
süibbËr_’abËd
 = 
F®£


250 #MAIN_OBJ.
deviû
('D‘CÁr_SÇpshÙ').
chªged
.
discÚÃù
(
£lf
.
Ú_Ãw_d‘_d©a
)

251 #£lf.
¶ÙWidg‘
.
d–ImagePlÙI‹ms
()

253 
def
 
	$Ú_Ãw_d‘_d©a
(
£lf
, 
¬r
):

254 if(
£lf
.
süibbËr_’abËd
):

255 
couÁs
 = 
¬r
[0]

256 
x
 = 
¬r
[1]

257 
y
 = 
¬r
[2]

258 
£lf
.
¶ÙWidg‘
.
	`addPix–
(
x
, 
y
, 
couÁs
, 50, 
True
)

259 
£lf
.
fbk_úŒ
 = 0

261 
£lf
.
fbk_úŒ
 += 1

263 
def
 
	$move_d‘xy_mŒs
(
£lf
, 
xpos
, 
ypos
):

264 
MAIN_OBJ
.
	`deviû
(
DNM_DETECTOR_X
).
	$move
(
xpos
)

265 
MAIN_OBJ
.
	`deviû
(
DNM_DETECTOR_Y
).
	$move
(
ypos
)

267 
def
 
	$£t_dw–l
(
£lf
, 
dw–l
):

268 
£lf
.
	$£t_·rm
(
£lf
.
dw–lFld
, 
dw–l
)

269 
£lf
.
	$upd©e_d©a
()

271 
def
 
	$£t_roi
(
£lf
, 
roi
):

273 
£t_roi
 
¡ªd¬d
 
funùiÚ
 
suµÜ‹d
 
by
 
®l
 
sÿn
 
¶uggšs
 
to
 
š™Ÿlize
 
the
 
GUI
 
this
 sÿÀ
w™h
 
v®ues


274 
¡Üed
 
š
 
the
 
deçuÉs
 
lib¿ry


276 :
·¿m
 
roi
: 
is
 
a
 
¡ªd¬d
 
diù
 
»tuºed
 
äom
 
the
 
ÿÎ
 
to
 
DEFAULTS
.
	$g‘_deçuÉs
()

277 :
ty³
 
roi
: 
diù
.

279 :
»tuºs
: 
NÚe


282 #´šˆ'd‘_sÿn: s‘_roi: ' , 
roi


283 (
cx
, 
cy
, 
cz
, 
c0
èğ
roi
['CENTER']

284 (
rx
, 
ry
, 
rz
, 
s0
èğ
roi
['RANGE']

285 (
nx
, 
ny
, 
nz
, 
n0
èğ
roi
['NPOINTS']

286 (
sx
, 
sy
, 
sz
, 
s0
èğ
roi
['STEP']

288 if('DWELL' 
š
 
roi
):

289 
£lf
.
	`£t_·rm
(£lf.
dw–lFld
, 
roi
['DWELL'])

291 
£lf
.
	$£t_·rm
(
£lf
.
ûÁ”XFld
, 
cx
)

292 
£lf
.
	$£t_·rm
(
£lf
.
ûÁ”YFld
, 
cy
)

294 if(
rx
 !ğ
NÚe
):

295 
£lf
.
	$£t_·rm
(
£lf
.
¿ngeXFld
, 
rx
)

296 if(
ry
 !ğ
NÚe
):

297 
£lf
.
	$£t_·rm
(
£lf
.
¿ngeYFld
, 
ry
)

299 if(
nx
 !ğ
NÚe
):

300 
£lf
.
	`£t_·rm
(£lf.
ÅoštsXFld
, 
nx
, 
ty³
='št', 
æoÜ
=2)

302 if(
ny
 !ğ
NÚe
):

303 
£lf
.
	`£t_·rm
(£lf.
ÅoštsYFld
, 
ny
, 
ty³
='št', 
æoÜ
=2)

305 if(
sx
 !ğ
NÚe
):

306 
£lf
.
	`£t_·rm
(£lf.
¡•XFld
, 
sx
, 
ty³
='æßt', 
æoÜ
=0)

308 if(
sy
 !ğ
NÚe
):

309 
£lf
.
	`£t_·rm
(£lf.
¡•YFld
, 
sy
, 
ty³
='æßt', 
æoÜ
=0)

313 
def
 
	$mod_roi
(
£lf
, 
¥_db
, 
do_»ÿlc
=
True
):

315 
¥_db
 
is
 
a
 
widg‘_com
 
diù


316 
The
 
pu½o£
 
of
 
the
 
	$mod_roi
(è
funùiÚ
 
is
 
to
 
upd©e
 
the
 
f›lds
 
š
h
GUI
 
w™h
h
cÜ»ù
 
v®ues


317 
™
 
ÿn
 
be
 
ÿÎed
 
by
 
e™h”
 
a
 
sigÇl
 
äom
 
Úe
 
of
 
the
 
ed™
 
	`f›lds
 (
ex
: 
£lf
.
ûÁ”XFld
è
Ü


318 
by
 
a
 
sigÇl
 
äom
‡ 
	$¶Ù‹r
 (
vŸ
 
the
 
maš
 
gui
 
th©
 
is
 
cÚÃùed
 
to
h
¶Ù‹r
è
so
h© 
as
 
a
 
u£r


319 
g¿bs
 
a
 
»giÚ
 
of
 
š‹»¡
 
m¬k”
 
š
 
the
 
¶Ù
 
ªd
 
e™h”
 
moves
 
Ü
 
»sizes
 
™
, 
tho£
 
Ãw
 
ûÁ”
‡nd 
size


320 
v®ues
 
wl
 
be
 
d–iv”ed
 
h”e
 
ªd
, 
»quœed
, 
the
 
¡•sizes
 wÈb
»ÿlcuÏ‹d


323 :
·¿m
 
¥_db
: 
is
 
a
 
¡ªd¬d
 
diù
 
»tuºed
 
äom
 
the
 
ÿÎ
 
to
 
sm
.
¡xm_cÚŒŞ
.
¡xm_uts
.
roi_uts
.
	$make_¥©Ÿl_db_diù
()

324 :
ty³
 
¥_db
: 
diù
.

326 :
·¿m
 
do_»ÿlc
: 
£Ëùiv–y
 
the
 
STEP
 
of
h
ROI
's for X‡nd Y can be„ecalculated ifhe‚umber of…oints or„ange have changed

327 :
ty³
 
do_»ÿlc
: 
æag
.

329 :
»tuºs
: 
NÚe


332 if(
¥_db
['CMND'] =ğ
widg‘_com_cmnd_ty³s
.
DEL_ROI
):

335 if(
£lf
.
süibbËr_’abËd
):

336 
x_roi
 = 
¥_db
[
SPDB_X
]

337 
y_roi
 = 
¥_db
[
SPDB_Y
]

338 
£lf
.
	`move_d‘xy_mŒs
(
x_roi
['CENTER'], 
y_roi
['CENTER'])

341 if(
¥_db
['CMND'] =ğ
widg‘_com_cmnd_ty³s
.
LOAD_SCAN
):

342 
£lf
.
¥_db
 = sp_db

344 if(
¥_db
['CMND'] =ğ
widg‘_com_cmnd_ty³s
.
SELECT_ROI
):

345 #dù_put(
£lf
.
¥_db
, 
SPDB_SCAN_PLUGIN_ITEM_ID
, 
	`dù_g‘
(¥_db, 
SPDB_PLOT_ITEM_ID
))

346 
	`dù_put
(
£lf
.
¥_db
, 
SPDB_ID_VAL
, 
	$dù_g‘
(
¥_db
, 
SPDB_PLOT_ITEM_ID
))

348 
£lf
.
¥_db
[
SPDB_X
]['CENTER'] = sp_db[SPDB_X]['CENTER']

350 if(
¥_db
[
SPDB_X
]['RANGE'] != 0):

351 
£lf
.
¥_db
[
SPDB_X
]['RANGE'] = sp_db[SPDB_X]['RANGE']

353 
£lf
.
¥_db
[
SPDB_Y
]['CENTER'] = sp_db[SPDB_Y]['CENTER']

355 if(
¥_db
[
SPDB_Y
]['RANGE'] != 0):

356 
£lf
.
¥_db
[
SPDB_Y
]['RANGE'] = sp_db[SPDB_Y]['RANGE']

358 
x_roi
 = 
£lf
.
¥_db
[
SPDB_X
]

359 
y_roi
 = 
£lf
.
¥_db
[
SPDB_Y
]

360 
e_rois
 = 
£lf
.
¥_db
[
SPDB_EV_ROIS
]

362 #ià
do_»ÿlc
 
th’
 
™
 
is
 
beÿu£
 
	`mod_roi
(è
has
 
b“n
 
ÿÎed
 
by
 
a
 
sigÇl
 
th©
 
the


363 #¶ÙWidg‘‹¸
has
 
»sized
/
moved
 
the
 
ROI
,h
»ÿlc
 
of
 
x
/
y
 
wh’
h
numb”
 oà
pošts


364 #i 
chªged
 
is
 
hªdËd
 
above
 
š
 
the
 
sigÇl
 th
ÅoštsFld


365 if(
do_»ÿlc
):

366 
	$Ú_¿nge_chªged
(
x_roi
)

367 
	$Ú_¿nge_chªged
(
y_roi
)

369 
£lf
.
	`£t_·rm
(£lf.
ûÁ”XFld
, 
x_roi
['CENTER'])

370 
£lf
.
	`£t_·rm
(£lf.
ûÁ”YFld
, 
y_roi
['CENTER'])

372 if(
e_rois
[0]['DWELL'] !ğ
NÚe
):

373 
£lf
.
	`£t_·rm
(£lf.
dw–lFld
, 
e_rois
[0]['DWELL'])

375 if(
x_roi
['RANGE'] !ğ
NÚe
):

376 
£lf
.
	`£t_·rm
(£lf.
¿ngeXFld
, 
x_roi
['RANGE'])

377 if(
y_roi
['RANGE'] !ğ
NÚe
):

378 
£lf
.
	`£t_·rm
(£lf.
¿ngeYFld
, 
y_roi
['RANGE'])

380 if(
x_roi
['NPOINTS'] !ğ
NÚe
):

381 
£lf
.
	`£t_·rm
(£lf.
ÅoštsXFld
, 
x_roi
['NPOINTS'], 
ty³
='št', 
æoÜ
=2)

383 if(
y_roi
['NPOINTS'] !ğ
NÚe
):

384 
£lf
.
	`£t_·rm
(£lf.
ÅoštsYFld
, 
y_roi
['NPOINTS'], 
ty³
='št', 
æoÜ
=2)

386 if(
x_roi
['STEP'] !ğ
NÚe
):

387 
£lf
.
	`£t_·rm
(£lf.
¡•XFld
, 
x_roi
['STEP'], 
ty³
='æßt', 
æoÜ
=0)

389 if(
y_roi
['STEP'] !ğ
NÚe
):

390 
£lf
.
	`£t_·rm
(£lf.
¡•YFld
, 
y_roi
['STEP'], 
ty³
='æßt', 
æoÜ
=0)

392 if(
¥_db
['CMND'] =ğ
widg‘_com_cmnd_ty³s
.
SELECT_ROI
):

393 
£lf
.
	$upd©e_Ï¡_£‰šgs
()

395 
def
 
	$upd©e_Ï¡_£‰šgs
(
£lf
):

398 
x_roi
 = 
£lf
.
¥_db
[
SPDB_X
]

399 
y_roi
 = 
£lf
.
¥_db
[
SPDB_Y
]

400 
e_rois
 = 
£lf
.
¥_db
[
SPDB_EV_ROIS
]

402 
DEFAULTS
.
	`£t
('SCAN.DETECTOR.CENTER', (
x_roi
['CENTER'], 
y_roi
['CENTER'], 0, 0))

403 
DEFAULTS
.
	`£t
('SCAN.DETECTOR.RANGE', (
x_roi
['RANGE'], 
y_roi
['RANGE'], 0, 0))

404 
DEFAULTS
.
	`£t
('SCAN.DETECTOR.NPOINTS', (
x_roi
['NPOINTS'], 
y_roi
['NPOINTS'], 0, 0))

405 
DEFAULTS
.
	`£t
('SCAN.DETECTOR.STEP', (
x_roi
['STEP'], 
y_roi
['STEP'], 0, 0))

406 
DEFAULTS
.
	`£t
('SCAN.DETECTOR.DWELL', 
e_rois
[0]['DWELL'])

407 
DEFAULTS
.
	$upd©e
()

409 
def
 
	$upd©e_d©a
(
£lf
):

411 
This
 
is
 
a
 
¡ªd¬d
 
funùiÚ
 
th©
 
®l
 
sÿn
 
¶uggšs
 
have
h© i 
ÿÎed
 
to


412 
g‘
 
the
 
d©a
 
äom
h
¶uggšs
 
UI
 
widg‘s
 
ªd
 
wr™e
 
them
 
što
 
a
 
diù
 
»tuºed
 
by


413 
	`g‘_ba£_sÿÅ¬am_roi
(), 
this
 
diù
 
is
 
em™‹d
 
by
 
®l
 
sÿn
 
¶uggšs
 
to
 
be
 
u£d
 by

414 
the
 
sÿn
 
şas£s
 
	$cÚfigu»
(è
funùiÚs


416 :
»tuºs
: 
NÚe


419 #upd©
loÿl
 
widg‘_com
 
diù


420 
wdg_com
 = 
£lf
.
	$upd©e_sšgË_¥©Ÿl_wdg_com
()

422 
£lf
.
	$upd©e_Ï¡_£‰šgs
()

424 
£lf
.
roi_chªged
.
	$em™
(
wdg_com
)

425 (
wdg_com
)

	@scan_plugins/scandata_categories.py

2 
C»©ed
 
Ú
 
	gAug
 25, 2014

4 @
	gauthÜ
: 
b”gr


6 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui


8 
äom
 
	gşs
.
	guts
.
diù_uts
 
impÜt
 
	gdù_g‘
, 
	gdù_put


10 
def
 
	$g’_axis_dù
():

11 
dù
 = {
	}
}

12 
dù_put
(
dù
, 'Dir', 0)

13 
dù_put
(
dù
, 'Max', 0)

14 
dù_put
(
dù
, 'Min', 0)

15 
dù_put
(
dù
, 'Name', '')

16 
dù_put
(
dù
, 'Points', [])

17 
dù_put
(
dù
, 'Unit', '')

18 (
	gdù
)

21 
şass
 
	$HdrSeùiÚ
(
QtCÜe
.
QObjeù
):

23 
chªged
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
)

24 
£ùiÚ
 = "" #thi 
is
 
the
 seùiÚ 
Çme


25 
d•’dªc›s
 = []

27 
def
 
	$lßd_£ùiÚ_šfo
(
£lf
, 
dù
):

29 
this
 
is
 
ª
 
API
 
ÿÎ
 
suµÜ‹d
 
by
 
—ch
 
Hdr
 
£ùiÚ
 
objeù
, 
™
 
wl
  
a
 
diù
 
»´e£Ášg


30 
the
 
£ùiÚ
 
d©a
. 
The
 
dù
 
·¿m
 
is
 
a
 
diù
 
th©
 
cÚšs
 
®l
 
of
h
šfo
 oàth
cu¼’t
 
sÿn
,he

31 
job
 
of
 
this
 
funùiÚ
 
is
 
to
 
·r£
 
out
 
the
 
·¹s
 
th©
h
£ùiÚ
 
ÿ»s
 
about
.

32 
This
 
funùiÚ
 
em™s
 
chªged
 
sigÇl
.

33 
This
 
funùiÚ
 
»tuns
 
a
 
diù
:

36 
·ss


	@scan_plugins/scandata_categories.py

2 
C»©ed
 
Ú
 
	gAug
 25, 2014

4 @
	gauthÜ
: 
b”gr


6 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui


8 
äom
 
	gşs
.
	guts
.
diù_uts
 
impÜt
 
	gdù_g‘
, 
	gdù_put


10 
def
 
	$g’_axis_dù
():

11 
dù
 = {
	}
}

12 
dù_put
(
dù
, 'Dir', 0)

13 
dù_put
(
dù
, 'Max', 0)

14 
dù_put
(
dù
, 'Min', 0)

15 
dù_put
(
dù
, 'Name', '')

16 
dù_put
(
dù
, 'Points', [])

17 
dù_put
(
dù
, 'Unit', '')

18 (
	gdù
)

21 
şass
 
	$HdrSeùiÚ
(
QtCÜe
.
QObjeù
):

23 
chªged
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
)

24 
£ùiÚ
 = "" #thi 
is
 
the
 seùiÚ 
Çme


25 
d•’dªc›s
 = []

27 
def
 
	$lßd_£ùiÚ_šfo
(
£lf
, 
dù
):

29 
this
 
is
 
ª
 
API
 
ÿÎ
 
suµÜ‹d
 
by
 
—ch
 
Hdr
 
£ùiÚ
 
objeù
, 
™
 
wl
  
a
 
diù
 
»´e£Ášg


30 
the
 
£ùiÚ
 
d©a
. 
The
 
dù
 
·¿m
 
is
 
a
 
diù
 
th©
 
cÚšs
 
®l
 
of
h
šfo
 oàth
cu¼’t
 
sÿn
,he

31 
job
 
of
 
this
 
funùiÚ
 
is
 
to
 
·r£
 
out
 
the
 
·¹s
 
th©
h
£ùiÚ
 
ÿ»s
 
about
.

32 
This
 
funùiÚ
 
em™s
 
chªged
 
sigÇl
.

33 
This
 
funùiÚ
 
»tuns
 
a
 
diù
:

36 
·ss


	@setup_env.py

2 
C»©ed
 
Ú
 
	gOù
 3, 2016

4 @
	gauthÜ
: 
b”gr


6 
impÜt
 
os


9 
·th_£p
 = ';'

10 
•icsP©h
 = 
r
'C:\controls\epics\R3.14.12.4\base\bin\win32-x86;C:\controls\epics\R3.14.12.4\lib\win32-x86;'

11 
mypy·th
 = 
r
'.\\cls;.\\blctl;C:\\eclipse\\plugins\\org.python.pydev_3.4.1.201403181715\\pysrc\\pydev_sitecustomize;.\\blctl;.\\Beamlines;.\\cls;'

13 
·th
 = [
os
.
’vœÚ
['PATH']]

14 
·th
.
ex‹nd
(
•icsP©h
.
¥l™
(';'))

15 
os
.
’vœÚ
['PATH'] = 
·th_£p
.
još
(
·th
)

17 #py·th = 
os
.
’vœÚ
['PYTHONPATH'] + ';' + 
mypy·th


18 #py·th = 
os
.
’vœÚ
['PYTHONPATH'] + ';' + 
mypy·th


19 #impÜˆ
sys


20 #sys.
·th
.
­³nd
(
mypy·th
)

21 #os.
’vœÚ
['PYTHONPATH'] = 
py·th


22 #´šˆ
os
.
’vœÚ
['PYTHONPATH']

23 
os
.
’vœÚ
['EPICS_CA_MAX_ARRAY_BYTES'] = "10000000"

25 
__Çme__
 == '__main__':

	@setup_env.py

2 
C»©ed
 
Ú
 
	gOù
 3, 2016

4 @
	gauthÜ
: 
b”gr


6 
impÜt
 
os


9 
·th_£p
 = ';'

10 
•icsP©h
 = 
r
'C:\controls\epics\R3.14.12.4\base\bin\win32-x86;C:\controls\epics\R3.14.12.4\lib\win32-x86;'

11 
mypy·th
 = 
r
'.\\cls;.\\blctl;C:\\eclipse\\plugins\\org.python.pydev_3.4.1.201403181715\\pysrc\\pydev_sitecustomize;.\\blctl;.\\Beamlines;.\\cls;'

13 
·th
 = [
os
.
’vœÚ
['PATH']]

14 
·th
.
ex‹nd
(
•icsP©h
.
¥l™
(';'))

15 
os
.
’vœÚ
['PATH'] = 
·th_£p
.
još
(
·th
)

17 #py·th = 
os
.
’vœÚ
['PYTHONPATH'] + ';' + 
mypy·th


18 #py·th = 
os
.
’vœÚ
['PYTHONPATH'] + ';' + 
mypy·th


19 #impÜˆ
sys


20 #sys.
·th
.
­³nd
(
mypy·th
)

21 #os.
’vœÚ
['PYTHONPATH'] = 
py·th


22 #´šˆ
os
.
’vœÚ
['PYTHONPATH']

23 
os
.
’vœÚ
['EPICS_CA_MAX_ARRAY_BYTES'] = "10000000"

25 
__Çme__
 == '__main__':

	@ui/__init__.py

2 
C»©ed
 
	gÚ
 2013-05-13

4 @
	gauthÜ
: 
b”gr


	@ui/__init__.py

2 
C»©ed
 
	gÚ
 2013-05-13

4 @
	gauthÜ
: 
b”gr


	@widgets/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

	@widgets/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

	@widgets/camera_ruler.py

2 
C»©ed
 
Ú
 
	gMay
 11, 2016

4 @
	gauthÜ
: 
b”gr


7 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
	guic
, 
	gQtWidg‘s


9 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
pyStxm
 
impÜt
 
	gabs_·th_to_ši_fe


10 
äom
 
	gşs
.
	g¶ÙWidg‘s
.
imageWidg‘
 
impÜt
 
	gImageWidg‘


11 
äom
 
	gbcm
.
	gdeviû
.
deviû_Çmes
 
	gimpÜt
 *

12 #äom 
şs
.
­¶iÿtiÚs
.
pyStxm
.
¡xm_uts
.
jsÚ½c_æ—ÿm_£rv”
 
impÜt
 
Reque¡HªdËr


14 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


15 
äom
 
	gşs
.
	guts
.
cfg·r£r
 
impÜt
 
	gCÚfigCÏss


17 
äom
 
	gşs
.
	gsÿÂšg
.
·¿mLšeEd™
 
impÜt
 
	gdblLšeEd™P¬amObj


18 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
bl07ID01
 
impÜt
 
	gMAIN_OBJ


20 
äom
 
	gşs
.
	guts
.
impÜt
 
	gEnum


21 
	gÿmruËr_mode
 = 
Enum
('LOCAL', 'SERVER', 'CLIENT')

23 #»ad 
the
 
ši
 
fe
 
ªd
 
lßd
h 
dœeùÜ›s


24 
	g­pCÚfig
 = 
CÚfigCÏss
(
abs_·th_to_ši_fe
)

25 
widg‘sUiDœ
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'widgetsUiDir')

26 
	gCAMERA_WAVEFORM_PV_STR
 = 
­pCÚfig
.
g‘_v®ue
('CAMERA', 'camera_waveform')

27 
	gIMAGE_WIDTH
 = 
­pCÚfig
.
g‘_v®ue
('CAMERA', 'frame_wd')

28 
	gIMAGE_HT
 = 
­pCÚfig
.
g‘_v®ue
('CAMERA', 'frame_ht')

29 
	gSCALER_AT_FULL_LENS_ZOOM_OUT
 = (
­pCÚfig
.
g‘_v®ue
('CAMERA', 'scaling_factor'))

30 
	gPREC
 = 3

32 
_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

34 
def
 
	$make_uhv¡xm_di¡ªû_v”ifiÿtiÚ_wšdow
():

35 #wš = 
	`Cam”aV›w”Widg‘
(
·»Á
 = 
NÚe
, 
ftSŒ
 = "*.hdf5", 
ty³
=NÚe, 
İtiÚs
=
	`diù
(
show_cÚŒa¡
=
F®£
, 
show_x£ùiÚ
=F®£, 
show_y£ùiÚ
=F®£,
show_™emli¡
=False))

36 
wš
 = 
	`ImageWidg‘
(
·»Á
 = 
NÚe
, 
ftSŒ
 = "*.hdf5", 
ty³
='ÿlib_ÿm”a', 
İtiÚs
=
	`diù
(
show_cÚŒa¡
=
F®£
, 
show_x£ùiÚ
=F®£, 
show_y£ùiÚ
=F®£,
show_™emli¡
=False))

37 
wš
.
	`£t_’abË_muÉi_»giÚ
(
F®£
)

38 
wš
.
	`’abË_image_·¿m_di¥Ïy
(
F®£
)

39 #wš.
	`’abË_toŞ_by_Çme
('StxmO³nFeToŞ', 
F®£
)

40 #wš.
	`addToŞ
('StxmHorizMeasureTool')

42 (
wš
)

47 
şass
 
	$Cam”aRuËr
(
QtWidg‘s
.
QWidg‘
):

49 
This
 
is
 
a
 
widg‘
 i 
u£d
 
to
 
g¿b
 
ª
 
image
 
äom
‡ 1394 
fœewœe
 
ÿm”a
 
ªd
 
u£
 
™
 
as
‡À
absŞu‹
 
’cod”
Ø
d‘”mše


50 
the
 
pos™iÚs
 
of
:

51 
ZÚ•Ï‹
 
Z


52 
OSA
 
Z


53 
Sam¶e
 
Z


54 
D‘eùÜ
 
Z


56 
The
 
widg‘
 
makes
 
the
 
assum±iÚ
 
th©
h
pix–
 
sÿlšg
 
has
 
b“n
 
£t
 
cÜ»ùly
 
such
h©h
m—su»m’¡
 
made
 
usšg
h
toŞs
 
¬e


57 
physiÿÎy
 
accu¿‹
.

61 
def
 
	$__š™__
(
£lf
, 
mode
=
ÿmruËr_mode
.
LOCAL
):

62 
	`su³r
(
Cam”aRuËr
, 
£lf
).
	`__š™__
()

63 
uic
.
	`lßdUi
(
widg‘sUiDœ
 + '/ÿm”a_ruËr.ui', 
£lf
)

64 
£lf
.
¶Ù
 = 
	`make_uhv¡xm_di¡ªû_v”ifiÿtiÚ_wšdow
()

65 #hÏyouˆğ
QtWidg‘s
.
	`QHBoxLayout
()

66 
vÏyout
 = 
QtWidg‘s
.
	`QVBoxLayout
()

67 
vÏyout
.
	`addWidg‘
(
£lf
.
¶Ù
)

68 
£lf
.
¶ÙF¿me
.
	`£tLayout
(
vÏyout
)

70 
£lf
.
zpz
 = 
MAIN_OBJ
.
	`deviû
Ğ
DNM_ZONEPLATE_Z_BASE
)

71 
£lf
.
o§z
 = 
MAIN_OBJ
.
	`deviû
Ğ
DNM_OSA_Z_BASE
)

72 
£lf
.
d‘z
 = 
MAIN_OBJ
.
	`deviû
Ğ
DNM_DETECTOR_Z
)

74 
£lf
.
	`lßd_cur_pos™iÚs
()

76 #£lf.
§m¶eZFld
.
dpo
 = 
	`dblLšeEd™P¬amObj
('§m¶eZFld', -5000, 5000.0, 
PREC
, 
·»Á
=
£lf
.sampleZFld)

77 #£lf.
§m¶eZFld
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(
£lf
.
£t_ûÁ”_ªd_sÿË
)

79 #£lf.
§m¶eZFld
.
»tuºP»s£d
.
	`cÚÃù
(
£lf
.
£t_ûÁ”_ªd_sÿË
)

80 #£lf.
§m¶eZBŠ
.
şicked
.
	`cÚÃù
(
£lf
.
£t_ûÁ”_ªd_sÿË
)

82 
£lf
.
zÚ•Ï‹ZFld
.
dpo
 = 
	`dblLšeEd™P¬amObj
('zÚ•Ï‹ZFld', s–f.
zpz
.
	`g‘
('LLM'), s–f.zpz.g‘('HLM'), 
PREC
, 
·»Á
=self.zoneplateZFld)

83 
£lf
.
zÚ•Ï‹ZFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
£t_zÚ•Ï‹
)

84 #£lf.
zÚ•Ï‹ZFld
.
»tuºP»s£d
.
	`cÚÃù
(
£lf
.
£t_zÚ•Ï‹
)

85 
£lf
.
zÚ•Ï‹ZBŠ
.
şicked
.
	`cÚÃù
(£lf.
£t_zÚ•Ï‹
)

87 
£lf
.
o§ZFld
.
dpo
 = 
	`dblLšeEd™P¬amObj
('o§ZFld', s–f.
o§z
.
	`g‘
('LLM'), s–f.o§z.g‘('HLM'), 
PREC
, 
·»Á
=self.osaZFld)

88 
£lf
.
o§ZFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
£t_o§
)

89 #£lf.
o§ZFld
.
»tuºP»s£d
.
	`cÚÃù
(
£lf
.
£t_o§
)

90 
£lf
.
o§ZBŠ
.
şicked
.
	`cÚÃù
(£lf.
£t_o§
)

92 
£lf
.
d‘ZFld
.
dpo
 = 
	`dblLšeEd™P¬amObj
('d‘ZFld', s–f.
d‘z
.
	`g‘
('LLM'), s–f.d‘z.g‘('HLM'), 
PREC
, 
·»Á
=self.detZFld)

93 
£lf
.
d‘ZFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
£t_d‘eùÜ
)

94 #£lf.
d‘ZFld
.
»tuºP»s£d
.
	`cÚÃù
(
£lf
.
£t_d‘eùÜ
)

95 
£lf
.
d‘ZBŠ
.
şicked
.
	`cÚÃù
(£lf.
£t_d‘eùÜ
)

97 
£lf
.
ÿm”a_dev
 = 
NÚe


98 
£lf
.
ÿlib_ÿm”a
 = 
NÚe


100 
£lf
.
mode
 = mode

102 if(
mode
 =ğ
ÿmruËr_mode
.
SERVER
):

103 
äom
 
bcm
.
deviû
.
ÿm”a
 
impÜt
 
FËaCam”a


104 
´št
 'RUnning in Server Mode'

105 
£lf
.
ÿm”a_dev
 = 
	`FËaCam”a
('Grasshopper2')

106 
£lf
.
ÿlib_ÿm”a
 = 
MAIN_OBJ
.
	`deviû
(
DNM_CALIB_CAMERA_SRVR
)

107 
£lf
.
ÿlib_ÿm”a
.
acquœe_äame
.
	`cÚÃù
(£lf.
Ú_aquœe_äame
)

108 
£lf
.
g¿bBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_loÿl_g¿b_bŠ
)

110 
	$–if
(
mode
 =ğ
ÿmruËr_mode
.
CLIENT
):

111 
´št
 'RUnning in Client Mode'

112 
£lf
.
ÿlib_ÿm”a
 = 
MAIN_OBJ
.
	`deviû
(
DNM_CALIB_CAMERA_CLIENT
)

113 #£lf.
ÿlib_ÿm”a
.
chªged
.
	`cÚÃù
(
£lf
.
Ú_image_upd©ed
)

114 
£lf
.
g¿bBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_»mÙe_g¿b_bŠ
)

116 
äom
 
bcm
.
deviû
.
ÿm”a
 
impÜt
 
FËaCam”a


117 
´št
 'RUnning in LOCAL Mode'

118 
£lf
.
ÿm”a_dev
 = 
	`FËaCam”a
('Grasshopper2')

119 
£lf
.
ÿlib_ÿm”a
 = 
MAIN_OBJ
.
	`deviû
(
DNM_CALIB_CAMERA_CLIENT
)

120 
£lf
.
g¿bBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_loÿl_g¿b_bŠ
)

124 #deà
	`Ú_image_upd©ed
(
£lf
, 
d©a
):

125 #´šˆ
d©a
[0:10]

127 
def
 
	$Ú_aquœe_äame
(
£lf
, 
toggË
):

129 
This
 
is
 
a
 
sigÇl
 
hªdËr
 
th©
 i 
»¥Údšg
 
to
 
the
 
g¿b_äame
 
pv
 
bešg
 
£t


130 
this
 
hªdËr
 
£rves
 
the
 
»mÙe
 
mode
 
g¿bBŠ
 
şicked
 
sigÇl


132 if(
toggË
 == 1):

133 #Úly 
g¿b
 
a
 
äame
 
Ú
‡ 
Œªs™iÚ
 
to
 1 
nÙ
 
back
o 0

134 
image
 = 
£lf
.
ÿm”a_dev
.
	`g¿b_äame
(
as_1d_¬¿y
=
True
)

135 
£lf
.
ÿlib_ÿm”a
.
	`£t_image_d©a
(
image
)

137 
def
 
	$Ú_loÿl_g¿b_bŠ
(
£lf
):

139 
This
 
is
 
a
 
sigÇl
 
hªdËr
 
th©
 i 
»¥Údšg
 
to
 
the
 
g¿b
 
bu‰Ú
 
bešg
 
´es£d


140 
this
 
hªdËr
 
£rves
 
the
 
loÿl
 
ªd
 
£rv”
 
mode
 
g¿bBŠ
 
şicked
 
sigÇl


142 
image
 = 
£lf
.
ÿm”a_dev
.
	`g¿b_äame
()

143 
£lf
.
¶Ù
.
	`£t_d©a
(
image
)

144 
£lf
.
	`­¶y_sÿlšg
(
image
)

147 
def
 
	$Ú_»mÙe_g¿b_bŠ
(
£lf
):

148 #push 
the
 
acquœe
 
pv
 
so
 
th©
h
£rv”
 
wl
 
aquœe
 
a
 
äame
 
ªd
 
wr™e
 
™
 
to
 
‹h
 
wavefÜm
…v

149 
£lf
.
ÿlib_ÿm”a
.
	`g¿b_äame
()

150 
image
 = 
£lf
.
ÿlib_ÿm”a
.
	`g‘_image_d©a
()

151 if(
image
 
is
 
nÙ
 
NÚe
):

152 
£lf
.
¶Ù
.
	`£t_d©a
(
image
)

153 
£lf
.
	`­¶y_sÿlšg
(
image
)

156 
def
 
	$­¶y_sÿlšg
(
£lf
, 
image
):

157 #ht, 
wd
, 
şrs
 = 
image
.
sh­e


158 
ht
, 
wd
 = 
image
.
sh­e


159 #sÿË = (1000.0/(
wd
))

160 
sÿË
 = 
SCALER_AT_FULL_LENS_ZOOM_OUT


161 #ià
sÿË
 != 1.0:

162 #imagğ
cv2
.
	`»size
(
image
, (0, 0), 
fx
=
sÿË
, 
fy
=scale)

163 #g‘ 
u£r
 
e¥ecif›d
 
ûÁ”
 
ªd
 
sÿË


165 #cx = (
	`¡r
(
£lf
.
ûÁ”XFld
.
	`‹xt
()))

166 #sÿË = (
	`¡r
(
£lf
.
sÿËFld
.
	`‹xt
()))

167 
cx
 = 0.0

169 
x1
 = 
cx
 - ((0.5*
wd
)*
sÿË
)

170 
y1
 = 0 - ((0.5*
ht
)*
sÿË
)

171 
x2
 = 
cx
 + ((0.5*
wd
)*
sÿË
)

172 
y2
 = 0 + ((0.5*
ht
)*
sÿË
)

174 
£lf
.
¶Ù
.
	`£t_image_·¿m‘”s
(£lf.¶Ù.
™em
, 
x1
, 
y1
, 
x2
, 
y2
)

176 
def
 
	$lßd_cur_pos™iÚs
(
£lf
):

177 
zpz
 = 
£lf
.zpz.
	`g‘_pos™iÚ
()

178 
o§z
 = 
£lf
.o§z.
	`g‘_pos™iÚ
()

179 
d‘z
 = 
£lf
.d‘z.
	`g‘_pos™iÚ
()

181 
£lf
.
zÚ•Ï‹ZFld
.
	`£tText
('%.3f' % 
zpz
)

182 
£lf
.
o§ZFld
.
	`£tText
('%.3f' % 
o§z
)

183 
£lf
.
d‘ZFld
.
	`£tText
('%.3f' % 
d‘z
)

186 
def
 
	$£t_ûÁ”_ªd_sÿË
(
£lf
):

188 
cx
 = (
	`¡r
(
£lf
.
§m¶eZFld
.
	`‹xt
()))

189 #sÿË = (
	`¡r
(
£lf
.
sÿËFld
.
	`‹xt
()))

190 
sÿË
 = 17.2

191 
£lf
.
¶Ù
.
	`Ú_move_image_ûÁ”
(
cx
, 
sÿË
)

193 
def
 
	$£t_zÚ•Ï‹
(
£lf
):

194 
pos
 = (
	`¡r
(
£lf
.
zÚ•Ï‹ZFld
.
	`‹xt
()))

195 
£lf
.
zpz
.
	`£t_pos™iÚ
(
pos
)

198 
def
 
	$£t_o§
(
£lf
):

199 
pos
 = (
	`¡r
(
£lf
.
o§ZFld
.
	`‹xt
()))

200 
£lf
.
o§z
.
	`£t_pos™iÚ
(
pos
)

201 #£ˆ
the
 
soá
 
lim™s
 
of
 
o§z


202 #£ˆ
the
 
soá
 
lim™s
 
of
 
zpz


204 
def
 
	$£t_d‘eùÜ
(
£lf
):

205 
pos
 = (
	`¡r
(
£lf
.
d‘ZFld
.
	`‹xt
()))

206 
£lf
.
d‘z
.
	`£t_pos™iÚ
(
pos
)

207 #£ˆ
the
 
soá
 
lim™s
 
of
 
d‘z


210 
__Çme__
 == '__main__':

211 
impÜt
 
sys


212 
impÜt
 
os


214 
ho¡Çme
 = 
os
.
	`g‘’v
('COMPUTERNAME')

215 if(
ho¡Çme
 == 'IOC1610-303'):

216 
mode
 = 
ÿmruËr_mode
.
SERVER


218 
mode
 = 
ÿmruËr_mode
.
CLIENT


220 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

221 
wš
 = 
	`Cam”aRuËr
(
mode
=mode)

222 
wš
.
	`»size
(900,900)

223 
wš
.
	`show
()

225 
­p
.
	`exec_
()

	@widgets/camera_ruler.py

2 
C»©ed
 
Ú
 
	gMay
 11, 2016

4 @
	gauthÜ
: 
b”gr


7 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
	guic
, 
	gQtWidg‘s


9 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
pyStxm
 
impÜt
 
	gabs_·th_to_ši_fe


10 
äom
 
	gşs
.
	g¶ÙWidg‘s
.
imageWidg‘
 
impÜt
 
	gImageWidg‘


11 
äom
 
	gbcm
.
	gdeviû
.
deviû_Çmes
 
	gimpÜt
 *

12 #äom 
şs
.
­¶iÿtiÚs
.
pyStxm
.
¡xm_uts
.
jsÚ½c_æ—ÿm_£rv”
 
impÜt
 
Reque¡HªdËr


14 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


15 
äom
 
	gşs
.
	guts
.
cfg·r£r
 
impÜt
 
	gCÚfigCÏss


17 
äom
 
	gşs
.
	gsÿÂšg
.
·¿mLšeEd™
 
impÜt
 
	gdblLšeEd™P¬amObj


18 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
bl07ID01
 
impÜt
 
	gMAIN_OBJ


20 
äom
 
	gşs
.
	guts
.
impÜt
 
	gEnum


21 
	gÿmruËr_mode
 = 
Enum
('LOCAL', 'SERVER', 'CLIENT')

23 #»ad 
the
 
ši
 
fe
 
ªd
 
lßd
h 
dœeùÜ›s


24 
	g­pCÚfig
 = 
CÚfigCÏss
(
abs_·th_to_ši_fe
)

25 
widg‘sUiDœ
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'widgetsUiDir')

26 
	gCAMERA_WAVEFORM_PV_STR
 = 
­pCÚfig
.
g‘_v®ue
('CAMERA', 'camera_waveform')

27 
	gIMAGE_WIDTH
 = 
­pCÚfig
.
g‘_v®ue
('CAMERA', 'frame_wd')

28 
	gIMAGE_HT
 = 
­pCÚfig
.
g‘_v®ue
('CAMERA', 'frame_ht')

29 
	gSCALER_AT_FULL_LENS_ZOOM_OUT
 = (
­pCÚfig
.
g‘_v®ue
('CAMERA', 'scaling_factor'))

30 
	gPREC
 = 3

32 
_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

34 
def
 
	$make_uhv¡xm_di¡ªû_v”ifiÿtiÚ_wšdow
():

35 #wš = 
	`Cam”aV›w”Widg‘
(
·»Á
 = 
NÚe
, 
ftSŒ
 = "*.hdf5", 
ty³
=NÚe, 
İtiÚs
=
	`diù
(
show_cÚŒa¡
=
F®£
, 
show_x£ùiÚ
=F®£, 
show_y£ùiÚ
=F®£,
show_™emli¡
=False))

36 
wš
 = 
	`ImageWidg‘
(
·»Á
 = 
NÚe
, 
ftSŒ
 = "*.hdf5", 
ty³
='ÿlib_ÿm”a', 
İtiÚs
=
	`diù
(
show_cÚŒa¡
=
F®£
, 
show_x£ùiÚ
=F®£, 
show_y£ùiÚ
=F®£,
show_™emli¡
=False))

37 
wš
.
	`£t_’abË_muÉi_»giÚ
(
F®£
)

38 
wš
.
	`’abË_image_·¿m_di¥Ïy
(
F®£
)

39 #wš.
	`’abË_toŞ_by_Çme
('StxmO³nFeToŞ', 
F®£
)

40 #wš.
	`addToŞ
('StxmHorizMeasureTool')

42 (
wš
)

47 
şass
 
	$Cam”aRuËr
(
QtWidg‘s
.
QWidg‘
):

49 
This
 
is
 
a
 
widg‘
 i 
u£d
 
to
 
g¿b
 
ª
 
image
 
äom
‡ 1394 
fœewœe
 
ÿm”a
 
ªd
 
u£
 
™
 
as
‡À
absŞu‹
 
’cod”
Ø
d‘”mše


50 
the
 
pos™iÚs
 
of
:

51 
ZÚ•Ï‹
 
Z


52 
OSA
 
Z


53 
Sam¶e
 
Z


54 
D‘eùÜ
 
Z


56 
The
 
widg‘
 
makes
 
the
 
assum±iÚ
 
th©
h
pix–
 
sÿlšg
 
has
 
b“n
 
£t
 
cÜ»ùly
 
such
h©h
m—su»m’¡
 
made
 
usšg
h
toŞs
 
¬e


57 
physiÿÎy
 
accu¿‹
.

61 
def
 
	$__š™__
(
£lf
, 
mode
=
ÿmruËr_mode
.
LOCAL
):

62 
	`su³r
(
Cam”aRuËr
, 
£lf
).
	`__š™__
()

63 
uic
.
	`lßdUi
(
widg‘sUiDœ
 + '/ÿm”a_ruËr.ui', 
£lf
)

64 
£lf
.
¶Ù
 = 
	`make_uhv¡xm_di¡ªû_v”ifiÿtiÚ_wšdow
()

65 #hÏyouˆğ
QtWidg‘s
.
	`QHBoxLayout
()

66 
vÏyout
 = 
QtWidg‘s
.
	`QVBoxLayout
()

67 
vÏyout
.
	`addWidg‘
(
£lf
.
¶Ù
)

68 
£lf
.
¶ÙF¿me
.
	`£tLayout
(
vÏyout
)

70 
£lf
.
zpz
 = 
MAIN_OBJ
.
	`deviû
Ğ
DNM_ZONEPLATE_Z_BASE
)

71 
£lf
.
o§z
 = 
MAIN_OBJ
.
	`deviû
Ğ
DNM_OSA_Z_BASE
)

72 
£lf
.
d‘z
 = 
MAIN_OBJ
.
	`deviû
Ğ
DNM_DETECTOR_Z
)

74 
£lf
.
	`lßd_cur_pos™iÚs
()

76 #£lf.
§m¶eZFld
.
dpo
 = 
	`dblLšeEd™P¬amObj
('§m¶eZFld', -5000, 5000.0, 
PREC
, 
·»Á
=
£lf
.sampleZFld)

77 #£lf.
§m¶eZFld
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(
£lf
.
£t_ûÁ”_ªd_sÿË
)

79 #£lf.
§m¶eZFld
.
»tuºP»s£d
.
	`cÚÃù
(
£lf
.
£t_ûÁ”_ªd_sÿË
)

80 #£lf.
§m¶eZBŠ
.
şicked
.
	`cÚÃù
(
£lf
.
£t_ûÁ”_ªd_sÿË
)

82 
£lf
.
zÚ•Ï‹ZFld
.
dpo
 = 
	`dblLšeEd™P¬amObj
('zÚ•Ï‹ZFld', s–f.
zpz
.
	`g‘
('LLM'), s–f.zpz.g‘('HLM'), 
PREC
, 
·»Á
=self.zoneplateZFld)

83 
£lf
.
zÚ•Ï‹ZFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
£t_zÚ•Ï‹
)

84 #£lf.
zÚ•Ï‹ZFld
.
»tuºP»s£d
.
	`cÚÃù
(
£lf
.
£t_zÚ•Ï‹
)

85 
£lf
.
zÚ•Ï‹ZBŠ
.
şicked
.
	`cÚÃù
(£lf.
£t_zÚ•Ï‹
)

87 
£lf
.
o§ZFld
.
dpo
 = 
	`dblLšeEd™P¬amObj
('o§ZFld', s–f.
o§z
.
	`g‘
('LLM'), s–f.o§z.g‘('HLM'), 
PREC
, 
·»Á
=self.osaZFld)

88 
£lf
.
o§ZFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
£t_o§
)

89 #£lf.
o§ZFld
.
»tuºP»s£d
.
	`cÚÃù
(
£lf
.
£t_o§
)

90 
£lf
.
o§ZBŠ
.
şicked
.
	`cÚÃù
(£lf.
£t_o§
)

92 
£lf
.
d‘ZFld
.
dpo
 = 
	`dblLšeEd™P¬amObj
('d‘ZFld', s–f.
d‘z
.
	`g‘
('LLM'), s–f.d‘z.g‘('HLM'), 
PREC
, 
·»Á
=self.detZFld)

93 
£lf
.
d‘ZFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
£t_d‘eùÜ
)

94 #£lf.
d‘ZFld
.
»tuºP»s£d
.
	`cÚÃù
(
£lf
.
£t_d‘eùÜ
)

95 
£lf
.
d‘ZBŠ
.
şicked
.
	`cÚÃù
(£lf.
£t_d‘eùÜ
)

97 
£lf
.
ÿm”a_dev
 = 
NÚe


98 
£lf
.
ÿlib_ÿm”a
 = 
NÚe


100 
£lf
.
mode
 = mode

102 if(
mode
 =ğ
ÿmruËr_mode
.
SERVER
):

103 
äom
 
bcm
.
deviû
.
ÿm”a
 
impÜt
 
FËaCam”a


104 
´št
 'RUnning in Server Mode'

105 
£lf
.
ÿm”a_dev
 = 
	`FËaCam”a
('Grasshopper2')

106 
£lf
.
ÿlib_ÿm”a
 = 
MAIN_OBJ
.
	`deviû
(
DNM_CALIB_CAMERA_SRVR
)

107 
£lf
.
ÿlib_ÿm”a
.
acquœe_äame
.
	`cÚÃù
(£lf.
Ú_aquœe_äame
)

108 
£lf
.
g¿bBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_loÿl_g¿b_bŠ
)

110 
	$–if
(
mode
 =ğ
ÿmruËr_mode
.
CLIENT
):

111 
´št
 'RUnning in Client Mode'

112 
£lf
.
ÿlib_ÿm”a
 = 
MAIN_OBJ
.
	`deviû
(
DNM_CALIB_CAMERA_CLIENT
)

113 #£lf.
ÿlib_ÿm”a
.
chªged
.
	`cÚÃù
(
£lf
.
Ú_image_upd©ed
)

114 
£lf
.
g¿bBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_»mÙe_g¿b_bŠ
)

116 
äom
 
bcm
.
deviû
.
ÿm”a
 
impÜt
 
FËaCam”a


117 
´št
 'RUnning in LOCAL Mode'

118 
£lf
.
ÿm”a_dev
 = 
	`FËaCam”a
('Grasshopper2')

119 
£lf
.
ÿlib_ÿm”a
 = 
MAIN_OBJ
.
	`deviû
(
DNM_CALIB_CAMERA_CLIENT
)

120 
£lf
.
g¿bBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_loÿl_g¿b_bŠ
)

124 #deà
	`Ú_image_upd©ed
(
£lf
, 
d©a
):

125 #´šˆ
d©a
[0:10]

127 
def
 
	$Ú_aquœe_äame
(
£lf
, 
toggË
):

129 
This
 
is
 
a
 
sigÇl
 
hªdËr
 
th©
 i 
»¥Údšg
 
to
 
the
 
g¿b_äame
 
pv
 
bešg
 
£t


130 
this
 
hªdËr
 
£rves
 
the
 
»mÙe
 
mode
 
g¿bBŠ
 
şicked
 
sigÇl


132 if(
toggË
 == 1):

133 #Úly 
g¿b
 
a
 
äame
 
Ú
‡ 
Œªs™iÚ
 
to
 1 
nÙ
 
back
o 0

134 
image
 = 
£lf
.
ÿm”a_dev
.
	`g¿b_äame
(
as_1d_¬¿y
=
True
)

135 
£lf
.
ÿlib_ÿm”a
.
	`£t_image_d©a
(
image
)

137 
def
 
	$Ú_loÿl_g¿b_bŠ
(
£lf
):

139 
This
 
is
 
a
 
sigÇl
 
hªdËr
 
th©
 i 
»¥Údšg
 
to
 
the
 
g¿b
 
bu‰Ú
 
bešg
 
´es£d


140 
this
 
hªdËr
 
£rves
 
the
 
loÿl
 
ªd
 
£rv”
 
mode
 
g¿bBŠ
 
şicked
 
sigÇl


142 
image
 = 
£lf
.
ÿm”a_dev
.
	`g¿b_äame
()

143 
£lf
.
¶Ù
.
	`£t_d©a
(
image
)

144 
£lf
.
	`­¶y_sÿlšg
(
image
)

147 
def
 
	$Ú_»mÙe_g¿b_bŠ
(
£lf
):

148 #push 
the
 
acquœe
 
pv
 
so
 
th©
h
£rv”
 
wl
 
aquœe
 
a
 
äame
 
ªd
 
wr™e
 
™
 
to
 
‹h
 
wavefÜm
…v

149 
£lf
.
ÿlib_ÿm”a
.
	`g¿b_äame
()

150 
image
 = 
£lf
.
ÿlib_ÿm”a
.
	`g‘_image_d©a
()

151 if(
image
 
is
 
nÙ
 
NÚe
):

152 
£lf
.
¶Ù
.
	`£t_d©a
(
image
)

153 
£lf
.
	`­¶y_sÿlšg
(
image
)

156 
def
 
	$­¶y_sÿlšg
(
£lf
, 
image
):

157 #ht, 
wd
, 
şrs
 = 
image
.
sh­e


158 
ht
, 
wd
 = 
image
.
sh­e


159 #sÿË = (1000.0/(
wd
))

160 
sÿË
 = 
SCALER_AT_FULL_LENS_ZOOM_OUT


161 #ià
sÿË
 != 1.0:

162 #imagğ
cv2
.
	`»size
(
image
, (0, 0), 
fx
=
sÿË
, 
fy
=scale)

163 #g‘ 
u£r
 
e¥ecif›d
 
ûÁ”
 
ªd
 
sÿË


165 #cx = (
	`¡r
(
£lf
.
ûÁ”XFld
.
	`‹xt
()))

166 #sÿË = (
	`¡r
(
£lf
.
sÿËFld
.
	`‹xt
()))

167 
cx
 = 0.0

169 
x1
 = 
cx
 - ((0.5*
wd
)*
sÿË
)

170 
y1
 = 0 - ((0.5*
ht
)*
sÿË
)

171 
x2
 = 
cx
 + ((0.5*
wd
)*
sÿË
)

172 
y2
 = 0 + ((0.5*
ht
)*
sÿË
)

174 
£lf
.
¶Ù
.
	`£t_image_·¿m‘”s
(£lf.¶Ù.
™em
, 
x1
, 
y1
, 
x2
, 
y2
)

176 
def
 
	$lßd_cur_pos™iÚs
(
£lf
):

177 
zpz
 = 
£lf
.zpz.
	`g‘_pos™iÚ
()

178 
o§z
 = 
£lf
.o§z.
	`g‘_pos™iÚ
()

179 
d‘z
 = 
£lf
.d‘z.
	`g‘_pos™iÚ
()

181 
£lf
.
zÚ•Ï‹ZFld
.
	`£tText
('%.3f' % 
zpz
)

182 
£lf
.
o§ZFld
.
	`£tText
('%.3f' % 
o§z
)

183 
£lf
.
d‘ZFld
.
	`£tText
('%.3f' % 
d‘z
)

186 
def
 
	$£t_ûÁ”_ªd_sÿË
(
£lf
):

188 
cx
 = (
	`¡r
(
£lf
.
§m¶eZFld
.
	`‹xt
()))

189 #sÿË = (
	`¡r
(
£lf
.
sÿËFld
.
	`‹xt
()))

190 
sÿË
 = 17.2

191 
£lf
.
¶Ù
.
	`Ú_move_image_ûÁ”
(
cx
, 
sÿË
)

193 
def
 
	$£t_zÚ•Ï‹
(
£lf
):

194 
pos
 = (
	`¡r
(
£lf
.
zÚ•Ï‹ZFld
.
	`‹xt
()))

195 
£lf
.
zpz
.
	`£t_pos™iÚ
(
pos
)

198 
def
 
	$£t_o§
(
£lf
):

199 
pos
 = (
	`¡r
(
£lf
.
o§ZFld
.
	`‹xt
()))

200 
£lf
.
o§z
.
	`£t_pos™iÚ
(
pos
)

201 #£ˆ
the
 
soá
 
lim™s
 
of
 
o§z


202 #£ˆ
the
 
soá
 
lim™s
 
of
 
zpz


204 
def
 
	$£t_d‘eùÜ
(
£lf
):

205 
pos
 = (
	`¡r
(
£lf
.
d‘ZFld
.
	`‹xt
()))

206 
£lf
.
d‘z
.
	`£t_pos™iÚ
(
pos
)

207 #£ˆ
the
 
soá
 
lim™s
 
of
 
d‘z


210 
__Çme__
 == '__main__':

211 
impÜt
 
sys


212 
impÜt
 
os


214 
ho¡Çme
 = 
os
.
	`g‘’v
('COMPUTERNAME')

215 if(
ho¡Çme
 == 'IOC1610-303'):

216 
mode
 = 
ÿmruËr_mode
.
SERVER


218 
mode
 = 
ÿmruËr_mode
.
CLIENT


220 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

221 
wš
 = 
	`Cam”aRuËr
(
mode
=mode)

222 
wš
.
	`»size
(900,900)

223 
wš
.
	`show
()

225 
­p
.
	`exec_
()

	@widgets/detectorsPanel.py

2 
C»©ed
 
Ú
 
	gNov
 14, 2016

4 @
	gauthÜ
: 
b”gr


6 
impÜt
 
os


7 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
QtWidg‘s


8 
äom
 
PyQt5
 
impÜt
 
	guic


10 #äom 
PyQt5
.
Qt
 
impÜt
 
QToŞBu‰Ú


12 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
bl07ID01
 
impÜt
 
MAIN_OBJ


13 
äom
 
	gşs
.
	g­p_d©a
.
deçuÉs
 
impÜt
 
g‘_¡yË


15 
	guiDœ
 = 
os
.
·th
.
dœÇme
(
__fe__
) + '/ui/'

17 
şass
 
	$Ba£D‘eùÜD‘aDŸlog
(
QtWidg‘s
.
QDŸlog
):

19 
def
 
	`__š™__
(
£lf
, 
Çme
, 
d‘
, 
¬gs
={
	}
}, 
	g·»Á
=
NÚe
):

20 
QtWidg‘s
.
QDŸlog
.
	$__š™__
(
£lf
,
·»Á
)

21 
£lf
.
	$£tMod®
(
True
)

22 
£lf
.
t™ËLbl
 = 
QtWidg‘s
.
	$QLab–
(
Çme
)

23 
Ïyout
 = 
QtWidg‘s
.
	$QVBoxLayout
()

24 
Ïyout
.
	`£tCÚ‹ÁsM¬gšs
(2,2,2,2)

25 
Ïyout
.
	$addWidg‘
(
£lf
.
t™ËLbl
)

26 
£lf
.
qssh“t
 = 
	`g‘_¡yË
('dark')

27 
£lf
.
	$£tStyËSh“t
(
£lf
.
qssh“t
)

29 
£lf
.
	$£tLayout
(
Ïyout
)

31 
£lf
.
dù
 = {
	}
}

32 
£lf
.
dù
['Çme'] = 
Çme


33 
£lf
.
dù
['d‘_dev'] = 
d‘


34 
£lf
.
dù
['¬gs'] = 
¬gs


36 
def
 
	$g‘_cfg
(
£lf
):

38 
g‘
 
®l
 
of
 
the
 
deviûs
 
cÚfigu¿tiÚ
 
·¿ms
 
h”e
 
ªd
 
put
 
što
 
dù


40 (
£lf
.
dù
)

43 
şass
 
	$APD_D‘aDŸlog
(
Ba£D‘eùÜD‘aDŸlog
):

44 
def
 
	`__š™__
(
£lf
, 
Çme
, 
d‘
, 
¬gs
={
	}
}, 
	g·»Á
=
NÚe
):

45 
su³r
(
APD_D‘aDŸlog
, 
£lf
).
	$__š™__
(
Çme
, 
d‘
)

47 
şass
 
	$PMT_D‘aDŸlog
(
Ba£D‘eùÜD‘aDŸlog
):

48 
def
 
	`__š™__
(
£lf
, 
Çme
, 
d‘
, 
¬gs
={
	}
}, 
	g·»Á
=
NÚe
):

49 
su³r
(
PMT_D‘aDŸlog
, 
£lf
).
	$__š™__
(
Çme
, 
d‘
)

51 
şass
 
	$DAQMX_D‘aDŸlog
(
Ba£D‘eùÜD‘aDŸlog
):

52 
def
 
	`__š™__
(
£lf
, 
Çme
, 
d‘
, 
¬gs
={
	}
}, 
	g·»Á
=
NÚe
):

53 
su³r
(
DAQMX_D‘aDŸlog
, 
£lf
).
	$__š™__
(
Çme
, 
d‘
)

55 
şass
 
	$EPICS_D‘aDŸlog
(
Ba£D‘eùÜD‘aDŸlog
):

56 
def
 
	`__š™__
(
£lf
, 
Çme
, 
d‘
, 
¬gs
={
	}
}, 
	g·»Á
=
NÚe
):

57 
su³r
(
EPICS_D‘aDŸlog
, 
£lf
).
	$__š™__
(
Çme
, 
d‘
)

60 
def
 
	$make_d‘a_d‘eùÜ_fÜm
(
Çme
, 
d‘
):

61 if(
Çme
.
	`fšd
('PMT') > -1):

62 
ddf
 = 
	$PMT_D‘aDŸlog
(
Çme
, 
d‘
)

64 if(
Çme
.
	`fšd
('APD') > -1):

65 
ddf
 = 
	$APD_D‘aDŸlog
(
Çme
, 
d‘
)

67 if(
Çme
.
	`fšd
('StorageRingCurrent') > -1):

68 
ddf
 = 
	$EPICS_D‘aDŸlog
(
Çme
, 
d‘
)

70 (
ddf
)

72 
şass
 
	$D‘eùÜI‹m
(
QtWidg‘s
.
QWidg‘
):

74 
def
 
	$__š™__
(
£lf
, 
Çme
, 
d‘
, 
d‘as_wdg
, 
·»Á
=
NÚe
):

75 
QtWidg‘s
.
QWidg‘
.
	$__š™__
(
£lf
,
·»Á
)

76 
£lf
.
Çme
 =‚ame

77 
£lf
.
dcs_Çme
 = 
d‘
.
	$g‘_Çme
()

78 
£lf
.
d‘_cfg
 = 
d‘as_wdg
.
	$g‘_cfg
()

80 
Ïyout
 = 
QtWidg‘s
.
	$QHBoxLayout
()

81 
Ïyout
.
	`£tCÚ‹ÁsM¬gšs
(2,2,2,2)

82 
£lf
.
d‘asWdg
 = 
d‘as_wdg


83 
£lf
.
d‘asBŠ
 = 
QtWidg‘s
.
	$QToŞBu‰Ú
()

84 
£lf
.
d‘asBŠ
.
	`£tToŞT
('CÚfig ' + 
Çme
 + ' details')

85 #£lf.
¿dioBŠ
 = 
QtWidg‘s
.
	`QRadioBu‰Ú
(
Çme
)

86 
£lf
.
chkBox
 = 
QtWidg‘s
.
	$QCheckBox
(
Çme
)

87 
Ïyout
.
	$addWidg‘
(
£lf
.
d‘asBŠ
)

88 #Ïyout.
	`addWidg‘
(
£lf
.
¿dioBŠ
)

89 
Ïyout
.
	$addWidg‘
(
£lf
.
chkBox
)

91 
£lf
.
d‘asBŠ
.
şicked
.
	$cÚÃù
(
£lf
.
Ú_show_d‘as
)

92 #£lf.
¿dioBŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_¿dio_şicked
)

93 
£lf
.
chkBox
.
şicked
.
	$cÚÃù
(
£lf
.
Ú_checkbox_şicked
)

95 
£lf
.
is_checked
 = 
F®£


97 
£lf
.
	$£tLayout
(
Ïyout
)

99 
def
 
	$Ú_show_d‘as
(
£lf
):

100 
£lf
.
d‘asWdg
.
	$show
()

102 
def
 
	$Ú_¿dio_şicked
(
£lf
, 
chkd
):

103 
£lf
.
is_checked
 = 
chkd


105 
def
 
	$Ú_checkbox_şicked
(
£lf
, 
chkd
):

106 
£lf
.
is_checked
 = 
chkd


108 
def
 
	$is_checked
(
£lf
):

109 (
£lf
.
is_checked
)

111 
def
 
	$g‘_Çme
(
£lf
):

112 (
£lf
.
Çme
)

114 
def
 
	$g‘_dcs_Çme
(
£lf
):

115 (
£lf
.
dcs_Çme
)

119 
şass
 
	$D‘eùÜsPª–
(
QtWidg‘s
.
QDŸlog
):

121 
def
 
	$__š™__
(
£lf
, 
·»Á
=
NÚe
):

122 
QtWidg‘s
.
QDŸlog
.
	$__š™__
(
£lf
,
·»Á
)

123 
£lf
.
widg‘Li¡
 = []

124 
£lf
.
qssh“t
 = 
	`g‘_¡yË
('dark')

125 
Ïyout
 = 
QtWidg‘s
.
	$QHBoxLayout
()

126 
Ïyout
.
	`£tCÚ‹ÁsM¬gšs
(2,2,2,2)

127 
d‘Çme
 
š
 
MAIN_OBJ
.
	$g‘_deviû_li¡
(
d‘eùÜs
=
True
):

128 
d‘
 = 
MAIN_OBJ
.
	$deviû
(
d‘Çme
)

129 
ddf
 = 
	$make_d‘a_d‘eùÜ_fÜm
(
d‘Çme
, 
d‘
)

130 
widg‘
 = 
	$D‘eùÜI‹m
(
d‘Çme
, 
d‘
, 
ddf
)

131 
widg‘
.
	$£tStyËSh“t
(
£lf
.
qssh“t
)

132 
£lf
.
widg‘Li¡
.
	$­³nd
(
widg‘
)

133 
Ïyout
.
	$addWidg‘
(
widg‘
)

134 
£lf
.
	$£tLayout
(
Ïyout
)

136 
£lf
.
	$£tStyËSh“t
(
£lf
.
qssh“t
)

138 
def
 
	$g‘_£Ëùed_d‘eùÜs
(
£lf
):

140 
w®k
 
®l
 
of
 
the
 
d‘eùÜs
 
ªd
 
»cÜd
 
which
 
Úes
 
¬e
 
checked


142 
l¡
 = []

143 
d
 
š
 
£lf
.
widg‘Li¡
:

144 if(
d
.
is_checked
):

145 
dù
 = {
	}
}

146 
dù
['Çme'] = 
d
.
	$g‘_Çme
()

147 
dù
['dcs_Çme'] = 
d
.
	$g‘_dcs_Çme
()

148 
l¡
.
	$­³nd
(
dù
)

150 (
l¡
)

156 
__Çme__
 == '__main__':

157 
impÜt
 
sys


158 #mÙÜCfgObj = 
	`StxmMÙÜCÚfig
(
r
'C:\controls\py2.7\Beamlines\sm\stxm_control\StxmDir\Microscope Configuration\Motor.cfg')

159 
­p
 = 
QtWidg‘s
.
	$QAµliÿtiÚ
(
sys
.
¬gv
)

162 
mÙÜPª–
 = 
	$D‘eùÜsPª–
()

163 
mÙÜPª–
.
	$show
()

164 
sys
.
	`ex™
(
­p
.
	`exec_
())

	@widgets/detectorsPanel.py

2 
C»©ed
 
Ú
 
	gNov
 14, 2016

4 @
	gauthÜ
: 
b”gr


6 
impÜt
 
os


7 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
QtWidg‘s


8 
äom
 
PyQt5
 
impÜt
 
	guic


10 #äom 
PyQt5
.
Qt
 
impÜt
 
QToŞBu‰Ú


12 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
bl07ID01
 
impÜt
 
MAIN_OBJ


13 
äom
 
	gşs
.
	g­p_d©a
.
deçuÉs
 
impÜt
 
g‘_¡yË


15 
	guiDœ
 = 
os
.
·th
.
dœÇme
(
__fe__
) + '/ui/'

17 
şass
 
	$Ba£D‘eùÜD‘aDŸlog
(
QtWidg‘s
.
QDŸlog
):

19 
def
 
	`__š™__
(
£lf
, 
Çme
, 
d‘
, 
¬gs
={
	}
}, 
	g·»Á
=
NÚe
):

20 
QtWidg‘s
.
QDŸlog
.
	$__š™__
(
£lf
,
·»Á
)

21 
£lf
.
	$£tMod®
(
True
)

22 
£lf
.
t™ËLbl
 = 
QtWidg‘s
.
	$QLab–
(
Çme
)

23 
Ïyout
 = 
QtWidg‘s
.
	$QVBoxLayout
()

24 
Ïyout
.
	`£tCÚ‹ÁsM¬gšs
(2,2,2,2)

25 
Ïyout
.
	$addWidg‘
(
£lf
.
t™ËLbl
)

26 
£lf
.
qssh“t
 = 
	`g‘_¡yË
('dark')

27 
£lf
.
	$£tStyËSh“t
(
£lf
.
qssh“t
)

29 
£lf
.
	$£tLayout
(
Ïyout
)

31 
£lf
.
dù
 = {
	}
}

32 
£lf
.
dù
['Çme'] = 
Çme


33 
£lf
.
dù
['d‘_dev'] = 
d‘


34 
£lf
.
dù
['¬gs'] = 
¬gs


36 
def
 
	$g‘_cfg
(
£lf
):

38 
g‘
 
®l
 
of
 
the
 
deviûs
 
cÚfigu¿tiÚ
 
·¿ms
 
h”e
 
ªd
 
put
 
što
 
dù


40 (
£lf
.
dù
)

43 
şass
 
	$APD_D‘aDŸlog
(
Ba£D‘eùÜD‘aDŸlog
):

44 
def
 
	`__š™__
(
£lf
, 
Çme
, 
d‘
, 
¬gs
={
	}
}, 
	g·»Á
=
NÚe
):

45 
su³r
(
APD_D‘aDŸlog
, 
£lf
).
	$__š™__
(
Çme
, 
d‘
)

47 
şass
 
	$PMT_D‘aDŸlog
(
Ba£D‘eùÜD‘aDŸlog
):

48 
def
 
	`__š™__
(
£lf
, 
Çme
, 
d‘
, 
¬gs
={
	}
}, 
	g·»Á
=
NÚe
):

49 
su³r
(
PMT_D‘aDŸlog
, 
£lf
).
	$__š™__
(
Çme
, 
d‘
)

51 
şass
 
	$DAQMX_D‘aDŸlog
(
Ba£D‘eùÜD‘aDŸlog
):

52 
def
 
	`__š™__
(
£lf
, 
Çme
, 
d‘
, 
¬gs
={
	}
}, 
	g·»Á
=
NÚe
):

53 
su³r
(
DAQMX_D‘aDŸlog
, 
£lf
).
	$__š™__
(
Çme
, 
d‘
)

55 
şass
 
	$EPICS_D‘aDŸlog
(
Ba£D‘eùÜD‘aDŸlog
):

56 
def
 
	`__š™__
(
£lf
, 
Çme
, 
d‘
, 
¬gs
={
	}
}, 
	g·»Á
=
NÚe
):

57 
su³r
(
EPICS_D‘aDŸlog
, 
£lf
).
	$__š™__
(
Çme
, 
d‘
)

60 
def
 
	$make_d‘a_d‘eùÜ_fÜm
(
Çme
, 
d‘
):

61 if(
Çme
.
	`fšd
('PMT') > -1):

62 
ddf
 = 
	$PMT_D‘aDŸlog
(
Çme
, 
d‘
)

64 if(
Çme
.
	`fšd
('APD') > -1):

65 
ddf
 = 
	$APD_D‘aDŸlog
(
Çme
, 
d‘
)

67 if(
Çme
.
	`fšd
('StorageRingCurrent') > -1):

68 
ddf
 = 
	$EPICS_D‘aDŸlog
(
Çme
, 
d‘
)

70 (
ddf
)

72 
şass
 
	$D‘eùÜI‹m
(
QtWidg‘s
.
QWidg‘
):

74 
def
 
	$__š™__
(
£lf
, 
Çme
, 
d‘
, 
d‘as_wdg
, 
·»Á
=
NÚe
):

75 
QtWidg‘s
.
QWidg‘
.
	$__š™__
(
£lf
,
·»Á
)

76 
£lf
.
Çme
 =‚ame

77 
£lf
.
dcs_Çme
 = 
d‘
.
	$g‘_Çme
()

78 
£lf
.
d‘_cfg
 = 
d‘as_wdg
.
	$g‘_cfg
()

80 
Ïyout
 = 
QtWidg‘s
.
	$QHBoxLayout
()

81 
Ïyout
.
	`£tCÚ‹ÁsM¬gšs
(2,2,2,2)

82 
£lf
.
d‘asWdg
 = 
d‘as_wdg


83 
£lf
.
d‘asBŠ
 = 
QtWidg‘s
.
	$QToŞBu‰Ú
()

84 
£lf
.
d‘asBŠ
.
	`£tToŞT
('CÚfig ' + 
Çme
 + ' details')

85 #£lf.
¿dioBŠ
 = 
QtWidg‘s
.
	`QRadioBu‰Ú
(
Çme
)

86 
£lf
.
chkBox
 = 
QtWidg‘s
.
	$QCheckBox
(
Çme
)

87 
Ïyout
.
	$addWidg‘
(
£lf
.
d‘asBŠ
)

88 #Ïyout.
	`addWidg‘
(
£lf
.
¿dioBŠ
)

89 
Ïyout
.
	$addWidg‘
(
£lf
.
chkBox
)

91 
£lf
.
d‘asBŠ
.
şicked
.
	$cÚÃù
(
£lf
.
Ú_show_d‘as
)

92 #£lf.
¿dioBŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_¿dio_şicked
)

93 
£lf
.
chkBox
.
şicked
.
	$cÚÃù
(
£lf
.
Ú_checkbox_şicked
)

95 
£lf
.
is_checked
 = 
F®£


97 
£lf
.
	$£tLayout
(
Ïyout
)

99 
def
 
	$Ú_show_d‘as
(
£lf
):

100 
£lf
.
d‘asWdg
.
	$show
()

102 
def
 
	$Ú_¿dio_şicked
(
£lf
, 
chkd
):

103 
£lf
.
is_checked
 = 
chkd


105 
def
 
	$Ú_checkbox_şicked
(
£lf
, 
chkd
):

106 
£lf
.
is_checked
 = 
chkd


108 
def
 
	$is_checked
(
£lf
):

109 (
£lf
.
is_checked
)

111 
def
 
	$g‘_Çme
(
£lf
):

112 (
£lf
.
Çme
)

114 
def
 
	$g‘_dcs_Çme
(
£lf
):

115 (
£lf
.
dcs_Çme
)

119 
şass
 
	$D‘eùÜsPª–
(
QtWidg‘s
.
QDŸlog
):

121 
def
 
	$__š™__
(
£lf
, 
·»Á
=
NÚe
):

122 
QtWidg‘s
.
QDŸlog
.
	$__š™__
(
£lf
,
·»Á
)

123 
£lf
.
widg‘Li¡
 = []

124 
£lf
.
qssh“t
 = 
	`g‘_¡yË
('dark')

125 
Ïyout
 = 
QtWidg‘s
.
	$QHBoxLayout
()

126 
Ïyout
.
	`£tCÚ‹ÁsM¬gšs
(2,2,2,2)

127 
d‘Çme
 
š
 
MAIN_OBJ
.
	$g‘_deviû_li¡
(
d‘eùÜs
=
True
):

128 
d‘
 = 
MAIN_OBJ
.
	$deviû
(
d‘Çme
)

129 
ddf
 = 
	$make_d‘a_d‘eùÜ_fÜm
(
d‘Çme
, 
d‘
)

130 
widg‘
 = 
	$D‘eùÜI‹m
(
d‘Çme
, 
d‘
, 
ddf
)

131 
widg‘
.
	$£tStyËSh“t
(
£lf
.
qssh“t
)

132 
£lf
.
widg‘Li¡
.
	$­³nd
(
widg‘
)

133 
Ïyout
.
	$addWidg‘
(
widg‘
)

134 
£lf
.
	$£tLayout
(
Ïyout
)

136 
£lf
.
	$£tStyËSh“t
(
£lf
.
qssh“t
)

138 
def
 
	$g‘_£Ëùed_d‘eùÜs
(
£lf
):

140 
w®k
 
®l
 
of
 
the
 
d‘eùÜs
 
ªd
 
»cÜd
 
which
 
Úes
 
¬e
 
checked


142 
l¡
 = []

143 
d
 
š
 
£lf
.
widg‘Li¡
:

144 if(
d
.
is_checked
):

145 
dù
 = {
	}
}

146 
dù
['Çme'] = 
d
.
	$g‘_Çme
()

147 
dù
['dcs_Çme'] = 
d
.
	$g‘_dcs_Çme
()

148 
l¡
.
	$­³nd
(
dù
)

150 (
l¡
)

156 
__Çme__
 == '__main__':

157 
impÜt
 
sys


158 #mÙÜCfgObj = 
	`StxmMÙÜCÚfig
(
r
'C:\controls\py2.7\Beamlines\sm\stxm_control\StxmDir\Microscope Configuration\Motor.cfg')

159 
­p
 = 
QtWidg‘s
.
	$QAµliÿtiÚ
(
sys
.
¬gv
)

162 
mÙÜPª–
 = 
	$D‘eùÜsPª–
()

163 
mÙÜPª–
.
	$show
()

164 
sys
.
	`ex™
(
­p
.
	`exec_
())

	@widgets/energy_selection.py

2 
C»©ed
 
	gÚ
 2013-06-18

4 @
	gauthÜ
: 
b”gr


7 
C»©ed
 
Ú
 2013-05-29

9 @
authÜ
: 
b”gr


11 
impÜt
 
numpy
 
as
 
Å


13 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui


14 
äom
 
PyQt5
 
impÜt
 
	guic


15 
impÜt
 
	gPyQt4
.
Qwt5
 
as
 
	gQwt


17 
äom
 
	gguiqwt
.
bud”
 
impÜt
 
	gmake


19 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


20 
äom
 
	gşs
.
	guts
.
feUts
 
impÜt
 
	glßdD©ToXY
, 
	glßdD©ToA¼ay
, 
	glßdD©To2DA¼ay
, 
	g»adCŞumnSŒs


21 
äom
 
	gbcm
.
	guts
.
cfg·r£r
 
impÜt
 
	gCÚfigCÏss


22 
äom
 
	gbcm
.
	guts
.
unique_id
 
impÜt
 
	guniqueshÜtid


24 
äom
 
	gguiqwt
.
sigÇls
 
impÜt
 (
SIG_MARKER_CHANGED
, 
SIG_PLOT_LABELS_CHANGED
,

25 
SIG_ANNOTATION_CHANGED
, 
SIG_AXIS_DIRECTION_CHANGED
,

26 
SIG_ITEMS_CHANGED
, 
SIG_ACTIVE_ITEM_CHANGED
, 
SIG_ITEM_MOVED
,

27 
SIG_LUT_CHANGED
, 
SIG_ITEM_SELECTION_CHANGED
, 
SIG_STOP_MOVING
,

28 
SIG_RANGE_CHANGED
)

30 
äom
 
	gsm
.
	g¡xm_cÚŒŞ
.
	g¶Ù‹rs
.
curveWidg‘
 
impÜt
 
	gCurveV›w”Widg‘


31 
impÜt
 
	gsm
.
	g¡xm_cÚŒŞ
.
	g¡xm_maš_qrc


34 #_äomUtf8 = 
QtCÜe
.
QSŒšg
.
äomUtf8


35 #exû± 
A‰ribu‹E¼Ü
:

36 
	g_äomUtf8
 = 
Ïmbda
 
s
: s

38 #£tu°
moduË
 
logg”
 
w™h
 
a
  do-
nÙhšg
 
hªdËr


39 
_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

41 
şass
 
	$EÃrgyS–eùÜ
(
CurveV›w”Widg‘
):

42 
Ãw_¿nge
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
, , , )

43 
ºg_chªged
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
, , , )

45 
def
 
	`__š™__
(
£lf
,
wšT™ËSŒ
 = "EÃrgy S–eùÜ", 
toŞb¬
 = 
F®£
, 
show_bË
=F®£, 
İtiÚs
 = {
	}
}):

46 
su³r
(
EÃrgyS–eùÜ
, 
£lf
).
__š™__
(
wšT™ËSŒ
 = wšT™ËSŒ, 
toŞb¬
 =oŞb¬, 
İtiÚs
 = {})

47 #£lf.
ui
 = 
uic
.
lßdUi
(
widg‘sDœ
 + 
SLASH
 + 'energySelect.ui')

48 
£lf
.
£tMšimumSize
(1300,1000)

50 
	g£lf
.
£tPlÙAxisSŒs
(
x¡r
="eV", 
y¡r
=
NÚe
)

52 #£lf.
»gToŞs
()

53 
£lf
.
addToŞ
('HRangeTool')

54 
£lf
.
mod–
 = 
NÚe


55 #£lf.
ü—‹_‹¡_¶Ù
(200, 2000)

57 
	g£lf
.
	g_deçuÉ_ºg_ûÁ”
 = 395

58 
£lf
.
_deçuÉ_ºg_tÙ®
 = 0

59 
£lf
.
_deçuÉ_ºg_ÅÁs
 = 1

61 
£lf
.
_ºg_ûÁ”
 = s–f.
_deçuÉ_ºg_ûÁ”


62 
£lf
.
_ºg_tÙ®
 = s–f.
_deçuÉ_ºg_tÙ®


63 
£lf
.
_ºg_Åošts
 = s–f.
_deçuÉ_ºg_ÅÁs


65 #£lf.
£t_axis_fÚt_size
('left', 1)

66 #£lf.
£t_axis_fÚt_size
('top', 4)

68 
	g£lf
.
	g»giÚ_Çme
 = 'None'

69 
£lf
.
sÿn_id
 = 0

71 
£lf
.
addRngBŠ
 = 
QtWidg‘s
.
QToŞBu‰Ú
()

72 
£lf
.
addRngBŠ
.
£tText
(
_äomUtf8
(""))

73 
icÚ4
 = 
QtWidg‘s
.
QIcÚ
()

75 
icÚ4
.
addPixm­
(
QtGui
.
QPixm­
(
_äomUtf8
(":/guiqwt/icÚs/images/x¿nge.²g")), 
QtWidg‘s
.
QIcÚ
.
NÜm®
, QtWidg‘s.QIcÚ.
Off
)

76 
	gicÚ4
.
addPixm­
(
QtGui
.
QPixm­
(
_äomUtf8
(":/guiqwt/icÚs/images/x¿nge.²g")), 
QtWidg‘s
.
QIcÚ
.
NÜm®
, QtWidg‘s.QIcÚ.
On
)

77 
	g£lf
.
	gaddRngBŠ
.
£tIcÚ
(
icÚ4
)

78 
	g£lf
.
	gaddRngBŠ
.
£tIcÚSize
(
QtCÜe
.
QSize
(16, 16))

79 
	g£lf
.
	gaddRngBŠ
.
£tAutoRai£
(
True
)

80 
	g£lf
.
	gaddRngBŠ
.
£tObjeùName
(
_äomUtf8
("newRangeButton"))

81 
	g£lf
.
	gaddRngBŠ
.
£tToŞT
(
_äomUtf8
("addƒnergy„ange"))

82 
	g£lf
.
	gaddRngBŠ
.
	gşicked
.
cÚÃù
(
£lf
.
Ú_bŠ_Ãw_¿nge
)

84 
	g£lf
.
ü—‹_ba£_lše
(0, 2500)

86 
	g£lf
.
	gûÁ”Ed™
 = 
QtWidg‘s
.
QLšeEd™
()

87 
£lf
.
¿ngeEd™
 = 
QtWidg‘s
.
QLšeEd™
()

88 
£lf
.
ÅoštsEd™
 = 
QtWidg‘s
.
QLšeEd™
()

90 
£lf
.
ûÁ”Ed™
.
£tV®id©Ü
(
QtWidg‘s
.
QDoubËV®id©Ü
(100.0, 2500.0, 3, self))

91 
	g£lf
.
	g¿ngeEd™
.
£tV®id©Ü
(
QtWidg‘s
.
QDoubËV®id©Ü
(100.0, 2500.0, 3, 
£lf
))

92 
	g£lf
.
	gÅoštsEd™
.
£tV®id©Ü
(
QtWidg‘s
.
QIÁV®id©Ü
(1, 1000, 
£lf
))

94 
	g£lf
.
	gûÁ”Ed™
.
	g»tuºP»s£d
.
cÚÃù
(
£lf
.
Ú_¡¬t_chªged
)

95 
	g£lf
.
	g¿ngeEd™
.
	g»tuºP»s£d
.
cÚÃù
(
£lf
.
Ú_¡İ_chªged
)

96 
	g£lf
.
	gÅoštsEd™
.
	g»tuºP»s£d
.
cÚÃù
(
£lf
.
Ú_Åošts_chªged
)

98 
	g£lf
.
	g’”gy_id
 = 0

99 
£lf
.
cur_¿nge_™em
 = 
NÚe


101 
¥aûr
 = 
QtWidg‘s
.
QS·ûrI‹m
(5000,100,QtWidg‘s.
QSizePŞicy
.
Maximum
, QtWidg‘s.QSizePŞicy.
Ex·ndšg
)

103 
	g£lf
.
	g¡¬tLbl
 = 
QtWidg‘s
.
QLab–
('Start:')

104 
£lf
.
¡İLbl
 = 
QtWidg‘s
.
QLab–
('Stop:')

105 
£lf
.
ÅoštsLbl
 = 
QtWidg‘s
.
QLab–
('#Points:')

107 
£lf
.
¡¬tLbl
.
£tBuddy
(£lf.
ûÁ”Ed™
)

108 
£lf
.
¡İLbl
.
£tBuddy
(£lf.
¿ngeEd™
)

109 
£lf
.
ÅoštsLbl
.
£tBuddy
(£lf.
ÅoštsEd™
)

111 
£lf
.
sÿnEvTabË
 = 
EÃrgySÿnTabËV›w
()

112 
£lf
.
sÿnEvTabË
.
¿nge_chªged
.
cÚÃù
(£lf.
Ú_mod–_chªged
)

114 
vÏyout
 = 
£lf
.
Ïyout
()

116 if(
show_bË
):

117 
vÏyout
.
addWidg‘
(
£lf
.
sÿnEvTabË
)

118 
£lf
.
£tMšimumSize
(100,200)

119 
	g£lf
.
£tMšimumHeight
(200)

120 
	g£lf
.
£tMaximumHeight
(400)

121 
	g£lf
.
	gsÿnEvTabË
.
£tMšimumHeight
(400)

123 
£lf
.
£tMšimumSize
(100,150)

124 
	g£lf
.
£tMšimumHeight
(150)

125 
	g£lf
.
£tMaximumHeight
(150)

126 
	ghÏyout2
 = 
QtWidg‘s
.
QHBoxLayout
()

127 
hÏyout2
.
addWidg‘
(
£lf
.
¡¬tLbl
)

128 
hÏyout2
.
addWidg‘
(
£lf
.
¡¬tEd™
)

130 
hÏyout2
.
addWidg‘
(
£lf
.
¡İLbl
)

131 
hÏyout2
.
addWidg‘
(
£lf
.
¡İEd™
)

132 
hÏyout2
.
addI‹m
(
¥aûr
)

133 
hÏyout2
.
addWidg‘
(
£lf
.
¡•sLbl
)

134 
hÏyout2
.
addWidg‘
(
£lf
.
¡•sEd™
)

135 #vÏyout.
addLayout
(
hÏyout1
)

136 
vÏyout
.
addLayout
(
hÏyout2
)

137 #vÏyout.
addWidg‘
(
£lf
.
bËV›w
)

139 
def
 
	$g‘_¿nge_id
(
£lf
):

140 (
£lf
.
’”gy_id
)

142 
def
 
	$£t_¿nge_id
(
£lf
, 
’”gy_id
):

143 
£lf
.
’”gy_id
 =ƒnergy_id

145 
def
 
	$g‘_ûÁ”
(
£lf
):

146 (
£lf
.
_ºg_ûÁ”
)

148 
def
 
	$g‘_¿nge
(
£lf
):

149 (
£lf
.
_ºg_tÙ®
)

151 
def
 
	$g‘_Åošts
(
£lf
):

152 (
£lf
.
_ºg_Åošts
)

154 
def
 
	$Ú_bŠ_Ãw_¿nge
(
£lf
):

155 
£lf
.
	`ü—‹_Ãw_¿nge
(£lf.
_ºg_ûÁ”
, s–f.
_ºg_tÙ®
)

157 
def
 
	$ü—‹_Ãw_¿nge
(
£lf
, 
ûÁ”
=
NÚe
, 
ºg
=NÚe, 
dosigÇl
=
True
):

158 if(
ûÁ”
 
is
 
NÚe
):

159 
ûÁ”
 = 
£lf
.
_deçuÉ_ºg_ûÁ”


160 if(
ºg
 
is
 
NÚe
):

161 
ºg
 = 
£lf
.
_deçuÉ_ºg_tÙ®


163 if(
£lf
.
cur_¿nge_™em
 
is
 
nÙ
 
NÚe
):

164 
£lf
.
	`d–PlÙI‹m
(£lf.
cur_¿nge_™em
, 
»¶Ù
=
True
)

166 
£lf
.
_ºg_ûÁ”
 = 
ûÁ”


167 
£lf
.
_ºg_tÙ®
 = 
ºg


168 
£lf
.
_ºg_Åošts
 = s–f.
_deçuÉ_ºg_ÅÁs


170 
£lf
.
cur_¿nge_™em
 = 
make
.
	`¿nge
(
ûÁ”
 - (0.5*
ºg
), center + (0.5*rng))

171 
£lf
.
’”gy_id
 = 
	`uniqueshÜtid
()

172 
£lf
.
	`upd©e_ed™_widg‘s
()

173 if(
dosigÇl
):

174 
£lf
.
Ãw_¿nge
.
	`em™
(£lf.
’”gy_id
, s–f.
_ºg_ûÁ”
, s–f.
_ºg_tÙ®
, s–f.
_ºg_Åošts
)

175 
£lf
.
	`upd©e_curve
()

176 (
£lf
.
’”gy_id
)

178 
def
 
	$Ú_¡¬t_chªged
(
£lf
):

179 if(
£lf
.
cur_¿nge_™em
 
is
 
nÙ
 
NÚe
):

180 
edt
 = 
£lf
.
	`£nd”
()

181 
£lf
.
_ºg_ûÁ”
, 
ok
 = 
edt
.
	`‹xt
().
	`toFlßt
()

182 #´šˆ'¡¬ˆchªgedØ%àeV' % (
£lf
.
_ºg_ûÁ”
)

183 
£lf
.
	`modify_¿nge
(£lf.
_ºg_ûÁ”
, s–f.
_ºg_tÙ®
, 
dosigÇl
=
True
)

185 
def
 
	$Ú_¡İ_chªged
(
£lf
):

186 if(
£lf
.
cur_¿nge_™em
 
is
 
nÙ
 
NÚe
):

187 
edt
 = 
£lf
.
	`£nd”
()

188 
£lf
.
_ºg_tÙ®
, 
ok
 = 
edt
.
	`‹xt
().
	`toFlßt
()

189 #´šˆ'¡İ chªgedØ%àeV ' % (
£lf
.
_ºg_tÙ®
)

190 
£lf
.
	`modify_¿nge
(£lf.
_ºg_ûÁ”
, s–f.
_ºg_tÙ®
, 
dosigÇl
=
True
)

192 
def
 
	$Ú_Åošts_chªged
(
£lf
):

193 if(
£lf
.
cur_¿nge_™em
 
is
 
nÙ
 
NÚe
):

194 
edt
 = 
£lf
.
	`£nd”
()

195 
v®
, 
ok
 = 
edt
.
	`‹xt
().
	`toIÁ
()

196 
£lf
.
_ºg_Åošts
 = 
v®


197 #´šˆ'¡• chªgedØ%d ' % (
v®
)

198 
£lf
.
	`modify_¿nge
(£lf.
_ºg_ûÁ”
, s–f.
_ºg_tÙ®
, 
dosigÇl
=
True
)

201 
def
 
	$modify_¿nge
(
£lf
, 
ûÁ”
, 
ºg
, 
Åošts
, 
dosigÇl
=
True
, 
doZoom
=
F®£
):

202 #´šˆ'modify_¿nge(%.2f, %.2f)' % (
ûÁ”
, 
ºg
)

203 
£lf
.
_ºg_ûÁ”
 = 
ûÁ”


204 
£lf
.
_ºg_tÙ®
 = 
ºg


205 
£lf
.
_ºg_Åošts
 = 
Åošts


206 
£lf
.
	`upd©e_¶Ù
(
ûÁ”
, 
ºg
)

207 if(
doZoom
):

208 
£lf
.
	`zoom_to_¿nge
()

210 if(
dosigÇl
):

211 
£lf
.
ºg_chªged
.
	`em™
(£lf.
’”gy_id
, 
ûÁ”
, 
ºg
, 
Åošts
)

214 
def
 
	$zoom_to_¿nge
(
£lf
):

215 
_d–
 = 
£lf
.
_ºg_tÙ®


216 
_·d
 = 
_d–
*0.05

218 
_mš
 = 
£lf
.
_ºg_ûÁ”
 - (0.5 * s–f.
_ºg_tÙ®
)

219 
_max
 = 
£lf
.
_ºg_ûÁ”
 + (0.5 * s–f.
_ºg_tÙ®
)

221 
x
 = 
Å
.
	`lš¥aû
(
_mš
 - 
_·d
, 
_max
 + _pad)

222 
y
 = 
Å
.
	`z”os
(
	`Ën
(
x
))

223 
£lf
.
	`£tXYD©a
('bckgºd', 
x
, 
y
, 
upd©e
=
F®£
)

224 
£lf
.
	`£t_autosÿË
()

226 
def
 
	$¿nge_chªged
(
£lf
, 
»giÚWidg‘
, 
ºg
):

227 
p1
, 
p2
 = 
»giÚWidg‘
.
	`g‘_¿nge
()

228 #nÙ 
su»
 
‹h
 
hªdË
 
the
 
wdig‘
 
g¿bbed
 
was
h
max
 
Ü
 
mš


229 if(
p1
 > 
p2
):

230 
max
 = 
p1


231 
mš
 = 
p2


233 
max
 = 
p2


234 
mš
 = 
p1


235 
£lf
.
_ºg_ûÁ”
 = (
max
 + 
mš
)/2.0

236 
£lf
.
_ºg_tÙ®
 = 
max
 - 
mš


237 
´št
 '¿ngchªged: %s: %f, %f' % (
£lf
.
’”gy_id
, s–f.
_ºg_ûÁ”
, s–f.
_ºg_tÙ®
)

238 
£lf
.
	`upd©e_ed™_widg‘s
()

239 #£lf.
m­³r
.
	`subm™
()

240 
£lf
.
ºg_chªged
.
	`em™
(£lf.
’”gy_id
, s–f.
_ºg_ûÁ”
, s–f.
_ºg_tÙ®
, s–f.
_ºg_Åošts
)

242 
def
 
	$upd©e_ed™_widg‘s
(
£lf
):

243 
£lf
.
ûÁ”Ed™
.
	`£tText
('%.2f' % s–f.
_ºg_ûÁ”
)

244 
£lf
.
¿ngeEd™
.
	`£tText
('%.2f' % s–f.
_ºg_tÙ®
)

245 
£lf
.
ÅoštsEd™
.
	`£tText
('%.d' % s–f.
_ºg_Åošts
)

247 
def
 
	$ü—‹_‹¡_¶Ù
(
£lf
, 
¡¬t
, 
¡İ
):

248 
x
 = 
Å
.
	`lš¥aû
(
¡¬t
, 
¡İ
)

249 
y
 = 
Å
.
	`sš
Òp.sšÒp.sš(
x
)))

250 
£lf
.
	`ü—‹_curve
('bckgºd',
x
, 
y
)

252 
def
 
	$ü—‹_ba£_lše
(
£lf
, 
¡¬t
, 
¡İ
):

253 
x
 = 
Å
.
	`lš¥aû
(
¡¬t
, 
¡İ
)

254 
y
 = 
Å
.
	`z”os
(
	`Ën
(
x
))

255 #£lf.
	`ü—‹_curve
('bckgºd',
x
, 
y
,
£ËùabË
=
F®£
)

256 
£lf
.
	`ü—‹_curve
('bckgºd',
x
, 
y
)

259 
def
 
	$Ú_¡İ_ed™šgFšished
(
£lf
):

260 
ed™
 = 
£lf
.
	`£nd”
()

261 #£lf.
mod–
.

263 
def
 
	$upd©e_¶Ù
(
£lf
, 
ûÁ”
, 
ºg
):

264 if(
£lf
.
cur_¿nge_™em
 
is
 
nÙ
 
NÚe
):

265 
£lf
.
_ºg_ûÁ”
 = 
ûÁ”


266 
£lf
.
_ºg_tÙ®
 = 
ºg


267 #mofify 
the
 
visu®
 
of
h
¿nge
 th
Ãw
 
v®ues


268 
_mš
 = 
ûÁ”
 - (0.5 * 
ºg
)

269 
_max
 = 
ûÁ”
 + (0.5 * 
ºg
)

270 
£lf
.
	`adju¡_¿nge
(
_mš
, 
_max
)

273 
def
 
	$£tupMod–
(
£lf
):

274 
£lf
.
mod–
 = 
QtWidg‘s
.
	`QSnd¬dI‹mMod–
(1, 
	`Ën
(£lf.
hdrLi¡
), self)

275 
row
 = 0

276 
sÿn¡¬t
 = ("15.53")

277 
sÿn¡İ
 = ("45.53")

278 
sÿn¡•
 = ("10")

280 
™em
 = 
QtWidg‘s
.
	`QSnd¬dI‹m
(
sÿn¡¬t
)

281 
£lf
.
mod–
.
	`£tI‹m
(
row
, 0, 
™em
)

282 
™em
 = 
QtWidg‘s
.
	`QSnd¬dI‹m
(
sÿn¡İ
)

283 
£lf
.
mod–
.
	`£tI‹m
(
row
, 1, 
™em
)

284 
™em
 = 
QtWidg‘s
.
	`QSnd¬dI‹m
(
sÿn¡•
)

285 
£lf
.
mod–
.
	`£tI‹m
(
row
, 2, 
™em
)

287 #w™houˆ
this
 
the
 
m­pšg
 
dÛ¢
't work

288 
£lf
.
m­³r
.
	`toFœ¡
()

290 
def
 
	$mou£R–—£Ev’t
(
£lf
, 
ev
):

292 
ev
.
	`bu‰Ú
(è=ğ
QtCÜe
.
Qt
.
MiddËBu‰Ú
:

293 
£lf
.
	`zoom_to_¿nge
()

296 
__Çme__
 == "__main__":

298 
impÜt
 
sys


300 
def
 
	$my_Ãw_¿nge
(
id
, 
ûÁ”
, 
ºg
, 
¡•
):

301 
´št
 'Ãw„ªge! [%d] = %.2f,%.2à¡• = %d' % (
id
, 
ûÁ”
, 
ºg
, 
¡•
)

303 
def
 
	$my_¿nge_chªged
(
id
, 
ûÁ”
, 
ºg
, 
¡•
):

304 
´št
 '¿ngchªged[%d] = %.2f,%.2à¡• = %d' % (
id
, 
ûÁ”
, 
ºg
, 
¡•
)

307 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

309 
wš
 = 
	`EÃrgyS–eùÜ
(
show_bË
=
True
)

310 
wš
.
Ãw_¿nge
.
	`cÚÃù
(
my_Ãw_¿nge
)

311 
wš
.
ºg_chªged
.
	`cÚÃù
(
my_¿nge_chªged
)

313 
wš
.
	`show
()

315 
sys
.
	`ex™
(
­p
.
	`exec_
())

	@widgets/energy_selection.py

2 
C»©ed
 
	gÚ
 2013-06-18

4 @
	gauthÜ
: 
b”gr


7 
C»©ed
 
Ú
 2013-05-29

9 @
authÜ
: 
b”gr


11 
impÜt
 
numpy
 
as
 
Å


13 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui


14 
äom
 
PyQt5
 
impÜt
 
	guic


15 
impÜt
 
	gPyQt4
.
Qwt5
 
as
 
	gQwt


17 
äom
 
	gguiqwt
.
bud”
 
impÜt
 
	gmake


19 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


20 
äom
 
	gşs
.
	guts
.
feUts
 
impÜt
 
	glßdD©ToXY
, 
	glßdD©ToA¼ay
, 
	glßdD©To2DA¼ay
, 
	g»adCŞumnSŒs


21 
äom
 
	gbcm
.
	guts
.
cfg·r£r
 
impÜt
 
	gCÚfigCÏss


22 
äom
 
	gbcm
.
	guts
.
unique_id
 
impÜt
 
	guniqueshÜtid


24 
äom
 
	gguiqwt
.
sigÇls
 
impÜt
 (
SIG_MARKER_CHANGED
, 
SIG_PLOT_LABELS_CHANGED
,

25 
SIG_ANNOTATION_CHANGED
, 
SIG_AXIS_DIRECTION_CHANGED
,

26 
SIG_ITEMS_CHANGED
, 
SIG_ACTIVE_ITEM_CHANGED
, 
SIG_ITEM_MOVED
,

27 
SIG_LUT_CHANGED
, 
SIG_ITEM_SELECTION_CHANGED
, 
SIG_STOP_MOVING
,

28 
SIG_RANGE_CHANGED
)

30 
äom
 
	gsm
.
	g¡xm_cÚŒŞ
.
	g¶Ù‹rs
.
curveWidg‘
 
impÜt
 
	gCurveV›w”Widg‘


31 
impÜt
 
	gsm
.
	g¡xm_cÚŒŞ
.
	g¡xm_maš_qrc


34 #_äomUtf8 = 
QtCÜe
.
QSŒšg
.
äomUtf8


35 #exû± 
A‰ribu‹E¼Ü
:

36 
	g_äomUtf8
 = 
Ïmbda
 
s
: s

38 #£tu°
moduË
 
logg”
 
w™h
 
a
  do-
nÙhšg
 
hªdËr


39 
_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

41 
şass
 
	$EÃrgyS–eùÜ
(
CurveV›w”Widg‘
):

42 
Ãw_¿nge
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
, , , )

43 
ºg_chªged
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
, , , )

45 
def
 
	`__š™__
(
£lf
,
wšT™ËSŒ
 = "EÃrgy S–eùÜ", 
toŞb¬
 = 
F®£
, 
show_bË
=F®£, 
İtiÚs
 = {
	}
}):

46 
su³r
(
EÃrgyS–eùÜ
, 
£lf
).
__š™__
(
wšT™ËSŒ
 = wšT™ËSŒ, 
toŞb¬
 =oŞb¬, 
İtiÚs
 = {})

47 #£lf.
ui
 = 
uic
.
lßdUi
(
widg‘sDœ
 + 
SLASH
 + 'energySelect.ui')

48 
£lf
.
£tMšimumSize
(1300,1000)

50 
	g£lf
.
£tPlÙAxisSŒs
(
x¡r
="eV", 
y¡r
=
NÚe
)

52 #£lf.
»gToŞs
()

53 
£lf
.
addToŞ
('HRangeTool')

54 
£lf
.
mod–
 = 
NÚe


55 #£lf.
ü—‹_‹¡_¶Ù
(200, 2000)

57 
	g£lf
.
	g_deçuÉ_ºg_ûÁ”
 = 395

58 
£lf
.
_deçuÉ_ºg_tÙ®
 = 0

59 
£lf
.
_deçuÉ_ºg_ÅÁs
 = 1

61 
£lf
.
_ºg_ûÁ”
 = s–f.
_deçuÉ_ºg_ûÁ”


62 
£lf
.
_ºg_tÙ®
 = s–f.
_deçuÉ_ºg_tÙ®


63 
£lf
.
_ºg_Åošts
 = s–f.
_deçuÉ_ºg_ÅÁs


65 #£lf.
£t_axis_fÚt_size
('left', 1)

66 #£lf.
£t_axis_fÚt_size
('top', 4)

68 
	g£lf
.
	g»giÚ_Çme
 = 'None'

69 
£lf
.
sÿn_id
 = 0

71 
£lf
.
addRngBŠ
 = 
QtWidg‘s
.
QToŞBu‰Ú
()

72 
£lf
.
addRngBŠ
.
£tText
(
_äomUtf8
(""))

73 
icÚ4
 = 
QtWidg‘s
.
QIcÚ
()

75 
icÚ4
.
addPixm­
(
QtGui
.
QPixm­
(
_äomUtf8
(":/guiqwt/icÚs/images/x¿nge.²g")), 
QtWidg‘s
.
QIcÚ
.
NÜm®
, QtWidg‘s.QIcÚ.
Off
)

76 
	gicÚ4
.
addPixm­
(
QtGui
.
QPixm­
(
_äomUtf8
(":/guiqwt/icÚs/images/x¿nge.²g")), 
QtWidg‘s
.
QIcÚ
.
NÜm®
, QtWidg‘s.QIcÚ.
On
)

77 
	g£lf
.
	gaddRngBŠ
.
£tIcÚ
(
icÚ4
)

78 
	g£lf
.
	gaddRngBŠ
.
£tIcÚSize
(
QtCÜe
.
QSize
(16, 16))

79 
	g£lf
.
	gaddRngBŠ
.
£tAutoRai£
(
True
)

80 
	g£lf
.
	gaddRngBŠ
.
£tObjeùName
(
_äomUtf8
("newRangeButton"))

81 
	g£lf
.
	gaddRngBŠ
.
£tToŞT
(
_äomUtf8
("addƒnergy„ange"))

82 
	g£lf
.
	gaddRngBŠ
.
	gşicked
.
cÚÃù
(
£lf
.
Ú_bŠ_Ãw_¿nge
)

84 
	g£lf
.
ü—‹_ba£_lše
(0, 2500)

86 
	g£lf
.
	gûÁ”Ed™
 = 
QtWidg‘s
.
QLšeEd™
()

87 
£lf
.
¿ngeEd™
 = 
QtWidg‘s
.
QLšeEd™
()

88 
£lf
.
ÅoštsEd™
 = 
QtWidg‘s
.
QLšeEd™
()

90 
£lf
.
ûÁ”Ed™
.
£tV®id©Ü
(
QtWidg‘s
.
QDoubËV®id©Ü
(100.0, 2500.0, 3, self))

91 
	g£lf
.
	g¿ngeEd™
.
£tV®id©Ü
(
QtWidg‘s
.
QDoubËV®id©Ü
(100.0, 2500.0, 3, 
£lf
))

92 
	g£lf
.
	gÅoštsEd™
.
£tV®id©Ü
(
QtWidg‘s
.
QIÁV®id©Ü
(1, 1000, 
£lf
))

94 
	g£lf
.
	gûÁ”Ed™
.
	g»tuºP»s£d
.
cÚÃù
(
£lf
.
Ú_¡¬t_chªged
)

95 
	g£lf
.
	g¿ngeEd™
.
	g»tuºP»s£d
.
cÚÃù
(
£lf
.
Ú_¡İ_chªged
)

96 
	g£lf
.
	gÅoštsEd™
.
	g»tuºP»s£d
.
cÚÃù
(
£lf
.
Ú_Åošts_chªged
)

98 
	g£lf
.
	g’”gy_id
 = 0

99 
£lf
.
cur_¿nge_™em
 = 
NÚe


101 
¥aûr
 = 
QtWidg‘s
.
QS·ûrI‹m
(5000,100,QtWidg‘s.
QSizePŞicy
.
Maximum
, QtWidg‘s.QSizePŞicy.
Ex·ndšg
)

103 
	g£lf
.
	g¡¬tLbl
 = 
QtWidg‘s
.
QLab–
('Start:')

104 
£lf
.
¡İLbl
 = 
QtWidg‘s
.
QLab–
('Stop:')

105 
£lf
.
ÅoštsLbl
 = 
QtWidg‘s
.
QLab–
('#Points:')

107 
£lf
.
¡¬tLbl
.
£tBuddy
(£lf.
ûÁ”Ed™
)

108 
£lf
.
¡İLbl
.
£tBuddy
(£lf.
¿ngeEd™
)

109 
£lf
.
ÅoštsLbl
.
£tBuddy
(£lf.
ÅoštsEd™
)

111 
£lf
.
sÿnEvTabË
 = 
EÃrgySÿnTabËV›w
()

112 
£lf
.
sÿnEvTabË
.
¿nge_chªged
.
cÚÃù
(£lf.
Ú_mod–_chªged
)

114 
vÏyout
 = 
£lf
.
Ïyout
()

116 if(
show_bË
):

117 
vÏyout
.
addWidg‘
(
£lf
.
sÿnEvTabË
)

118 
£lf
.
£tMšimumSize
(100,200)

119 
	g£lf
.
£tMšimumHeight
(200)

120 
	g£lf
.
£tMaximumHeight
(400)

121 
	g£lf
.
	gsÿnEvTabË
.
£tMšimumHeight
(400)

123 
£lf
.
£tMšimumSize
(100,150)

124 
	g£lf
.
£tMšimumHeight
(150)

125 
	g£lf
.
£tMaximumHeight
(150)

126 
	ghÏyout2
 = 
QtWidg‘s
.
QHBoxLayout
()

127 
hÏyout2
.
addWidg‘
(
£lf
.
¡¬tLbl
)

128 
hÏyout2
.
addWidg‘
(
£lf
.
¡¬tEd™
)

130 
hÏyout2
.
addWidg‘
(
£lf
.
¡İLbl
)

131 
hÏyout2
.
addWidg‘
(
£lf
.
¡İEd™
)

132 
hÏyout2
.
addI‹m
(
¥aûr
)

133 
hÏyout2
.
addWidg‘
(
£lf
.
¡•sLbl
)

134 
hÏyout2
.
addWidg‘
(
£lf
.
¡•sEd™
)

135 #vÏyout.
addLayout
(
hÏyout1
)

136 
vÏyout
.
addLayout
(
hÏyout2
)

137 #vÏyout.
addWidg‘
(
£lf
.
bËV›w
)

139 
def
 
	$g‘_¿nge_id
(
£lf
):

140 (
£lf
.
’”gy_id
)

142 
def
 
	$£t_¿nge_id
(
£lf
, 
’”gy_id
):

143 
£lf
.
’”gy_id
 =ƒnergy_id

145 
def
 
	$g‘_ûÁ”
(
£lf
):

146 (
£lf
.
_ºg_ûÁ”
)

148 
def
 
	$g‘_¿nge
(
£lf
):

149 (
£lf
.
_ºg_tÙ®
)

151 
def
 
	$g‘_Åošts
(
£lf
):

152 (
£lf
.
_ºg_Åošts
)

154 
def
 
	$Ú_bŠ_Ãw_¿nge
(
£lf
):

155 
£lf
.
	`ü—‹_Ãw_¿nge
(£lf.
_ºg_ûÁ”
, s–f.
_ºg_tÙ®
)

157 
def
 
	$ü—‹_Ãw_¿nge
(
£lf
, 
ûÁ”
=
NÚe
, 
ºg
=NÚe, 
dosigÇl
=
True
):

158 if(
ûÁ”
 
is
 
NÚe
):

159 
ûÁ”
 = 
£lf
.
_deçuÉ_ºg_ûÁ”


160 if(
ºg
 
is
 
NÚe
):

161 
ºg
 = 
£lf
.
_deçuÉ_ºg_tÙ®


163 if(
£lf
.
cur_¿nge_™em
 
is
 
nÙ
 
NÚe
):

164 
£lf
.
	`d–PlÙI‹m
(£lf.
cur_¿nge_™em
, 
»¶Ù
=
True
)

166 
£lf
.
_ºg_ûÁ”
 = 
ûÁ”


167 
£lf
.
_ºg_tÙ®
 = 
ºg


168 
£lf
.
_ºg_Åošts
 = s–f.
_deçuÉ_ºg_ÅÁs


170 
£lf
.
cur_¿nge_™em
 = 
make
.
	`¿nge
(
ûÁ”
 - (0.5*
ºg
), center + (0.5*rng))

171 
£lf
.
’”gy_id
 = 
	`uniqueshÜtid
()

172 
£lf
.
	`upd©e_ed™_widg‘s
()

173 if(
dosigÇl
):

174 
£lf
.
Ãw_¿nge
.
	`em™
(£lf.
’”gy_id
, s–f.
_ºg_ûÁ”
, s–f.
_ºg_tÙ®
, s–f.
_ºg_Åošts
)

175 
£lf
.
	`upd©e_curve
()

176 (
£lf
.
’”gy_id
)

178 
def
 
	$Ú_¡¬t_chªged
(
£lf
):

179 if(
£lf
.
cur_¿nge_™em
 
is
 
nÙ
 
NÚe
):

180 
edt
 = 
£lf
.
	`£nd”
()

181 
£lf
.
_ºg_ûÁ”
, 
ok
 = 
edt
.
	`‹xt
().
	`toFlßt
()

182 #´šˆ'¡¬ˆchªgedØ%àeV' % (
£lf
.
_ºg_ûÁ”
)

183 
£lf
.
	`modify_¿nge
(£lf.
_ºg_ûÁ”
, s–f.
_ºg_tÙ®
, 
dosigÇl
=
True
)

185 
def
 
	$Ú_¡İ_chªged
(
£lf
):

186 if(
£lf
.
cur_¿nge_™em
 
is
 
nÙ
 
NÚe
):

187 
edt
 = 
£lf
.
	`£nd”
()

188 
£lf
.
_ºg_tÙ®
, 
ok
 = 
edt
.
	`‹xt
().
	`toFlßt
()

189 #´šˆ'¡İ chªgedØ%àeV ' % (
£lf
.
_ºg_tÙ®
)

190 
£lf
.
	`modify_¿nge
(£lf.
_ºg_ûÁ”
, s–f.
_ºg_tÙ®
, 
dosigÇl
=
True
)

192 
def
 
	$Ú_Åošts_chªged
(
£lf
):

193 if(
£lf
.
cur_¿nge_™em
 
is
 
nÙ
 
NÚe
):

194 
edt
 = 
£lf
.
	`£nd”
()

195 
v®
, 
ok
 = 
edt
.
	`‹xt
().
	`toIÁ
()

196 
£lf
.
_ºg_Åošts
 = 
v®


197 #´šˆ'¡• chªgedØ%d ' % (
v®
)

198 
£lf
.
	`modify_¿nge
(£lf.
_ºg_ûÁ”
, s–f.
_ºg_tÙ®
, 
dosigÇl
=
True
)

201 
def
 
	$modify_¿nge
(
£lf
, 
ûÁ”
, 
ºg
, 
Åošts
, 
dosigÇl
=
True
, 
doZoom
=
F®£
):

202 #´šˆ'modify_¿nge(%.2f, %.2f)' % (
ûÁ”
, 
ºg
)

203 
£lf
.
_ºg_ûÁ”
 = 
ûÁ”


204 
£lf
.
_ºg_tÙ®
 = 
ºg


205 
£lf
.
_ºg_Åošts
 = 
Åošts


206 
£lf
.
	`upd©e_¶Ù
(
ûÁ”
, 
ºg
)

207 if(
doZoom
):

208 
£lf
.
	`zoom_to_¿nge
()

210 if(
dosigÇl
):

211 
£lf
.
ºg_chªged
.
	`em™
(£lf.
’”gy_id
, 
ûÁ”
, 
ºg
, 
Åošts
)

214 
def
 
	$zoom_to_¿nge
(
£lf
):

215 
_d–
 = 
£lf
.
_ºg_tÙ®


216 
_·d
 = 
_d–
*0.05

218 
_mš
 = 
£lf
.
_ºg_ûÁ”
 - (0.5 * s–f.
_ºg_tÙ®
)

219 
_max
 = 
£lf
.
_ºg_ûÁ”
 + (0.5 * s–f.
_ºg_tÙ®
)

221 
x
 = 
Å
.
	`lš¥aû
(
_mš
 - 
_·d
, 
_max
 + _pad)

222 
y
 = 
Å
.
	`z”os
(
	`Ën
(
x
))

223 
£lf
.
	`£tXYD©a
('bckgºd', 
x
, 
y
, 
upd©e
=
F®£
)

224 
£lf
.
	`£t_autosÿË
()

226 
def
 
	$¿nge_chªged
(
£lf
, 
»giÚWidg‘
, 
ºg
):

227 
p1
, 
p2
 = 
»giÚWidg‘
.
	`g‘_¿nge
()

228 #nÙ 
su»
 
‹h
 
hªdË
 
the
 
wdig‘
 
g¿bbed
 
was
h
max
 
Ü
 
mš


229 if(
p1
 > 
p2
):

230 
max
 = 
p1


231 
mš
 = 
p2


233 
max
 = 
p2


234 
mš
 = 
p1


235 
£lf
.
_ºg_ûÁ”
 = (
max
 + 
mš
)/2.0

236 
£lf
.
_ºg_tÙ®
 = 
max
 - 
mš


237 
´št
 '¿ngchªged: %s: %f, %f' % (
£lf
.
’”gy_id
, s–f.
_ºg_ûÁ”
, s–f.
_ºg_tÙ®
)

238 
£lf
.
	`upd©e_ed™_widg‘s
()

239 #£lf.
m­³r
.
	`subm™
()

240 
£lf
.
ºg_chªged
.
	`em™
(£lf.
’”gy_id
, s–f.
_ºg_ûÁ”
, s–f.
_ºg_tÙ®
, s–f.
_ºg_Åošts
)

242 
def
 
	$upd©e_ed™_widg‘s
(
£lf
):

243 
£lf
.
ûÁ”Ed™
.
	`£tText
('%.2f' % s–f.
_ºg_ûÁ”
)

244 
£lf
.
¿ngeEd™
.
	`£tText
('%.2f' % s–f.
_ºg_tÙ®
)

245 
£lf
.
ÅoštsEd™
.
	`£tText
('%.d' % s–f.
_ºg_Åošts
)

247 
def
 
	$ü—‹_‹¡_¶Ù
(
£lf
, 
¡¬t
, 
¡İ
):

248 
x
 = 
Å
.
	`lš¥aû
(
¡¬t
, 
¡İ
)

249 
y
 = 
Å
.
	`sš
Òp.sšÒp.sš(
x
)))

250 
£lf
.
	`ü—‹_curve
('bckgºd',
x
, 
y
)

252 
def
 
	$ü—‹_ba£_lše
(
£lf
, 
¡¬t
, 
¡İ
):

253 
x
 = 
Å
.
	`lš¥aû
(
¡¬t
, 
¡İ
)

254 
y
 = 
Å
.
	`z”os
(
	`Ën
(
x
))

255 #£lf.
	`ü—‹_curve
('bckgºd',
x
, 
y
,
£ËùabË
=
F®£
)

256 
£lf
.
	`ü—‹_curve
('bckgºd',
x
, 
y
)

259 
def
 
	$Ú_¡İ_ed™šgFšished
(
£lf
):

260 
ed™
 = 
£lf
.
	`£nd”
()

261 #£lf.
mod–
.

263 
def
 
	$upd©e_¶Ù
(
£lf
, 
ûÁ”
, 
ºg
):

264 if(
£lf
.
cur_¿nge_™em
 
is
 
nÙ
 
NÚe
):

265 
£lf
.
_ºg_ûÁ”
 = 
ûÁ”


266 
£lf
.
_ºg_tÙ®
 = 
ºg


267 #mofify 
the
 
visu®
 
of
h
¿nge
 th
Ãw
 
v®ues


268 
_mš
 = 
ûÁ”
 - (0.5 * 
ºg
)

269 
_max
 = 
ûÁ”
 + (0.5 * 
ºg
)

270 
£lf
.
	`adju¡_¿nge
(
_mš
, 
_max
)

273 
def
 
	$£tupMod–
(
£lf
):

274 
£lf
.
mod–
 = 
QtWidg‘s
.
	`QSnd¬dI‹mMod–
(1, 
	`Ën
(£lf.
hdrLi¡
), self)

275 
row
 = 0

276 
sÿn¡¬t
 = ("15.53")

277 
sÿn¡İ
 = ("45.53")

278 
sÿn¡•
 = ("10")

280 
™em
 = 
QtWidg‘s
.
	`QSnd¬dI‹m
(
sÿn¡¬t
)

281 
£lf
.
mod–
.
	`£tI‹m
(
row
, 0, 
™em
)

282 
™em
 = 
QtWidg‘s
.
	`QSnd¬dI‹m
(
sÿn¡İ
)

283 
£lf
.
mod–
.
	`£tI‹m
(
row
, 1, 
™em
)

284 
™em
 = 
QtWidg‘s
.
	`QSnd¬dI‹m
(
sÿn¡•
)

285 
£lf
.
mod–
.
	`£tI‹m
(
row
, 2, 
™em
)

287 #w™houˆ
this
 
the
 
m­pšg
 
dÛ¢
't work

288 
£lf
.
m­³r
.
	`toFœ¡
()

290 
def
 
	$mou£R–—£Ev’t
(
£lf
, 
ev
):

292 
ev
.
	`bu‰Ú
(è=ğ
QtCÜe
.
Qt
.
MiddËBu‰Ú
:

293 
£lf
.
	`zoom_to_¿nge
()

296 
__Çme__
 == "__main__":

298 
impÜt
 
sys


300 
def
 
	$my_Ãw_¿nge
(
id
, 
ûÁ”
, 
ºg
, 
¡•
):

301 
´št
 'Ãw„ªge! [%d] = %.2f,%.2à¡• = %d' % (
id
, 
ûÁ”
, 
ºg
, 
¡•
)

303 
def
 
	$my_¿nge_chªged
(
id
, 
ûÁ”
, 
ºg
, 
¡•
):

304 
´št
 '¿ngchªged[%d] = %.2f,%.2à¡• = %d' % (
id
, 
ûÁ”
, 
ºg
, 
¡•
)

307 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

309 
wš
 = 
	`EÃrgyS–eùÜ
(
show_bË
=
True
)

310 
wš
.
Ãw_¿nge
.
	`cÚÃù
(
my_Ãw_¿nge
)

311 
wš
.
ºg_chªged
.
	`cÚÃù
(
my_¿nge_chªged
)

313 
wš
.
	`show
()

315 
sys
.
	`ex™
(
­p
.
	`exec_
())

	@widgets/energy_selection_v1.py

2 
C»©ed
 
	gÚ
 2013-05-29

4 @
	gauthÜ
: 
b”gr


6 
impÜt
 
numpy
 
as
 
Å


8 
äom
 
PyQt5
 
impÜt
 
QtGui
, 
	gQtCÜe


9 
äom
 
PyQt5
 
impÜt
 
	guic


10 
impÜt
 
	gPyQt4
.
Qwt5
 
as
 
	gQwt


12 
äom
 
	gguiqwt
.
bud”
 
impÜt
 
	gmake


14 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


15 
äom
 
	gşs
.
	guts
.
feUts
 
impÜt
 
	glßdD©ToXY
, 
	glßdD©ToA¼ay
, 
	glßdD©To2DA¼ay
, 
	g»adCŞumnSŒs


16 
äom
 
	gbcm
.
	guts
.
cfg·r£r
 
impÜt
 
	gCÚfigCÏss


18 
äom
 
	gguiqwt
.
sigÇls
 
impÜt
 (
SIG_MARKER_CHANGED
, 
SIG_PLOT_LABELS_CHANGED
,

19 
SIG_ANNOTATION_CHANGED
, 
SIG_AXIS_DIRECTION_CHANGED
,

20 
SIG_ITEMS_CHANGED
, 
SIG_ACTIVE_ITEM_CHANGED
, 
SIG_ITEM_MOVED
,

21 
SIG_LUT_CHANGED
, 
SIG_ITEM_SELECTION_CHANGED
, 
SIG_STOP_MOVING
,

22 
SIG_RANGE_CHANGED
)

24 
äom
 
	gşs
.
	gsÿÂšg
.
SÿnDef
 
impÜt
 
	gBa£SÿnDef


25 
äom
 
	gşs
.
	gsÿÂšg
.
SÿnTabËV›w
 
impÜt
 
	gEÃrgySÿnTabËV›w


26 
äom
 
	gsm
.
	g¡xm_cÚŒŞ
.
	g¶Ù‹rs
.
curveWidg‘
 
impÜt
 
	gCurveV›w”Widg‘


28 
impÜt
 
	gsm
.
	g¡xm_cÚŒŞ
.
	g¡xm_maš_qrc


31 #_äomUtf8 = 
QtCÜe
.
QSŒšg
.
äomUtf8


32 #exû± 
A‰ribu‹E¼Ü
:

33 
	g_äomUtf8
 = 
Ïmbda
 
s
: s

35 #£tu°
moduË
 
logg”
 
w™h
 
a
  do-
nÙhšg
 
hªdËr


36 
_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

38 
şass
 
	$EÃrgyS–eùÜ
(
CurveV›w”Widg‘
):

39 
Ãw_¿nge
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
, , )

41 
def
 
	`__š™__
(
£lf
,
wšT™ËSŒ
 = "EÃrgy S–eùÜ", 
toŞb¬
 = 
F®£
, 
show_bË
=F®£, 
İtiÚs
 = {
	}
}):

42 
su³r
(
EÃrgyS–eùÜ
, 
£lf
).
__š™__
(
wšT™ËSŒ
 = wšT™ËSŒ, 
toŞb¬
 =oŞb¬, 
İtiÚs
 = {})

43 #£lf.
ui
 = 
uic
.
lßdUi
(
widg‘sDœ
 + 
SLASH
 + 'energySelect.ui')

44 
£lf
.
£tMšimumSize
(1300,1000)

46 #£lf.
£tPlÙAxisSŒs
(
t™Ë
=
NÚe
, 
x¡r
="eV", 
y¡r
=None)

48 #£lf.
»gToŞs
()

49 
	g£lf
.
addToŞ
('HRangeTool')

50 
	g£lf
.
	gmod–
 = 
NÚe


51 #£lf.
ü—‹_‹¡_¶Ù
(200, 2000)

52 
	g£lf
.
	g_ºg_mš
 = 200

53 
£lf
.
_ºg_max
 = 2000

55 #£lf.
ü—‹_ba£_lše
(0, 
£lf
.
_ºg_max
+200)

56 #£lf.
ü—‹_¿nge
(
£lf
.
_ºg_mš
, s–f.
_ºg_max
)

57 #£lf.
ü—‹_‹¡_¶Ù
()

58 #£lf.
£t_axis_fÚt_size
('left', 1)

59 #£lf.
£t_axis_fÚt_size
('top', 4)

61 
	g£lf
.
	g»giÚ_Çme
 = 'None'

62 
£lf
.
sÿn_id
 = 0

64 
£lf
.
addRngBŠ
 = 
QtWidg‘s
.
QToŞBu‰Ú
()

65 
£lf
.
addRngBŠ
.
£tText
(
_äomUtf8
(""))

66 
icÚ4
 = 
QtWidg‘s
.
QIcÚ
()

68 
icÚ4
.
addPixm­
(
QtGui
.
QPixm­
(
_äomUtf8
(":/guiqwt/icÚs/images/x¿nge.²g")), 
QtWidg‘s
.
QIcÚ
.
NÜm®
, QtWidg‘s.QIcÚ.
Off
)

69 
	gicÚ4
.
addPixm­
(
QtGui
.
QPixm­
(
_äomUtf8
(":/guiqwt/icÚs/images/x¿nge.²g")), 
QtWidg‘s
.
QIcÚ
.
NÜm®
, QtWidg‘s.QIcÚ.
On
)

70 
	g£lf
.
	gaddRngBŠ
.
£tIcÚ
(
icÚ4
)

71 
	g£lf
.
	gaddRngBŠ
.
£tIcÚSize
(
QtCÜe
.
QSize
(16, 16))

72 
	g£lf
.
	gaddRngBŠ
.
£tAutoRai£
(
True
)

73 
	g£lf
.
	gaddRngBŠ
.
£tObjeùName
(
_äomUtf8
("forwardButton"))

74 
	g£lf
.
	gaddRngBŠ
.
	gşicked
.
cÚÃù
(
£lf
.
Ú_Ãw_¿nge
)

78 #£lEnLbÈğ
QtWidg‘s
.
QLab–
('Selecting Energy for: ')

79 #£lf.
curRegiÚLbl
 = 
QtWidg‘s
.
QLab–
('None')

80 
	g£lf
.
	gsÿnEvTabË
 = 
EÃrgySÿnTabËV›w
()

81 
£lf
.
sÿnEvTabË
.
¿nge_chªged
.
cÚÃù
(£lf.
Ú_mod–_chªged
)

82 
£lf
.
¡¬tEd™
 = 
QtWidg‘s
.
QLšeEd™
()

83 
£lf
.
¡İEd™
 = 
QtWidg‘s
.
QLšeEd™
()

84 
£lf
.
¡•sEd™
 = 
QtWidg‘s
.
QLšeEd™
()

85 #¡İEd™.
‹xtEd™ed
.
cÚÃù
(
£lf
.
Ú_¡İ_ed™ed
)

86 
£lf
.
¡¬tEd™
.
»tuºP»s£d
.
cÚÃù
(£lf.
Ú_¡¬t_chªged
)

87 
£lf
.
¡İEd™
.
»tuºP»s£d
.
cÚÃù
(£lf.
Ú_¡İ_chªged
)

88 
£lf
.
¡•sEd™
.
»tuºP»s£d
.
cÚÃù
(£lf.
Ú_¡•s_chªged
)

90 
£lf
.
cur_’”gy_id
 = 0

91 
£lf
.
cur_sÿn_id
 = 0

94 #S‘ 
up
 
the
 
m­³r
.

95 #£lf.
£tupMod–
()

96 #£lf.
hdrLi¡
 = ['Name','Start', 'Stop', 'Step', 'Points', 'Dwell', 'Pol1', 'Pol2', 'Off1', 'Off2', 'XMCD']

97 #£lf.
m­³r
 = 
QtWidg‘s
.
QD©aWidg‘M­³r
(
£lf
)

98 #£lf.
m­³r
.
£tMod–
(
£lf
.
mod–
)

99 #£lf.
m­³r
.
addM­pšg
(
£lf
.
¡¬tEd™
, 0)

100 #£lf.
m­³r
.
addM­pšg
(
£lf
.
¡İEd™
, 1)

101 #£lf.
m­³r
.
addM­pšg
(
£lf
.
¡•sEd™
, 2)

103 
	g£lf
.
	gbËV›w
 = 
QtWidg‘s
.
QTabËV›w
()

104 
£lf
.
bËV›w
.
£tMod–
(£lf.
mod–
)

105 
£lf
.
bËV›w
.
£tCŞumnWidth
(0,100)

106 
	g£lf
.
	gbËV›w
.
£tCŞumnWidth
(1,100)

107 
	g£lf
.
	gbËV›w
.
£tCŞumnWidth
(2,100)

108 #£lf.
bËV›w
.
»sizeCŞumnsToCÚ‹Ás
()

109 
	g£lf
.
	gbËV›w
.
£tWšdowT™Ë
("my view")

112 
	g¥aûr
 = 
QtWidg‘s
.
QS·ûrI‹m
(5000,100,QtWidg‘s.
QSizePŞicy
.
Maximum
, QtWidg‘s.QSizePŞicy.
Ex·ndšg
)

113 
	g£lf
.
	g£lP”iodicTabËBŠ
 = 
QtWidg‘s
.
QToŞBu‰Ú
()

115 
£lf
.
¡¬tLbl
 = 
QtWidg‘s
.
QLab–
('Start:')

116 
£lf
.
¡İLbl
 = 
QtWidg‘s
.
QLab–
('Stop:')

117 
£lf
.
¡•sLbl
 = 
QtWidg‘s
.
QLab–
('Steps:')

119 
£lf
.
¡¬tLbl
.
£tBuddy
(£lf.
¡¬tEd™
)

120 
£lf
.
¡İLbl
.
£tBuddy
(£lf.
¡İEd™
)

121 
£lf
.
¡•sLbl
.
£tBuddy
(£lf.
¡•sEd™
)

123 
vÏyout
 = 
£lf
.
Ïyout
()

124 #vÏyout.
£tCÚ‹ÁsM¬gšs
(
QtCÜe
.
QM¬gšs
(2,2,2,2))

125 
	gvÏyout
.
addWidg‘
(
£lf
.
addRngBŠ
)

126 if(
	gshow_bË
):

127 
vÏyout
.
addWidg‘
(
£lf
.
sÿnEvTabË
)

128 
£lf
.
£tMšimumSize
(100,200)

129 
	g£lf
.
£tMšimumHeight
(200)

130 
	g£lf
.
£tMaximumHeight
(400)

131 
	g£lf
.
	gsÿnEvTabË
.
£tMšimumHeight
(400)

133 
£lf
.
£tMšimumSize
(100,150)

134 
	g£lf
.
£tMšimumHeight
(150)

135 
	g£lf
.
£tMaximumHeight
(150)

136 
	ghÏyout2
 = 
QtWidg‘s
.
QHBoxLayout
()

137 
hÏyout2
.
addWidg‘
(
£lf
.
¡¬tLbl
)

138 
hÏyout2
.
addWidg‘
(
£lf
.
¡¬tEd™
)

140 
hÏyout2
.
addWidg‘
(
£lf
.
¡İLbl
)

141 
hÏyout2
.
addWidg‘
(
£lf
.
¡İEd™
)

142 
hÏyout2
.
addI‹m
(
¥aûr
)

143 
hÏyout2
.
addWidg‘
(
£lf
.
¡•sLbl
)

144 
hÏyout2
.
addWidg‘
(
£lf
.
¡•sEd™
)

145 #vÏyout.
addLayout
(
hÏyout1
)

146 
vÏyout
.
addLayout
(
hÏyout2
)

147 #vÏyout.
addWidg‘
(
£lf
.
bËV›w
)

149 
def
 
	$Ú_Ãw_¿nge
(
£lf
):

150 
£lf
.
	`ü—‹_ba£_lše
(0, s–f.
_ºg_max
+200)

151 
ºg_™em
 = 
make
.
	`¿nge
(
£lf
.
_ºg_mš
, s–f.
_ºg_max
)

152 
£lf
.
¶Ù
.
	`add_™em
(
ºg_™em
)

153 #£lf.
	`ü—‹_¿nge
(
£lf
.
_ºg_mš
, s–f.
_ºg_max
)

154 #sÿÀğ
	`Ba£SÿnDef
(
£lf
.
_ºg_mš
,£lf.
_ºg_max
,0,10)

155 #£lf.
	`add_’”gy
(
sÿn
)

156 
£lf
.
	`upd©e_curve
()

158 
def
 
	$Ú_¡¬t_chªged
(
£lf
):

159 
edt
 = 
£lf
.
	`£nd”
()

160 
£lf
.
_ºg_mš
, 
ok
 = 
edt
.
	`‹xt
().
	`toFlßt
()

161 
´št
 '¡¬ˆchªgedØ%àeV' % (
£lf
.
_ºg_mš
)

162 
£lf
.
	`modify_¿nge
(£lf.
_ºg_mš
, s–f.
_ºg_max
, 
dosigÇl
=
F®£
)

164 
def
 
	$Ú_¡İ_chªged
(
£lf
):

165 
edt
 = 
£lf
.
	`£nd”
()

166 
£lf
.
_ºg_max
, 
ok
 = 
edt
.
	`‹xt
().
	`toFlßt
()

167 
´št
 '¡İ chªgedØ%àeV ' % (
£lf
.
_ºg_max
)

168 
£lf
.
	`modify_¿nge
(£lf.
_ºg_mš
, s–f.
_ºg_max
, 
dosigÇl
=
F®£
)

170 
def
 
	$Ú_¡•s_chªged
(
£lf
):

171 
edt
 = 
£lf
.
	`£nd”
()

172 
v®
, 
ok
 = 
edt
.
	`‹xt
().
	`toIÁ
()

173 
´št
 '¡• chªgedØ%d ' % (
v®
)

176 
def
 
	$£t_»giÚ_Çme
(
£lf
, 
»giÚ_Çme
):

177 
£lf
.
»giÚ_Çme
 =„egion_name

179 
def
 
	$£t_cur_sÿn_id
(
£lf
, 
sÿn_id
):

180 
£lf
.
cur_sÿn_id
 = 
sÿn_id


183 
def
 
	$Ú_mod–_chªged
(
£lf
, 
row
, 
sÿn
):

184 
ev_sÿndef
 = 
sÿn
.
	`g‘_ev_»giÚs
()[
row
]

185 #£lf.
_ºg_mš
 = 
ev_sÿndef
.
	`g‘_¡¬t
()

186 #£lf.
_ºg_max
 = 
ev_sÿndef
.
	`g‘_¡İ
()

187 ##
mofify
 
the
 
visu®
 
of
h
¿nge
 th
Ãw
 
v®ues


188 #£lf.
	`adju¡_¿nge
(
£lf
.
_ºg_mš
, s–f.
_ºg_max
)

189 
£lf
.
	`upd©e_¶Ù
(
ev_sÿndef
)

191 
def
 
	$modify_¿nge
(
£lf
, 
sÿn_id
, 
sÿn
, 
dosigÇl
=
F®£
):

192 #´šˆ'modify_¿nge(%.2f, %.2f)' % (
_mš
, 
_max
)

193 
£lf
.
	`upd©e_¶Ù
(
sÿn
)

194 #£lf.
_ºg_mš
 = 
sÿn
.
	`g‘_¡¬t
()

195 #£lf.
_ºg_max
 = 
sÿn
.
	`g‘_¡İ
()

196 ##
mofify
 
the
 
visu®
 
of
h
¿nge
 th
Ãw
 
v®ues


197 #£lf.
	`adju¡_¿nge
(
£lf
.
_ºg_mš
, s–f.
_ºg_max
, 
dosigÇl
)

198 #chªg
the
 
mod–


199 
£lf
.
sÿnEvTabË
.
	`modify_d©a
(
sÿn
.
sÿn_id
, scan)

202 
def
 
	$zoom_to_¿nge
(
£lf
):

203 
x
 = 
Å
.
	`lš¥aû
(
£lf
.
_ºg_mš
-20, s–f.
_ºg_max
+20)

204 
y
 = 
Å
.
	`z”os
(
	`Ën
(
x
))

205 
£lf
.
	`£tXYD©a
('bckgºd', 
x
, 
y
, 
upd©e
=
F®£
)

206 
£lf
.
	`£t_autosÿË
()

208 
def
 
	$¿nge_chªged
(
£lf
, 
ºg
, 
_mš
, 
_max
):

209 
´št
 '¿ngchªged: %s: %f, %f' % (
£lf
.
»giÚ_Çme
, 
_mš
, 
_max
)

210 
£lf
.
_ºg_mš
 = 
_mš


211 
£lf
.
_ºg_max
 = 
_max


212 
£lf
.
¡¬tEd™
.
	`£tText
('%.2f' % s–f.
_ºg_mš
)

213 
£lf
.
¡İEd™
.
	`£tText
('%.2f' % s–f.
_ºg_max
)

214 #£lf.
m­³r
.
	`subm™
()

215 
£lf
.
Ãw_¿nge
.
	`em™
(£lf.
»giÚ_Çme
, s–f.
_ºg_mš
, s–f.
_ºg_max
)

220 
def
 
	$ü—‹_‹¡_¶Ù
(
£lf
, 
¡¬t
, 
¡İ
):

221 
x
 = 
Å
.
	`lš¥aû
(
¡¬t
, 
¡İ
)

222 
y
 = 
Å
.
	`sš
Òp.sšÒp.sš(
x
)))

223 
£lf
.
	`ü—‹_curve
('bckgºd',
x
, 
y
)

225 
def
 
	$ü—‹_ba£_lše
(
£lf
, 
¡¬t
, 
¡İ
):

226 
x
 = 
Å
.
	`lš¥aû
(
¡¬t
, 
¡İ
)

227 
y
 = 
Å
.
	`z”os
(
	`Ën
(
x
))

228 
£lf
.
	`ü—‹_curve
('bckgºd',
x
, 
y
)

230 #deà
	`Ú_¡İ_ed™ed
(
£lf
, 
q¡r
):

231 #v®¡¸ğ
	`¡r
(
q¡r
)

232 #ed™ = 
£lf
.
	`£nd”
()

233 #´šˆ'[%s]ƒd™ed = %s' % (
ed™
.
	`toŞT
(), 
v®¡r
)

234 #´šˆ'cu¼’ˆrow iÀmod– i %d' % 
£lf
.
m­³r
.
	`cu¼’tIndex
()

236 
def
 
	$Ú_¡İ_ed™šgFšished
(
£lf
):

237 
ed™
 = 
£lf
.
	`£nd”
()

238 #£lf.
mod–
.

240 
def
 
	$add_’”gy
(
£lf
, 
sÿn
):

241 
£lf
.
£t_»giÚ_Çme
 = 'EV%d' % s–f.
cur_’”gy_id


242 
sÿn
.
	`£t_sÿn_Çme
(
£lf
.
£t_»giÚ_Çme
)

243 
£lf
.
sÿnEvTabË
.
	`add_sÿn
(£lf.
cur_’”gy_id
, 
sÿn
)

244 
£lf
.
	`upd©e_¶Ù
(
sÿn
)

245 
£lf
.
cur_’”gy_id
 += 1

247 
def
 
	$upd©e_¶Ù
(
£lf
, 
sÿn
):

248 
£lf
.
_ºg_mš
 = 
sÿn
.
	`g‘_¡¬t
()

249 
£lf
.
_ºg_max
 = 
sÿn
.
	`g‘_¡İ
()

250 #mofify 
the
 
visu®
 
of
h
¿nge
 th
Ãw
 
v®ues


251 
£lf
.
	`adju¡_¿nge
(£lf.
_ºg_mš
, s–f.
_ºg_max
)

254 
def
 
	$£tupMod–
(
£lf
):

255 
£lf
.
mod–
 = 
QtWidg‘s
.
	`QSnd¬dI‹mMod–
(1, 
	`Ën
(£lf.
hdrLi¡
), self)

256 
row
 = 0

257 
sÿn¡¬t
 = ("15.53")

258 
sÿn¡İ
 = ("45.53")

259 
sÿn¡•
 = ("10")

261 
™em
 = 
QtWidg‘s
.
	`QSnd¬dI‹m
(
sÿn¡¬t
)

262 
£lf
.
mod–
.
	`£tI‹m
(
row
, 0, 
™em
)

263 
™em
 = 
QtWidg‘s
.
	`QSnd¬dI‹m
(
sÿn¡İ
)

264 
£lf
.
mod–
.
	`£tI‹m
(
row
, 1, 
™em
)

265 
™em
 = 
QtWidg‘s
.
	`QSnd¬dI‹m
(
sÿn¡•
)

266 
£lf
.
mod–
.
	`£tI‹m
(
row
, 2, 
™em
)

268 #w™houˆ
this
 
the
 
m­pšg
 
dÛ¢
't work

269 
£lf
.
m­³r
.
	`toFœ¡
()

272 
__Çme__
 == "__main__":

274 
impÜt
 
sys


276 
def
 
	$Ú_Ãw_¿nge
(
ºg
, 
mš
, 
max
):

277 #´šˆ'¿ngğ%.2f,%.2f' % (
mš
,
max
)

278 
·ss


280 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

282 
wš
 = 
	`EÃrgyS–eùÜ
(
show_bË
=
True
)

284 
wš
.
Ãw_¿nge
.
	`cÚÃù
(
Ú_Ãw_¿nge
)

286 
wš
.
	`show
()

288 
sys
.
	`ex™
(
­p
.
	`exec_
())

	@widgets/energy_selection_v1.py

2 
C»©ed
 
	gÚ
 2013-05-29

4 @
	gauthÜ
: 
b”gr


6 
impÜt
 
numpy
 
as
 
Å


8 
äom
 
PyQt5
 
impÜt
 
QtGui
, 
	gQtCÜe


9 
äom
 
PyQt5
 
impÜt
 
	guic


10 
impÜt
 
	gPyQt4
.
Qwt5
 
as
 
	gQwt


12 
äom
 
	gguiqwt
.
bud”
 
impÜt
 
	gmake


14 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


15 
äom
 
	gşs
.
	guts
.
feUts
 
impÜt
 
	glßdD©ToXY
, 
	glßdD©ToA¼ay
, 
	glßdD©To2DA¼ay
, 
	g»adCŞumnSŒs


16 
äom
 
	gbcm
.
	guts
.
cfg·r£r
 
impÜt
 
	gCÚfigCÏss


18 
äom
 
	gguiqwt
.
sigÇls
 
impÜt
 (
SIG_MARKER_CHANGED
, 
SIG_PLOT_LABELS_CHANGED
,

19 
SIG_ANNOTATION_CHANGED
, 
SIG_AXIS_DIRECTION_CHANGED
,

20 
SIG_ITEMS_CHANGED
, 
SIG_ACTIVE_ITEM_CHANGED
, 
SIG_ITEM_MOVED
,

21 
SIG_LUT_CHANGED
, 
SIG_ITEM_SELECTION_CHANGED
, 
SIG_STOP_MOVING
,

22 
SIG_RANGE_CHANGED
)

24 
äom
 
	gşs
.
	gsÿÂšg
.
SÿnDef
 
impÜt
 
	gBa£SÿnDef


25 
äom
 
	gşs
.
	gsÿÂšg
.
SÿnTabËV›w
 
impÜt
 
	gEÃrgySÿnTabËV›w


26 
äom
 
	gsm
.
	g¡xm_cÚŒŞ
.
	g¶Ù‹rs
.
curveWidg‘
 
impÜt
 
	gCurveV›w”Widg‘


28 
impÜt
 
	gsm
.
	g¡xm_cÚŒŞ
.
	g¡xm_maš_qrc


31 #_äomUtf8 = 
QtCÜe
.
QSŒšg
.
äomUtf8


32 #exû± 
A‰ribu‹E¼Ü
:

33 
	g_äomUtf8
 = 
Ïmbda
 
s
: s

35 #£tu°
moduË
 
logg”
 
w™h
 
a
  do-
nÙhšg
 
hªdËr


36 
_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

38 
şass
 
	$EÃrgyS–eùÜ
(
CurveV›w”Widg‘
):

39 
Ãw_¿nge
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
, , )

41 
def
 
	`__š™__
(
£lf
,
wšT™ËSŒ
 = "EÃrgy S–eùÜ", 
toŞb¬
 = 
F®£
, 
show_bË
=F®£, 
İtiÚs
 = {
	}
}):

42 
su³r
(
EÃrgyS–eùÜ
, 
£lf
).
__š™__
(
wšT™ËSŒ
 = wšT™ËSŒ, 
toŞb¬
 =oŞb¬, 
İtiÚs
 = {})

43 #£lf.
ui
 = 
uic
.
lßdUi
(
widg‘sDœ
 + 
SLASH
 + 'energySelect.ui')

44 
£lf
.
£tMšimumSize
(1300,1000)

46 #£lf.
£tPlÙAxisSŒs
(
t™Ë
=
NÚe
, 
x¡r
="eV", 
y¡r
=None)

48 #£lf.
»gToŞs
()

49 
	g£lf
.
addToŞ
('HRangeTool')

50 
	g£lf
.
	gmod–
 = 
NÚe


51 #£lf.
ü—‹_‹¡_¶Ù
(200, 2000)

52 
	g£lf
.
	g_ºg_mš
 = 200

53 
£lf
.
_ºg_max
 = 2000

55 #£lf.
ü—‹_ba£_lše
(0, 
£lf
.
_ºg_max
+200)

56 #£lf.
ü—‹_¿nge
(
£lf
.
_ºg_mš
, s–f.
_ºg_max
)

57 #£lf.
ü—‹_‹¡_¶Ù
()

58 #£lf.
£t_axis_fÚt_size
('left', 1)

59 #£lf.
£t_axis_fÚt_size
('top', 4)

61 
	g£lf
.
	g»giÚ_Çme
 = 'None'

62 
£lf
.
sÿn_id
 = 0

64 
£lf
.
addRngBŠ
 = 
QtWidg‘s
.
QToŞBu‰Ú
()

65 
£lf
.
addRngBŠ
.
£tText
(
_äomUtf8
(""))

66 
icÚ4
 = 
QtWidg‘s
.
QIcÚ
()

68 
icÚ4
.
addPixm­
(
QtGui
.
QPixm­
(
_äomUtf8
(":/guiqwt/icÚs/images/x¿nge.²g")), 
QtWidg‘s
.
QIcÚ
.
NÜm®
, QtWidg‘s.QIcÚ.
Off
)

69 
	gicÚ4
.
addPixm­
(
QtGui
.
QPixm­
(
_äomUtf8
(":/guiqwt/icÚs/images/x¿nge.²g")), 
QtWidg‘s
.
QIcÚ
.
NÜm®
, QtWidg‘s.QIcÚ.
On
)

70 
	g£lf
.
	gaddRngBŠ
.
£tIcÚ
(
icÚ4
)

71 
	g£lf
.
	gaddRngBŠ
.
£tIcÚSize
(
QtCÜe
.
QSize
(16, 16))

72 
	g£lf
.
	gaddRngBŠ
.
£tAutoRai£
(
True
)

73 
	g£lf
.
	gaddRngBŠ
.
£tObjeùName
(
_äomUtf8
("forwardButton"))

74 
	g£lf
.
	gaddRngBŠ
.
	gşicked
.
cÚÃù
(
£lf
.
Ú_Ãw_¿nge
)

78 #£lEnLbÈğ
QtWidg‘s
.
QLab–
('Selecting Energy for: ')

79 #£lf.
curRegiÚLbl
 = 
QtWidg‘s
.
QLab–
('None')

80 
	g£lf
.
	gsÿnEvTabË
 = 
EÃrgySÿnTabËV›w
()

81 
£lf
.
sÿnEvTabË
.
¿nge_chªged
.
cÚÃù
(£lf.
Ú_mod–_chªged
)

82 
£lf
.
¡¬tEd™
 = 
QtWidg‘s
.
QLšeEd™
()

83 
£lf
.
¡İEd™
 = 
QtWidg‘s
.
QLšeEd™
()

84 
£lf
.
¡•sEd™
 = 
QtWidg‘s
.
QLšeEd™
()

85 #¡İEd™.
‹xtEd™ed
.
cÚÃù
(
£lf
.
Ú_¡İ_ed™ed
)

86 
£lf
.
¡¬tEd™
.
»tuºP»s£d
.
cÚÃù
(£lf.
Ú_¡¬t_chªged
)

87 
£lf
.
¡İEd™
.
»tuºP»s£d
.
cÚÃù
(£lf.
Ú_¡İ_chªged
)

88 
£lf
.
¡•sEd™
.
»tuºP»s£d
.
cÚÃù
(£lf.
Ú_¡•s_chªged
)

90 
£lf
.
cur_’”gy_id
 = 0

91 
£lf
.
cur_sÿn_id
 = 0

94 #S‘ 
up
 
the
 
m­³r
.

95 #£lf.
£tupMod–
()

96 #£lf.
hdrLi¡
 = ['Name','Start', 'Stop', 'Step', 'Points', 'Dwell', 'Pol1', 'Pol2', 'Off1', 'Off2', 'XMCD']

97 #£lf.
m­³r
 = 
QtWidg‘s
.
QD©aWidg‘M­³r
(
£lf
)

98 #£lf.
m­³r
.
£tMod–
(
£lf
.
mod–
)

99 #£lf.
m­³r
.
addM­pšg
(
£lf
.
¡¬tEd™
, 0)

100 #£lf.
m­³r
.
addM­pšg
(
£lf
.
¡İEd™
, 1)

101 #£lf.
m­³r
.
addM­pšg
(
£lf
.
¡•sEd™
, 2)

103 
	g£lf
.
	gbËV›w
 = 
QtWidg‘s
.
QTabËV›w
()

104 
£lf
.
bËV›w
.
£tMod–
(£lf.
mod–
)

105 
£lf
.
bËV›w
.
£tCŞumnWidth
(0,100)

106 
	g£lf
.
	gbËV›w
.
£tCŞumnWidth
(1,100)

107 
	g£lf
.
	gbËV›w
.
£tCŞumnWidth
(2,100)

108 #£lf.
bËV›w
.
»sizeCŞumnsToCÚ‹Ás
()

109 
	g£lf
.
	gbËV›w
.
£tWšdowT™Ë
("my view")

112 
	g¥aûr
 = 
QtWidg‘s
.
QS·ûrI‹m
(5000,100,QtWidg‘s.
QSizePŞicy
.
Maximum
, QtWidg‘s.QSizePŞicy.
Ex·ndšg
)

113 
	g£lf
.
	g£lP”iodicTabËBŠ
 = 
QtWidg‘s
.
QToŞBu‰Ú
()

115 
£lf
.
¡¬tLbl
 = 
QtWidg‘s
.
QLab–
('Start:')

116 
£lf
.
¡İLbl
 = 
QtWidg‘s
.
QLab–
('Stop:')

117 
£lf
.
¡•sLbl
 = 
QtWidg‘s
.
QLab–
('Steps:')

119 
£lf
.
¡¬tLbl
.
£tBuddy
(£lf.
¡¬tEd™
)

120 
£lf
.
¡İLbl
.
£tBuddy
(£lf.
¡İEd™
)

121 
£lf
.
¡•sLbl
.
£tBuddy
(£lf.
¡•sEd™
)

123 
vÏyout
 = 
£lf
.
Ïyout
()

124 #vÏyout.
£tCÚ‹ÁsM¬gšs
(
QtCÜe
.
QM¬gšs
(2,2,2,2))

125 
	gvÏyout
.
addWidg‘
(
£lf
.
addRngBŠ
)

126 if(
	gshow_bË
):

127 
vÏyout
.
addWidg‘
(
£lf
.
sÿnEvTabË
)

128 
£lf
.
£tMšimumSize
(100,200)

129 
	g£lf
.
£tMšimumHeight
(200)

130 
	g£lf
.
£tMaximumHeight
(400)

131 
	g£lf
.
	gsÿnEvTabË
.
£tMšimumHeight
(400)

133 
£lf
.
£tMšimumSize
(100,150)

134 
	g£lf
.
£tMšimumHeight
(150)

135 
	g£lf
.
£tMaximumHeight
(150)

136 
	ghÏyout2
 = 
QtWidg‘s
.
QHBoxLayout
()

137 
hÏyout2
.
addWidg‘
(
£lf
.
¡¬tLbl
)

138 
hÏyout2
.
addWidg‘
(
£lf
.
¡¬tEd™
)

140 
hÏyout2
.
addWidg‘
(
£lf
.
¡İLbl
)

141 
hÏyout2
.
addWidg‘
(
£lf
.
¡İEd™
)

142 
hÏyout2
.
addI‹m
(
¥aûr
)

143 
hÏyout2
.
addWidg‘
(
£lf
.
¡•sLbl
)

144 
hÏyout2
.
addWidg‘
(
£lf
.
¡•sEd™
)

145 #vÏyout.
addLayout
(
hÏyout1
)

146 
vÏyout
.
addLayout
(
hÏyout2
)

147 #vÏyout.
addWidg‘
(
£lf
.
bËV›w
)

149 
def
 
	$Ú_Ãw_¿nge
(
£lf
):

150 
£lf
.
	`ü—‹_ba£_lše
(0, s–f.
_ºg_max
+200)

151 
ºg_™em
 = 
make
.
	`¿nge
(
£lf
.
_ºg_mš
, s–f.
_ºg_max
)

152 
£lf
.
¶Ù
.
	`add_™em
(
ºg_™em
)

153 #£lf.
	`ü—‹_¿nge
(
£lf
.
_ºg_mš
, s–f.
_ºg_max
)

154 #sÿÀğ
	`Ba£SÿnDef
(
£lf
.
_ºg_mš
,£lf.
_ºg_max
,0,10)

155 #£lf.
	`add_’”gy
(
sÿn
)

156 
£lf
.
	`upd©e_curve
()

158 
def
 
	$Ú_¡¬t_chªged
(
£lf
):

159 
edt
 = 
£lf
.
	`£nd”
()

160 
£lf
.
_ºg_mš
, 
ok
 = 
edt
.
	`‹xt
().
	`toFlßt
()

161 
´št
 '¡¬ˆchªgedØ%àeV' % (
£lf
.
_ºg_mš
)

162 
£lf
.
	`modify_¿nge
(£lf.
_ºg_mš
, s–f.
_ºg_max
, 
dosigÇl
=
F®£
)

164 
def
 
	$Ú_¡İ_chªged
(
£lf
):

165 
edt
 = 
£lf
.
	`£nd”
()

166 
£lf
.
_ºg_max
, 
ok
 = 
edt
.
	`‹xt
().
	`toFlßt
()

167 
´št
 '¡İ chªgedØ%àeV ' % (
£lf
.
_ºg_max
)

168 
£lf
.
	`modify_¿nge
(£lf.
_ºg_mš
, s–f.
_ºg_max
, 
dosigÇl
=
F®£
)

170 
def
 
	$Ú_¡•s_chªged
(
£lf
):

171 
edt
 = 
£lf
.
	`£nd”
()

172 
v®
, 
ok
 = 
edt
.
	`‹xt
().
	`toIÁ
()

173 
´št
 '¡• chªgedØ%d ' % (
v®
)

176 
def
 
	$£t_»giÚ_Çme
(
£lf
, 
»giÚ_Çme
):

177 
£lf
.
»giÚ_Çme
 =„egion_name

179 
def
 
	$£t_cur_sÿn_id
(
£lf
, 
sÿn_id
):

180 
£lf
.
cur_sÿn_id
 = 
sÿn_id


183 
def
 
	$Ú_mod–_chªged
(
£lf
, 
row
, 
sÿn
):

184 
ev_sÿndef
 = 
sÿn
.
	`g‘_ev_»giÚs
()[
row
]

185 #£lf.
_ºg_mš
 = 
ev_sÿndef
.
	`g‘_¡¬t
()

186 #£lf.
_ºg_max
 = 
ev_sÿndef
.
	`g‘_¡İ
()

187 ##
mofify
 
the
 
visu®
 
of
h
¿nge
 th
Ãw
 
v®ues


188 #£lf.
	`adju¡_¿nge
(
£lf
.
_ºg_mš
, s–f.
_ºg_max
)

189 
£lf
.
	`upd©e_¶Ù
(
ev_sÿndef
)

191 
def
 
	$modify_¿nge
(
£lf
, 
sÿn_id
, 
sÿn
, 
dosigÇl
=
F®£
):

192 #´šˆ'modify_¿nge(%.2f, %.2f)' % (
_mš
, 
_max
)

193 
£lf
.
	`upd©e_¶Ù
(
sÿn
)

194 #£lf.
_ºg_mš
 = 
sÿn
.
	`g‘_¡¬t
()

195 #£lf.
_ºg_max
 = 
sÿn
.
	`g‘_¡İ
()

196 ##
mofify
 
the
 
visu®
 
of
h
¿nge
 th
Ãw
 
v®ues


197 #£lf.
	`adju¡_¿nge
(
£lf
.
_ºg_mš
, s–f.
_ºg_max
, 
dosigÇl
)

198 #chªg
the
 
mod–


199 
£lf
.
sÿnEvTabË
.
	`modify_d©a
(
sÿn
.
sÿn_id
, scan)

202 
def
 
	$zoom_to_¿nge
(
£lf
):

203 
x
 = 
Å
.
	`lš¥aû
(
£lf
.
_ºg_mš
-20, s–f.
_ºg_max
+20)

204 
y
 = 
Å
.
	`z”os
(
	`Ën
(
x
))

205 
£lf
.
	`£tXYD©a
('bckgºd', 
x
, 
y
, 
upd©e
=
F®£
)

206 
£lf
.
	`£t_autosÿË
()

208 
def
 
	$¿nge_chªged
(
£lf
, 
ºg
, 
_mš
, 
_max
):

209 
´št
 '¿ngchªged: %s: %f, %f' % (
£lf
.
»giÚ_Çme
, 
_mš
, 
_max
)

210 
£lf
.
_ºg_mš
 = 
_mš


211 
£lf
.
_ºg_max
 = 
_max


212 
£lf
.
¡¬tEd™
.
	`£tText
('%.2f' % s–f.
_ºg_mš
)

213 
£lf
.
¡İEd™
.
	`£tText
('%.2f' % s–f.
_ºg_max
)

214 #£lf.
m­³r
.
	`subm™
()

215 
£lf
.
Ãw_¿nge
.
	`em™
(£lf.
»giÚ_Çme
, s–f.
_ºg_mš
, s–f.
_ºg_max
)

220 
def
 
	$ü—‹_‹¡_¶Ù
(
£lf
, 
¡¬t
, 
¡İ
):

221 
x
 = 
Å
.
	`lš¥aû
(
¡¬t
, 
¡İ
)

222 
y
 = 
Å
.
	`sš
Òp.sšÒp.sš(
x
)))

223 
£lf
.
	`ü—‹_curve
('bckgºd',
x
, 
y
)

225 
def
 
	$ü—‹_ba£_lše
(
£lf
, 
¡¬t
, 
¡İ
):

226 
x
 = 
Å
.
	`lš¥aû
(
¡¬t
, 
¡İ
)

227 
y
 = 
Å
.
	`z”os
(
	`Ën
(
x
))

228 
£lf
.
	`ü—‹_curve
('bckgºd',
x
, 
y
)

230 #deà
	`Ú_¡İ_ed™ed
(
£lf
, 
q¡r
):

231 #v®¡¸ğ
	`¡r
(
q¡r
)

232 #ed™ = 
£lf
.
	`£nd”
()

233 #´šˆ'[%s]ƒd™ed = %s' % (
ed™
.
	`toŞT
(), 
v®¡r
)

234 #´šˆ'cu¼’ˆrow iÀmod– i %d' % 
£lf
.
m­³r
.
	`cu¼’tIndex
()

236 
def
 
	$Ú_¡İ_ed™šgFšished
(
£lf
):

237 
ed™
 = 
£lf
.
	`£nd”
()

238 #£lf.
mod–
.

240 
def
 
	$add_’”gy
(
£lf
, 
sÿn
):

241 
£lf
.
£t_»giÚ_Çme
 = 'EV%d' % s–f.
cur_’”gy_id


242 
sÿn
.
	`£t_sÿn_Çme
(
£lf
.
£t_»giÚ_Çme
)

243 
£lf
.
sÿnEvTabË
.
	`add_sÿn
(£lf.
cur_’”gy_id
, 
sÿn
)

244 
£lf
.
	`upd©e_¶Ù
(
sÿn
)

245 
£lf
.
cur_’”gy_id
 += 1

247 
def
 
	$upd©e_¶Ù
(
£lf
, 
sÿn
):

248 
£lf
.
_ºg_mš
 = 
sÿn
.
	`g‘_¡¬t
()

249 
£lf
.
_ºg_max
 = 
sÿn
.
	`g‘_¡İ
()

250 #mofify 
the
 
visu®
 
of
h
¿nge
 th
Ãw
 
v®ues


251 
£lf
.
	`adju¡_¿nge
(£lf.
_ºg_mš
, s–f.
_ºg_max
)

254 
def
 
	$£tupMod–
(
£lf
):

255 
£lf
.
mod–
 = 
QtWidg‘s
.
	`QSnd¬dI‹mMod–
(1, 
	`Ën
(£lf.
hdrLi¡
), self)

256 
row
 = 0

257 
sÿn¡¬t
 = ("15.53")

258 
sÿn¡İ
 = ("45.53")

259 
sÿn¡•
 = ("10")

261 
™em
 = 
QtWidg‘s
.
	`QSnd¬dI‹m
(
sÿn¡¬t
)

262 
£lf
.
mod–
.
	`£tI‹m
(
row
, 0, 
™em
)

263 
™em
 = 
QtWidg‘s
.
	`QSnd¬dI‹m
(
sÿn¡İ
)

264 
£lf
.
mod–
.
	`£tI‹m
(
row
, 1, 
™em
)

265 
™em
 = 
QtWidg‘s
.
	`QSnd¬dI‹m
(
sÿn¡•
)

266 
£lf
.
mod–
.
	`£tI‹m
(
row
, 2, 
™em
)

268 #w™houˆ
this
 
the
 
m­pšg
 
dÛ¢
't work

269 
£lf
.
m­³r
.
	`toFœ¡
()

272 
__Çme__
 == "__main__":

274 
impÜt
 
sys


276 
def
 
	$Ú_Ãw_¿nge
(
ºg
, 
mš
, 
max
):

277 #´šˆ'¿ngğ%.2f,%.2f' % (
mš
,
max
)

278 
·ss


280 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

282 
wš
 = 
	`EÃrgyS–eùÜ
(
show_bË
=
True
)

284 
wš
.
Ãw_¿nge
.
	`cÚÃù
(
Ú_Ãw_¿nge
)

286 
wš
.
	`show
()

288 
sys
.
	`ex™
(
­p
.
	`exec_
())

	@widgets/fbk.py

2 
C»©ed
 
Ú
 
	gMay
 9, 2012

4 @
	gauthÜ
: 
b”gr


6 
impÜt
 
os


7 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
QtWidg‘s


8 
äom
 
PyQt5
 
impÜt
 
uic


10 
	guiDœ
 = 
os
.
·th
.
dœÇme
(
__fe__
) + '/ui/'

12 
şass
 
	$fbkCÏss
(
QtWidg‘s
.
QWidg‘
):

13 
chªged
 = 
QtCÜe
.
	$pyqtSigÇl
()

15 
def
 
	$__š™__
(
£lf
, 
pv
, 
lblText
, 
fbk_v®
=
NÚe
, 
·»Á
=NÚe, 
’gš“ršg_nÙ©iÚ
=
F®£
):

16 
QtWidg‘s
.
QWidg‘
.
	$__š™__
(
£lf
,
·»Á
)

17 
uic
.
	`lßdUi
(
uiDœ
 + 'fbk.ui', 
£lf
)

18 
£lf
.
pv
 =…v

19 
£lf
.
Çme
 = 
pv
.
	$g‘_Çme
()

20 
£lf
.
pvNameFld
.
	$£tText
(
lblText
)

21 
pv
.
	`add_ÿÎback
('VAL', 
£lf
.
_Ú_Ãw_pv_d©a
)

22 
£lf
.
pvd‘a
 = 
NÚe


23 
£lf
.
chªged
.
	$cÚÃù
(
£lf
.
Ú_chªge
)

24 
£lf
.
posFbkLbl
.
	$£tToŞT
(
£lf
.
Çme
)

25 
£lf
.
u£_’g_ämt
 = 
’gš“ršg_nÙ©iÚ


26 if(
fbk_v®
 
is
 
nÙ
 
NÚe
):

27 
£lf
.
	$Ú_chªge
(
fbk_v®
)

29 #deà
	`check_ÿlibd
(
£lf
, 
ÿl
):

30 #if(
ÿl
):

31 #ş¸ğ
QtGui
.
	`QCŞÜ
(0,255,0è#(
r
,
g
,
b
)

33 #ş¸ğ
QtGui
.
	`QCŞÜ
(255,0,0è#(
r
,
g
,
b
)

34 #£lf.
ÿlibdWgt
.
	`£tStyËSh“t
("QWidg‘ { background-cŞÜ: % }" % 
şr
.
	`Çme
())

35 #
#deà
	`Ú_movšg
(
£lf
, 
is_movšg
):

36 #if(
is_movšg
):

37 #ş¸ğ
QtGui
.
	`QCŞÜ
(255,0,0è#(
r
,
g
,
b
)

39 #ş¸ğ
QtGui
.
	`QCŞÜ
(240,240,240è#(
r
,
g
,
b
)

40 #
#£lf.
movšgWgt
.
	`£tStyËSh“t
("QWidg‘ { background-cŞÜ: % }" % 
şr
.
	`Çme
())

42 
def
 
	$Ú_chªge
(
£lf
, 
v®
):

43 if(
£lf
.
u£_’g_ämt
):

44 
£lf
.
posFbkLbl
.
	`£tText
("%.3e" % 
v®
 )

46 
£lf
.
posFbkLbl
.
	`£tText
('%.3f' % 
v®
)

49 
def
 
	$_Ú_Ãw_pv_d©a
(
£lf
, **
kw¬gs
):

50 #´šˆ'Ú_Ãw_d©¨\n',
¬r


51 
v®
 = 
kw¬gs
['value']

52 
£lf
.
chªged
.
	`em™
(
v®
)

	@widgets/fbk.py

2 
C»©ed
 
Ú
 
	gMay
 9, 2012

4 @
	gauthÜ
: 
b”gr


6 
impÜt
 
os


7 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
QtWidg‘s


8 
äom
 
PyQt5
 
impÜt
 
uic


10 
	guiDœ
 = 
os
.
·th
.
dœÇme
(
__fe__
) + '/ui/'

12 
şass
 
	$fbkCÏss
(
QtWidg‘s
.
QWidg‘
):

13 
chªged
 = 
QtCÜe
.
	$pyqtSigÇl
()

15 
def
 
	$__š™__
(
£lf
, 
pv
, 
lblText
, 
fbk_v®
=
NÚe
, 
·»Á
=NÚe, 
’gš“ršg_nÙ©iÚ
=
F®£
):

16 
QtWidg‘s
.
QWidg‘
.
	$__š™__
(
£lf
,
·»Á
)

17 
uic
.
	`lßdUi
(
uiDœ
 + 'fbk.ui', 
£lf
)

18 
£lf
.
pv
 =…v

19 
£lf
.
Çme
 = 
pv
.
	$g‘_Çme
()

20 
£lf
.
pvNameFld
.
	$£tText
(
lblText
)

21 
pv
.
	`add_ÿÎback
('VAL', 
£lf
.
_Ú_Ãw_pv_d©a
)

22 
£lf
.
pvd‘a
 = 
NÚe


23 
£lf
.
chªged
.
	$cÚÃù
(
£lf
.
Ú_chªge
)

24 
£lf
.
posFbkLbl
.
	$£tToŞT
(
£lf
.
Çme
)

25 
£lf
.
u£_’g_ämt
 = 
’gš“ršg_nÙ©iÚ


26 if(
fbk_v®
 
is
 
nÙ
 
NÚe
):

27 
£lf
.
	$Ú_chªge
(
fbk_v®
)

29 #deà
	`check_ÿlibd
(
£lf
, 
ÿl
):

30 #if(
ÿl
):

31 #ş¸ğ
QtGui
.
	`QCŞÜ
(0,255,0è#(
r
,
g
,
b
)

33 #ş¸ğ
QtGui
.
	`QCŞÜ
(255,0,0è#(
r
,
g
,
b
)

34 #£lf.
ÿlibdWgt
.
	`£tStyËSh“t
("QWidg‘ { background-cŞÜ: % }" % 
şr
.
	`Çme
())

35 #
#deà
	`Ú_movšg
(
£lf
, 
is_movšg
):

36 #if(
is_movšg
):

37 #ş¸ğ
QtGui
.
	`QCŞÜ
(255,0,0è#(
r
,
g
,
b
)

39 #ş¸ğ
QtGui
.
	`QCŞÜ
(240,240,240è#(
r
,
g
,
b
)

40 #
#£lf.
movšgWgt
.
	`£tStyËSh“t
("QWidg‘ { background-cŞÜ: % }" % 
şr
.
	`Çme
())

42 
def
 
	$Ú_chªge
(
£lf
, 
v®
):

43 if(
£lf
.
u£_’g_ämt
):

44 
£lf
.
posFbkLbl
.
	`£tText
("%.3e" % 
v®
 )

46 
£lf
.
posFbkLbl
.
	`£tText
('%.3f' % 
v®
)

49 
def
 
	$_Ú_Ãw_pv_d©a
(
£lf
, **
kw¬gs
):

50 #´šˆ'Ú_Ãw_d©¨\n',
¬r


51 
v®
 = 
kw¬gs
['value']

52 
£lf
.
chªged
.
	`em™
(
v®
)

	@widgets/focusAndZoneplateParms.py

2 
C»©ed
 
Ú
 
	gDec
 4, 2014

4 @
	gauthÜ
: 
b”gr


6 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
	gQtWidg‘s


7 
äom
 
PyQt5
 
impÜt
 
	guic


9 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
bl10ID01
 
impÜt
 
	gMAIN_OBJ
, 
	gDEFAULTS


11 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
pyStxm
 
impÜt
 
	gabs_·th_to_ši_fe


13 
äom
 
	gşs
.
	gsÿÂšg
.
¡xmTy³s
 
impÜt
 
	gsÿn_ty³s
, 
	g’d¡©iÚ_id_ty³s


15 
äom
 
	gşs
.
	gÿWidg‘s
.
ÿLab–Widg‘
 
impÜt
 
	gassign_aiLab–Widg‘


16 
äom
 
	gşs
.
	guts
.
cfg·r£r
 
impÜt
 
	gCÚfigCÏss


17 
äom
 
	gbcm
.
	g•ics_deviûs
.
ŒªsfÜm
 
impÜt
 
	gT¿nsfÜm


18 #»ad 
the
 
ši
 
fe
 
ªd
 
lßd
h 
dœeùÜ›s


19 
	g­pCÚfig
 = 
CÚfigCÏss
(
abs_·th_to_ši_fe
)

20 
widg‘sUiDœ
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'widgetsUiDir')

22 
def
 
	$ªg¡rom_to_Çnom‘”
(
ªg
):

23 
ªg_to_nm
 = 0.1

24 (
ªg
 * 
ªg_to_nm
)

26 
def
 
	$Çnom‘”_to_ªg¡rom
(
nm
):

27 
nm_to_ªg
 = 10

28 (
nm
 * 
nm_to_ªg
)

31 
def
 
	$A0Max
(
zpD
, 
f
, 
o§D
):

33 
AoMax
 = (
Do
 * 
f
)/
D


34 
wh”e
:

35 
Do
 
is
 
OSA
 
dŸm‘”


36 
D
 
is
 
ZP
 
DŸm‹r


37 
f
 
is
 
foÿl
 
Ëngth


39 
todo
:

42 
Do
 = 
o§D


43 
D
 = 
zpD


44 
aomax
 = (
Do
 * (-1.0 *
f
))/
D


45 
Cz
 = 
aomax
 - 15 #id—Îy 
£t
 Cz 
to
 
about
 15u
m
 
Ëss
 
thª
 
A0
 
max


46 ((
aomax
, 
Cz
))

49 
def
 
	$waveL’gth
(
’”gy
):

51  
the
 
wav–’gth
 
as
 
a
 
funùiÚ
 
of
 
’”gy
, 
»tuºed
 
š
 
Çnom‘”s


52 
	`E
(
eV
èğ12398.52/
Ïmbda


53 
Ïmbda
 = 12398.52/
	`E
(
eV
)

55 
wvL’
 = (12398.52/
’”gy
)

56 (
wvL’
)

60 
def
 
	$foÿl_Ëngth
(
’”gy
, 
a1
):

62 
f
 = 
A1
 * 
E


64 
f
 = 
a1
 * 
’”gy


66 (
f
)

69 
def
 
	$g‘_zp_dù
():

71 
zp1
 = {'a1':-4.840,'D':100.0, 'CsD':45.0, 'OZÚe': 60.0
	}
}

72 
zp2
 = {'a1':-6.792,'D':240.0, 'CsD':90.0, 'OZone': 35.0}

73 
zp3
 = {'a1':-7.767,'D':240.0, 'CsD':90.0, 'OZone': 40.0}

74 
zp4
 = {'a1':-4.524,'D':140.0, 'CsD':60.0, 'OZone': 40.0}

75 
zp5
 = {'a1':-4.859,'D':240.0, 'CsD':95.0, 'OZone': 25.0}

76 
zps
 = [
zp1
, 
zp2
, 
zp3
, 
zp4
, 
zp5
]

77 (
	gzps
)

79 
def
 
	$g‘_amb_o§_dù
():

80 
o§1
 = {'D':30.0
	}
}

81 
o§2
 = {'D':50.0}

82 
o§3
 = {'D':40.0}

83 
o§s
 = [
o§1
, 
o§2
, 
o§3
]

84 (
	go§s
)

86 
def
 
	$g‘_uhv_o§_dù
():

87 
o§1
 = {'D':40.0
	}
}

88 
o§2
 = {'D':50.0}

89 
o§3
 = {'D':60.0}

90 
o§4
 = {'D':70.0}

91 
o§s
 = [
o§1
, 
o§2
, 
o§3
, 
o§4
]

92 (
	go§s
)

94 
def
 
	$g‘_o§_dù
():

95 
deviûs
 = 
MAIN_OBJ
.
	`g‘_deviû_obj
()

96 if(
deviûs
.
es_id
 =ğ
’d¡©iÚ_id_ty³s
.
UHV
):

97 
o§s
 = 
	`g‘_uhv_o§_dù
()

99 
o§s
 = 
	`g‘_amb_o§_dù
()

100 (
o§s
)

103 
def
 
	$ÿlc_zpz
(
f
, 
A0
):

104 
zpz
 = 
f
 + 
A0


105 (
zpz
)

108 
def
 
	$focus_to_cursÜ_£t_Cz
(
f
, 
A0
, 
Cz
, 
Ãw_zpz
):

109 
ÿlcd_zpz
 = 
	`ÿlc_zpz
(
f
, 
A0
)

110 
d–_zpz
 = 
ÿlcd_zpz
 - 
Ãw_zpz


111 
Ãw_Cz
 = 
Cz
 + 
d–_zpz


113 #´šˆ'Ãw focu found‡ˆZpz=%.2fum, d–ToFocus=%.2à' % (
Ãw_zpz
, 
d–_zpz
)

114 #´šˆ'movZpzØ%.2f, movCz from %.2àtØ%.2f' % (
ÿlcd_zpz
, 
Cz
, 
Ãw_Cz
)

115 ((
ÿlcd_zpz
, 
Ãw_Cz
))

118 
def
 
	$focus_to_cursÜ_£t_A0
(
f
, 
A0
, 
Cz
, 
Ãw_zpz
):

119 
ÿlcd_zpz
 = 
	`ÿlc_zpz
(
f
, 
A0
)

120 
d–_zpz
 = 
ÿlcd_zpz
 - 
Ãw_zpz


121 
X
 = 
Ãw_zpz
 - 
ÿlcd_zpz


122 
A0upd©ed
 = 
X
 + 
A0


124 #´šˆ'Ãw focu found‡ˆZpz=%.2fum, d–ToFocus=%.2à' % (
Ãw_zpz
, 
d–_zpz
)

125 #´šˆ'chªgA0 from %.2àtØ%.2f' % (
A0
, 
A0upd©ed
)

126 ((
ÿlcd_zpz
, 
A0upd©ed
))

129 
def
 
	`š™_zp_def_ŒªsfÜm_»c
(
zp_def
, 
blEÃrgy
='BL1610-I10:ENERGY',
¡xm
='amb'):

130 #cu¼’y 
the£
 
¬e
 
defšed
 
h”e
 
but
he£ 
Ãed
 
to
 
ev’uÎy
 
be
 
wr™‹n
Ø
disk
 
ªd
 
lßded


131 
def_idx
 = 
zp_def
['zp_id']

132 
Œec
 = 
	`T¿nsfÜm
('%s:%s:zp%d:def' % (
blEÃrgy
, 
¡xm
, 
def_idx
))

133 
Œec
.
	`put
('DESC', 
¡xm
 + ' zp%d def' % 
def_idx
)

134 
Œec
.
	`put
('CMTA', 'zp%d A1' % 
def_idx
)

135 
Œec
.
	`put
('A', 
zp_def
['a1'])

136 
Œec
.
	`put
('OUTA', '%s:%s:zp:def.CLCA PP' % (
blEÃrgy
, 
¡xm
))

138 
Œec
.
	`put
('CMTB', 'zp%d DŸm‘”' % 
def_idx
)

139 
Œec
.
	`put
('B', 
zp_def
['D'])

140 
Œec
.
	`put
('OUTB', '%s:%s:zp:def.CLCB PP' % (
blEÃrgy
, 
¡xm
))

142 
Œec
.
	`put
('CMTC', 'zp%d C’Œ® stİ' % 
def_idx
)

143 
Œec
.
	`put
('C', 
zp_def
['CsD'])

144 
Œec
.
	`put
('OUTC', '%s:%s:zp:def.CLCC PP' % (
blEÃrgy
, 
¡xm
))

146 
Œec
.
	`put
('CMTD', 'zp%d ResŞutiÚ' % 
def_idx
)

147 
Œec
.
	`put
('D', 
zp_def
['OZone'])

148 
Œec
.
	`put
('OUTD', '%s:%s:zp:def.CLCD PP' % (
blEÃrgy
, 
¡xm
))

150 
def
 
	`š™_o§_def_ŒªsfÜm_»c
(
o§_def
, 
blEÃrgy
='BL1610-I10:ENERGY',
¡xm
='amb'):

151 #cu¼’y 
the£
 
¬e
 
defšed
 
h”e
 
but
he£ 
Ãed
 
to
 
ev’uÎy
 
be
 
wr™‹n
Ø
disk
 
ªd
 
lßded


152 
def_idx
 = 
o§_def
['osa_id']

153 
Œec
 = 
	`T¿nsfÜm
('%s:%s:zp%d:def' % (
blEÃrgy
, 
¡xm
, 
def_idx
))

154 
Œec
.
	`put
('DESC', 
¡xm
 + ' o§%d def' % 
def_idx
)

155 
Œec
.
	`put
('CMTA', 'o§%d A1' % 
def_idx
)

156 
Œec
.
	`put
('A', 
o§_def
['D'])

160 
şass
 
	$FocusP¬ams
(
QtWidg‘s
.
QDŸlog
):

161 
Çme
 = "Point scan…arams"

163 
d©a
 = {
	}
}

164 
£ùiÚ_id
 = 'POINT'

165 
axis_¡ršgs
 = ['counts', 'eV', '', '']

167 
def
 
	$__š™__
(
£lf
, 
·»Á
=
NÚe
):

168 
QtWidg‘s
.
QDŸlog
.
	`__š™__
(
£lf
)

169 
£lf
.
_·»Á
 = 
·»Á


170 
uic
.
	`lßdUi
Ğ
widg‘sUiDœ
 + '\\focusAndZÚ•Ï‹P¬ms.ui', 
£lf
)

171 
£lf
.
	`£tMod®
(
True
)

173 #fÜû  
mode
 
to
 
be
 1 (
adju¡
 
A0
 
v®ue
 
nÙ
 
Cz


174 #MAIN_OBJ.
	`deviû
('Zpz_sÿnModeFÏg').
	`put
(0)

175 #MAIN_OBJ.
	`deviû
('Zpz_sÿnModeFÏg').
	`put
(1)

176 #£lf.
evFbkLbl
 = 
	`assign_aiLab–Widg‘
(
£lf
.evFbkLbl, 'MONO1610-I10-01:’”gy:fbk', 
hdrText
='EÃrgy', 
egu
='eV', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='blue')

177 #£lf.
evFbkLbl
 = 
	`assign_aiLab–Widg‘
(
£lf
.evFbkLbl, 'BL1610-I10:ENERGY.RBV', 
hdrText
='EÃrgy', 
egu
='eV', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='white')

179 #£lf.
evFbkLbl
 = 
	`assign_aiLab–Widg‘
(
£lf
.evFbkLbl, 
MAIN_OBJ
.
	`deviû
('ENERGY').
	`g‘_Çme
(è+ '.RBV', 
hdrText
='EÃrgy', 
egu
='eV', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='white')

180 #£lf.
a1FbkLbl
 = 
	`assign_aiLab–Widg‘
(
£lf
.a1FbkLbl, 
MAIN_OBJ
.
	`deviû
('Zp_def').
	`g‘_Çme
(è+ '.A', 
hdrText
='A1', 
egu
='', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='wh™e',
fÜm©
='%5.4f')

181 #£lf.
a0MaxFbkLbl
 = 
	`assign_aiLab–Widg‘
(
£lf
.a0MaxFbkLbl, 
MAIN_OBJ
.
	`deviû
('A0Max').
	`g‘_Çme
(), 
hdrText
='A0Max', 
egu
='um', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='wh™e',
fÜm©
='%5.2f')

182 #£lf.
æFbkLbl
 = 
	`assign_aiLab–Widg‘
(
£lf
.æFbkLbl, 
MAIN_OBJ
.
	`deviû
('Foÿl_L’gth').
	`g‘_Çme
(), 
hdrText
='Fl', 
egu
='um', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='wh™e',
fÜm©
='%5.2f')

183 #£lf.
§m¶eZFbkLbl
 = 
	`assign_aiLab–Widg‘
(
£lf
.§m¶eZFbkLbl, 
MAIN_OBJ
.
	`deviû
('Id—l_A0').
	`g‘_Çme
(), 
hdrText
='Cz', 
egu
='um', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='wh™e',
fÜm©
='%5.2f')

184 #£lf.
zpzFbkLbl
 = 
	`assign_aiLab–Widg‘
(
£lf
.zpzFbkLbl, 
MAIN_OBJ
.
	`deviû
('Zpz_pos').
	`g‘_Çme
(), 
hdrText
='Zpz', 
egu
='um', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='wh™e',
fÜm©
='%5.2f')

186 
£lf
.
evFbkLbl
 = 
	`assign_aiLab–Widg‘
(£lf.evFbkLbl, 
MAIN_OBJ
.
	`deviû
('ENERGY_RBV'), 
hdrText
='EÃrgy', 
egu
='eV', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='white')

187 
£lf
.
a1FbkLbl
 = 
	`assign_aiLab–Widg‘
(£lf.a1FbkLbl, 
MAIN_OBJ
.
	`deviû
('Zp_def.A'), 
hdrText
='A1', 
egu
='', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='wh™e',
fÜm©
='%5.4f')

188 
£lf
.
a0MaxFbkLbl
 = 
	`assign_aiLab–Widg‘
(£lf.a0MaxFbkLbl, 
MAIN_OBJ
.
	`deviû
('A0Max'), 
hdrText
='A0Max', 
egu
='um', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='wh™e',
fÜm©
='%5.2f')

189 
£lf
.
æFbkLbl
 = 
	`assign_aiLab–Widg‘
(£lf.æFbkLbl, 
MAIN_OBJ
.
	`deviû
('Foÿl_L’gth'), 
hdrText
='Fl', 
egu
='um', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='wh™e',
fÜm©
='%5.2f')

190 
£lf
.
§m¶eZFbkLbl
 = 
	`assign_aiLab–Widg‘
(£lf.§m¶eZFbkLbl, 
MAIN_OBJ
.
	`deviû
('Id—l_A0'), 
hdrText
='Cz', 
egu
='um', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='wh™e',
fÜm©
='%5.2f')

191 
£lf
.
zpzFbkLbl
 = 
	`assign_aiLab–Widg‘
(£lf.zpzFbkLbl, 
MAIN_OBJ
.
	`deviû
('Zpz_pos'), 
hdrText
='Zpz', 
egu
='um', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='wh™e',
fÜm©
='%5.2f')

193 
£lf
.
a0Fld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_a0_chªged
)

195 #£lf.
o§P¬ms_ui
 = 
uic
.
	`lßdUi
Ğ
widg‘sUiDœ
 + '\\osaFlds.ui')

196 
£lf
.
zpToŞBox
 = 
QtWidg‘s
.
	`QToŞBox
()

197 
£lf
.
o§ToŞBox
 = 
QtWidg‘s
.
	`QToŞBox
()

199 
£lf
.
zp_tbox_widg‘s
 = []

200 
£lf
.
o§_tbox_widg‘s
 = []

204 
zp_dù
 = 
DEFAULTS
.
	`g‘
('PRESETS.ZP_PARAMS')

205 
o§_dù
 = 
DEFAULTS
.
	`g‘
('PRESETS.OSA_PARAMS')

206 #£lf.
zpToŞBox
.
	`£tCu¼’tIndex
(1)

207 #£lf.
o§ToŞBox
.
	`£tCu¼’tIndex
(0)

209 #£lf.
cur_zp
 = 
£lf
.
zpToŞBox
.
	`cu¼’tIndex
()

210 #£lf.
cur_o§
 = 
£lf
.
o§ToŞBox
.
	`cu¼’tIndex
()

211 
£lf
.
zp_·Ãls
 = []

212 
·ges
 = 0

213 
zp_def
 
š
 
zp_dù
:

214 
zpP¬ms_ui
 = 
uic
.
	`lßdUi
Ğ
widg‘sUiDœ
 + '\\zpFlds.ui')

216 
	`š™_zp_def_ŒªsfÜm_»c
(
zp_def
)

218 #pİuÏ‹ 
f›lds


219 
zpP¬ms_ui
.
zpDFld
.
	`£tText
('%.2f' % 
zp_def
['D'])

220 
zpP¬ms_ui
.
zpCStİFld
.
	`£tText
('%.2f' % 
zp_def
['CsD'])

221 
zpP¬ms_ui
.
zpOZÚeFld
.
	`£tText
('%.2f' % 
zp_def
['OZone'])

222 
zpP¬ms_ui
.
zpA1Fld
.
	`£tText
('%.3f' % 
zp_def
['a1'])

224 
zpP¬ms_ui
.
zpDFld
.
»tuºP»s£d
.
	`cÚÃù
(
£lf
.
upd©e_zp_d©a
)

225 
zpP¬ms_ui
.
zpCStİFld
.
»tuºP»s£d
.
	`cÚÃù
(
£lf
.
upd©e_zp_d©a
)

226 
zpP¬ms_ui
.
zpOZÚeFld
.
»tuºP»s£d
.
	`cÚÃù
(
£lf
.
upd©e_zp_d©a
)

227 
zpP¬ms_ui
.
zpA1Fld
.
»tuºP»s£d
.
	`cÚÃù
(
£lf
.
upd©e_zp_d©a
)

229 
£lf
.
zpToŞBox
.
	`š£¹I‹m
(
·ges
, 
zpP¬ms_ui
, 'ZP %d'%(pages+1))

230 
£lf
.
zp_tbox_widg‘s
.
	`­³nd
(
zpP¬ms_ui
)

231 
·ges
 += 1

233 
£lf
.
zp_·Ãls
.
	`­³nd
(
zpP¬ms_ui
)

235 
£lf
.
zpGroupBox
.
	`Ïyout
().
	`addWidg‘
(£lf.
zpToŞBox
)

236 
£lf
.
zpToŞBox
.
	`£tCu¼’tIndex
(1)

239 
·ges
 = 0

240 
o§_def
 
š
 
o§_dù
:

241 
o§P¬ms_ui
 = 
uic
.
	`lßdUi
(
widg‘sUiDœ
 + '\\osaFlds.ui')

243 
	`š™_o§_def_ŒªsfÜm_»c
(
o§_def
)

245 #pİuÏ‹ 
f›lds


246 
o§P¬ms_ui
.
o§DFld
.
	`£tText
('%.2f' % 
o§_def
['D'])

247 
£lf
.
o§ToŞBox
.
	`š£¹I‹m
(
·ges
, 
o§P¬ms_ui
, 'OSA %d'%(pages+1))

249 
o§P¬ms_ui
.
o§DFld
.
»tuºP»s£d
.
	`cÚÃù
(
£lf
.
upd©e_o§_d©a
)

250 
£lf
.
o§_tbox_widg‘s
.
	`­³nd
(
o§P¬ms_ui
)

251 
·ges
 += 1

253 
£lf
.
o§GroupBox
.
	`Ïyout
().
	`addWidg‘
(£lf.
o§ToŞBox
)

254 
£lf
.
o§ToŞBox
.
	`£tCu¼’tIndex
(1)

256 
£lf
.
	`lßd_deçuÉs
()

258 #£lf.
	`upd©e_zp_d©a
()

260 
£lf
.
zpToŞBox
.
cu¼’tChªged
.
	`cÚÃù
(£lf.
upd©e_zp_£ËùiÚ
)

261 
£lf
.
o§ToŞBox
.
cu¼’tChªged
.
	`cÚÃù
(£lf.
upd©e_o§_£ËùiÚ
)

263 
MAIN_OBJ
.
	`deviû
('Zpz_sÿnModeFÏg').
	`put
('VAL', 1)

266 
def
 
	$Ú_’”gy_fbk_chªged
(
£lf
, 
v®
):

267 
£lf
.
	`upd©e_zp_d©a
(
upd©e_deçuÉs
=
F®£
)

269 
def
 
	$lßd_deçuÉs
(
£lf
):

270 
zp_idx
 = 
DEFAULTS
.
	`g‘
('PRESETS.ZP_FOCUS_PARAMS.ZP_IDX')

271 
zpA1
 = 
DEFAULTS
.
	`g‘
('PRESETS.ZP_FOCUS_PARAMS.ZP_A1')

272 #zpD = 
DEFAULTS
.
	`g‘
('PRESETS.ZP_FOCUS_PARAMS.ZP_D')

273 
o§_idx
 = 
DEFAULTS
.
	`g‘
('PRESETS.ZP_FOCUS_PARAMS.OSA_IDX')

274 #o§D = 
DEFAULTS
.
	`g‘
('PRESETS.ZP_FOCUS_PARAMS.OSA_D')

275 
A0
 = 
DEFAULTS
.
	`g‘
('PRESETS.ZP_FOCUS_PARAMS.OSA_A0')

276 #aomax = 
DEFAULTS
.
	`g‘
('PRESETS.ZP_FOCUS_PARAMS.OSA_A0MAX')

278 
£lf
.
zpToŞBox
.
	`£tCu¼’tIndex
(
zp_idx
)

279 
£lf
.
o§ToŞBox
.
	`£tCu¼’tIndex
(
o§_idx
)

281 
MAIN_OBJ
.
	`deviû
('A0').
	`put
(
A0
)

282 #fÜû 
•ics
 
to
 
upd©e
 
the
 
»cÜd
 
def
 
äÜ
 
ZP
's

283 
MAIN_OBJ
.
	`deviû
('Zp_£Ëù').
	`put
('VAL', 
zp_idx
)

285 #zp_deàğ
MAIN_OBJ
.
	`deviû
('Zp_def')

286 #a1 = 
zp_def
.
	`g‘
('A')

287 #d = 
zp_def
.
	`g‘
('B')

288 #c ğ
zp_def
.
	`g‘
('C')

289 #» ğ
zp_def
.
	`g‘
('D')

290 
£lf
.
a0Fld
.
	`£tText
Ğ'%.3f' % 
A0
)

291 
zp_²l
 = 
£lf
.
zp_·Ãls
[
zp_idx
]

292 
zp_²l
.
zpA1Fld
.
	`£tText
Ğ'%.3f' % 
zpA1
)

295 
def
 
	$Ú_a0_chªged
(
£lf
):

296 
A0
 = (
	`¡r
(
£lf
.
a0Fld
.
	`‹xt
()))

297 
MAIN_OBJ
.
	`deviû
('A0').
	`put
(
A0
)

298 
£lf
.
	`upd©e_zp_d©a
()

301 
def
 
	$upd©e_zp_£ËùiÚ
(
£lf
):

302 
zp_idx
 = 
£lf
.
zpToŞBox
.
	`cu¼’tIndex
()

303 
MAIN_OBJ
.
	`deviû
('Zp_£Ëù').
	`put
('VAL', 
zp_idx
)

304 
£lf
.
	`upd©e_zp_d©a
()

306 
def
 
	$upd©e_o§_£ËùiÚ
(
£lf
):

307 
o§_idx
 = 
£lf
.
o§ToŞBox
.
	`cu¼’tIndex
()

308 
MAIN_OBJ
.
	`deviû
('OSA_£Ëù').
	`put
('VAL', 
o§_idx
)

309 
£lf
.
	`upd©e_zp_d©a
()

311 
def
 
	$upd©e_o§_d©a
(
£lf
):

312 
o§£l_pv
 = 
MAIN_OBJ
.
	`deviû
('OSA_select')

313 
o§def_pv
 = 
MAIN_OBJ
.
	`deviû
('OSA_def')

316 
idx
 = 
£lf
.
o§ToŞBox
.
	`cu¼’tIndex
()

320 
_ui
 = 
£lf
.
o§_tbox_widg‘s
[
idx
]

321 
o§D
 = (
	`¡r
(
_ui
.
o§DFld
.
	`‹xt
()))

323 #o§£l_pv.
	`put
(
o§£l_pv
.
¡r_æds
[
idx
], 'o§%d %d' % (idx+1,
o§D
))

324 #o§£l_pv.
	`put
(
o§£l_pv
.
v®_æds
[
idx
], 
o§D
)

326 #o§£l_pv.
	`put
('CMT' + 
o§_id¡rs
[
idx
], 'o§%d %d' % (idx+1,
o§D
))

327 #o§def_pv.
	`put
(
o§_id¡rs
[
idx
], 
o§D
)

329 #g‘ 
li¡
 
of
 
zp
 
defs


331 
o§s
 = 
DEFAULTS
.
	`g‘
('PRESETS.OSA_PARAMS')

332 #{'o§_id': 1, 'D':30.0
	}
}

333 
	go§s
[
idx
]['D'] = 
o§D


334 
DEFAULTS
.
£t
('PRESETS.OSA_PARAMS', 
o§s
)

336 
	g£lf
.
upd©e_zp_d©a
()

339 
def
 
	$upd©e_zp_d©a
(
£lf
, 
upd©e_deçuÉs
=
True
):

341 
Wr™e
 
ZP
 
£Ëù


342 
Wr™e
 
OSA
 
S–eù


343 
Wr™e
 
A0


344 
Wr™e


345 
Mode
 
£Ëù


346 
StÜe
 
´e£ts


349 
zp_id¡rs
 = ['A','B','C','D','E','F','G','H','I','J']

350 
’”gy
 = (
	`¡r
(
£lf
.
evFbkLbl
.
	`g‘_‹xt
()))

351 
aomax
 = (
	`¡r
(
£lf
.
a0MaxFbkLbl
.
	`g‘_‹xt
()))

352 
zp_idx
 = 
£lf
.
zpToŞBox
.
	`cu¼’tIndex
()

354 
zpP¬ms_ui
 = 
£lf
.
zp_tbox_widg‘s
[
zp_idx
]

356 
o§_idx
 = 
£lf
.
o§ToŞBox
.
	`cu¼’tIndex
()

357 
o§_ui
 = 
£lf
.
o§_tbox_widg‘s
[
o§_idx
]

358 
o§D
 = (
	`¡r
(
o§_ui
.
o§DFld
.
	`‹xt
()))

359 
A0
 = (
	`¡r
(
£lf
.
a0Fld
.
	`‹xt
()))

361 
æ
 = (
	`¡r
(
£lf
.
æFbkLbl
.
	`g‘_‹xt
()))

362 #æ = 
MAIN_OBJ
.
	`deviû
('Foÿl_L’gth').
	`g‘
()

363 #Zpz_po ğ
MAIN_OBJ
.
	`deviû
('Zpz_pos').
	`g‘
()

364 
Zpz_pos
 = (
	`¡r
(
£lf
.
zpzFbkLbl
.
	`g‘_‹xt
()))

365 #Cz_po ğ
MAIN_OBJ
.
	`deviû
('Cz_pos').
	`g‘
()

366 
Cz_pos
 = (
	`¡r
(
£lf
.
§m¶eZFbkLbl
.
	`g‘_‹xt
()))

367 #'
Zpz_sÿnFÏg
'

368 #'
D–_Zpz
'

370 
zpD
 = (
	`¡r
(
zpP¬ms_ui
.
zpDFld
.
	`‹xt
()))

371 
zpCStİ
 = (
	`¡r
(
zpP¬ms_ui
.
zpCStİFld
.
	`‹xt
()))

372 
zpOZÚe
 = (
	`¡r
(
zpP¬ms_ui
.
zpOZÚeFld
.
	`‹xt
()))

373 
zpA1
 = (
	`¡r
(
zpP¬ms_ui
.
zpA1Fld
.
	`‹xt
()))

375 
deviûs
 = 
MAIN_OBJ
.
	`g‘_deviûs
()

376 
deviûs
['PVS']['Zp_def%d_A' % 
zp_idx
].
	`put
(
zpA1
)

377 #
##
æ
 = 
	`foÿl_Ëngth
(
’”gy
, 
zpA1
)

378 #(
aomax
, 
id—lA0
èğ
	`A0Max
(
zpD
, 
æ
, 
o§D
)

379 ##
´št
 'ThfoÿÈËngth fÜƒÃrgy %.3àeV‡nd zÚ¶©[%d] i %.3àmiüÚs' % (
’”gy
, 
zp_idx
, 
æ
)

380 ##
´št
 'A0 should b< %.2àum sØ£‰šg CzØ%.2f' % (
aomax
, 
id—lA0
)

381 #
##
£lf
.
a0Fld
.
	`£tText
('%.3f' % 
A0
)

382 #
#Zpz_po ğ
MAIN_OBJ
.
	`deviû
('Zpz_pos').
	`g‘
()

383 #Cz_po ğ
MAIN_OBJ
.
	`deviû
('Cz_pos').
	`g‘
()

384 #
#
#£lf.
a0MaxFbkLbl
.
	`£tText
('%.3f' % 
aomax
)

385 #£lf.
æFbkLbl
.
	`£tText
('%.3f' % 
æ
)

386 #£lf.
§m¶eZFbkLbl
.
	`£tText
('%.3f' % 
id—lA0
)

387 #
#zpz = 
	`ÿlc_zpz
(
æ
, 
A0
)

388 #£lf.
zpzFbkLbl
.
	`£tText
('%.3f' % 
Zpz_pos
)

389 #
#£lf.
§m¶eZFbkLbl
.
	`£tText
('%.3f' % 
Cz_pos
)

390 #
##
mŒcz
 = 
MAIN_OBJ
.
	`deviû
('CoarseZ.Z')

391 ##
mŒcz
.
	`move
(
A0
)

392 #
#if(
upd©e_deçuÉs
):

393 
DEFAULTS
.
	`£t
('PRESETS.ZP_FOCUS_PARAMS.ZP_IDX', 
zp_idx
)

394 
DEFAULTS
.
	`£t
('PRESETS.ZP_FOCUS_PARAMS.ZP_A1', 
zpA1
)

395 
DEFAULTS
.
	`£t
('PRESETS.ZP_FOCUS_PARAMS.ZP_D', 
zpD
)

396 
DEFAULTS
.
	`£t
('PRESETS.ZP_FOCUS_PARAMS.OSA_IDX', 
o§_idx
)

397 
DEFAULTS
.
	`£t
('PRESETS.ZP_FOCUS_PARAMS.OSA_D', 
o§D
)

398 
DEFAULTS
.
	`£t
('PRESETS.ZP_FOCUS_PARAMS.OSA_A0', 
A0
)

399 
DEFAULTS
.
	`£t
('PRESETS.ZP_FOCUS_PARAMS.OSA_A0MAX', 
aomax
)

401 
zps
 = 
DEFAULTS
.
	`g‘
('PRESETS.ZP_PARAMS')

402 #{'o§_id': 1, 'D':30.0
	}
}

403 
	gzps
[
zp_idx
]['a1'] = 
zpA1


404 
DEFAULTS
.
£t
('PRESETS.ZP_PARAMS', 
zps
)

406 #DEFAULTS.
£t
('PRESETS.ZP_FOCUS_PARAMS.OSA_IDEAL_A0', 
id—lA0
)

407 
	gDEFAULTS
.
upd©e
()

412 
def
 
	$g‘_loÿl_·¿ms
(
£lf
):

413 
’”gy
 = (
	`¡r
(
£lf
.
evFbkLbl
.
	`g‘_‹xt
()))

414 
Ãw_zpz
ğ(
	`¡r
(
£lf
.
ûÁ”ZPFld
.
	`‹xt
()))

416 
zp_idx
 = 
£lf
.
zpToŞBox
.
	`cu¼’tIndex
()

417 
zpP¬ms_ui
 = 
£lf
.
zp_tbox_widg‘s
[
zp_idx
]

419 
o§_idx
 = 
£lf
.
o§ToŞBox
.
	`cu¼’tIndex
()

420 
o§_ui
 = 
£lf
.
o§_tbox_widg‘s
[
o§_idx
]

422 
o§D
 = (
	`¡r
(
o§_ui
.
o§DFld
.
	`‹xt
()))

423 
A0
 = (
	`¡r
(
£lf
.
a0Fld
.
	`‹xt
()))

424 
zpD
 = (
	`¡r
(
zpP¬ms_ui
.
zpDFld
.
	`‹xt
()))

425 
zpCStİ
 = (
	`¡r
(
zpP¬ms_ui
.
zpCStİFld
.
	`‹xt
()))

426 
zpOZÚe
 = (
	`¡r
(
zpP¬ms_ui
.
zpOZÚeFld
.
	`‹xt
()))

427 
zpA1
 = (
	`¡r
(
zpP¬ms_ui
.
zpA1Fld
.
	`‹xt
()))

429 
æ
 = 
	`foÿl_Ëngth
(
’”gy
, 
zpA1
)

430 (
aomax
, 
id—lA0
èğ
	`A0Max
(
zpD
, 
æ
, 
o§D
)

432 
d©
 = {
	}
}

433 
d©
['’”gy'] = 
’”gy


434 
d©
['o§D'] = 
o§D


435 
d©
['A0'] = 
A0


436 
d©
['zpD'] = 
zpD


437 
d©
['zpA1'] = 
zpA1


438 
d©
['æ'] = 
æ


439 
d©
['id—lA0'] = 
id—lA0


440 
d©
['Ãw_zpz'] = 
Ãw_zpz


442 (
d©
)

444 
__Çme__
 == "__main__":

445 
impÜt
 
sys


447 #zp ğ
g‘_zp_dù
()

448 #o§ ğ
g‘_o§_dù
()

450 #DEFAULTS.
add_£ùiÚ
('PRESETS.ZP_PARAMS', 
zps
)

451 #DEFAULTS.
add_£ùiÚ
('PRESETS.OSA_PARAMS',
o§s
)

452 #DEFAULTS.
add_£ùiÚ
('PRESETS.ZP_FOCUS_PARAMS',{})

453 #DEFAULTS.
add_£ùiÚ
('PRESETS.ZP_FOCUS_PARAMS.ZP_IDX', 0)

454 #DEFAULTS.
add_£ùiÚ
('PRESETS.ZP_FOCUS_PARAMS.ZP_A1', 0)

455 #DEFAULTS.
add_£ùiÚ
('PRESETS.ZP_FOCUS_PARAMS.ZP_D', 0)

456 #DEFAULTS.
add_£ùiÚ
('PRESETS.ZP_FOCUS_PARAMS.OSA_IDX', 0)

457 #DEFAULTS.
add_£ùiÚ
('PRESETS.ZP_FOCUS_PARAMS.OSA_D', 0)

458 #DEFAULTS.
add_£ùiÚ
('PRESETS.ZP_FOCUS_PARAMS.OSA_A0', 0)

459 #DEFAULTS.
add_£ùiÚ
('PRESETS.ZP_FOCUS_PARAMS.OSA_A0MAX', 0)

460 #DEFAULTS.
add_£ùiÚ
('PRESETS.ZP_FOCUS_PARAMS.OSA_IDEAL_A0', 0)

462 
	g­p
 = 
QtWidg‘s
.
QAµliÿtiÚ
(
sys
.
¬gv
)

463 
wšdow
 = 
FocusP¬ams
()

464 
wšdow
.
show
()

466 
­p
.
exec_
()

	@widgets/focusAndZoneplateParms.py

2 
C»©ed
 
Ú
 
	gDec
 4, 2014

4 @
	gauthÜ
: 
b”gr


6 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
	gQtWidg‘s


7 
äom
 
PyQt5
 
impÜt
 
	guic


9 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
bl10ID01
 
impÜt
 
	gMAIN_OBJ
, 
	gDEFAULTS


11 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
pyStxm
 
impÜt
 
	gabs_·th_to_ši_fe


13 
äom
 
	gşs
.
	gsÿÂšg
.
¡xmTy³s
 
impÜt
 
	gsÿn_ty³s
, 
	g’d¡©iÚ_id_ty³s


15 
äom
 
	gşs
.
	gÿWidg‘s
.
ÿLab–Widg‘
 
impÜt
 
	gassign_aiLab–Widg‘


16 
äom
 
	gşs
.
	guts
.
cfg·r£r
 
impÜt
 
	gCÚfigCÏss


17 
äom
 
	gbcm
.
	g•ics_deviûs
.
ŒªsfÜm
 
impÜt
 
	gT¿nsfÜm


18 #»ad 
the
 
ši
 
fe
 
ªd
 
lßd
h 
dœeùÜ›s


19 
	g­pCÚfig
 = 
CÚfigCÏss
(
abs_·th_to_ši_fe
)

20 
widg‘sUiDœ
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'widgetsUiDir')

22 
def
 
	$ªg¡rom_to_Çnom‘”
(
ªg
):

23 
ªg_to_nm
 = 0.1

24 (
ªg
 * 
ªg_to_nm
)

26 
def
 
	$Çnom‘”_to_ªg¡rom
(
nm
):

27 
nm_to_ªg
 = 10

28 (
nm
 * 
nm_to_ªg
)

31 
def
 
	$A0Max
(
zpD
, 
f
, 
o§D
):

33 
AoMax
 = (
Do
 * 
f
)/
D


34 
wh”e
:

35 
Do
 
is
 
OSA
 
dŸm‘”


36 
D
 
is
 
ZP
 
DŸm‹r


37 
f
 
is
 
foÿl
 
Ëngth


39 
todo
:

42 
Do
 = 
o§D


43 
D
 = 
zpD


44 
aomax
 = (
Do
 * (-1.0 *
f
))/
D


45 
Cz
 = 
aomax
 - 15 #id—Îy 
£t
 Cz 
to
 
about
 15u
m
 
Ëss
 
thª
 
A0
 
max


46 ((
aomax
, 
Cz
))

49 
def
 
	$waveL’gth
(
’”gy
):

51  
the
 
wav–’gth
 
as
 
a
 
funùiÚ
 
of
 
’”gy
, 
»tuºed
 
š
 
Çnom‘”s


52 
	`E
(
eV
èğ12398.52/
Ïmbda


53 
Ïmbda
 = 12398.52/
	`E
(
eV
)

55 
wvL’
 = (12398.52/
’”gy
)

56 (
wvL’
)

60 
def
 
	$foÿl_Ëngth
(
’”gy
, 
a1
):

62 
f
 = 
A1
 * 
E


64 
f
 = 
a1
 * 
’”gy


66 (
f
)

69 
def
 
	$g‘_zp_dù
():

71 
zp1
 = {'a1':-4.840,'D':100.0, 'CsD':45.0, 'OZÚe': 60.0
	}
}

72 
zp2
 = {'a1':-6.792,'D':240.0, 'CsD':90.0, 'OZone': 35.0}

73 
zp3
 = {'a1':-7.767,'D':240.0, 'CsD':90.0, 'OZone': 40.0}

74 
zp4
 = {'a1':-4.524,'D':140.0, 'CsD':60.0, 'OZone': 40.0}

75 
zp5
 = {'a1':-4.859,'D':240.0, 'CsD':95.0, 'OZone': 25.0}

76 
zps
 = [
zp1
, 
zp2
, 
zp3
, 
zp4
, 
zp5
]

77 (
	gzps
)

79 
def
 
	$g‘_amb_o§_dù
():

80 
o§1
 = {'D':30.0
	}
}

81 
o§2
 = {'D':50.0}

82 
o§3
 = {'D':40.0}

83 
o§s
 = [
o§1
, 
o§2
, 
o§3
]

84 (
	go§s
)

86 
def
 
	$g‘_uhv_o§_dù
():

87 
o§1
 = {'D':40.0
	}
}

88 
o§2
 = {'D':50.0}

89 
o§3
 = {'D':60.0}

90 
o§4
 = {'D':70.0}

91 
o§s
 = [
o§1
, 
o§2
, 
o§3
, 
o§4
]

92 (
	go§s
)

94 
def
 
	$g‘_o§_dù
():

95 
deviûs
 = 
MAIN_OBJ
.
	`g‘_deviû_obj
()

96 if(
deviûs
.
es_id
 =ğ
’d¡©iÚ_id_ty³s
.
UHV
):

97 
o§s
 = 
	`g‘_uhv_o§_dù
()

99 
o§s
 = 
	`g‘_amb_o§_dù
()

100 (
o§s
)

103 
def
 
	$ÿlc_zpz
(
f
, 
A0
):

104 
zpz
 = 
f
 + 
A0


105 (
zpz
)

108 
def
 
	$focus_to_cursÜ_£t_Cz
(
f
, 
A0
, 
Cz
, 
Ãw_zpz
):

109 
ÿlcd_zpz
 = 
	`ÿlc_zpz
(
f
, 
A0
)

110 
d–_zpz
 = 
ÿlcd_zpz
 - 
Ãw_zpz


111 
Ãw_Cz
 = 
Cz
 + 
d–_zpz


113 #´šˆ'Ãw focu found‡ˆZpz=%.2fum, d–ToFocus=%.2à' % (
Ãw_zpz
, 
d–_zpz
)

114 #´šˆ'movZpzØ%.2f, movCz from %.2àtØ%.2f' % (
ÿlcd_zpz
, 
Cz
, 
Ãw_Cz
)

115 ((
ÿlcd_zpz
, 
Ãw_Cz
))

118 
def
 
	$focus_to_cursÜ_£t_A0
(
f
, 
A0
, 
Cz
, 
Ãw_zpz
):

119 
ÿlcd_zpz
 = 
	`ÿlc_zpz
(
f
, 
A0
)

120 
d–_zpz
 = 
ÿlcd_zpz
 - 
Ãw_zpz


121 
X
 = 
Ãw_zpz
 - 
ÿlcd_zpz


122 
A0upd©ed
 = 
X
 + 
A0


124 #´šˆ'Ãw focu found‡ˆZpz=%.2fum, d–ToFocus=%.2à' % (
Ãw_zpz
, 
d–_zpz
)

125 #´šˆ'chªgA0 from %.2àtØ%.2f' % (
A0
, 
A0upd©ed
)

126 ((
ÿlcd_zpz
, 
A0upd©ed
))

129 
def
 
	`š™_zp_def_ŒªsfÜm_»c
(
zp_def
, 
blEÃrgy
='BL1610-I10:ENERGY',
¡xm
='amb'):

130 #cu¼’y 
the£
 
¬e
 
defšed
 
h”e
 
but
he£ 
Ãed
 
to
 
ev’uÎy
 
be
 
wr™‹n
Ø
disk
 
ªd
 
lßded


131 
def_idx
 = 
zp_def
['zp_id']

132 
Œec
 = 
	`T¿nsfÜm
('%s:%s:zp%d:def' % (
blEÃrgy
, 
¡xm
, 
def_idx
))

133 
Œec
.
	`put
('DESC', 
¡xm
 + ' zp%d def' % 
def_idx
)

134 
Œec
.
	`put
('CMTA', 'zp%d A1' % 
def_idx
)

135 
Œec
.
	`put
('A', 
zp_def
['a1'])

136 
Œec
.
	`put
('OUTA', '%s:%s:zp:def.CLCA PP' % (
blEÃrgy
, 
¡xm
))

138 
Œec
.
	`put
('CMTB', 'zp%d DŸm‘”' % 
def_idx
)

139 
Œec
.
	`put
('B', 
zp_def
['D'])

140 
Œec
.
	`put
('OUTB', '%s:%s:zp:def.CLCB PP' % (
blEÃrgy
, 
¡xm
))

142 
Œec
.
	`put
('CMTC', 'zp%d C’Œ® stİ' % 
def_idx
)

143 
Œec
.
	`put
('C', 
zp_def
['CsD'])

144 
Œec
.
	`put
('OUTC', '%s:%s:zp:def.CLCC PP' % (
blEÃrgy
, 
¡xm
))

146 
Œec
.
	`put
('CMTD', 'zp%d ResŞutiÚ' % 
def_idx
)

147 
Œec
.
	`put
('D', 
zp_def
['OZone'])

148 
Œec
.
	`put
('OUTD', '%s:%s:zp:def.CLCD PP' % (
blEÃrgy
, 
¡xm
))

150 
def
 
	`š™_o§_def_ŒªsfÜm_»c
(
o§_def
, 
blEÃrgy
='BL1610-I10:ENERGY',
¡xm
='amb'):

151 #cu¼’y 
the£
 
¬e
 
defšed
 
h”e
 
but
he£ 
Ãed
 
to
 
ev’uÎy
 
be
 
wr™‹n
Ø
disk
 
ªd
 
lßded


152 
def_idx
 = 
o§_def
['osa_id']

153 
Œec
 = 
	`T¿nsfÜm
('%s:%s:zp%d:def' % (
blEÃrgy
, 
¡xm
, 
def_idx
))

154 
Œec
.
	`put
('DESC', 
¡xm
 + ' o§%d def' % 
def_idx
)

155 
Œec
.
	`put
('CMTA', 'o§%d A1' % 
def_idx
)

156 
Œec
.
	`put
('A', 
o§_def
['D'])

160 
şass
 
	$FocusP¬ams
(
QtWidg‘s
.
QDŸlog
):

161 
Çme
 = "Point scan…arams"

163 
d©a
 = {
	}
}

164 
£ùiÚ_id
 = 'POINT'

165 
axis_¡ršgs
 = ['counts', 'eV', '', '']

167 
def
 
	$__š™__
(
£lf
, 
·»Á
=
NÚe
):

168 
QtWidg‘s
.
QDŸlog
.
	`__š™__
(
£lf
)

169 
£lf
.
_·»Á
 = 
·»Á


170 
uic
.
	`lßdUi
Ğ
widg‘sUiDœ
 + '\\focusAndZÚ•Ï‹P¬ms.ui', 
£lf
)

171 
£lf
.
	`£tMod®
(
True
)

173 #fÜû  
mode
 
to
 
be
 1 (
adju¡
 
A0
 
v®ue
 
nÙ
 
Cz


174 #MAIN_OBJ.
	`deviû
('Zpz_sÿnModeFÏg').
	`put
(0)

175 #MAIN_OBJ.
	`deviû
('Zpz_sÿnModeFÏg').
	`put
(1)

176 #£lf.
evFbkLbl
 = 
	`assign_aiLab–Widg‘
(
£lf
.evFbkLbl, 'MONO1610-I10-01:’”gy:fbk', 
hdrText
='EÃrgy', 
egu
='eV', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='blue')

177 #£lf.
evFbkLbl
 = 
	`assign_aiLab–Widg‘
(
£lf
.evFbkLbl, 'BL1610-I10:ENERGY.RBV', 
hdrText
='EÃrgy', 
egu
='eV', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='white')

179 #£lf.
evFbkLbl
 = 
	`assign_aiLab–Widg‘
(
£lf
.evFbkLbl, 
MAIN_OBJ
.
	`deviû
('ENERGY').
	`g‘_Çme
(è+ '.RBV', 
hdrText
='EÃrgy', 
egu
='eV', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='white')

180 #£lf.
a1FbkLbl
 = 
	`assign_aiLab–Widg‘
(
£lf
.a1FbkLbl, 
MAIN_OBJ
.
	`deviû
('Zp_def').
	`g‘_Çme
(è+ '.A', 
hdrText
='A1', 
egu
='', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='wh™e',
fÜm©
='%5.4f')

181 #£lf.
a0MaxFbkLbl
 = 
	`assign_aiLab–Widg‘
(
£lf
.a0MaxFbkLbl, 
MAIN_OBJ
.
	`deviû
('A0Max').
	`g‘_Çme
(), 
hdrText
='A0Max', 
egu
='um', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='wh™e',
fÜm©
='%5.2f')

182 #£lf.
æFbkLbl
 = 
	`assign_aiLab–Widg‘
(
£lf
.æFbkLbl, 
MAIN_OBJ
.
	`deviû
('Foÿl_L’gth').
	`g‘_Çme
(), 
hdrText
='Fl', 
egu
='um', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='wh™e',
fÜm©
='%5.2f')

183 #£lf.
§m¶eZFbkLbl
 = 
	`assign_aiLab–Widg‘
(
£lf
.§m¶eZFbkLbl, 
MAIN_OBJ
.
	`deviû
('Id—l_A0').
	`g‘_Çme
(), 
hdrText
='Cz', 
egu
='um', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='wh™e',
fÜm©
='%5.2f')

184 #£lf.
zpzFbkLbl
 = 
	`assign_aiLab–Widg‘
(
£lf
.zpzFbkLbl, 
MAIN_OBJ
.
	`deviû
('Zpz_pos').
	`g‘_Çme
(), 
hdrText
='Zpz', 
egu
='um', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='wh™e',
fÜm©
='%5.2f')

186 
£lf
.
evFbkLbl
 = 
	`assign_aiLab–Widg‘
(£lf.evFbkLbl, 
MAIN_OBJ
.
	`deviû
('ENERGY_RBV'), 
hdrText
='EÃrgy', 
egu
='eV', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='white')

187 
£lf
.
a1FbkLbl
 = 
	`assign_aiLab–Widg‘
(£lf.a1FbkLbl, 
MAIN_OBJ
.
	`deviû
('Zp_def.A'), 
hdrText
='A1', 
egu
='', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='wh™e',
fÜm©
='%5.4f')

188 
£lf
.
a0MaxFbkLbl
 = 
	`assign_aiLab–Widg‘
(£lf.a0MaxFbkLbl, 
MAIN_OBJ
.
	`deviû
('A0Max'), 
hdrText
='A0Max', 
egu
='um', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='wh™e',
fÜm©
='%5.2f')

189 
£lf
.
æFbkLbl
 = 
	`assign_aiLab–Widg‘
(£lf.æFbkLbl, 
MAIN_OBJ
.
	`deviû
('Foÿl_L’gth'), 
hdrText
='Fl', 
egu
='um', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='wh™e',
fÜm©
='%5.2f')

190 
£lf
.
§m¶eZFbkLbl
 = 
	`assign_aiLab–Widg‘
(£lf.§m¶eZFbkLbl, 
MAIN_OBJ
.
	`deviû
('Id—l_A0'), 
hdrText
='Cz', 
egu
='um', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='wh™e',
fÜm©
='%5.2f')

191 
£lf
.
zpzFbkLbl
 = 
	`assign_aiLab–Widg‘
(£lf.zpzFbkLbl, 
MAIN_OBJ
.
	`deviû
('Zpz_pos'), 
hdrText
='Zpz', 
egu
='um', 
t™Ë_cŞÜ
='wh™e', 
v¬_şr
='wh™e',
fÜm©
='%5.2f')

193 
£lf
.
a0Fld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_a0_chªged
)

195 #£lf.
o§P¬ms_ui
 = 
uic
.
	`lßdUi
Ğ
widg‘sUiDœ
 + '\\osaFlds.ui')

196 
£lf
.
zpToŞBox
 = 
QtWidg‘s
.
	`QToŞBox
()

197 
£lf
.
o§ToŞBox
 = 
QtWidg‘s
.
	`QToŞBox
()

199 
£lf
.
zp_tbox_widg‘s
 = []

200 
£lf
.
o§_tbox_widg‘s
 = []

204 
zp_dù
 = 
DEFAULTS
.
	`g‘
('PRESETS.ZP_PARAMS')

205 
o§_dù
 = 
DEFAULTS
.
	`g‘
('PRESETS.OSA_PARAMS')

206 #£lf.
zpToŞBox
.
	`£tCu¼’tIndex
(1)

207 #£lf.
o§ToŞBox
.
	`£tCu¼’tIndex
(0)

209 #£lf.
cur_zp
 = 
£lf
.
zpToŞBox
.
	`cu¼’tIndex
()

210 #£lf.
cur_o§
 = 
£lf
.
o§ToŞBox
.
	`cu¼’tIndex
()

211 
£lf
.
zp_·Ãls
 = []

212 
·ges
 = 0

213 
zp_def
 
š
 
zp_dù
:

214 
zpP¬ms_ui
 = 
uic
.
	`lßdUi
Ğ
widg‘sUiDœ
 + '\\zpFlds.ui')

216 
	`š™_zp_def_ŒªsfÜm_»c
(
zp_def
)

218 #pİuÏ‹ 
f›lds


219 
zpP¬ms_ui
.
zpDFld
.
	`£tText
('%.2f' % 
zp_def
['D'])

220 
zpP¬ms_ui
.
zpCStİFld
.
	`£tText
('%.2f' % 
zp_def
['CsD'])

221 
zpP¬ms_ui
.
zpOZÚeFld
.
	`£tText
('%.2f' % 
zp_def
['OZone'])

222 
zpP¬ms_ui
.
zpA1Fld
.
	`£tText
('%.3f' % 
zp_def
['a1'])

224 
zpP¬ms_ui
.
zpDFld
.
»tuºP»s£d
.
	`cÚÃù
(
£lf
.
upd©e_zp_d©a
)

225 
zpP¬ms_ui
.
zpCStİFld
.
»tuºP»s£d
.
	`cÚÃù
(
£lf
.
upd©e_zp_d©a
)

226 
zpP¬ms_ui
.
zpOZÚeFld
.
»tuºP»s£d
.
	`cÚÃù
(
£lf
.
upd©e_zp_d©a
)

227 
zpP¬ms_ui
.
zpA1Fld
.
»tuºP»s£d
.
	`cÚÃù
(
£lf
.
upd©e_zp_d©a
)

229 
£lf
.
zpToŞBox
.
	`š£¹I‹m
(
·ges
, 
zpP¬ms_ui
, 'ZP %d'%(pages+1))

230 
£lf
.
zp_tbox_widg‘s
.
	`­³nd
(
zpP¬ms_ui
)

231 
·ges
 += 1

233 
£lf
.
zp_·Ãls
.
	`­³nd
(
zpP¬ms_ui
)

235 
£lf
.
zpGroupBox
.
	`Ïyout
().
	`addWidg‘
(£lf.
zpToŞBox
)

236 
£lf
.
zpToŞBox
.
	`£tCu¼’tIndex
(1)

239 
·ges
 = 0

240 
o§_def
 
š
 
o§_dù
:

241 
o§P¬ms_ui
 = 
uic
.
	`lßdUi
(
widg‘sUiDœ
 + '\\osaFlds.ui')

243 
	`š™_o§_def_ŒªsfÜm_»c
(
o§_def
)

245 #pİuÏ‹ 
f›lds


246 
o§P¬ms_ui
.
o§DFld
.
	`£tText
('%.2f' % 
o§_def
['D'])

247 
£lf
.
o§ToŞBox
.
	`š£¹I‹m
(
·ges
, 
o§P¬ms_ui
, 'OSA %d'%(pages+1))

249 
o§P¬ms_ui
.
o§DFld
.
»tuºP»s£d
.
	`cÚÃù
(
£lf
.
upd©e_o§_d©a
)

250 
£lf
.
o§_tbox_widg‘s
.
	`­³nd
(
o§P¬ms_ui
)

251 
·ges
 += 1

253 
£lf
.
o§GroupBox
.
	`Ïyout
().
	`addWidg‘
(£lf.
o§ToŞBox
)

254 
£lf
.
o§ToŞBox
.
	`£tCu¼’tIndex
(1)

256 
£lf
.
	`lßd_deçuÉs
()

258 #£lf.
	`upd©e_zp_d©a
()

260 
£lf
.
zpToŞBox
.
cu¼’tChªged
.
	`cÚÃù
(£lf.
upd©e_zp_£ËùiÚ
)

261 
£lf
.
o§ToŞBox
.
cu¼’tChªged
.
	`cÚÃù
(£lf.
upd©e_o§_£ËùiÚ
)

263 
MAIN_OBJ
.
	`deviû
('Zpz_sÿnModeFÏg').
	`put
('VAL', 1)

266 
def
 
	$Ú_’”gy_fbk_chªged
(
£lf
, 
v®
):

267 
£lf
.
	`upd©e_zp_d©a
(
upd©e_deçuÉs
=
F®£
)

269 
def
 
	$lßd_deçuÉs
(
£lf
):

270 
zp_idx
 = 
DEFAULTS
.
	`g‘
('PRESETS.ZP_FOCUS_PARAMS.ZP_IDX')

271 
zpA1
 = 
DEFAULTS
.
	`g‘
('PRESETS.ZP_FOCUS_PARAMS.ZP_A1')

272 #zpD = 
DEFAULTS
.
	`g‘
('PRESETS.ZP_FOCUS_PARAMS.ZP_D')

273 
o§_idx
 = 
DEFAULTS
.
	`g‘
('PRESETS.ZP_FOCUS_PARAMS.OSA_IDX')

274 #o§D = 
DEFAULTS
.
	`g‘
('PRESETS.ZP_FOCUS_PARAMS.OSA_D')

275 
A0
 = 
DEFAULTS
.
	`g‘
('PRESETS.ZP_FOCUS_PARAMS.OSA_A0')

276 #aomax = 
DEFAULTS
.
	`g‘
('PRESETS.ZP_FOCUS_PARAMS.OSA_A0MAX')

278 
£lf
.
zpToŞBox
.
	`£tCu¼’tIndex
(
zp_idx
)

279 
£lf
.
o§ToŞBox
.
	`£tCu¼’tIndex
(
o§_idx
)

281 
MAIN_OBJ
.
	`deviû
('A0').
	`put
(
A0
)

282 #fÜû 
•ics
 
to
 
upd©e
 
the
 
»cÜd
 
def
 
äÜ
 
ZP
's

283 
MAIN_OBJ
.
	`deviû
('Zp_£Ëù').
	`put
('VAL', 
zp_idx
)

285 #zp_deàğ
MAIN_OBJ
.
	`deviû
('Zp_def')

286 #a1 = 
zp_def
.
	`g‘
('A')

287 #d = 
zp_def
.
	`g‘
('B')

288 #c ğ
zp_def
.
	`g‘
('C')

289 #» ğ
zp_def
.
	`g‘
('D')

290 
£lf
.
a0Fld
.
	`£tText
Ğ'%.3f' % 
A0
)

291 
zp_²l
 = 
£lf
.
zp_·Ãls
[
zp_idx
]

292 
zp_²l
.
zpA1Fld
.
	`£tText
Ğ'%.3f' % 
zpA1
)

295 
def
 
	$Ú_a0_chªged
(
£lf
):

296 
A0
 = (
	`¡r
(
£lf
.
a0Fld
.
	`‹xt
()))

297 
MAIN_OBJ
.
	`deviû
('A0').
	`put
(
A0
)

298 
£lf
.
	`upd©e_zp_d©a
()

301 
def
 
	$upd©e_zp_£ËùiÚ
(
£lf
):

302 
zp_idx
 = 
£lf
.
zpToŞBox
.
	`cu¼’tIndex
()

303 
MAIN_OBJ
.
	`deviû
('Zp_£Ëù').
	`put
('VAL', 
zp_idx
)

304 
£lf
.
	`upd©e_zp_d©a
()

306 
def
 
	$upd©e_o§_£ËùiÚ
(
£lf
):

307 
o§_idx
 = 
£lf
.
o§ToŞBox
.
	`cu¼’tIndex
()

308 
MAIN_OBJ
.
	`deviû
('OSA_£Ëù').
	`put
('VAL', 
o§_idx
)

309 
£lf
.
	`upd©e_zp_d©a
()

311 
def
 
	$upd©e_o§_d©a
(
£lf
):

312 
o§£l_pv
 = 
MAIN_OBJ
.
	`deviû
('OSA_select')

313 
o§def_pv
 = 
MAIN_OBJ
.
	`deviû
('OSA_def')

316 
idx
 = 
£lf
.
o§ToŞBox
.
	`cu¼’tIndex
()

320 
_ui
 = 
£lf
.
o§_tbox_widg‘s
[
idx
]

321 
o§D
 = (
	`¡r
(
_ui
.
o§DFld
.
	`‹xt
()))

323 #o§£l_pv.
	`put
(
o§£l_pv
.
¡r_æds
[
idx
], 'o§%d %d' % (idx+1,
o§D
))

324 #o§£l_pv.
	`put
(
o§£l_pv
.
v®_æds
[
idx
], 
o§D
)

326 #o§£l_pv.
	`put
('CMT' + 
o§_id¡rs
[
idx
], 'o§%d %d' % (idx+1,
o§D
))

327 #o§def_pv.
	`put
(
o§_id¡rs
[
idx
], 
o§D
)

329 #g‘ 
li¡
 
of
 
zp
 
defs


331 
o§s
 = 
DEFAULTS
.
	`g‘
('PRESETS.OSA_PARAMS')

332 #{'o§_id': 1, 'D':30.0
	}
}

333 
	go§s
[
idx
]['D'] = 
o§D


334 
DEFAULTS
.
£t
('PRESETS.OSA_PARAMS', 
o§s
)

336 
	g£lf
.
upd©e_zp_d©a
()

339 
def
 
	$upd©e_zp_d©a
(
£lf
, 
upd©e_deçuÉs
=
True
):

341 
Wr™e
 
ZP
 
£Ëù


342 
Wr™e
 
OSA
 
S–eù


343 
Wr™e
 
A0


344 
Wr™e


345 
Mode
 
£Ëù


346 
StÜe
 
´e£ts


349 
zp_id¡rs
 = ['A','B','C','D','E','F','G','H','I','J']

350 
’”gy
 = (
	`¡r
(
£lf
.
evFbkLbl
.
	`g‘_‹xt
()))

351 
aomax
 = (
	`¡r
(
£lf
.
a0MaxFbkLbl
.
	`g‘_‹xt
()))

352 
zp_idx
 = 
£lf
.
zpToŞBox
.
	`cu¼’tIndex
()

354 
zpP¬ms_ui
 = 
£lf
.
zp_tbox_widg‘s
[
zp_idx
]

356 
o§_idx
 = 
£lf
.
o§ToŞBox
.
	`cu¼’tIndex
()

357 
o§_ui
 = 
£lf
.
o§_tbox_widg‘s
[
o§_idx
]

358 
o§D
 = (
	`¡r
(
o§_ui
.
o§DFld
.
	`‹xt
()))

359 
A0
 = (
	`¡r
(
£lf
.
a0Fld
.
	`‹xt
()))

361 
æ
 = (
	`¡r
(
£lf
.
æFbkLbl
.
	`g‘_‹xt
()))

362 #æ = 
MAIN_OBJ
.
	`deviû
('Foÿl_L’gth').
	`g‘
()

363 #Zpz_po ğ
MAIN_OBJ
.
	`deviû
('Zpz_pos').
	`g‘
()

364 
Zpz_pos
 = (
	`¡r
(
£lf
.
zpzFbkLbl
.
	`g‘_‹xt
()))

365 #Cz_po ğ
MAIN_OBJ
.
	`deviû
('Cz_pos').
	`g‘
()

366 
Cz_pos
 = (
	`¡r
(
£lf
.
§m¶eZFbkLbl
.
	`g‘_‹xt
()))

367 #'
Zpz_sÿnFÏg
'

368 #'
D–_Zpz
'

370 
zpD
 = (
	`¡r
(
zpP¬ms_ui
.
zpDFld
.
	`‹xt
()))

371 
zpCStİ
 = (
	`¡r
(
zpP¬ms_ui
.
zpCStİFld
.
	`‹xt
()))

372 
zpOZÚe
 = (
	`¡r
(
zpP¬ms_ui
.
zpOZÚeFld
.
	`‹xt
()))

373 
zpA1
 = (
	`¡r
(
zpP¬ms_ui
.
zpA1Fld
.
	`‹xt
()))

375 
deviûs
 = 
MAIN_OBJ
.
	`g‘_deviûs
()

376 
deviûs
['PVS']['Zp_def%d_A' % 
zp_idx
].
	`put
(
zpA1
)

377 #
##
æ
 = 
	`foÿl_Ëngth
(
’”gy
, 
zpA1
)

378 #(
aomax
, 
id—lA0
èğ
	`A0Max
(
zpD
, 
æ
, 
o§D
)

379 ##
´št
 'ThfoÿÈËngth fÜƒÃrgy %.3àeV‡nd zÚ¶©[%d] i %.3àmiüÚs' % (
’”gy
, 
zp_idx
, 
æ
)

380 ##
´št
 'A0 should b< %.2àum sØ£‰šg CzØ%.2f' % (
aomax
, 
id—lA0
)

381 #
##
£lf
.
a0Fld
.
	`£tText
('%.3f' % 
A0
)

382 #
#Zpz_po ğ
MAIN_OBJ
.
	`deviû
('Zpz_pos').
	`g‘
()

383 #Cz_po ğ
MAIN_OBJ
.
	`deviû
('Cz_pos').
	`g‘
()

384 #
#
#£lf.
a0MaxFbkLbl
.
	`£tText
('%.3f' % 
aomax
)

385 #£lf.
æFbkLbl
.
	`£tText
('%.3f' % 
æ
)

386 #£lf.
§m¶eZFbkLbl
.
	`£tText
('%.3f' % 
id—lA0
)

387 #
#zpz = 
	`ÿlc_zpz
(
æ
, 
A0
)

388 #£lf.
zpzFbkLbl
.
	`£tText
('%.3f' % 
Zpz_pos
)

389 #
#£lf.
§m¶eZFbkLbl
.
	`£tText
('%.3f' % 
Cz_pos
)

390 #
##
mŒcz
 = 
MAIN_OBJ
.
	`deviû
('CoarseZ.Z')

391 ##
mŒcz
.
	`move
(
A0
)

392 #
#if(
upd©e_deçuÉs
):

393 
DEFAULTS
.
	`£t
('PRESETS.ZP_FOCUS_PARAMS.ZP_IDX', 
zp_idx
)

394 
DEFAULTS
.
	`£t
('PRESETS.ZP_FOCUS_PARAMS.ZP_A1', 
zpA1
)

395 
DEFAULTS
.
	`£t
('PRESETS.ZP_FOCUS_PARAMS.ZP_D', 
zpD
)

396 
DEFAULTS
.
	`£t
('PRESETS.ZP_FOCUS_PARAMS.OSA_IDX', 
o§_idx
)

397 
DEFAULTS
.
	`£t
('PRESETS.ZP_FOCUS_PARAMS.OSA_D', 
o§D
)

398 
DEFAULTS
.
	`£t
('PRESETS.ZP_FOCUS_PARAMS.OSA_A0', 
A0
)

399 
DEFAULTS
.
	`£t
('PRESETS.ZP_FOCUS_PARAMS.OSA_A0MAX', 
aomax
)

401 
zps
 = 
DEFAULTS
.
	`g‘
('PRESETS.ZP_PARAMS')

402 #{'o§_id': 1, 'D':30.0
	}
}

403 
	gzps
[
zp_idx
]['a1'] = 
zpA1


404 
DEFAULTS
.
£t
('PRESETS.ZP_PARAMS', 
zps
)

406 #DEFAULTS.
£t
('PRESETS.ZP_FOCUS_PARAMS.OSA_IDEAL_A0', 
id—lA0
)

407 
	gDEFAULTS
.
upd©e
()

412 
def
 
	$g‘_loÿl_·¿ms
(
£lf
):

413 
’”gy
 = (
	`¡r
(
£lf
.
evFbkLbl
.
	`g‘_‹xt
()))

414 
Ãw_zpz
ğ(
	`¡r
(
£lf
.
ûÁ”ZPFld
.
	`‹xt
()))

416 
zp_idx
 = 
£lf
.
zpToŞBox
.
	`cu¼’tIndex
()

417 
zpP¬ms_ui
 = 
£lf
.
zp_tbox_widg‘s
[
zp_idx
]

419 
o§_idx
 = 
£lf
.
o§ToŞBox
.
	`cu¼’tIndex
()

420 
o§_ui
 = 
£lf
.
o§_tbox_widg‘s
[
o§_idx
]

422 
o§D
 = (
	`¡r
(
o§_ui
.
o§DFld
.
	`‹xt
()))

423 
A0
 = (
	`¡r
(
£lf
.
a0Fld
.
	`‹xt
()))

424 
zpD
 = (
	`¡r
(
zpP¬ms_ui
.
zpDFld
.
	`‹xt
()))

425 
zpCStİ
 = (
	`¡r
(
zpP¬ms_ui
.
zpCStİFld
.
	`‹xt
()))

426 
zpOZÚe
 = (
	`¡r
(
zpP¬ms_ui
.
zpOZÚeFld
.
	`‹xt
()))

427 
zpA1
 = (
	`¡r
(
zpP¬ms_ui
.
zpA1Fld
.
	`‹xt
()))

429 
æ
 = 
	`foÿl_Ëngth
(
’”gy
, 
zpA1
)

430 (
aomax
, 
id—lA0
èğ
	`A0Max
(
zpD
, 
æ
, 
o§D
)

432 
d©
 = {
	}
}

433 
d©
['’”gy'] = 
’”gy


434 
d©
['o§D'] = 
o§D


435 
d©
['A0'] = 
A0


436 
d©
['zpD'] = 
zpD


437 
d©
['zpA1'] = 
zpA1


438 
d©
['æ'] = 
æ


439 
d©
['id—lA0'] = 
id—lA0


440 
d©
['Ãw_zpz'] = 
Ãw_zpz


442 (
d©
)

444 
__Çme__
 == "__main__":

445 
impÜt
 
sys


447 #zp ğ
g‘_zp_dù
()

448 #o§ ğ
g‘_o§_dù
()

450 #DEFAULTS.
add_£ùiÚ
('PRESETS.ZP_PARAMS', 
zps
)

451 #DEFAULTS.
add_£ùiÚ
('PRESETS.OSA_PARAMS',
o§s
)

452 #DEFAULTS.
add_£ùiÚ
('PRESETS.ZP_FOCUS_PARAMS',{})

453 #DEFAULTS.
add_£ùiÚ
('PRESETS.ZP_FOCUS_PARAMS.ZP_IDX', 0)

454 #DEFAULTS.
add_£ùiÚ
('PRESETS.ZP_FOCUS_PARAMS.ZP_A1', 0)

455 #DEFAULTS.
add_£ùiÚ
('PRESETS.ZP_FOCUS_PARAMS.ZP_D', 0)

456 #DEFAULTS.
add_£ùiÚ
('PRESETS.ZP_FOCUS_PARAMS.OSA_IDX', 0)

457 #DEFAULTS.
add_£ùiÚ
('PRESETS.ZP_FOCUS_PARAMS.OSA_D', 0)

458 #DEFAULTS.
add_£ùiÚ
('PRESETS.ZP_FOCUS_PARAMS.OSA_A0', 0)

459 #DEFAULTS.
add_£ùiÚ
('PRESETS.ZP_FOCUS_PARAMS.OSA_A0MAX', 0)

460 #DEFAULTS.
add_£ùiÚ
('PRESETS.ZP_FOCUS_PARAMS.OSA_IDEAL_A0', 0)

462 
	g­p
 = 
QtWidg‘s
.
QAµliÿtiÚ
(
sys
.
¬gv
)

463 
wšdow
 = 
FocusP¬ams
()

464 
wšdow
.
show
()

466 
­p
.
exec_
()

	@widgets/motorPanel.py

2 
C»©ed
 
	gÚ
 2014-07-15

4 @
	gauthÜ
: 
b”gr


6 
impÜt
 
sys


7 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
	guic
, 
	gQtWidg‘s


9 
impÜt
 
	gtime


10 
impÜt
 
	gQueue


11 
impÜt
 
	g©ex™


13 #äom 
bcm
.
´ÙocŞ
.
•ics
.
mÙÜ
 
impÜt
 
MÙÜ
 
as
 
­sMÙÜ


14 #äom 
bcm
.
uts
.
dœli¡
 
impÜt
 dirlist

15 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
bl07ID01
 
impÜt
 
	gMAIN_OBJ
, 
	gPOS_TYPE_BL
, 
	gPOS_TYPE_ES


16 
äom
 
	gşs
.
	g­p_d©a
.
deçuÉs
 
impÜt
 
	grgb_as_hex
, 
	gma¡”_cŞÜs
, 
	gg‘_¡yË


17 #äom 
şs
.
ÿWidg‘s
.
ÿComboBox
 
impÜt
 
ÿ_mbbiComboBoxWidg‘


18 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


20 #äom 
şs
.
­¶iÿtiÚs
.
pyStxm
.
widg‘s
.
¥fbk_sm®l
 
impÜt
 spfbk_small

21 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	gwidg‘s
.
¥fbk_sm®l
 
impÜt
 
Ui_FÜm
 
as
 
	g¥fbk_sm®l


23 #mÙÜ 
š‹º®
 
¡©us


24 
	gNONFLOAT
, 
	gOUTSIDE_LIMITS
, 
	gUNCONNECTED
 = -13, -12, -11

25 
	gTIMEOUT
, 
	gTIMEOUT_BUTDONE
 = -8, -7

26 
	gUNKNOWN_ERROR
 = -5

27 
DONEW_SOFTLIM
, 
	gDONEW_HARDLIM
 = -4, -3

28 
	gDONE_OK
 = 0

29 
MOVE_BEGUN
, 
	gMOVE_BEGUN_CONFIRMED
 = 0, 1

30 
	gNOWAIT_SOFTLIM
, 
	gNOWAIT_HARDLIM
 = 4, 3

34 
	g_fbk_nÙ_movšg
 = 
ma¡”_cŞÜs
['app_blue']

37 
_fbk_movšg
 = "rgb(254, 233, 0);"

38 #£tu°
moduË
 
logg”
 
w™h
 
a
  do-
nÙhšg
 
hªdËr


39 
_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

42 
şass
 
	$Pos™iÚ”sPª–
(
QtWidg‘s
.
QWidg‘
):

44 
This
 
is
 
a
 
widg‘
 
th©
 
kes
 
äom
 
the
 
¬g
 'pos™iÚ”_£t'h
pos™iÚ”s
 
to
 
f‹r
 fromhe

45 
ma¡”
 
deviû
 
li¡
 
š
 
the
 
maš
 
objeù
. 
This
 
®lows
 
this
 
Pª–
 
to
 
´e£Á
 
a
 
·Ãl
 
of
 
End¡©iÚ
 
Ü
 
B—mlše


46 
pos™iÚ”s
 
d•’dšg
.

47 
pos™iÚ”_£t
='endstation'

48 :
·¿m
 
pos™iÚ”_£t
: 
a
 
¡ršg
 
th©
 
is
 
u£d
 
to
 
decide
 
which
 
pos™iÚ”s
Ø
šşude
 
Ú
 
the
 
·Ãl
. 
SuµÜ‹d


49 
İtiÚs
 
¬e
:

53 :
ty³
 
¡ršg
:

55 :
»tuºs
: 
NÚe


57 
def
 
	`__š™__
(
£lf
, 
pos™iÚ”_£t
='ES', 
exşude_li¡
=[]):

58 
	`su³r
(
Pos™iÚ”sPª–
, 
£lf
).
	`__š™__
()

61 #£lf.
exşude_li¡
 = ['_ZonePlateZ_base', 'SampleFineX', 'SampleFineY', 'CoarseX.X', 'CoarseY.Y', 'AUX1','AUX2','Cff','PeemM3Trans']

62 
£lf
.
exşude_li¡
 =ƒxclude_list

63 #£lf.
bl_li¡
 = ['EPUPolarization', 'EPUGap', 'SlitY', 'SlitX', 'EPUOffset', 'EPUHarmonic', 'EPUFollowing', \

64 #'
B¿nch
', '
G¿tšg
', '
Cff
', '
AUX1
', '
AUX2
','
MÚoT¿ns
', '
P“mM3T¿ns
', '
M3STXMP™ch
'] 

66 
£lf
.
’um_li¡
 = ['EPUPolarization', 'EPUHarmonic', 'Branch' ]

68 
£lf
.
fbk_’abËd
 = 
F®£


69 
£lf
.
pos™iÚ”_£t
 =…ositioner_set

70 
£lf
.
mŒ
 = 
NÚe


71 
£lf
.
mŒlib
 = 
NÚe


73 
£lf
.
vbox
 = 
QtWidg‘s
.
	`QVBoxLayout
()

74 
£lf
.
vbox
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

75 
£lf
.
vbox
.
	`£tS·cšg
(0)

77 
£lf
.
¡yËBŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
('Update Style')

78 
£lf
.
¡yËBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_upd©e_¡yË
)

80 #£lf.
vbox
.
	`addWidg‘
(
£lf
.
¡yËBŠ
)

81 
£lf
.
upd©eQueue
 = 
Queue
.
	`Queue
()

83 
£lf
.
upd©eTim”
 = 
QtCÜe
.
	`QTim”
()

84 
£lf
.
upd©eTim”
.
timeout
.
	`cÚÃù
(£lf.
upd©e_widg‘s
)

87 
£lf
.
	`£tLayout
(£lf.
vbox
)

88 
£lf
.
mŒ_diù
 = {
	}
}

89 #£lf.
qssh“t
 = 
g‘_¡yË
('dark')

90 #£lf.
£tStyËSh“t
(
£lf
.
qssh“t
)

92 
devs
 = 
MAIN_OBJ
.
g‘_deviûs
()

93 #DEVICE_CFG.
g‘_deviû_li¡
()

94 
pos_keys
 = 
devs
['POSITIONERS'].
keys
()

95 
pos_keys
.
sÜt
()

96 
dev
 
š
 
pos_keys
:

97 #´šˆ
dev


98 if(
dev
 
š
 
£lf
.
exşude_li¡
):

101 
u£this
 = 
F®£


102 
mŒ
 = 
MAIN_OBJ
.
deviû
(
dev
)

103 if(
£lf
.
pos™iÚ”_£t
.
fšd
(
POS_TYPE_BL
) > -1):

104 if(
mŒ
.
_pos_£t
 =ğ
POS_TYPE_BL
):

105 
u£this
 = 
True


107 if(
£lf
.
pos™iÚ”_£t
.
fšd
(
POS_TYPE_ES
) > -1):

108 if(
mŒ
.
_pos_£t
 =ğ
POS_TYPE_ES
):

109 
u£this
 = 
True


111 if(
u£this
):

112 #if(
dev
 
š
 
£lf
.
’um_li¡
):

113 #cbox = 
ÿ_mbbiComboBoxWidg‘
(
mŒ
.
g‘_Çme
(), 
hdrText
='Mode')

114 #£lf.
vbox
.
addWidg‘
(
cbox
)

116 #_logg”.
debug
('uic.lßdU˜[%s]' % 
dev
)

117 #dev_u˜ğ
uic
.
lßdUi
(
r
'C:\controls\py2.7\Beamlines\sm\stxm_control\widgets\ui\spfbk_small.ui')

118 
	gwidg
 = 
QtWidg‘s
.
QWidg‘
()

119 
dev_ui
 = 
¥fbk_sm®l
()

120 
dev_ui
.
£tupUi
(
widg
)

122 #dev_ui.
£tPosFld
.
š¡®lEv’tF‹r
(
F‹r
())

123 #mŒ = 
MAIN_OBJ
.
deviû
(
dev
)

124 
£lf
.
mŒ_diù
[
mŒ
.
g‘_Çme
()] = ( 
dev
, 
	gdev_ui
, 
	gwidg
, 
	gmŒ
)

125 
	g£lf
.
cÚÃù_mÙÜ_widg‘s
(
dev
, 
dev_ui
, 
widg
, 
mŒ
)

126 #_logg”.
debug
('DONE uic.lßdU˜[%s]' % 
dev
)

127 #´šˆ'pos™iÚ”: [%s]…vÇm[%s]' % (
dev
, 
mŒ
.
g‘_Çme
())

128 
	g£lf
.
	gupd©eTim”
.
¡¬t
(100)

129 
	g£lf
.
	gfbk_’abËd
 = 
True


130 #£lf.
lßdMÙÜCÚfig
(
pos™iÚ”
)

131 
©ex™
.(
£lf
.
Ú_ex™
)

133 
def
 
	$Ú_ex™
(
£lf
):

135 
·ss


138 
def
 
	$Ú_upd©e_¡yË
(
£lf
):

140 
£lf
.
qssh“t
 = 
	`g‘_¡yË
('dark')

141 
£lf
.
	`£tStyËSh“t
(£lf.
qssh“t
)

143 
def
 
	$cÚÃù_mÙÜ_widg‘s
(
£lf
, 
Çme
, 
mŒ_ui
, 
widg
, 
mŒ
):

144 
_logg”
.
	`debug
('cÚÃù_mÙÜ_widg‘s[%s]' % 
Çme
)

145 #cÚÃù 
bŠ
 
hªdËrs


146 #hlm = 
mŒ
.
	`g‘
('HLM')

147 #Îm = 
mŒ
.
	`g‘
('LLM')

148 
desc
 = 
mŒ
.
	`g‘
('DESC')

149 
pv_Çme
 = 
mŒ
.
	`g‘_Çme
()

150 #ma_¡¸ğ'movabsŞu‹ b‘w“À%.2àªd %.2f' % (
Îm
, 
hlm
)

151 
mŒ_ui
.
¡İBŠ
.
şicked
.
	`cÚÃù
(
£lf
.
¡İ
)

152 
mŒ_ui
.
d‘asBŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_d‘as
)

153 
mŒ_ui
.
£tPosFld
.
»tuºP»s£d
.
	`cÚÃù
(
£lf
.
Ú_»tuº_´es£d
)

154 #mŒ_ui.
£tPosFld
.
ed™šgFšished
.
	`cÚÃù
(
£lf
.
Ú_ed™šg_fšished
)

156 #mŒ_ui.
£tPosFld
.
	`£tToŞT
(
ma_¡r
)

158 
mŒ_ui
.
£tPosFld
.
	`£tCÚ‹xtM’uPŞicy
(
QtCÜe
.
Qt
.
Cu¡omCÚ‹xtM’u
)

159 
mŒ_ui
.
£tPosFld
.
cu¡omCÚ‹xtM’uReque¡ed
.
	`cÚÃù
(
£lf
.
cÚ‹xtM’uEv’t
)

161 
mŒ_ui
.
mŒNameFld
.
	`£tText
(
Çme
)

162 
mŒ_ui
.
mŒNameFld
.
	`£tToŞT
(
desc
)

163 
mŒ_ui
.
£tPosFld
.
	`£tStusT
(
pv_Çme
)

164 
mŒ_ui
.
¡İBŠ
.
	`£tStusT
(
pv_Çme
)

165 
mŒ_ui
.
d‘asBŠ
.
	`£tStusT
(
pv_Çme
)

167 #_logg”.
	`debug
('addšg c®lback DMOV,RBV fÜ [%s]' % 
Çme
)

168 #if(
	`ha§‰r
(
mŒ
, 'add_callback')):

169 #_logg”.
	`debug
('add_ÿÎback(DMOV [%s]' % 
Çme
)

170 
mŒ
.
	`add_ÿÎback
('DMOV', 
£lf
.
upd©eMovšg
)

171 #_logg”.
	`debug
('add_ÿÎback(RBV [%s]' % 
Çme
)

172 
mŒ
.
	`add_ÿÎback
('RBV', 
£lf
.
upd©eFbk
)

173 #_logg”.
	`debug
('g‘_pos™iÚ(è[%s]' % 
Çme
)

175 #_logg”.
	`debug
('g‘tšg RBV,EGU fÜ [%s]' % 
Çme
)

176 
fbk
 = 
mŒ
.
	`g‘_pos™iÚ
()

177 #_logg”.
	`debug
('add_ÿÎback(EGU [%s]' % 
Çme
)

178 
un™s
 = 
	`¡r
(
mŒ
.
	`g‘
('EGU'))

179 #_logg”.
	`debug
('dÚcÚÃùšg [%s]' % 
Çme
)

180 
s
 = '%6.3f' % 
fbk


181 
mŒ_ui
.
posFbkLbl
.
	`£tText
(
s
)

182 
mŒ_ui
.
un™sLbl
.
	`£tText
(
un™s
)

184 #–if(
	`ha§‰r
(
mŒ
, 'changed')):

185 ##
´št
 'Snd¬d PV: unsuµÜ‹d…os™iÚ” [%s]' % 
Çme


188 #´šˆ'unsuµÜ‹d…os™iÚ” [%s]' % 
Çme


190 
£lf
.
vbox
.
	`addWidg‘
(
widg
)

191 #_logg”.
	`debug
('DÚe[%s] \n\n' % 
Çme
)

193 
def
 
	$Ú_ed™šg_fšished
(
£lf
):

194 
´št
 'on_editing_finished'

196 
def
 
	$upd©e_widg‘s
(
£lf
):

197 
ÿÎ_sk_dÚe
 = 
F®£


198 
nÙ
 
£lf
.
upd©eQueue
.
	$em±y
():

199 
»¥
 = 
£lf
.
upd©eQueue
.
	`g‘
()

200 if('£tStyËSh“t' 
š
 
»¥
.
	$keys
()):

201 
ss
 
š
 
»¥
['setStyleSheet']:

202 
widg‘
 = 
ss
[0]

203 
şr_¡r
 = 
ss
[1]

204 #´šˆ'upd©e_widg‘s: s‘StyËSh“t(%s)' % 
şr_¡r


205 
widg‘
.
	`£tStyËSh“t
(
şr_¡r
)

206 
ÿÎ_sk_dÚe
 = 
True


208 if('£tText' 
š
 
»¥
.
	$keys
()):

209 
widg‘
 = 
»¥
['setText'][0]

210 
_¡r
 = 
»¥
['setText'][1]

211 #´šˆ'upd©e_widg‘s: s‘Text(%s)' % 
_¡r


212 
widg‘
.
	`£tText
(
_¡r
)

213 
ÿÎ_sk_dÚe
 = 
True


215 if(
ÿÎ_sk_dÚe
):

216 
£lf
.
upd©eQueue
.
	`sk_dÚe
()

219 
def
 
	$¡İ
(
£lf
):

220 
æd
 = 
£lf
.
	`£nd”
()

221 
pvÇme
 = 
	`¡r
(
æd
.
	`¡©usT
())

222 (
dev
, 
dev_ui
, 
widg
, 
mŒ
èğ
£lf
.
mŒ_diù
[
pvÇme
]

223 
mŒ
.
	`¡İ
()

225 
def
 
	$upd©eMovšg
(
£lf
, **
kw¬gs
):

227 
™
 
wl
 
ev’tu®ly
 
sûw
 
up
 
‹h
 
maš
 
GUI
 
th»ad


228 
H’û
 
the
 
u£
 
of
 
a
 
Queue
 
ªd
 
QTim”


230 
pvÇme
 = 
kw¬gs
['pvÇme'].
	`¥l™
('.')[0]

231 (
dev
, 
dev_ui
, 
widg
, 
mŒ
èğ
£lf
.
mŒ_diù
[
pvÇme
]

232 
v®
 = (
kw¬gs
['value'])

233 
txt_şr
 = "color: black;"

234 #thi 
is
 
the
 
DMOV
 
Ü
 
DONE
 
Movšg
, 
I
 
wªt
 Movšg 
so
 
šv”t
 
logic


235 if(
v®
):

236 
şr_¡r
 = 
_fbk_nÙ_movšg


239 
şr_¡r
 = 
_fbk_movšg


242 
_dù
 = {
	}
}

243 
_dù
['£tStyËSh“t'] = [(
dev_ui
.
mŒNameFld
, "background-cŞÜ: " + 
şr_¡r
), (dev_ui.
posFbkLbl
, 
txt_şr
)]

244 
	g£lf
.
	gupd©eQueue
.
put_nowa™
(
_dù
)

248 
def
 
	$upd©eFbk
(
£lf
, **
kw¬gs
):

250 
™
 
wl
 
ev’tu®ly
 
sûw
 
up
 
‹h
 
maš
 
GUI
 
th»ad


251 
H’û
 
the
 
u£
 
of
 
a
 
Queue
 
ªd
 
QTim”


253 if(
£lf
.
fbk_’abËd
 
is
 
True
):

254 
pvÇme
 = 
kw¬gs
['pvÇme'].
	`¥l™
('.')[0]

255 (
dev
, 
dev_ui
, 
widg
, 
mŒ
èğ
£lf
.
mŒ_diù
[
pvÇme
]

256 
v®
 = (
kw¬gs
['value'])

257 
s
 = '%6.3f' % 
v®


258 
_dù
 = {
	}
}

259 
_dù
['£tText'] = (
dev_ui
.
posFbkLbl
, 
	gs
)

260 
	g£lf
.
	gupd©eQueue
.
put_nowa™
(
_dù
)

262 
def
 
	$Ú_»tuº_´es£d
(
£lf
):

263 
æd
 = 
£lf
.
	`£nd”
()

264 
pvÇme
 = 
	`¡r
(
æd
.
	`¡©usT
())

265 (
dev
, 
dev_ui
, 
widg
, 
mŒ
èğ
£lf
.
mŒ_diù
[
pvÇme
]

266 
pos
 = (
	`¡r
(
£lf
.
	`£nd”
().
	`‹xt
()))

267 
¡s
 = 
mŒ
.
	`move
(
pos
)

269 if(
¡s
 =ğ
OUTSIDE_LIMITS
):

270 #outsid
the
 
lim™s


271 
şr_¡r
 = "yellow;"

273 
şr_¡r
 = "white;"

275 
_dù
 = {
	}
}

276 
_dù
['£tStyËSh“t'] = [(
dev_ui
.
£tPosFld
, "background-cŞÜ: " + 
şr_¡r
)]

277 
	g£lf
.
	gupd©eQueue
.
put_nowa™
(
_dù
)

279 
def
 
	$check_soá_lim™s
(
£lf
, 
mŒ
, 
¥
):

280 
lvio
 = 
mŒ
.
	`g‘
('LVIO')

281 if(
lvio
 == 0):

282 (
True
)

284 (
F®£
)

286 
def
 
	$cÚ‹xtM’uEv’t
(
£lf
, 
ev’t
):

287 
æd
 = 
£lf
.
	`£nd”
()

288 if(
æd
):

289 
pvÇme
 = 
	`¡r
(
æd
.
	`¡©usT
())

290 (
dev
, 
dev_ui
, 
widg
, 
mŒ
èğ
£lf
.
mŒ_diù
[
pvÇme
]

292 #£lf.
_pvs
['VAL'].
cÚÃùed


293 if(
mŒ
.
_pvs
['VAL'].
cÚÃùed
):

294 
hlm
 = 
mŒ
.
	`g‘
('HLM')

295 
Îm
 = 
mŒ
.
	`g‘
('LLM')

297 if((
Îm
 
is
 
nÙ
 
NÚe
è
	$ªd
 (
hlm
 
is
 
nÙ
 
NÚe
)):

298 
ma_¡r
 = 'mov% absŞu‹ b‘w“À%.2àªd %.2f' % (
dev
, 
Îm
, 
hlm
)

300 
ma_¡r
 = 'MÙÜ % nÙ cÚÃùed' % (
dev
)

302 
£lf
.
m’u
 = 
QtWidg‘s
.
	`QM’u
(self)

303 
»ÇmeAùiÚ
 = 
QtWidg‘s
.
	`QAùiÚ
(
ma_¡r
, 
£lf
)

304 
»ÇmeAùiÚ
.
Œigg”ed
.
	`cÚÃù
(
£lf
.
»ÇmeSlÙ
)

305 
£lf
.
m’u
.
	`addAùiÚ
(
»ÇmeAùiÚ
)

306 #add 
Ùh”
 
»quœed
 
aùiÚs


307 
£lf
.
m’u
.
	`pİup
(
QtWidg‘s
.
QCursÜ
.
	`pos
())

310 
def
 
	$»ÇmeSlÙ
(
£lf
):

311 
´št
 "renaming slot called"

312 #g‘ 
the
 
£Ëùed
 
ûÎ
 
ªd
 
³rfÜm
 
»Çmšg


315 
def
 
	$Ú_d‘as
(
£lf
):

316 
æd
 = 
£lf
.
	`£nd”
()

317 
pvÇme
 = 
	`¡r
(
æd
.
	`¡©usT
())

318 (
dev
, 
dev_ui
, 
widg
, 
mŒ
èğ
£lf
.
mŒ_diù
[
pvÇme
]

319 #dev_u˜ğ
uic
.
	`lßdUi
(
r
'C:\controls\py2.7\Beamlines\sm\stxm_control\widgets\ui\spfbk_detail.ui')

320 
d‘FÜm
 = 
	`Pos™iÚ”D‘a
(
dev
, 
dev_ui
, 
mŒ
)

321 
d‘FÜm
.
	`exec_
()

325 
şass
 
	$Pos™iÚ”D‘a
(
QtWidg‘s
.
QDŸlog
):

327 
şassdocs


329 
def
 
	$__š™__
(
£lf
, 
pos™iÚ”
, 
dev_ui
, 
mŒ
):

330 
	`su³r
(
Pos™iÚ”D‘a
, 
£lf
).
	`__š™__
()

331 
uic
.
	`lßdUi
(
r
'C:\cÚŒŞs\py2.7\B—mlšes\sm\¡xm_cÚŒŞ\widg‘s\ui\¥fbk_d‘a.ui', 
£lf
)

332 
£lf
.
mŒ
 = mtr

333 
£lf
.
pos™iÚ”
 =…ositioner

334 
£lf
.
dev_ui
 = dev_ui

335 #lßd 
the
 
MÙÜ
.
cfg
 
fe


337 #cÚÃù 
bŠ
 
hªdËrs


338 
£lf
.
¡İBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_¡İ_bŠ
)

339 
£lf
.
ÿlBŠ
.
şicked
.
	`cÚÃù
(£lf.
ÿlib¿‹
)

340 
£lf
.
goHomeBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_home_bŠ
)

341 
£lf
.
fÜûC®ib¿‹dBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_fÜû_ÿlib¿‹d
)

342 
£lf
.
z”oMŒBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_z”o_mÙÜ
)

343 
£lf
.
ÚOffBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú
)

344 
£lf
.
mŒG½Box
.
şicked
.
	`cÚÃù
(£lf.
Ú_’abË
)

345 
£lf
.
domovesBŠ
.
şicked
.
	`cÚÃù
(£lf.
do_moves
)

347 
£lf
.
»lS‘poštFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_move_»l_pos™iÚ
)

348 
£lf
.
£oštFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_move_to_pos™iÚ
)

349 
£lf
.
£tPosFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_£t_pos™iÚ
)

350 
£lf
.
v–Fld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_£t_v–o
)

354 
def
 
	`lßdMÙÜCÚfig
(
£lf
, 
pos™iÚ”
='AbsSampleX'):

355 
pos™iÚ”
 = 
	`¡r
(positioner)

357 if(
£lf
.
mŒ
 !ğ
NÚe
):

358 
£lf
.
mŒ
.
chªged
.
	`discÚÃù
()

359 
£lf
.
mŒ
.
¡©us
.
	`discÚÃù
()

360 
	`d–
(
£lf
.
mŒ
)

361 
£lf
.
mŒ
 = 
NÚe


362 
£lf
.
mŒNameFld
.
	`£tText
(
pos™iÚ”
)

363 
£lf
.
un™sLbl
.
	`£tText
(£lf.
un™s
)

364 
£lf
.
mŒ
 = s–f.
deviûs
[
pos™iÚ”
]

365 
£lf
.
	`lßdP¬amsToGui
(£lf.
mŒ
)

366 #£lf.
mŒ
.
chªged
.
	`cÚÃù
(
£lf
.
upd©eFbk
)

368 
£lf
.
mŒ
.
chªged
.
	`cÚÃù
(£lf.
Ú_chªge
)

369 
£lf
.
mŒ
.
ÿlib_chªged
.
	`cÚÃù
(£lf.
check_ÿlibd
)

370 
£lf
.
mŒ
.
¡©us
.
	`cÚÃù
(£lf.
Ú_¡©us
)

371 
£lf
.
mŒ
.
movšg
.
	`cÚÃù
(£lf.
Ú_movšg
)

372 
£lf
.
mŒ
.
log_msg
.
	`cÚÃù
(£lf.
Ú_log_msg
)

374 
£lf
.
moveTh»ad
 = 
QtCÜe
.
	`QTh»ad
()

375 
£lf
.
sÿnObj
 = 
	`sÿnTh»ad
(£lf.
mŒ
)

376 
£lf
.
sÿnObj
.
	`moveToTh»ad
(£lf.
moveTh»ad
)

377 
£lf
.
sÿnObj
.
dÚe
.
	`cÚÃù
(£lf.
Ú_sÿn_dÚe
)

378 
£lf
.
moveTh»ad
.
¡¬‹d
.
	`cÚÃù
(£lf.
sÿnObj
.
do_moves
)

379 
£lf
.
moveTh»ad
.
‹rmš©ed
.
	`cÚÃù
(£lf.
move_‹rmš©ed
)

380 
£lf
.
q
 = 
QtCÜe
.
	`QEv’tLoİ
()

384 
def
 
	$lßdP¬amsToGui
(
£lf
, 
mŒ
):

385 
£lf
.
posFbkLbl
.
	`£tText
('%.3f' % (£lf.
mŒ
.
pos™iÚ
))

386 
£lf
.
z”oOff£tLbl
.
	`£tText
('%.6f' % (£lf.
mŒ
.
un™_off£t
))

387 
£lf
.
absPosLbl
.
	`£tText
(
	`¡r
('%.3f' % (£lf.
mŒ
.
abs_pos™iÚ
)))

388 
£lf
.
’cSlİeLbl
.
	`£tText
(
	`¡r
('%.6f' % (£lf.
mŒ
.
’c_¦İe
)))

389 
£lf
.
ÃgWšdowLbl
.
	`£tText
(
	`¡r
('%.3f' % (£lf.
mŒ
.
ÃgWšdow
)))

390 
£lf
.
posWšdowLbl
.
	`£tText
(
	`¡r
('%.3f' % (£lf.
mŒ
.
posWšdow
)))

392 
£lf
.
v–FbkLbl
.
	`£tText
(
	`¡r
('%.3f' % (£lf.
mŒ
.
dV–
)))

393 
£lf
.
accFbkLbl
.
	`£tText
(
	`¡r
('%.3f' % (£lf.
mŒ
.
dAcûl
)))

398 
def
 
	$Ú_chªge
(
£lf
, 
v®
):

399 #´šˆ'Ú_chªge: %s: %.2f' % (
pos™iÚ”
, 
v®
)

400 
£lf
.
posFbkLbl
.
	`£tText
('%.3f' % (
v®
))

401 
£lf
.
z”oOff£tLbl
.
	`£tText
('%.6f' % (£lf.
mŒ
.
un™_off£t
))

402 
£lf
.
absPosLbl
.
	`£tText
(
	`¡r
('%.3f' % (£lf.
mŒ
.
abs_pos™iÚ
)))

403 
£lf
.
’cSlİeLbl
.
	`£tText
(
	`¡r
('%.6f' % (£lf.
mŒ
.
’c_¦İe
)))

404 
£lf
.
ÃgWšdowLbl
.
	`£tText
(
	`¡r
('%.3f' % (£lf.
mŒ
.
ÃgWšdow
)))

405 
£lf
.
posWšdowLbl
.
	`£tText
(
	`¡r
('%.3f' % (£lf.
mŒ
.
posWšdow
)))

407 
£lf
.
v–FbkLbl
.
	`£tText
(
	`¡r
('%.3f' % (£lf.
mŒ
.
dV–
)))

408 
£lf
.
accFbkLbl
.
	`£tText
(
	`¡r
('%.3f' % (£lf.
mŒ
.
dAcûl
)))

409 #£lf.
	`check_ÿlibd
()

411 
def
 
	$Ú_log_msg
(
£lf
, 
msg
):

412 
£lf
.
logSŒšgLbl
.
	`£tText
(
	`¡r
(
msg
))

414 
def
 
	$ş—r_”rÜ
(
£lf
):

415 
£lf
.
logSŒšgLbl
.
	`£tText
('')

417 #deà
	`Ú_¡©us
(
£lf
, 
pos™iÚ”
, 
¡©us
):

418 #if(
£lf
.
mŒ
 !ğ
NÚe
):

419 #£lf.
¡©usLbl
.
	`£tText
(
	`¡r
(
¡©us
))

421 
def
 
	$Ú_’abË
(
£lf
, 
is_checked
):

422 
£lf
.
mŒ
.
	`£t_’abË
(
is_checked
)

424 
def
 
	$Ú_¡©us
(
£lf
, 
¡©us
):

425 if(
£lf
.
mŒ
 !ğ
NÚe
):

426 
£lf
.
¡©usLbl
.
	`£tText
(
	`¡r
(
¡©us
))

428 
def
 
	$Ú_movšg
(
£lf
, 
is_movšg
):

429 if(
is_movšg
):

430 
şr
 = 
QtGui
.
	`QCŞÜ
(255,0,0è#(
r
,
g
,
b
)

432 
şr
 = 
QtGui
.
	`QCŞÜ
(130,130,130è#(
r
,
g
,
b
)

433 
£lf
.
	`ş—r_”rÜ
()

434 #if(
£lf
.
isdiff
 !ğ
is_movšg
):

435 #objg¿ph.
	`show_growth
()

436 
£lf
.
isdiff
 = 
is_movšg


437 
£lf
.
movšgWgt
.
	`£tStyËSh“t
("QWidg‘ { background-cŞÜ: % }" % 
şr
.
	`Çme
())

439 
def
 
	$check_ÿlibd
(
£lf
, 
ÿl
):

440 if(
ÿl
):

441 
şr
 = 
QtGui
.
	`QCŞÜ
(0,255,0è#(
r
,
g
,
b
)

443 
şr
 = 
QtGui
.
	`QCŞÜ
(255,0,0è#(
r
,
g
,
b
)

444 
£lf
.
ÿlib¿‹dWgt
.
	`£tStyËSh“t
("QWidg‘ { background-cŞÜ: % }" % 
şr
.
	`Çme
())

446 
def
 
	$Ú_z”o_mÙÜ
(
£lf
):

447 if(
£lf
.
mŒ
 !ğ
NÚe
):

448 
£lf
.
mŒ
.
	`z”o_mÙÜ
()

450 
def
 
	$Ú_fÜû_ÿlib¿‹d
(
£lf
):

451 if(
£lf
.
mŒ
 !ğ
NÚe
):

452 
£lf
.
mŒ
.
	`fÜû_ÿlib¿‹d
()

454 
def
 
	$Ú_£t_v–o
(
£lf
):

455 if(
£lf
.
mŒ
 !ğ
NÚe
):

456 
v®
 = (
	`¡r
(
£lf
.
v–Fld
.
	`‹xt
()))

457 
£lf
.
mŒ
.
	`£t_v–oc™y
(
v®
)

459 
def
 
	$Ú_£t_sÿn_¡¬t
(
£lf
):

460 if(
£lf
.
mŒ
 !ğ
NÚe
):

461 
¡¹v®
 = (
	`¡r
(
£lf
.
sÿnS¹Fld
.
	`‹xt
()))

462 
ºgv®
 = (
	`¡r
(
£lf
.
¿ngeFld
.
	`‹xt
()))

464 
ûÁ”x
 = 
¡¹v®
 + (0.5 * 
ºgv®
)

465 if(
ºgv®
 > 80):

466 
£lf
.
mŒ
.
	`£t_fÜ_cßr£_sÿn
(
True
, 
ûÁ”x
)

468 
£lf
.
mŒ
.
	`£t_fÜ_cßr£_sÿn
(
F®£
, 
ûÁ”x
)

470 
£lf
.
mŒ
.
	`move_to_fšesÿn_¡¬t
(
ûÁ”x
, 
ºgv®
)

471 
£lf
.
mŒ
.
	`£t_m¬k”
(
¡¹v®
)

473 
def
 
	$Ú_move_to_pos™iÚ
(
£lf
):

474 if(
£lf
.
mŒ
 !ğ
NÚe
):

475 
´št
 ''

476 
v®
 = (
	`¡r
(
£lf
.
£oštFld
.
	`‹xt
()))

478 
£lf
.
mŒ
.
	`move_to
(
v®
, 
wa™
=
True
)

481 
def
 
	$Ú_move_»l_pos™iÚ
(
£lf
):

482 if(
£lf
.
mŒ
 !ğ
NÚe
):

483 
v®
 = (
	`¡r
(
£lf
.
»lS‘poštFld
.
	`‹xt
()))

484 
£lf
.
mŒ
.
	`move_by
(
v®
, 
wa™
=
True
)

486 
def
 
	$Ú_£t_pos™iÚ
(
£lf
):

487 if(
£lf
.
mŒ
 !ğ
NÚe
):

488 
v®
 = (
	`¡r
(
£lf
.
£tPosFld
.
	`‹xt
()))

489 
£lf
.
mŒ
.
	`£t_pos™iÚ
(
v®
)

491 
def
 
	$Ú_¡İ_bŠ
(
£lf
):

492 if(
£lf
.
mŒ
 !ğ
NÚe
):

493 #£lf.
mŒ
.
	`£t_fÜ_cßr£_sÿn
(
True
, -46.7)

494 
£lf
.
mŒ
.
	`¡İ
()

496 
def
 
	$Ú_home_bŠ
(
£lf
):

497 if(
£lf
.
mŒ
 !ğ
NÚe
):

498 
£lf
.
mŒ
.
	`go_home
()

499 #£lf.
mŒ
.
	`£t_fÜ_cßr£_sÿn
(
F®£
, -46.7)

501 
def
 
	$¡İ
(
£lf
):

502 if(
£lf
.
mŒ
 !ğ
NÚe
):

503 
£lf
.
mŒ
.
	`_¡İ_mÙÜ
()

505 
def
 
	$ÿlib¿‹
(
£lf
):

506 if(
£lf
.
mŒ
 !ğ
NÚe
):

507 
£lf
.
mŒ
.
	`ÿlib¿‹
()

509 
def
 
	$goHome
(
£lf
):

510 if(
£lf
.
mŒ
 !ğ
NÚe
):

511 
£lf
.
mŒ
.
	`go_home
(
wa™
=
F®£
)

513 
def
 
	$Ú_sÿn_dÚe
(
£lf
):

514 
´št
 'on_scan_done: called'

515 
£lf
.
q
.
	`qu™
()

517 
def
 
	$Ú
(
£lf
, 
ischecked
):

518 if(
£lf
.
mŒ
 !ğ
NÚe
):

519 if(
ischecked
):

520 
£lf
.
mŒ
.
	`mÙÜ_Ú
()

522 
£lf
.
mŒ
.
	`mÙÜ_off
()

524 
def
 
	$do_moves
(
£lf
):

525 
£lf
.
moveTh»ad
.
	`¡¬t
()

527 
£lf
.
q
.
	`exec_
()

528 
´št
 'after self.q.exec_()'

529 #£lf.
moveTh»ad
.
dÚe
.
	`discÚÃù
()

530 
£lf
.
moveTh»ad
.
	`wa™
(50)

531 
£lf
.
moveTh»ad
.
	`‹rmš©e
()

532 
´št
 'done'

533 #objg¿ph.
	`show_growth
()

535 
def
 
	$move_‹rmš©ed
(
£lf
):

536 
´št
 'self.moveThread: finallyhis sucker died'

538 
def
 
	$Ú_ex™
(
£lf
):

539 
·ss


540 #£lf.
moveTh»ad
.
	`wa™
(50)

541 #£lf.
moveTh»ad
.
	`qu™
()

542 #£lf.
moveTh»ad
.
	`‹rmš©e
()

543 #if(
£lf
.
mŒ
 
is
 
nÙ
 
NÚe
):

544 #£lf.
mŒ
.
	`şo£_mŒ
()

546 #ià
__Çme__
 == '__main__':

547 #
#­°ğ
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

548 #wšdow = 
	`Pos™iÚ”sPª–
('beamline')

549 #wšdow.
	`show
()

550 #wšdow2 = 
	`Pos™iÚ”sPª–
('endstation')

551 #wšdow2.
	`show
()

552 #
#­p.
	`exec_
()

553 #
#
 go():

554 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

555 #wšdow = 
	`Pos™iÚ”sPª–
('beamline')

556 #wšdow.
	`show
()

557 
wšdow2
 = 
	`Pos™iÚ”sPª–
('ES')

558 
wšdow2
.
	`show
()

560 
­p
.
	`exec_
()

563 
def
 
	$´ofe_™
():

567 
´ofe
.
Profe
.
bŸs
 = 9.95500362835e-07

569 
´ofe
.
	`run
('go()', 'testprof.dat')

571 
p
 = 
p¡©s
.
	`Sts
('testprof.dat')

572 
p
.
	`sÜt_¡©s
('cumuÏtive').
	`´št_¡©s
(100)

575 
__Çme__
 == '__main__':

576 
impÜt
 
´ofe


577 
impÜt
 
p¡©s


578 
	`log_to_qt
()

579 
	`go
()

	@widgets/motorPanel.py

2 
C»©ed
 
	gÚ
 2014-07-15

4 @
	gauthÜ
: 
b”gr


6 
impÜt
 
sys


7 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
	guic
, 
	gQtWidg‘s


9 
impÜt
 
	gtime


10 
impÜt
 
	gQueue


11 
impÜt
 
	g©ex™


13 #äom 
bcm
.
´ÙocŞ
.
•ics
.
mÙÜ
 
impÜt
 
MÙÜ
 
as
 
­sMÙÜ


14 #äom 
bcm
.
uts
.
dœli¡
 
impÜt
 dirlist

15 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
bl07ID01
 
impÜt
 
	gMAIN_OBJ
, 
	gPOS_TYPE_BL
, 
	gPOS_TYPE_ES


16 
äom
 
	gşs
.
	g­p_d©a
.
deçuÉs
 
impÜt
 
	grgb_as_hex
, 
	gma¡”_cŞÜs
, 
	gg‘_¡yË


17 #äom 
şs
.
ÿWidg‘s
.
ÿComboBox
 
impÜt
 
ÿ_mbbiComboBoxWidg‘


18 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


20 #äom 
şs
.
­¶iÿtiÚs
.
pyStxm
.
widg‘s
.
¥fbk_sm®l
 
impÜt
 spfbk_small

21 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	gwidg‘s
.
¥fbk_sm®l
 
impÜt
 
Ui_FÜm
 
as
 
	g¥fbk_sm®l


23 #mÙÜ 
š‹º®
 
¡©us


24 
	gNONFLOAT
, 
	gOUTSIDE_LIMITS
, 
	gUNCONNECTED
 = -13, -12, -11

25 
	gTIMEOUT
, 
	gTIMEOUT_BUTDONE
 = -8, -7

26 
	gUNKNOWN_ERROR
 = -5

27 
DONEW_SOFTLIM
, 
	gDONEW_HARDLIM
 = -4, -3

28 
	gDONE_OK
 = 0

29 
MOVE_BEGUN
, 
	gMOVE_BEGUN_CONFIRMED
 = 0, 1

30 
	gNOWAIT_SOFTLIM
, 
	gNOWAIT_HARDLIM
 = 4, 3

34 
	g_fbk_nÙ_movšg
 = 
ma¡”_cŞÜs
['app_blue']

37 
_fbk_movšg
 = "rgb(254, 233, 0);"

38 #£tu°
moduË
 
logg”
 
w™h
 
a
  do-
nÙhšg
 
hªdËr


39 
_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

42 
şass
 
	$Pos™iÚ”sPª–
(
QtWidg‘s
.
QWidg‘
):

44 
This
 
is
 
a
 
widg‘
 
th©
 
kes
 
äom
 
the
 
¬g
 'pos™iÚ”_£t'h
pos™iÚ”s
 
to
 
f‹r
 fromhe

45 
ma¡”
 
deviû
 
li¡
 
š
 
the
 
maš
 
objeù
. 
This
 
®lows
 
this
 
Pª–
 
to
 
´e£Á
 
a
 
·Ãl
 
of
 
End¡©iÚ
 
Ü
 
B—mlše


46 
pos™iÚ”s
 
d•’dšg
.

47 
pos™iÚ”_£t
='endstation'

48 :
·¿m
 
pos™iÚ”_£t
: 
a
 
¡ršg
 
th©
 
is
 
u£d
 
to
 
decide
 
which
 
pos™iÚ”s
Ø
šşude
 
Ú
 
the
 
·Ãl
. 
SuµÜ‹d


49 
İtiÚs
 
¬e
:

53 :
ty³
 
¡ršg
:

55 :
»tuºs
: 
NÚe


57 
def
 
	`__š™__
(
£lf
, 
pos™iÚ”_£t
='ES', 
exşude_li¡
=[]):

58 
	`su³r
(
Pos™iÚ”sPª–
, 
£lf
).
	`__š™__
()

61 #£lf.
exşude_li¡
 = ['_ZonePlateZ_base', 'SampleFineX', 'SampleFineY', 'CoarseX.X', 'CoarseY.Y', 'AUX1','AUX2','Cff','PeemM3Trans']

62 
£lf
.
exşude_li¡
 =ƒxclude_list

63 #£lf.
bl_li¡
 = ['EPUPolarization', 'EPUGap', 'SlitY', 'SlitX', 'EPUOffset', 'EPUHarmonic', 'EPUFollowing', \

64 #'
B¿nch
', '
G¿tšg
', '
Cff
', '
AUX1
', '
AUX2
','
MÚoT¿ns
', '
P“mM3T¿ns
', '
M3STXMP™ch
'] 

66 
£lf
.
’um_li¡
 = ['EPUPolarization', 'EPUHarmonic', 'Branch' ]

68 
£lf
.
fbk_’abËd
 = 
F®£


69 
£lf
.
pos™iÚ”_£t
 =…ositioner_set

70 
£lf
.
mŒ
 = 
NÚe


71 
£lf
.
mŒlib
 = 
NÚe


73 
£lf
.
vbox
 = 
QtWidg‘s
.
	`QVBoxLayout
()

74 
£lf
.
vbox
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

75 
£lf
.
vbox
.
	`£tS·cšg
(0)

77 
£lf
.
¡yËBŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
('Update Style')

78 
£lf
.
¡yËBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_upd©e_¡yË
)

80 #£lf.
vbox
.
	`addWidg‘
(
£lf
.
¡yËBŠ
)

81 
£lf
.
upd©eQueue
 = 
Queue
.
	`Queue
()

83 
£lf
.
upd©eTim”
 = 
QtCÜe
.
	`QTim”
()

84 
£lf
.
upd©eTim”
.
timeout
.
	`cÚÃù
(£lf.
upd©e_widg‘s
)

87 
£lf
.
	`£tLayout
(£lf.
vbox
)

88 
£lf
.
mŒ_diù
 = {
	}
}

89 #£lf.
qssh“t
 = 
g‘_¡yË
('dark')

90 #£lf.
£tStyËSh“t
(
£lf
.
qssh“t
)

92 
devs
 = 
MAIN_OBJ
.
g‘_deviûs
()

93 #DEVICE_CFG.
g‘_deviû_li¡
()

94 
pos_keys
 = 
devs
['POSITIONERS'].
keys
()

95 
pos_keys
.
sÜt
()

96 
dev
 
š
 
pos_keys
:

97 #´šˆ
dev


98 if(
dev
 
š
 
£lf
.
exşude_li¡
):

101 
u£this
 = 
F®£


102 
mŒ
 = 
MAIN_OBJ
.
deviû
(
dev
)

103 if(
£lf
.
pos™iÚ”_£t
.
fšd
(
POS_TYPE_BL
) > -1):

104 if(
mŒ
.
_pos_£t
 =ğ
POS_TYPE_BL
):

105 
u£this
 = 
True


107 if(
£lf
.
pos™iÚ”_£t
.
fšd
(
POS_TYPE_ES
) > -1):

108 if(
mŒ
.
_pos_£t
 =ğ
POS_TYPE_ES
):

109 
u£this
 = 
True


111 if(
u£this
):

112 #if(
dev
 
š
 
£lf
.
’um_li¡
):

113 #cbox = 
ÿ_mbbiComboBoxWidg‘
(
mŒ
.
g‘_Çme
(), 
hdrText
='Mode')

114 #£lf.
vbox
.
addWidg‘
(
cbox
)

116 #_logg”.
debug
('uic.lßdU˜[%s]' % 
dev
)

117 #dev_u˜ğ
uic
.
lßdUi
(
r
'C:\controls\py2.7\Beamlines\sm\stxm_control\widgets\ui\spfbk_small.ui')

118 
	gwidg
 = 
QtWidg‘s
.
QWidg‘
()

119 
dev_ui
 = 
¥fbk_sm®l
()

120 
dev_ui
.
£tupUi
(
widg
)

122 #dev_ui.
£tPosFld
.
š¡®lEv’tF‹r
(
F‹r
())

123 #mŒ = 
MAIN_OBJ
.
deviû
(
dev
)

124 
£lf
.
mŒ_diù
[
mŒ
.
g‘_Çme
()] = ( 
dev
, 
	gdev_ui
, 
	gwidg
, 
	gmŒ
)

125 
	g£lf
.
cÚÃù_mÙÜ_widg‘s
(
dev
, 
dev_ui
, 
widg
, 
mŒ
)

126 #_logg”.
debug
('DONE uic.lßdU˜[%s]' % 
dev
)

127 #´šˆ'pos™iÚ”: [%s]…vÇm[%s]' % (
dev
, 
mŒ
.
g‘_Çme
())

128 
	g£lf
.
	gupd©eTim”
.
¡¬t
(100)

129 
	g£lf
.
	gfbk_’abËd
 = 
True


130 #£lf.
lßdMÙÜCÚfig
(
pos™iÚ”
)

131 
©ex™
.(
£lf
.
Ú_ex™
)

133 
def
 
	$Ú_ex™
(
£lf
):

135 
·ss


138 
def
 
	$Ú_upd©e_¡yË
(
£lf
):

140 
£lf
.
qssh“t
 = 
	`g‘_¡yË
('dark')

141 
£lf
.
	`£tStyËSh“t
(£lf.
qssh“t
)

143 
def
 
	$cÚÃù_mÙÜ_widg‘s
(
£lf
, 
Çme
, 
mŒ_ui
, 
widg
, 
mŒ
):

144 
_logg”
.
	`debug
('cÚÃù_mÙÜ_widg‘s[%s]' % 
Çme
)

145 #cÚÃù 
bŠ
 
hªdËrs


146 #hlm = 
mŒ
.
	`g‘
('HLM')

147 #Îm = 
mŒ
.
	`g‘
('LLM')

148 
desc
 = 
mŒ
.
	`g‘
('DESC')

149 
pv_Çme
 = 
mŒ
.
	`g‘_Çme
()

150 #ma_¡¸ğ'movabsŞu‹ b‘w“À%.2àªd %.2f' % (
Îm
, 
hlm
)

151 
mŒ_ui
.
¡İBŠ
.
şicked
.
	`cÚÃù
(
£lf
.
¡İ
)

152 
mŒ_ui
.
d‘asBŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_d‘as
)

153 
mŒ_ui
.
£tPosFld
.
»tuºP»s£d
.
	`cÚÃù
(
£lf
.
Ú_»tuº_´es£d
)

154 #mŒ_ui.
£tPosFld
.
ed™šgFšished
.
	`cÚÃù
(
£lf
.
Ú_ed™šg_fšished
)

156 #mŒ_ui.
£tPosFld
.
	`£tToŞT
(
ma_¡r
)

158 
mŒ_ui
.
£tPosFld
.
	`£tCÚ‹xtM’uPŞicy
(
QtCÜe
.
Qt
.
Cu¡omCÚ‹xtM’u
)

159 
mŒ_ui
.
£tPosFld
.
cu¡omCÚ‹xtM’uReque¡ed
.
	`cÚÃù
(
£lf
.
cÚ‹xtM’uEv’t
)

161 
mŒ_ui
.
mŒNameFld
.
	`£tText
(
Çme
)

162 
mŒ_ui
.
mŒNameFld
.
	`£tToŞT
(
desc
)

163 
mŒ_ui
.
£tPosFld
.
	`£tStusT
(
pv_Çme
)

164 
mŒ_ui
.
¡İBŠ
.
	`£tStusT
(
pv_Çme
)

165 
mŒ_ui
.
d‘asBŠ
.
	`£tStusT
(
pv_Çme
)

167 #_logg”.
	`debug
('addšg c®lback DMOV,RBV fÜ [%s]' % 
Çme
)

168 #if(
	`ha§‰r
(
mŒ
, 'add_callback')):

169 #_logg”.
	`debug
('add_ÿÎback(DMOV [%s]' % 
Çme
)

170 
mŒ
.
	`add_ÿÎback
('DMOV', 
£lf
.
upd©eMovšg
)

171 #_logg”.
	`debug
('add_ÿÎback(RBV [%s]' % 
Çme
)

172 
mŒ
.
	`add_ÿÎback
('RBV', 
£lf
.
upd©eFbk
)

173 #_logg”.
	`debug
('g‘_pos™iÚ(è[%s]' % 
Çme
)

175 #_logg”.
	`debug
('g‘tšg RBV,EGU fÜ [%s]' % 
Çme
)

176 
fbk
 = 
mŒ
.
	`g‘_pos™iÚ
()

177 #_logg”.
	`debug
('add_ÿÎback(EGU [%s]' % 
Çme
)

178 
un™s
 = 
	`¡r
(
mŒ
.
	`g‘
('EGU'))

179 #_logg”.
	`debug
('dÚcÚÃùšg [%s]' % 
Çme
)

180 
s
 = '%6.3f' % 
fbk


181 
mŒ_ui
.
posFbkLbl
.
	`£tText
(
s
)

182 
mŒ_ui
.
un™sLbl
.
	`£tText
(
un™s
)

184 #–if(
	`ha§‰r
(
mŒ
, 'changed')):

185 ##
´št
 'Snd¬d PV: unsuµÜ‹d…os™iÚ” [%s]' % 
Çme


188 #´šˆ'unsuµÜ‹d…os™iÚ” [%s]' % 
Çme


190 
£lf
.
vbox
.
	`addWidg‘
(
widg
)

191 #_logg”.
	`debug
('DÚe[%s] \n\n' % 
Çme
)

193 
def
 
	$Ú_ed™šg_fšished
(
£lf
):

194 
´št
 'on_editing_finished'

196 
def
 
	$upd©e_widg‘s
(
£lf
):

197 
ÿÎ_sk_dÚe
 = 
F®£


198 
nÙ
 
£lf
.
upd©eQueue
.
	$em±y
():

199 
»¥
 = 
£lf
.
upd©eQueue
.
	`g‘
()

200 if('£tStyËSh“t' 
š
 
»¥
.
	$keys
()):

201 
ss
 
š
 
»¥
['setStyleSheet']:

202 
widg‘
 = 
ss
[0]

203 
şr_¡r
 = 
ss
[1]

204 #´šˆ'upd©e_widg‘s: s‘StyËSh“t(%s)' % 
şr_¡r


205 
widg‘
.
	`£tStyËSh“t
(
şr_¡r
)

206 
ÿÎ_sk_dÚe
 = 
True


208 if('£tText' 
š
 
»¥
.
	$keys
()):

209 
widg‘
 = 
»¥
['setText'][0]

210 
_¡r
 = 
»¥
['setText'][1]

211 #´šˆ'upd©e_widg‘s: s‘Text(%s)' % 
_¡r


212 
widg‘
.
	`£tText
(
_¡r
)

213 
ÿÎ_sk_dÚe
 = 
True


215 if(
ÿÎ_sk_dÚe
):

216 
£lf
.
upd©eQueue
.
	`sk_dÚe
()

219 
def
 
	$¡İ
(
£lf
):

220 
æd
 = 
£lf
.
	`£nd”
()

221 
pvÇme
 = 
	`¡r
(
æd
.
	`¡©usT
())

222 (
dev
, 
dev_ui
, 
widg
, 
mŒ
èğ
£lf
.
mŒ_diù
[
pvÇme
]

223 
mŒ
.
	`¡İ
()

225 
def
 
	$upd©eMovšg
(
£lf
, **
kw¬gs
):

227 
™
 
wl
 
ev’tu®ly
 
sûw
 
up
 
‹h
 
maš
 
GUI
 
th»ad


228 
H’û
 
the
 
u£
 
of
 
a
 
Queue
 
ªd
 
QTim”


230 
pvÇme
 = 
kw¬gs
['pvÇme'].
	`¥l™
('.')[0]

231 (
dev
, 
dev_ui
, 
widg
, 
mŒ
èğ
£lf
.
mŒ_diù
[
pvÇme
]

232 
v®
 = (
kw¬gs
['value'])

233 
txt_şr
 = "color: black;"

234 #thi 
is
 
the
 
DMOV
 
Ü
 
DONE
 
Movšg
, 
I
 
wªt
 Movšg 
so
 
šv”t
 
logic


235 if(
v®
):

236 
şr_¡r
 = 
_fbk_nÙ_movšg


239 
şr_¡r
 = 
_fbk_movšg


242 
_dù
 = {
	}
}

243 
_dù
['£tStyËSh“t'] = [(
dev_ui
.
mŒNameFld
, "background-cŞÜ: " + 
şr_¡r
), (dev_ui.
posFbkLbl
, 
txt_şr
)]

244 
	g£lf
.
	gupd©eQueue
.
put_nowa™
(
_dù
)

248 
def
 
	$upd©eFbk
(
£lf
, **
kw¬gs
):

250 
™
 
wl
 
ev’tu®ly
 
sûw
 
up
 
‹h
 
maš
 
GUI
 
th»ad


251 
H’û
 
the
 
u£
 
of
 
a
 
Queue
 
ªd
 
QTim”


253 if(
£lf
.
fbk_’abËd
 
is
 
True
):

254 
pvÇme
 = 
kw¬gs
['pvÇme'].
	`¥l™
('.')[0]

255 (
dev
, 
dev_ui
, 
widg
, 
mŒ
èğ
£lf
.
mŒ_diù
[
pvÇme
]

256 
v®
 = (
kw¬gs
['value'])

257 
s
 = '%6.3f' % 
v®


258 
_dù
 = {
	}
}

259 
_dù
['£tText'] = (
dev_ui
.
posFbkLbl
, 
	gs
)

260 
	g£lf
.
	gupd©eQueue
.
put_nowa™
(
_dù
)

262 
def
 
	$Ú_»tuº_´es£d
(
£lf
):

263 
æd
 = 
£lf
.
	`£nd”
()

264 
pvÇme
 = 
	`¡r
(
æd
.
	`¡©usT
())

265 (
dev
, 
dev_ui
, 
widg
, 
mŒ
èğ
£lf
.
mŒ_diù
[
pvÇme
]

266 
pos
 = (
	`¡r
(
£lf
.
	`£nd”
().
	`‹xt
()))

267 
¡s
 = 
mŒ
.
	`move
(
pos
)

269 if(
¡s
 =ğ
OUTSIDE_LIMITS
):

270 #outsid
the
 
lim™s


271 
şr_¡r
 = "yellow;"

273 
şr_¡r
 = "white;"

275 
_dù
 = {
	}
}

276 
_dù
['£tStyËSh“t'] = [(
dev_ui
.
£tPosFld
, "background-cŞÜ: " + 
şr_¡r
)]

277 
	g£lf
.
	gupd©eQueue
.
put_nowa™
(
_dù
)

279 
def
 
	$check_soá_lim™s
(
£lf
, 
mŒ
, 
¥
):

280 
lvio
 = 
mŒ
.
	`g‘
('LVIO')

281 if(
lvio
 == 0):

282 (
True
)

284 (
F®£
)

286 
def
 
	$cÚ‹xtM’uEv’t
(
£lf
, 
ev’t
):

287 
æd
 = 
£lf
.
	`£nd”
()

288 if(
æd
):

289 
pvÇme
 = 
	`¡r
(
æd
.
	`¡©usT
())

290 (
dev
, 
dev_ui
, 
widg
, 
mŒ
èğ
£lf
.
mŒ_diù
[
pvÇme
]

292 #£lf.
_pvs
['VAL'].
cÚÃùed


293 if(
mŒ
.
_pvs
['VAL'].
cÚÃùed
):

294 
hlm
 = 
mŒ
.
	`g‘
('HLM')

295 
Îm
 = 
mŒ
.
	`g‘
('LLM')

297 if((
Îm
 
is
 
nÙ
 
NÚe
è
	$ªd
 (
hlm
 
is
 
nÙ
 
NÚe
)):

298 
ma_¡r
 = 'mov% absŞu‹ b‘w“À%.2àªd %.2f' % (
dev
, 
Îm
, 
hlm
)

300 
ma_¡r
 = 'MÙÜ % nÙ cÚÃùed' % (
dev
)

302 
£lf
.
m’u
 = 
QtWidg‘s
.
	`QM’u
(self)

303 
»ÇmeAùiÚ
 = 
QtWidg‘s
.
	`QAùiÚ
(
ma_¡r
, 
£lf
)

304 
»ÇmeAùiÚ
.
Œigg”ed
.
	`cÚÃù
(
£lf
.
»ÇmeSlÙ
)

305 
£lf
.
m’u
.
	`addAùiÚ
(
»ÇmeAùiÚ
)

306 #add 
Ùh”
 
»quœed
 
aùiÚs


307 
£lf
.
m’u
.
	`pİup
(
QtWidg‘s
.
QCursÜ
.
	`pos
())

310 
def
 
	$»ÇmeSlÙ
(
£lf
):

311 
´št
 "renaming slot called"

312 #g‘ 
the
 
£Ëùed
 
ûÎ
 
ªd
 
³rfÜm
 
»Çmšg


315 
def
 
	$Ú_d‘as
(
£lf
):

316 
æd
 = 
£lf
.
	`£nd”
()

317 
pvÇme
 = 
	`¡r
(
æd
.
	`¡©usT
())

318 (
dev
, 
dev_ui
, 
widg
, 
mŒ
èğ
£lf
.
mŒ_diù
[
pvÇme
]

319 #dev_u˜ğ
uic
.
	`lßdUi
(
r
'C:\controls\py2.7\Beamlines\sm\stxm_control\widgets\ui\spfbk_detail.ui')

320 
d‘FÜm
 = 
	`Pos™iÚ”D‘a
(
dev
, 
dev_ui
, 
mŒ
)

321 
d‘FÜm
.
	`exec_
()

325 
şass
 
	$Pos™iÚ”D‘a
(
QtWidg‘s
.
QDŸlog
):

327 
şassdocs


329 
def
 
	$__š™__
(
£lf
, 
pos™iÚ”
, 
dev_ui
, 
mŒ
):

330 
	`su³r
(
Pos™iÚ”D‘a
, 
£lf
).
	`__š™__
()

331 
uic
.
	`lßdUi
(
r
'C:\cÚŒŞs\py2.7\B—mlšes\sm\¡xm_cÚŒŞ\widg‘s\ui\¥fbk_d‘a.ui', 
£lf
)

332 
£lf
.
mŒ
 = mtr

333 
£lf
.
pos™iÚ”
 =…ositioner

334 
£lf
.
dev_ui
 = dev_ui

335 #lßd 
the
 
MÙÜ
.
cfg
 
fe


337 #cÚÃù 
bŠ
 
hªdËrs


338 
£lf
.
¡İBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_¡İ_bŠ
)

339 
£lf
.
ÿlBŠ
.
şicked
.
	`cÚÃù
(£lf.
ÿlib¿‹
)

340 
£lf
.
goHomeBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_home_bŠ
)

341 
£lf
.
fÜûC®ib¿‹dBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_fÜû_ÿlib¿‹d
)

342 
£lf
.
z”oMŒBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_z”o_mÙÜ
)

343 
£lf
.
ÚOffBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú
)

344 
£lf
.
mŒG½Box
.
şicked
.
	`cÚÃù
(£lf.
Ú_’abË
)

345 
£lf
.
domovesBŠ
.
şicked
.
	`cÚÃù
(£lf.
do_moves
)

347 
£lf
.
»lS‘poštFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_move_»l_pos™iÚ
)

348 
£lf
.
£oštFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_move_to_pos™iÚ
)

349 
£lf
.
£tPosFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_£t_pos™iÚ
)

350 
£lf
.
v–Fld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_£t_v–o
)

354 
def
 
	`lßdMÙÜCÚfig
(
£lf
, 
pos™iÚ”
='AbsSampleX'):

355 
pos™iÚ”
 = 
	`¡r
(positioner)

357 if(
£lf
.
mŒ
 !ğ
NÚe
):

358 
£lf
.
mŒ
.
chªged
.
	`discÚÃù
()

359 
£lf
.
mŒ
.
¡©us
.
	`discÚÃù
()

360 
	`d–
(
£lf
.
mŒ
)

361 
£lf
.
mŒ
 = 
NÚe


362 
£lf
.
mŒNameFld
.
	`£tText
(
pos™iÚ”
)

363 
£lf
.
un™sLbl
.
	`£tText
(£lf.
un™s
)

364 
£lf
.
mŒ
 = s–f.
deviûs
[
pos™iÚ”
]

365 
£lf
.
	`lßdP¬amsToGui
(£lf.
mŒ
)

366 #£lf.
mŒ
.
chªged
.
	`cÚÃù
(
£lf
.
upd©eFbk
)

368 
£lf
.
mŒ
.
chªged
.
	`cÚÃù
(£lf.
Ú_chªge
)

369 
£lf
.
mŒ
.
ÿlib_chªged
.
	`cÚÃù
(£lf.
check_ÿlibd
)

370 
£lf
.
mŒ
.
¡©us
.
	`cÚÃù
(£lf.
Ú_¡©us
)

371 
£lf
.
mŒ
.
movšg
.
	`cÚÃù
(£lf.
Ú_movšg
)

372 
£lf
.
mŒ
.
log_msg
.
	`cÚÃù
(£lf.
Ú_log_msg
)

374 
£lf
.
moveTh»ad
 = 
QtCÜe
.
	`QTh»ad
()

375 
£lf
.
sÿnObj
 = 
	`sÿnTh»ad
(£lf.
mŒ
)

376 
£lf
.
sÿnObj
.
	`moveToTh»ad
(£lf.
moveTh»ad
)

377 
£lf
.
sÿnObj
.
dÚe
.
	`cÚÃù
(£lf.
Ú_sÿn_dÚe
)

378 
£lf
.
moveTh»ad
.
¡¬‹d
.
	`cÚÃù
(£lf.
sÿnObj
.
do_moves
)

379 
£lf
.
moveTh»ad
.
‹rmš©ed
.
	`cÚÃù
(£lf.
move_‹rmš©ed
)

380 
£lf
.
q
 = 
QtCÜe
.
	`QEv’tLoİ
()

384 
def
 
	$lßdP¬amsToGui
(
£lf
, 
mŒ
):

385 
£lf
.
posFbkLbl
.
	`£tText
('%.3f' % (£lf.
mŒ
.
pos™iÚ
))

386 
£lf
.
z”oOff£tLbl
.
	`£tText
('%.6f' % (£lf.
mŒ
.
un™_off£t
))

387 
£lf
.
absPosLbl
.
	`£tText
(
	`¡r
('%.3f' % (£lf.
mŒ
.
abs_pos™iÚ
)))

388 
£lf
.
’cSlİeLbl
.
	`£tText
(
	`¡r
('%.6f' % (£lf.
mŒ
.
’c_¦İe
)))

389 
£lf
.
ÃgWšdowLbl
.
	`£tText
(
	`¡r
('%.3f' % (£lf.
mŒ
.
ÃgWšdow
)))

390 
£lf
.
posWšdowLbl
.
	`£tText
(
	`¡r
('%.3f' % (£lf.
mŒ
.
posWšdow
)))

392 
£lf
.
v–FbkLbl
.
	`£tText
(
	`¡r
('%.3f' % (£lf.
mŒ
.
dV–
)))

393 
£lf
.
accFbkLbl
.
	`£tText
(
	`¡r
('%.3f' % (£lf.
mŒ
.
dAcûl
)))

398 
def
 
	$Ú_chªge
(
£lf
, 
v®
):

399 #´šˆ'Ú_chªge: %s: %.2f' % (
pos™iÚ”
, 
v®
)

400 
£lf
.
posFbkLbl
.
	`£tText
('%.3f' % (
v®
))

401 
£lf
.
z”oOff£tLbl
.
	`£tText
('%.6f' % (£lf.
mŒ
.
un™_off£t
))

402 
£lf
.
absPosLbl
.
	`£tText
(
	`¡r
('%.3f' % (£lf.
mŒ
.
abs_pos™iÚ
)))

403 
£lf
.
’cSlİeLbl
.
	`£tText
(
	`¡r
('%.6f' % (£lf.
mŒ
.
’c_¦İe
)))

404 
£lf
.
ÃgWšdowLbl
.
	`£tText
(
	`¡r
('%.3f' % (£lf.
mŒ
.
ÃgWšdow
)))

405 
£lf
.
posWšdowLbl
.
	`£tText
(
	`¡r
('%.3f' % (£lf.
mŒ
.
posWšdow
)))

407 
£lf
.
v–FbkLbl
.
	`£tText
(
	`¡r
('%.3f' % (£lf.
mŒ
.
dV–
)))

408 
£lf
.
accFbkLbl
.
	`£tText
(
	`¡r
('%.3f' % (£lf.
mŒ
.
dAcûl
)))

409 #£lf.
	`check_ÿlibd
()

411 
def
 
	$Ú_log_msg
(
£lf
, 
msg
):

412 
£lf
.
logSŒšgLbl
.
	`£tText
(
	`¡r
(
msg
))

414 
def
 
	$ş—r_”rÜ
(
£lf
):

415 
£lf
.
logSŒšgLbl
.
	`£tText
('')

417 #deà
	`Ú_¡©us
(
£lf
, 
pos™iÚ”
, 
¡©us
):

418 #if(
£lf
.
mŒ
 !ğ
NÚe
):

419 #£lf.
¡©usLbl
.
	`£tText
(
	`¡r
(
¡©us
))

421 
def
 
	$Ú_’abË
(
£lf
, 
is_checked
):

422 
£lf
.
mŒ
.
	`£t_’abË
(
is_checked
)

424 
def
 
	$Ú_¡©us
(
£lf
, 
¡©us
):

425 if(
£lf
.
mŒ
 !ğ
NÚe
):

426 
£lf
.
¡©usLbl
.
	`£tText
(
	`¡r
(
¡©us
))

428 
def
 
	$Ú_movšg
(
£lf
, 
is_movšg
):

429 if(
is_movšg
):

430 
şr
 = 
QtGui
.
	`QCŞÜ
(255,0,0è#(
r
,
g
,
b
)

432 
şr
 = 
QtGui
.
	`QCŞÜ
(130,130,130è#(
r
,
g
,
b
)

433 
£lf
.
	`ş—r_”rÜ
()

434 #if(
£lf
.
isdiff
 !ğ
is_movšg
):

435 #objg¿ph.
	`show_growth
()

436 
£lf
.
isdiff
 = 
is_movšg


437 
£lf
.
movšgWgt
.
	`£tStyËSh“t
("QWidg‘ { background-cŞÜ: % }" % 
şr
.
	`Çme
())

439 
def
 
	$check_ÿlibd
(
£lf
, 
ÿl
):

440 if(
ÿl
):

441 
şr
 = 
QtGui
.
	`QCŞÜ
(0,255,0è#(
r
,
g
,
b
)

443 
şr
 = 
QtGui
.
	`QCŞÜ
(255,0,0è#(
r
,
g
,
b
)

444 
£lf
.
ÿlib¿‹dWgt
.
	`£tStyËSh“t
("QWidg‘ { background-cŞÜ: % }" % 
şr
.
	`Çme
())

446 
def
 
	$Ú_z”o_mÙÜ
(
£lf
):

447 if(
£lf
.
mŒ
 !ğ
NÚe
):

448 
£lf
.
mŒ
.
	`z”o_mÙÜ
()

450 
def
 
	$Ú_fÜû_ÿlib¿‹d
(
£lf
):

451 if(
£lf
.
mŒ
 !ğ
NÚe
):

452 
£lf
.
mŒ
.
	`fÜû_ÿlib¿‹d
()

454 
def
 
	$Ú_£t_v–o
(
£lf
):

455 if(
£lf
.
mŒ
 !ğ
NÚe
):

456 
v®
 = (
	`¡r
(
£lf
.
v–Fld
.
	`‹xt
()))

457 
£lf
.
mŒ
.
	`£t_v–oc™y
(
v®
)

459 
def
 
	$Ú_£t_sÿn_¡¬t
(
£lf
):

460 if(
£lf
.
mŒ
 !ğ
NÚe
):

461 
¡¹v®
 = (
	`¡r
(
£lf
.
sÿnS¹Fld
.
	`‹xt
()))

462 
ºgv®
 = (
	`¡r
(
£lf
.
¿ngeFld
.
	`‹xt
()))

464 
ûÁ”x
 = 
¡¹v®
 + (0.5 * 
ºgv®
)

465 if(
ºgv®
 > 80):

466 
£lf
.
mŒ
.
	`£t_fÜ_cßr£_sÿn
(
True
, 
ûÁ”x
)

468 
£lf
.
mŒ
.
	`£t_fÜ_cßr£_sÿn
(
F®£
, 
ûÁ”x
)

470 
£lf
.
mŒ
.
	`move_to_fšesÿn_¡¬t
(
ûÁ”x
, 
ºgv®
)

471 
£lf
.
mŒ
.
	`£t_m¬k”
(
¡¹v®
)

473 
def
 
	$Ú_move_to_pos™iÚ
(
£lf
):

474 if(
£lf
.
mŒ
 !ğ
NÚe
):

475 
´št
 ''

476 
v®
 = (
	`¡r
(
£lf
.
£oštFld
.
	`‹xt
()))

478 
£lf
.
mŒ
.
	`move_to
(
v®
, 
wa™
=
True
)

481 
def
 
	$Ú_move_»l_pos™iÚ
(
£lf
):

482 if(
£lf
.
mŒ
 !ğ
NÚe
):

483 
v®
 = (
	`¡r
(
£lf
.
»lS‘poštFld
.
	`‹xt
()))

484 
£lf
.
mŒ
.
	`move_by
(
v®
, 
wa™
=
True
)

486 
def
 
	$Ú_£t_pos™iÚ
(
£lf
):

487 if(
£lf
.
mŒ
 !ğ
NÚe
):

488 
v®
 = (
	`¡r
(
£lf
.
£tPosFld
.
	`‹xt
()))

489 
£lf
.
mŒ
.
	`£t_pos™iÚ
(
v®
)

491 
def
 
	$Ú_¡İ_bŠ
(
£lf
):

492 if(
£lf
.
mŒ
 !ğ
NÚe
):

493 #£lf.
mŒ
.
	`£t_fÜ_cßr£_sÿn
(
True
, -46.7)

494 
£lf
.
mŒ
.
	`¡İ
()

496 
def
 
	$Ú_home_bŠ
(
£lf
):

497 if(
£lf
.
mŒ
 !ğ
NÚe
):

498 
£lf
.
mŒ
.
	`go_home
()

499 #£lf.
mŒ
.
	`£t_fÜ_cßr£_sÿn
(
F®£
, -46.7)

501 
def
 
	$¡İ
(
£lf
):

502 if(
£lf
.
mŒ
 !ğ
NÚe
):

503 
£lf
.
mŒ
.
	`_¡İ_mÙÜ
()

505 
def
 
	$ÿlib¿‹
(
£lf
):

506 if(
£lf
.
mŒ
 !ğ
NÚe
):

507 
£lf
.
mŒ
.
	`ÿlib¿‹
()

509 
def
 
	$goHome
(
£lf
):

510 if(
£lf
.
mŒ
 !ğ
NÚe
):

511 
£lf
.
mŒ
.
	`go_home
(
wa™
=
F®£
)

513 
def
 
	$Ú_sÿn_dÚe
(
£lf
):

514 
´št
 'on_scan_done: called'

515 
£lf
.
q
.
	`qu™
()

517 
def
 
	$Ú
(
£lf
, 
ischecked
):

518 if(
£lf
.
mŒ
 !ğ
NÚe
):

519 if(
ischecked
):

520 
£lf
.
mŒ
.
	`mÙÜ_Ú
()

522 
£lf
.
mŒ
.
	`mÙÜ_off
()

524 
def
 
	$do_moves
(
£lf
):

525 
£lf
.
moveTh»ad
.
	`¡¬t
()

527 
£lf
.
q
.
	`exec_
()

528 
´št
 'after self.q.exec_()'

529 #£lf.
moveTh»ad
.
dÚe
.
	`discÚÃù
()

530 
£lf
.
moveTh»ad
.
	`wa™
(50)

531 
£lf
.
moveTh»ad
.
	`‹rmš©e
()

532 
´št
 'done'

533 #objg¿ph.
	`show_growth
()

535 
def
 
	$move_‹rmš©ed
(
£lf
):

536 
´št
 'self.moveThread: finallyhis sucker died'

538 
def
 
	$Ú_ex™
(
£lf
):

539 
·ss


540 #£lf.
moveTh»ad
.
	`wa™
(50)

541 #£lf.
moveTh»ad
.
	`qu™
()

542 #£lf.
moveTh»ad
.
	`‹rmš©e
()

543 #if(
£lf
.
mŒ
 
is
 
nÙ
 
NÚe
):

544 #£lf.
mŒ
.
	`şo£_mŒ
()

546 #ià
__Çme__
 == '__main__':

547 #
#­°ğ
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

548 #wšdow = 
	`Pos™iÚ”sPª–
('beamline')

549 #wšdow.
	`show
()

550 #wšdow2 = 
	`Pos™iÚ”sPª–
('endstation')

551 #wšdow2.
	`show
()

552 #
#­p.
	`exec_
()

553 #
#
 go():

554 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

555 #wšdow = 
	`Pos™iÚ”sPª–
('beamline')

556 #wšdow.
	`show
()

557 
wšdow2
 = 
	`Pos™iÚ”sPª–
('ES')

558 
wšdow2
.
	`show
()

560 
­p
.
	`exec_
()

563 
def
 
	$´ofe_™
():

567 
´ofe
.
Profe
.
bŸs
 = 9.95500362835e-07

569 
´ofe
.
	`run
('go()', 'testprof.dat')

571 
p
 = 
p¡©s
.
	`Sts
('testprof.dat')

572 
p
.
	`sÜt_¡©s
('cumuÏtive').
	`´št_¡©s
(100)

575 
__Çme__
 == '__main__':

576 
impÜt
 
´ofe


577 
impÜt
 
p¡©s


578 
	`log_to_qt
()

579 
	`go
()

	@widgets/paramLineEdit.py

2 
C»©ed
 
Ú
 
	gJun
 8, 2016

4 @
	gauthÜ
: 
b”gr


7 
C»©ed
 
Ú
 
Jun
 3, 2016

9 @
	gauthÜ
: 
b”gr


14 
impÜt
 
sys


15 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
	gQtWidg‘s


16 #äom 
PyQt5
.
QtCÜe
 
impÜt
 *

17 #äom 
PyQt5
.
QtGui
 
impÜt
 *

19 
	gšv®id_ss
 = 'QLineEdit{background:„gb(140, 177, 255);}'

20 
v®id_ss
 = 'QLineEdit{background:„gb(255, 255, 255);}'

23 
şass
 
	$štP¬amV®id©Ü
(
QtGui
.
QIÁV®id©Ü
):

24 #¡©e_chªged = 
	`pyqtSigÇl
(
objeù
)

25 
def
 
	$__š™__
(
£lf
, 
_mš
, 
_max
, 
´ec
, 
qobj
=
NÚe
,
lšeFld
=None):

26 
QtGui
.
QIÁV®id©Ü
.
	`__š™__
(
£lf
)

27 
£lf
.
	`£tRªge
(
_mš
, 
_max
)

28 
£lf
.
chªges_locked
 = 
F®£


30 
def
 
	$is_dÚe
(
£lf
):

31 (
£lf
.
chªges_locked
)

33 
def
 
	$lock_chªges
(
£lf
, 
lock
):

34 
£lf
.
chªges_locked
 = 
lock


36 #deà
	`do_v®id©e
(
£lf
, 
šput
, 
pos
):

37 #¡©e, 
pos
 = 
QtWidg‘s
.
QIÁV®id©Ü
.
	`v®id©e
(
£lf
, 
šput
,…os)

38 #if(
šput
.
	`isEm±y
()):

39 #»tuº 
QtWidg‘s
.
QV®id©Ü
.
IÁ”medŸ‹
, 
pos


40 #
#if((
¡©e
 =ğ
QtWidg‘s
.
QV®id©Ü
.
IÁ”medŸ‹
è
ªd
 
šput
 == '-'):

41 #»tuº 
QtWidg‘s
.
QV®id©Ü
.
IÁ”medŸ‹
, 
pos


42 #
#if(
¡©e
 !ğ
QtWidg‘s
.
QV®id©Ü
.
Acû±abË
):

43 ##
´št
 'input invalid'

44 #»tuº 
QtWidg‘s
.
QV®id©Ü
.
Inv®id
, 
pos


46 ##
´št
 'input‡cceptable'

47 #»tuº 
QtWidg‘s
.
QV®id©Ü
.
Acû±abË
, 
pos


50 
şass
 
	$dblP¬amV®id©Ü
(
QtGui
.
QDoubËV®id©Ü
):

51 #¡©e_chªged = 
	`pyqtSigÇl
(
objeù
)

52 
def
 
	$__š™__
(
£lf
, 
_mš
, 
_max
, 
´ec
, 
qobj
=
NÚe
,
lšeFld
=None):

53 
QtGui
.
QDoubËV®id©Ü
.
	`__š™__
(
£lf
)

54 
£lf
.
	`£tRªge
(
_mš
, 
_max
, 
´ec
)

55 
£lf
.
chªges_locked
 = 
F®£


57 
def
 
	$is_dÚe
(
£lf
):

58 (
£lf
.
chªges_locked
)

60 
def
 
	$lock_chªges
(
£lf
, 
lock
):

61 
£lf
.
chªges_locked
 = 
lock


63 #deà
	`do_v®id©e
(
£lf
, 
šput
, 
pos
):

64 #¡©e, 
pos
 = 
QtWidg‘s
.
QDoubËV®id©Ü
.
	`v®id©e
(
£lf
, 
šput
,…os)

65 #if(
šput
.
	`isEm±y
(è
Ü
 input == '.'):

66 #»tuº 
QtWidg‘s
.
QV®id©Ü
.
IÁ”medŸ‹
, 
pos


67 #
#if((
¡©e
 =ğ
QtWidg‘s
.
QV®id©Ü
.
IÁ”medŸ‹
è
ªd
 
šput
 == '-'):

68 #»tuº 
QtWidg‘s
.
QV®id©Ü
.
IÁ”medŸ‹
, 
pos


69 #
#if(
¡©e
 !ğ
QtWidg‘s
.
QV®id©Ü
.
Acû±abË
):

70 ##
´št
 'input invalid'

71 #»tuº 
QtWidg‘s
.
QV®id©Ü
.
Inv®id
, 
pos


73 ##
´št
 'input‡cceptable'

74 #»tuº 
QtWidg‘s
.
QV®id©Ü
.
Acû±abË
, 
pos


77 
şass
 
	$štLšeEd™P¬amObj
(
QtCÜe
.
QObjeù
):

78 
v®id_»tuºP»s£d
 = 
QtCÜe
.
	`pyqtSigÇl
()

80 
def
 
	`__š™__
(
£lf
, 
id
, 
_mš
, 
_max
, 
´ec
=0, 
·»Á
=
NÚe
):

81 
QtCÜe
.
QObjeù
.
	`__š™__
(
£lf
)

82 
£lf
.
·»Á
 =…arent

83 
£lf
.
id
 = id

84 
£lf
.
cur_v®
 = (
_mš
 + 
_max
)/2.0

85 
£lf
.
´ec
 =…rec

86 
£lf
.
_mš
 = _min

87 
£lf
.
_max
 = _max

89 #£lf.
·»Á
.
	`£tText
('%d' % ((
_mš
 + 
_max
)/2.0))

90 
£lf
.
·»Á
.
	`£tCÚ‹xtM’uPŞicy
(
QtCÜe
.
Qt
.
Cu¡omCÚ‹xtM’u
)

91 
£lf
.
·»Á
.
cu¡omCÚ‹xtM’uReque¡ed
.
	`cÚÃù
(£lf.
cÚ‹xtM’uEv’t
)

92 
£lf
.
fmt
 = '%d'

94 
£lf
.
·»Á
.
focusInEv’t
 = self.focusInEvent

95 
£lf
.
·»Á
.
focusOutEv’t
 = self.focusOutEvent

97 #£lf.
·»Á
.
	`£tToŞT
('V®id„ªge: from %dØ%d' % (
_mš
, 
_max
))

99 
£lf
.
·»Á
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_št_·»Á_¹º_´es£d
)

100 
£lf
.
·»Á
.
‹xtEd™ed
.
	`cÚÃù
(£lf.
Ú_št_·»Á_chªged
)

102 
v
 = 
	`štP¬amV®id©Ü
(
_mš
, 
_max
, 
NÚe
)

103 
£lf
.
·»Á
.
	`£tV®id©Ü
(
v
)

105 
def
 
	$cÚ‹xtM’uEv’t
(
£lf
, 
ev’t
):

106 
æd
 = 
£lf
.
	`£nd”
()

107 if(
æd
):

108 if((
£lf
.
_mš
 
is
 
nÙ
 
NÚe
è
	$ªd
 (
£lf
.
_max
 
is
 
nÙ
 
NÚe
)):

109 
ma_¡r
 = 'v®id„ªgi b‘w“À%d‡nd %d' % (
£lf
.
_mš
, s–f.
_max
)

111 
ma_¡r
 = 'Motor‚ot connected'

113 
£lf
.
m’u
 = 
QtWidg‘s
.
	`QM’u
(£lf.
·»Á
)

114 
»ÇmeAùiÚ
 = 
QtWidg‘s
.
	`QAùiÚ
(
ma_¡r
, 
£lf
.
·»Á
)

115 
»ÇmeAùiÚ
.
Œigg”ed
.
	`cÚÃù
(
£lf
.
»ÇmeSlÙ
)

116 
£lf
.
m’u
.
	`addAùiÚ
(
»ÇmeAùiÚ
)

117 #add 
Ùh”
 
»quœed
 
aùiÚs


118 
£lf
.
m’u
.
	`pİup
(
QtGui
.
QCursÜ
.
	`pos
())

120 
def
 
	$»ÇmeSlÙ
(
£lf
):

121 
´št
 "renaming slot called"

122 #g‘ 
the
 
£Ëùed
 
ûÎ
 
ªd
 
³rfÜm
 
»Çmšg


124 
def
 
	$focusInEv’t
(
£lf
, 
ev’t
):

126 
£lf
.
cur_v®
 = (
	`¡r
(£lf.
·»Á
.
	`‹xt
()))

127 #£lf.
cur_v®
 = (
	`¡r
(
£lf
.
	`‹xt
()))

128 
QtWidg‘s
.
QLšeEd™
.
	`focusInEv’t
(
£lf
.
·»Á
, 
ev’t
)

130 
def
 
	$focusOutEv’t
(
£lf
, 
ev’t
):

132 
focus
 
is
 
lo¡
 
Ú
 
this
 
f›ld
 
th’
  
the
 
v®ue
 
to
 
™s
 
´evious
 value

133 
ªd
 
£t
 
the
 
background
 
cŞÜ
'''

134 
v
 = 
£lf
.
·»Á
.
	`v®id©Ü
()

135 if(
v
.
	$is_dÚe
()):

136 #v®u
is
 
acû±ed


137 
£lf
.
cur_v®
 = (
	`¡r
(£lf.
·»Á
.
	`‹xt
()))

139 #v®u
has
 
nÙ
 
b“n
 
acû±ed


140 
£lf
.
·»Á
.
	`£tText
(£lf.
fmt
 % s–f.
cur_v®
)

142 
£lf
.
·»Á
.
	`£tStyËSh“t
(
v®id_ss
)

143 
QtWidg‘s
.
QLšeEd™
.
	`focusOutEv’t
(
£lf
.
·»Á
, 
ev’t
)

145 
def
 
	$Ú_št_·»Á_¹º_´es£d
(
£lf
):

146 
£lf
.
cur_v®
 = (
	`¡r
(£lf.
·»Á
.
	`‹xt
()))

147 #´šˆ'§všg [%.3f]' % 
£lf
.
cur_v®


148 
v
 = 
£lf
.
·»Á
.
	`v®id©Ü
()

149 
v
.
	`lock_chªges
(
True
)

150 
£lf
.
·»Á
.
	`£tStyËSh“t
(
v®id_ss
)

151 
£lf
.
v®id_»tuºP»s£d
.
	`em™
()

153 
def
 
	$Ú_št_·»Á_chªged
(
£lf
):

154 
v
 = 
£lf
.
·»Á
.
	`v®id©Ü
()

155 
v
.
	`lock_chªges
(
F®£
)

156 
ss
 = 
šv®id_ss


157 
£lf
.
·»Á
.
	`£tStyËSh“t
(
ss
)

160 
şass
 
	$dblLšeEd™P¬amObj
(
QtCÜe
.
QObjeù
):

161 
v®id_»tuºP»s£d
 = 
QtCÜe
.
	`pyqtSigÇl
()

163 
def
 
	$__š™__
(
£lf
, 
id
, 
_mš
, 
_max
, 
´ec
, 
·»Á
=
NÚe
):

164 
QtCÜe
.
QObjeù
.
	`__š™__
(
£lf
)

165 
£lf
.
·»Á
 =…arent

166 
£lf
.
id
 = id

167 
£lf
.
cur_v®
 = (
_mš
 + 
_max
)/2.0

168 
£lf
.
´ec
 =…rec

169 
£lf
.
_mš
 = _min

170 
£lf
.
_max
 = _max

172 
£lf
.
·»Á
.
	`£tCÚ‹xtM’uPŞicy
(
QtCÜe
.
Qt
.
Cu¡omCÚ‹xtM’u
)

173 
£lf
.
·»Á
.
cu¡omCÚ‹xtM’uReque¡ed
.
	`cÚÃù
(£lf.
cÚ‹xtM’uEv’t
)

175 #£lf.
·»Á
.
	`£tText
('%.2f' % ((
_mš
 + 
_max
)/2.0))

176 
£lf
.
fmt
 = '%.' + '%df' % (£lf.
´ec
)

178 
£lf
.
·»Á
.
focusInEv’t
 = self.focusInEvent

179 
£lf
.
·»Á
.
focusOutEv’t
 = self.focusOutEvent

181 #£lf.
·»Á
.
	`£tToŞT
('V®id„ªge: from %.2àtØ%.2f' % (
_mš
, 
_max
))

183 
£lf
.
·»Á
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_dbl_·»Á_¹º_´es£d
)

184 
£lf
.
·»Á
.
‹xtEd™ed
.
	`cÚÃù
(£lf.
Ú_dbl_·»Á_chªged
)

186 
v
 = 
	`dblP¬amV®id©Ü
(
_mš
, 
_max
, 
£lf
.
´ec
, 
NÚe
)

187 
£lf
.
·»Á
.
	`£tV®id©Ü
(
v
)

189 
def
 
	$cÚ‹xtM’uEv’t
(
£lf
, 
ev’t
):

190 
æd
 = 
£lf
.
	`£nd”
()

191 if(
æd
):

192 if((
£lf
.
_mš
 
is
 
nÙ
 
NÚe
è
	$ªd
 (
£lf
.
_max
 
is
 
nÙ
 
NÚe
)):

193 
ma_¡r
 = 'v®id„ªgi b‘w“À%.2àªd %.2f' % (
£lf
.
_mš
, s–f.
_max
)

195 
ma_¡r
 = 'Motor‚ot connected'

197 
£lf
.
m’u
 = 
QtWidg‘s
.
	`QM’u
(£lf.
·»Á
)

198 
»ÇmeAùiÚ
 = 
QtWidg‘s
.
	`QAùiÚ
(
ma_¡r
, 
£lf
.
·»Á
)

199 
»ÇmeAùiÚ
.
Œigg”ed
.
	`cÚÃù
(
£lf
.
»ÇmeSlÙ
)

200 
£lf
.
m’u
.
	`addAùiÚ
(
»ÇmeAùiÚ
)

201 #add 
Ùh”
 
»quœed
 
aùiÚs


202 
£lf
.
m’u
.
	`pİup
(
QtGui
.
QCursÜ
.
	`pos
())

204 
def
 
	$»ÇmeSlÙ
(
£lf
):

205 
´št
 "renaming slot called"

206 #g‘ 
the
 
£Ëùed
 
ûÎ
 
ªd
 
³rfÜm
 
»Çmšg


208 
def
 
	$focusInEv’t
(
£lf
, 
ev’t
):

210 
£lf
.
cur_v®
 = (
	`¡r
(£lf.
·»Á
.
	`‹xt
()))

211 #£lf.
cur_v®
 = (
	`¡r
(
£lf
.
	`‹xt
()))

212 
QtWidg‘s
.
QLšeEd™
.
	`focusInEv’t
(
£lf
.
·»Á
, 
ev’t
)

214 
def
 
	$focusOutEv’t
(
£lf
, 
ev’t
):

216 
focus
 
is
 
lo¡
 
Ú
 
this
 
f›ld
 
th’
  
the
 
v®ue
 
to
 
™s
 
´evious
 value

217 
ªd
 
£t
 
the
 
background
 
cŞÜ
'''

218 
v
 = 
£lf
.
·»Á
.
	`v®id©Ü
()

219 if(
v
.
	$is_dÚe
()):

220 #v®u
is
 
acû±ed


221 
£lf
.
cur_v®
 = (
	`¡r
(£lf.
·»Á
.
	`‹xt
()))

223 #v®u
has
 
nÙ
 
b“n
 
acû±ed


224 
£lf
.
·»Á
.
	`£tText
(£lf.
fmt
 % s–f.
cur_v®
)

225 
£lf
.
·»Á
.
	`upd©e
()

226 
£lf
.
·»Á
.
	`£tStyËSh“t
(
v®id_ss
)

227 
QtWidg‘s
.
QLšeEd™
.
	`focusOutEv’t
(
£lf
.
·»Á
, 
ev’t
)

229 
def
 
	$Ú_dbl_·»Á_¹º_´es£d
(
£lf
):

230 
£lf
.
cur_v®
 = (
	`¡r
(£lf.
·»Á
.
	`‹xt
()))

231 #´šˆ'§všg [%.3f]' % 
£lf
.
cur_v®


232 
v
 = 
£lf
.
·»Á
.
	`v®id©Ü
()

233 
v
.
	`lock_chªges
(
True
)

234 
£lf
.
·»Á
.
	`£tStyËSh“t
(
v®id_ss
)

235 
£lf
.
v®id_»tuºP»s£d
.
	`em™
()

237 
def
 
	$Ú_dbl_·»Á_chªged
(
£lf
):

238 
v
 = 
£lf
.
·»Á
.
	`v®id©Ü
()

239 
v
.
	`lock_chªges
(
F®£
)

240 
ss
 = 
šv®id_ss


241 
£lf
.
·»Á
.
	`£tStyËSh“t
(
ss
)

246 
şass
 
	$‹¡Wšdow
(
QtWidg‘s
.
QWidg‘
):

248 
şassdocs


250 
def
 
	$__š™__
(
£lf
):

251 
	`su³r
(
‹¡Wšdow
, 
£lf
).
	`__š™__
()

253 
£lf
.
e1
 = 
QtWidg‘s
.
	`QLšeEd™
("0.0")

254 
£lf
.
e2
 = 
QtWidg‘s
.
	`QLšeEd™
("0.0")

255 
£lf
.
e3
 = 
QtWidg‘s
.
	`QLšeEd™
("0.0")

256 
£lf
.
e4
 = 
QtWidg‘s
.
	`QLšeEd™
("0.0")

258 
£lf
.
e1
.
dpo
 = 
	`dblLšeEd™P¬amObj
('e1', -500.0, 123.5, 3, 
·»Á
=self.e1)

259 
£lf
.
e2
.
dpo
 = 
	`dblLšeEd™P¬amObj
('e2', 0.0, 4123.5, 3, 
·»Á
=self.e2)

260 
£lf
.
e3
.
dpo
 = 
	`dblLšeEd™P¬amObj
('e3', 0.0, 63.5, 3, 
·»Á
=self.e3)

261 
£lf
.
e4
.
dpo
 = 
	`dblLšeEd™P¬amObj
('e4', -2000.0, 1993.5, 3, 
·»Á
=self.e4)

264 
£lf
.
e1
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(£lf.
»ÿlc_roi
)

265 
£lf
.
e2
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(£lf.
»ÿlc_roi
)

266 
£lf
.
e3
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(£lf.
»ÿlc_roi
)

267 
£lf
.
e4
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(£lf.
»ÿlc_roi
)

269 
æo
 = 
QtWidg‘s
.
	`QFÜmLayout
()

270 
æo
.
	`addRow
("DoubË v®id©Ü 1",
£lf
.
e1
)

271 
æo
.
	`addRow
("DoubË v®id©Ü 2",
£lf
.
e2
)

272 
æo
.
	`addRow
("DoubË v®id©Ü 3",
£lf
.
e3
)

273 
æo
.
	`addRow
("DoubË v®id©Ü 4",
£lf
.
e4
)

274 
£lf
.
	`£tLayout
(
æo
)

276 
def
 
	$»ÿlc_roi
(
£lf
):

277 
æd
 = 
£lf
.
	`£nd”
()

278 
´št
 '»ÿlcšg„o˜fÜ [%s]„ªg%.2àtØ%.2f' % (
æd
.
id
, fld.
_mš
, fld.
_max
)

280 
__Çme__
 == '__main__':

281 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

282 
wš
 = 
	`‹¡Wšdow
()

284 
wš
.
	`show
()

285 
wš
.
	`£tWšdowT™Ë
("PyQt")

286 
sys
.
	`ex™
(
­p
.
	`exec_
())

	@widgets/paramLineEdit.py

2 
C»©ed
 
Ú
 
	gJun
 8, 2016

4 @
	gauthÜ
: 
b”gr


7 
C»©ed
 
Ú
 
Jun
 3, 2016

9 @
	gauthÜ
: 
b”gr


14 
impÜt
 
sys


15 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
	gQtWidg‘s


16 #äom 
PyQt5
.
QtCÜe
 
impÜt
 *

17 #äom 
PyQt5
.
QtGui
 
impÜt
 *

19 
	gšv®id_ss
 = 'QLineEdit{background:„gb(140, 177, 255);}'

20 
v®id_ss
 = 'QLineEdit{background:„gb(255, 255, 255);}'

23 
şass
 
	$štP¬amV®id©Ü
(
QtGui
.
QIÁV®id©Ü
):

24 #¡©e_chªged = 
	`pyqtSigÇl
(
objeù
)

25 
def
 
	$__š™__
(
£lf
, 
_mš
, 
_max
, 
´ec
, 
qobj
=
NÚe
,
lšeFld
=None):

26 
QtGui
.
QIÁV®id©Ü
.
	`__š™__
(
£lf
)

27 
£lf
.
	`£tRªge
(
_mš
, 
_max
)

28 
£lf
.
chªges_locked
 = 
F®£


30 
def
 
	$is_dÚe
(
£lf
):

31 (
£lf
.
chªges_locked
)

33 
def
 
	$lock_chªges
(
£lf
, 
lock
):

34 
£lf
.
chªges_locked
 = 
lock


36 #deà
	`do_v®id©e
(
£lf
, 
šput
, 
pos
):

37 #¡©e, 
pos
 = 
QtWidg‘s
.
QIÁV®id©Ü
.
	`v®id©e
(
£lf
, 
šput
,…os)

38 #if(
šput
.
	`isEm±y
()):

39 #»tuº 
QtWidg‘s
.
QV®id©Ü
.
IÁ”medŸ‹
, 
pos


40 #
#if((
¡©e
 =ğ
QtWidg‘s
.
QV®id©Ü
.
IÁ”medŸ‹
è
ªd
 
šput
 == '-'):

41 #»tuº 
QtWidg‘s
.
QV®id©Ü
.
IÁ”medŸ‹
, 
pos


42 #
#if(
¡©e
 !ğ
QtWidg‘s
.
QV®id©Ü
.
Acû±abË
):

43 ##
´št
 'input invalid'

44 #»tuº 
QtWidg‘s
.
QV®id©Ü
.
Inv®id
, 
pos


46 ##
´št
 'input‡cceptable'

47 #»tuº 
QtWidg‘s
.
QV®id©Ü
.
Acû±abË
, 
pos


50 
şass
 
	$dblP¬amV®id©Ü
(
QtGui
.
QDoubËV®id©Ü
):

51 #¡©e_chªged = 
	`pyqtSigÇl
(
objeù
)

52 
def
 
	$__š™__
(
£lf
, 
_mš
, 
_max
, 
´ec
, 
qobj
=
NÚe
,
lšeFld
=None):

53 
QtGui
.
QDoubËV®id©Ü
.
	`__š™__
(
£lf
)

54 
£lf
.
	`£tRªge
(
_mš
, 
_max
, 
´ec
)

55 
£lf
.
chªges_locked
 = 
F®£


57 
def
 
	$is_dÚe
(
£lf
):

58 (
£lf
.
chªges_locked
)

60 
def
 
	$lock_chªges
(
£lf
, 
lock
):

61 
£lf
.
chªges_locked
 = 
lock


63 #deà
	`do_v®id©e
(
£lf
, 
šput
, 
pos
):

64 #¡©e, 
pos
 = 
QtWidg‘s
.
QDoubËV®id©Ü
.
	`v®id©e
(
£lf
, 
šput
,…os)

65 #if(
šput
.
	`isEm±y
(è
Ü
 input == '.'):

66 #»tuº 
QtWidg‘s
.
QV®id©Ü
.
IÁ”medŸ‹
, 
pos


67 #
#if((
¡©e
 =ğ
QtWidg‘s
.
QV®id©Ü
.
IÁ”medŸ‹
è
ªd
 
šput
 == '-'):

68 #»tuº 
QtWidg‘s
.
QV®id©Ü
.
IÁ”medŸ‹
, 
pos


69 #
#if(
¡©e
 !ğ
QtWidg‘s
.
QV®id©Ü
.
Acû±abË
):

70 ##
´št
 'input invalid'

71 #»tuº 
QtWidg‘s
.
QV®id©Ü
.
Inv®id
, 
pos


73 ##
´št
 'input‡cceptable'

74 #»tuº 
QtWidg‘s
.
QV®id©Ü
.
Acû±abË
, 
pos


77 
şass
 
	$štLšeEd™P¬amObj
(
QtCÜe
.
QObjeù
):

78 
v®id_»tuºP»s£d
 = 
QtCÜe
.
	`pyqtSigÇl
()

80 
def
 
	`__š™__
(
£lf
, 
id
, 
_mš
, 
_max
, 
´ec
=0, 
·»Á
=
NÚe
):

81 
QtCÜe
.
QObjeù
.
	`__š™__
(
£lf
)

82 
£lf
.
·»Á
 =…arent

83 
£lf
.
id
 = id

84 
£lf
.
cur_v®
 = (
_mš
 + 
_max
)/2.0

85 
£lf
.
´ec
 =…rec

86 
£lf
.
_mš
 = _min

87 
£lf
.
_max
 = _max

89 #£lf.
·»Á
.
	`£tText
('%d' % ((
_mš
 + 
_max
)/2.0))

90 
£lf
.
·»Á
.
	`£tCÚ‹xtM’uPŞicy
(
QtCÜe
.
Qt
.
Cu¡omCÚ‹xtM’u
)

91 
£lf
.
·»Á
.
cu¡omCÚ‹xtM’uReque¡ed
.
	`cÚÃù
(£lf.
cÚ‹xtM’uEv’t
)

92 
£lf
.
fmt
 = '%d'

94 
£lf
.
·»Á
.
focusInEv’t
 = self.focusInEvent

95 
£lf
.
·»Á
.
focusOutEv’t
 = self.focusOutEvent

97 #£lf.
·»Á
.
	`£tToŞT
('V®id„ªge: from %dØ%d' % (
_mš
, 
_max
))

99 
£lf
.
·»Á
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_št_·»Á_¹º_´es£d
)

100 
£lf
.
·»Á
.
‹xtEd™ed
.
	`cÚÃù
(£lf.
Ú_št_·»Á_chªged
)

102 
v
 = 
	`štP¬amV®id©Ü
(
_mš
, 
_max
, 
NÚe
)

103 
£lf
.
·»Á
.
	`£tV®id©Ü
(
v
)

105 
def
 
	$cÚ‹xtM’uEv’t
(
£lf
, 
ev’t
):

106 
æd
 = 
£lf
.
	`£nd”
()

107 if(
æd
):

108 if((
£lf
.
_mš
 
is
 
nÙ
 
NÚe
è
	$ªd
 (
£lf
.
_max
 
is
 
nÙ
 
NÚe
)):

109 
ma_¡r
 = 'v®id„ªgi b‘w“À%d‡nd %d' % (
£lf
.
_mš
, s–f.
_max
)

111 
ma_¡r
 = 'Motor‚ot connected'

113 
£lf
.
m’u
 = 
QtWidg‘s
.
	`QM’u
(£lf.
·»Á
)

114 
»ÇmeAùiÚ
 = 
QtWidg‘s
.
	`QAùiÚ
(
ma_¡r
, 
£lf
.
·»Á
)

115 
»ÇmeAùiÚ
.
Œigg”ed
.
	`cÚÃù
(
£lf
.
»ÇmeSlÙ
)

116 
£lf
.
m’u
.
	`addAùiÚ
(
»ÇmeAùiÚ
)

117 #add 
Ùh”
 
»quœed
 
aùiÚs


118 
£lf
.
m’u
.
	`pİup
(
QtGui
.
QCursÜ
.
	`pos
())

120 
def
 
	$»ÇmeSlÙ
(
£lf
):

121 
´št
 "renaming slot called"

122 #g‘ 
the
 
£Ëùed
 
ûÎ
 
ªd
 
³rfÜm
 
»Çmšg


124 
def
 
	$focusInEv’t
(
£lf
, 
ev’t
):

126 
£lf
.
cur_v®
 = (
	`¡r
(£lf.
·»Á
.
	`‹xt
()))

127 #£lf.
cur_v®
 = (
	`¡r
(
£lf
.
	`‹xt
()))

128 
QtWidg‘s
.
QLšeEd™
.
	`focusInEv’t
(
£lf
.
·»Á
, 
ev’t
)

130 
def
 
	$focusOutEv’t
(
£lf
, 
ev’t
):

132 
focus
 
is
 
lo¡
 
Ú
 
this
 
f›ld
 
th’
  
the
 
v®ue
 
to
 
™s
 
´evious
 value

133 
ªd
 
£t
 
the
 
background
 
cŞÜ
'''

134 
v
 = 
£lf
.
·»Á
.
	`v®id©Ü
()

135 if(
v
.
	$is_dÚe
()):

136 #v®u
is
 
acû±ed


137 
£lf
.
cur_v®
 = (
	`¡r
(£lf.
·»Á
.
	`‹xt
()))

139 #v®u
has
 
nÙ
 
b“n
 
acû±ed


140 
£lf
.
·»Á
.
	`£tText
(£lf.
fmt
 % s–f.
cur_v®
)

142 
£lf
.
·»Á
.
	`£tStyËSh“t
(
v®id_ss
)

143 
QtWidg‘s
.
QLšeEd™
.
	`focusOutEv’t
(
£lf
.
·»Á
, 
ev’t
)

145 
def
 
	$Ú_št_·»Á_¹º_´es£d
(
£lf
):

146 
£lf
.
cur_v®
 = (
	`¡r
(£lf.
·»Á
.
	`‹xt
()))

147 #´šˆ'§všg [%.3f]' % 
£lf
.
cur_v®


148 
v
 = 
£lf
.
·»Á
.
	`v®id©Ü
()

149 
v
.
	`lock_chªges
(
True
)

150 
£lf
.
·»Á
.
	`£tStyËSh“t
(
v®id_ss
)

151 
£lf
.
v®id_»tuºP»s£d
.
	`em™
()

153 
def
 
	$Ú_št_·»Á_chªged
(
£lf
):

154 
v
 = 
£lf
.
·»Á
.
	`v®id©Ü
()

155 
v
.
	`lock_chªges
(
F®£
)

156 
ss
 = 
šv®id_ss


157 
£lf
.
·»Á
.
	`£tStyËSh“t
(
ss
)

160 
şass
 
	$dblLšeEd™P¬amObj
(
QtCÜe
.
QObjeù
):

161 
v®id_»tuºP»s£d
 = 
QtCÜe
.
	`pyqtSigÇl
()

163 
def
 
	$__š™__
(
£lf
, 
id
, 
_mš
, 
_max
, 
´ec
, 
·»Á
=
NÚe
):

164 
QtCÜe
.
QObjeù
.
	`__š™__
(
£lf
)

165 
£lf
.
·»Á
 =…arent

166 
£lf
.
id
 = id

167 
£lf
.
cur_v®
 = (
_mš
 + 
_max
)/2.0

168 
£lf
.
´ec
 =…rec

169 
£lf
.
_mš
 = _min

170 
£lf
.
_max
 = _max

172 
£lf
.
·»Á
.
	`£tCÚ‹xtM’uPŞicy
(
QtCÜe
.
Qt
.
Cu¡omCÚ‹xtM’u
)

173 
£lf
.
·»Á
.
cu¡omCÚ‹xtM’uReque¡ed
.
	`cÚÃù
(£lf.
cÚ‹xtM’uEv’t
)

175 #£lf.
·»Á
.
	`£tText
('%.2f' % ((
_mš
 + 
_max
)/2.0))

176 
£lf
.
fmt
 = '%.' + '%df' % (£lf.
´ec
)

178 
£lf
.
·»Á
.
focusInEv’t
 = self.focusInEvent

179 
£lf
.
·»Á
.
focusOutEv’t
 = self.focusOutEvent

181 #£lf.
·»Á
.
	`£tToŞT
('V®id„ªge: from %.2àtØ%.2f' % (
_mš
, 
_max
))

183 
£lf
.
·»Á
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_dbl_·»Á_¹º_´es£d
)

184 
£lf
.
·»Á
.
‹xtEd™ed
.
	`cÚÃù
(£lf.
Ú_dbl_·»Á_chªged
)

186 
v
 = 
	`dblP¬amV®id©Ü
(
_mš
, 
_max
, 
£lf
.
´ec
, 
NÚe
)

187 
£lf
.
·»Á
.
	`£tV®id©Ü
(
v
)

189 
def
 
	$cÚ‹xtM’uEv’t
(
£lf
, 
ev’t
):

190 
æd
 = 
£lf
.
	`£nd”
()

191 if(
æd
):

192 if((
£lf
.
_mš
 
is
 
nÙ
 
NÚe
è
	$ªd
 (
£lf
.
_max
 
is
 
nÙ
 
NÚe
)):

193 
ma_¡r
 = 'v®id„ªgi b‘w“À%.2àªd %.2f' % (
£lf
.
_mš
, s–f.
_max
)

195 
ma_¡r
 = 'Motor‚ot connected'

197 
£lf
.
m’u
 = 
QtWidg‘s
.
	`QM’u
(£lf.
·»Á
)

198 
»ÇmeAùiÚ
 = 
QtWidg‘s
.
	`QAùiÚ
(
ma_¡r
, 
£lf
.
·»Á
)

199 
»ÇmeAùiÚ
.
Œigg”ed
.
	`cÚÃù
(
£lf
.
»ÇmeSlÙ
)

200 
£lf
.
m’u
.
	`addAùiÚ
(
»ÇmeAùiÚ
)

201 #add 
Ùh”
 
»quœed
 
aùiÚs


202 
£lf
.
m’u
.
	`pİup
(
QtGui
.
QCursÜ
.
	`pos
())

204 
def
 
	$»ÇmeSlÙ
(
£lf
):

205 
´št
 "renaming slot called"

206 #g‘ 
the
 
£Ëùed
 
ûÎ
 
ªd
 
³rfÜm
 
»Çmšg


208 
def
 
	$focusInEv’t
(
£lf
, 
ev’t
):

210 
£lf
.
cur_v®
 = (
	`¡r
(£lf.
·»Á
.
	`‹xt
()))

211 #£lf.
cur_v®
 = (
	`¡r
(
£lf
.
	`‹xt
()))

212 
QtWidg‘s
.
QLšeEd™
.
	`focusInEv’t
(
£lf
.
·»Á
, 
ev’t
)

214 
def
 
	$focusOutEv’t
(
£lf
, 
ev’t
):

216 
focus
 
is
 
lo¡
 
Ú
 
this
 
f›ld
 
th’
  
the
 
v®ue
 
to
 
™s
 
´evious
 value

217 
ªd
 
£t
 
the
 
background
 
cŞÜ
'''

218 
v
 = 
£lf
.
·»Á
.
	`v®id©Ü
()

219 if(
v
.
	$is_dÚe
()):

220 #v®u
is
 
acû±ed


221 
£lf
.
cur_v®
 = (
	`¡r
(£lf.
·»Á
.
	`‹xt
()))

223 #v®u
has
 
nÙ
 
b“n
 
acû±ed


224 
£lf
.
·»Á
.
	`£tText
(£lf.
fmt
 % s–f.
cur_v®
)

225 
£lf
.
·»Á
.
	`upd©e
()

226 
£lf
.
·»Á
.
	`£tStyËSh“t
(
v®id_ss
)

227 
QtWidg‘s
.
QLšeEd™
.
	`focusOutEv’t
(
£lf
.
·»Á
, 
ev’t
)

229 
def
 
	$Ú_dbl_·»Á_¹º_´es£d
(
£lf
):

230 
£lf
.
cur_v®
 = (
	`¡r
(£lf.
·»Á
.
	`‹xt
()))

231 #´šˆ'§všg [%.3f]' % 
£lf
.
cur_v®


232 
v
 = 
£lf
.
·»Á
.
	`v®id©Ü
()

233 
v
.
	`lock_chªges
(
True
)

234 
£lf
.
·»Á
.
	`£tStyËSh“t
(
v®id_ss
)

235 
£lf
.
v®id_»tuºP»s£d
.
	`em™
()

237 
def
 
	$Ú_dbl_·»Á_chªged
(
£lf
):

238 
v
 = 
£lf
.
·»Á
.
	`v®id©Ü
()

239 
v
.
	`lock_chªges
(
F®£
)

240 
ss
 = 
šv®id_ss


241 
£lf
.
·»Á
.
	`£tStyËSh“t
(
ss
)

246 
şass
 
	$‹¡Wšdow
(
QtWidg‘s
.
QWidg‘
):

248 
şassdocs


250 
def
 
	$__š™__
(
£lf
):

251 
	`su³r
(
‹¡Wšdow
, 
£lf
).
	`__š™__
()

253 
£lf
.
e1
 = 
QtWidg‘s
.
	`QLšeEd™
("0.0")

254 
£lf
.
e2
 = 
QtWidg‘s
.
	`QLšeEd™
("0.0")

255 
£lf
.
e3
 = 
QtWidg‘s
.
	`QLšeEd™
("0.0")

256 
£lf
.
e4
 = 
QtWidg‘s
.
	`QLšeEd™
("0.0")

258 
£lf
.
e1
.
dpo
 = 
	`dblLšeEd™P¬amObj
('e1', -500.0, 123.5, 3, 
·»Á
=self.e1)

259 
£lf
.
e2
.
dpo
 = 
	`dblLšeEd™P¬amObj
('e2', 0.0, 4123.5, 3, 
·»Á
=self.e2)

260 
£lf
.
e3
.
dpo
 = 
	`dblLšeEd™P¬amObj
('e3', 0.0, 63.5, 3, 
·»Á
=self.e3)

261 
£lf
.
e4
.
dpo
 = 
	`dblLšeEd™P¬amObj
('e4', -2000.0, 1993.5, 3, 
·»Á
=self.e4)

264 
£lf
.
e1
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(£lf.
»ÿlc_roi
)

265 
£lf
.
e2
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(£lf.
»ÿlc_roi
)

266 
£lf
.
e3
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(£lf.
»ÿlc_roi
)

267 
£lf
.
e4
.
dpo
.
v®id_»tuºP»s£d
.
	`cÚÃù
(£lf.
»ÿlc_roi
)

269 
æo
 = 
QtWidg‘s
.
	`QFÜmLayout
()

270 
æo
.
	`addRow
("DoubË v®id©Ü 1",
£lf
.
e1
)

271 
æo
.
	`addRow
("DoubË v®id©Ü 2",
£lf
.
e2
)

272 
æo
.
	`addRow
("DoubË v®id©Ü 3",
£lf
.
e3
)

273 
æo
.
	`addRow
("DoubË v®id©Ü 4",
£lf
.
e4
)

274 
£lf
.
	`£tLayout
(
æo
)

276 
def
 
	$»ÿlc_roi
(
£lf
):

277 
æd
 = 
£lf
.
	`£nd”
()

278 
´št
 '»ÿlcšg„o˜fÜ [%s]„ªg%.2àtØ%.2f' % (
æd
.
id
, fld.
_mš
, fld.
_max
)

280 
__Çme__
 == '__main__':

281 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

282 
wš
 = 
	`‹¡Wšdow
()

284 
wš
.
	`show
()

285 
wš
.
	`£tWšdowT™Ë
("PyQt")

286 
sys
.
	`ex™
(
­p
.
	`exec_
())

	@widgets/piezoRecalibrate.py

2 
C»©ed
 
	gÚ
 2014-07-15

4 @
	gauthÜ
: 
b”gr


6 
impÜt
 
sys


7 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
	guic
, 
	gQtWidg‘s


9 
impÜt
 
	gtime


10 
impÜt
 
	gQueue


11 
impÜt
 
	g©ex™


13 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
bl10ID01
 
impÜt
 
	gMAIN_OBJ
, 
	gPOS_TYPE_BL
, 
	gPOS_TYPE_ES


14 
äom
 
	gbcm
.
	gdeviû
.
deviû_Çmes
 
	gimpÜt
 *

15 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
p›zo_»ÿl
 
impÜt
 
	gp›zo_»ÿl


17 
äom
 
	gşs
.
	g­p_d©a
.
deçuÉs
 
impÜt
 
	grgb_as_hex
, 
	gma¡”_cŞÜs
, 
	gg‘_¡yË


18 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


20 #mÙÜ 
š‹º®
 
¡©us


21 
	gNONFLOAT
, 
	gOUTSIDE_LIMITS
, 
	gUNCONNECTED
 = -13, -12, -11

22 
	gTIMEOUT
, 
	gTIMEOUT_BUTDONE
 = -8, -7

23 
	gUNKNOWN_ERROR
 = -5

24 
DONEW_SOFTLIM
, 
	gDONEW_HARDLIM
 = -4, -3

25 
	gDONE_OK
 = 0

26 
MOVE_BEGUN
, 
	gMOVE_BEGUN_CONFIRMED
 = 0, 1

27 
	gNOWAIT_SOFTLIM
, 
	gNOWAIT_HARDLIM
 = 4, 3

31 
	g_fbk_nÙ_movšg
 = 
ma¡”_cŞÜs
['app_blue']

34 
_fbk_movšg
 = "rgb(254, 233, 0);"

35 #£tu°
moduË
 
logg”
 
w™h
 
a
  do-
nÙhšg
 
hªdËr


36 
_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

39 
şass
 
	$P›zoReÿlibPª–
(
QtWidg‘s
.
QWidg‘
):

42 :
·¿m
 
pos™iÚ”_£t
: 
a
 
¡ršg
 
th©
 
is
 
u£d
 
to
 
decide
 
which
 
pos™iÚ”s
Ø
šşude
 
Ú
 
the
 
·Ãl
. 
SuµÜ‹d


43 
İtiÚs
 
¬e
:

47 :
ty³
 
¡ršg
:

49 :
»tuºs
: 
NÚe


51 
def
 
	$__š™__
(
£lf
):

52 
	`su³r
(
P›zoReÿlibPª–
, 
£lf
).
	`__š™__
()

55 
£lf
.
po¢”_li¡
 = [
DNM_SAMPLE_X
, 
DNM_SAMPLE_Y
, 
DNM_ZONEPLATE_X
, 
DNM_ZONEPLATE_Y
]

56 
£lf
.
fbk_’abËd
 = 
F®£


57 
£lf
.
mŒ
 = 
NÚe


59 
£lf
.
mŒ_diù
 = {
	}
}

61 
£lf
.
vbox
 = 
QtWidg‘s
.
QVBoxLayout
()

62 
£lf
.
vbox
.
£tCÚ‹ÁsM¬gšs
(0,0,0,0)

63 
	g£lf
.
	gvbox
.
£tS·cšg
(0)

65 
	g£lf
.
	g¡yËBŠ
 = 
QtWidg‘s
.
QPushBu‰Ú
('Update Style')

66 
£lf
.
¡yËBŠ
.
şicked
.
cÚÃù
(£lf.
Ú_upd©e_¡yË
)

68 #£lf.
vbox
.
addWidg‘
(
£lf
.
¡yËBŠ
)

69 
£lf
.
upd©eQueue
 = 
Queue
.Queue()

71 
£lf
.
upd©eTim”
 = 
QtCÜe
.
QTim”
()

72 
£lf
.
upd©eTim”
.
timeout
.
cÚÃù
(£lf.
upd©e_widg‘s
)

75 
£lf
.
£tLayout
(£lf.
vbox
)

76 
£lf
.
mŒ_diù
 = {}

77 #£lf.
qssh“t
 = 
g‘_¡yË
('dark')

78 #£lf.
£tStyËSh“t
(
£lf
.
qssh“t
)

80 
devs
 = 
MAIN_OBJ
.
g‘_deviûs
()

81 #DEVICE_CFG.
g‘_deviû_li¡
()

82 
po¢”
 
š
 
£lf
.
po¢”_li¡
:

83 
po¢”_ui
 = 
p›zo_»ÿl
()

84 
mŒ
 = 
MAIN_OBJ
.
deviû
(
po¢”
)

85 #dev_ui.
£tPosFld
.
š¡®lEv’tF‹r
(
F‹r
())

86 #mŒ = 
MAIN_OBJ
.
deviû
(
dev
)

87 #£lf.
mŒ_diù
[
mŒ
.
g‘_Çme
()] = ( 
po¢”
, 
po¢”_ui
, mtr)

88 
	g£lf
.
cÚÃù_mÙÜ_widg‘s
(
po¢”
, 
po¢”_ui
, 
mŒ
)

89 #_logg”.
debug
('DONE uic.lßdU˜[%s]' % 
dev
)

90 #´šˆ'pos™iÚ”: [%s]…vÇm[%s]' % (
dev
, 
mŒ
.
g‘_Çme
())

91 
	g£lf
.
	gupd©eTim”
.
¡¬t
(100)

92 
	g£lf
.
	gfbk_’abËd
 = 
True


93 #£lf.
lßdMÙÜCÚfig
(
pos™iÚ”
)

94 
©ex™
.(
£lf
.
Ú_ex™
)

96 
def
 
	$Ú_ex™
(
£lf
):

98 
·ss


101 
def
 
	$Ú_upd©e_¡yË
(
£lf
):

103 
£lf
.
qssh“t
 = 
	`g‘_¡yË
('dark')

104 
£lf
.
	`£tStyËSh“t
(£lf.
qssh“t
)

106 
def
 
	$cÚÃù_mÙÜ_widg‘s
(
£lf
, 
Çme
, 
mŒ_ui
, 
mŒ
):

107 #_logg”.
	`debug
('cÚÃù_mÙÜ_widg‘s[%s]' % 
Çme
)

108 
desc
 = 
mŒ
.
	`g‘
('DESC')

109 
pv_Çme
 = 
mŒ
.
	`g‘_Çme
()

111 
mŒ_ui
.
»ûÁ”BŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_»ûÁ”
)

113 #£lf.
po¢”_li¡
 = ['SampleFineX', 'SampleFineY', 'ZoneplateX.X', 'ZoneplateY.Y']

115 
mŒ_ui
.
»ûÁ”BŠ
.
	`£tText
('ReûÁ” %s' % 
Çme
)

116 
mŒ_ui
.
»ûÁ”BŠ
.
	`£tToŞT
(
pv_Çme
)

118 
mŒ
.
	`add_ÿÎback
('DMOV', 
£lf
.
upd©eMovšg
)

119 #_logg”.
	`debug
('add_ÿÎback(RBV [%s]' % 
Çme
)

120 
mŒ
.
	`add_ÿÎback
('RBV', 
£lf
.
upd©eFbk
)

122 #_logg”.
	`debug
('g‘tšg RBV,EGU fÜ [%s]' % 
Çme
)

123 
fbk
 = 
mŒ
.
	`g‘_pos™iÚ
()

124 #_logg”.
	`debug
('add_ÿÎback(EGU [%s]' % 
Çme
)

125 #un™ ğ
	`¡r
(
mŒ
.
	`g‘
('EGU'))

126 #_logg”.
	`debug
('dÚcÚÃùšg [%s]' % 
Çme
)

127 
s
 = '%6.3f' % 
fbk


128 
mŒ_ui
.
posFbkLbl
.
	`£tText
(
s
)

129 
£lf
.
mŒ_diù
[
mŒ
.
	`g‘_Çme
()] = ( 
Çme
, 
mŒ_ui
, mtr)

130 #mŒ_ui.
un™sLbl
.
	`£tText
(
un™s
)

132 #–if(
	`ha§‰r
(
mŒ
, 'changed')):

133 ##
´št
 'Snd¬d PV: unsuµÜ‹d…os™iÚ” [%s]' % 
Çme


136 #´šˆ'unsuµÜ‹d…os™iÚ” [%s]' % 
Çme


138 
£lf
.
vbox
.
	`addWidg‘
(
mŒ_ui
)

139 #_logg”.
	`debug
('DÚe[%s] \n\n' % 
Çme
)

141 
def
 
	$Ú_»ûÁ”
(
£lf
):

142 
bŠ
 = 
£lf
.
	`£nd”
()

143 #txˆğ
	`¡r
(
bŠ
.
	`‹xt
())

144 
pv_Çme
 = 
	`¡r
(
bŠ
.
	`toŞT
().
	`toAscii
().
	`d©a
())

145 
txt
, 
mŒ_ui
, 
mŒ
 = 
£lf
.
mŒ_diù
[
pv_Çme
]

147 if(
txt
.
	`fšd
(
DNM_SAMPLE_X
) > -1):

148 #mŒ = 
£lf
.
mŒ_diù
[
DNM_SAMPLE_X
]

149 
mŒ
.
	`put
('AtzSetCoarsePos', 1)

150 
	`–if
(
txt
.
	`fšd
(
DNM_SAMPLE_Y
) > -1):

151 #mŒ = 
£lf
.
mŒ_diù
[
DNM_SAMPLE_Y
]

152 
mŒ
.
	`put
('AtzSetCoarsePos', 1)

153 
	`–if
(
txt
.
	`fšd
(
DNM_ZONEPLATE_X
) > -1):

154 #mŒ = 
£lf
.
mŒ_diù
[
DNM_ZONEPLATE_X
]

155 
mŒ
.
	`put
('AutoZero', 1)

156 
	`–if
(
txt
.
	`fšd
(
DNM_ZONEPLATE_Y
) > -1):

157 #mŒ = 
£lf
.
mŒ_diù
[
DNM_ZONEPLATE_Y
]

158 
mŒ
.
	`put
('AutoZero', 1)

160 
_logg”
.
	`”rÜ
('Ú_»ûÁ”: UÄecognized mÙÜ [%s]' % 
txt
)

163 
def
 
	$Ú_ed™šg_fšished
(
£lf
):

164 
´št
 'on_editing_finished'

166 
def
 
	$upd©e_widg‘s
(
£lf
):

167 
ÿÎ_sk_dÚe
 = 
F®£


168 
nÙ
 
£lf
.
upd©eQueue
.
	$em±y
():

169 
»¥
 = 
£lf
.
upd©eQueue
.
	`g‘
()

170 if('£tStyËSh“t' 
š
 
»¥
.
	$keys
()):

171 
ss
 
š
 
»¥
['setStyleSheet']:

172 
widg‘
 = 
ss
[0]

173 
şr_¡r
 = 
ss
[1]

174 #´šˆ'upd©e_widg‘s: s‘StyËSh“t(%s)' % 
şr_¡r


175 
widg‘
.
	`£tStyËSh“t
(
şr_¡r
)

176 
ÿÎ_sk_dÚe
 = 
True


178 if('£tText' 
š
 
»¥
.
	$keys
()):

179 
widg‘
 = 
»¥
['setText'][0]

180 
_¡r
 = 
»¥
['setText'][1]

181 #´šˆ'upd©e_widg‘s: s‘Text(%s)' % 
_¡r


182 
widg‘
.
	`£tText
(
_¡r
)

183 
ÿÎ_sk_dÚe
 = 
True


185 if(
ÿÎ_sk_dÚe
):

186 
£lf
.
upd©eQueue
.
	`sk_dÚe
()

189 
def
 
	$¡İ
(
£lf
):

190 
æd
 = 
£lf
.
	`£nd”
()

191 
pvÇme
 = 
	`¡r
(
æd
.
	`¡©usT
())

192 (
dev
, 
dev_ui
, 
mŒ
èğ
£lf
.
mŒ_diù
[
pvÇme
]

193 
mŒ
.
	`¡İ
()

195 
def
 
	$upd©eMovšg
(
£lf
, **
kw¬gs
):

197 
™
 
wl
 
ev’tu®ly
 
sûw
 
up
 
‹h
 
maš
 
GUI
 
th»ad


198 
H’û
 
the
 
u£
 
of
 
a
 
Queue
 
ªd
 
QTim”


200 
pvÇme
 = 
kw¬gs
['pvÇme'].
	`¥l™
('.')[0]

201 (
dev
, 
dev_ui
, 
mŒ
èğ
£lf
.
mŒ_diù
[
pvÇme
]

202 
v®
 = (
kw¬gs
['value'])

203 
txt_şr
 = "color: black;"

204 #thi 
is
 
the
 
DMOV
 
Ü
 
DONE
 
Movšg
, 
I
 
wªt
 Movšg 
so
 
šv”t
 
logic


205 if(
v®
):

206 
şr_¡r
 = 
_fbk_nÙ_movšg


209 
şr_¡r
 = 
_fbk_movšg


212 
_dù
 = {
	}
}

213 
_dù
['£tStyËSh“t'] = [(
dev_ui
.
»ûÁ”BŠ
, "background-cŞÜ: " + 
şr_¡r
), (dev_ui.
posFbkLbl
, 
txt_şr
)]

214 
	g£lf
.
	gupd©eQueue
.
put_nowa™
(
_dù
)

218 
def
 
	$upd©eFbk
(
£lf
, **
kw¬gs
):

220 
™
 
wl
 
ev’tu®ly
 
sûw
 
up
 
‹h
 
maš
 
GUI
 
th»ad


221 
H’û
 
the
 
u£
 
of
 
a
 
Queue
 
ªd
 
QTim”


223 if(
£lf
.
fbk_’abËd
 
is
 
True
):

224 
pvÇme
 = 
kw¬gs
['pvÇme'].
	`¥l™
('.')[0]

225 (
dev
, 
dev_ui
, 
mŒ
èğ
£lf
.
mŒ_diù
[
pvÇme
]

226 
v®
 = (
kw¬gs
['value'])

227 
s
 = '%6.3f' % 
v®


228 
_dù
 = {
	}
}

229 
_dù
['£tText'] = (
dev_ui
.
posFbkLbl
, 
	gs
)

230 
	g£lf
.
	gupd©eQueue
.
put_nowa™
(
_dù
)

233 
def
 
	$cÚ‹xtM’uEv’t
(
£lf
, 
ev’t
):

234 
æd
 = 
£lf
.
	`£nd”
()

235 if(
æd
):

236 
pvÇme
 = 
	`¡r
(
æd
.
	`¡©usT
())

237 (
dev
, 
dev_ui
, 
mŒ
èğ
£lf
.
mŒ_diù
[
pvÇme
]

239 #£lf.
_pvs
['VAL'].
cÚÃùed


240 if(
mŒ
.
_pvs
['VAL'].
cÚÃùed
):

241 
hlm
 = 
mŒ
.
	`g‘
('HLM')

242 
Îm
 = 
mŒ
.
	`g‘
('LLM')

244 if((
Îm
 
is
 
nÙ
 
NÚe
è
	$ªd
 (
hlm
 
is
 
nÙ
 
NÚe
)):

245 
ma_¡r
 = 'mov% absŞu‹ b‘w“À%.2àªd %.2f' % (
dev
, 
Îm
, 
hlm
)

247 
ma_¡r
 = 'MÙÜ % nÙ cÚÃùed' % (
dev
)

249 
£lf
.
m’u
 = 
QtWidg‘s
.
	`QM’u
(self)

250 
»ÇmeAùiÚ
 = 
QtWidg‘s
.
	`QAùiÚ
(
ma_¡r
, 
£lf
)

251 
»ÇmeAùiÚ
.
Œigg”ed
.
	`cÚÃù
(
£lf
.
»ÇmeSlÙ
)

252 
£lf
.
m’u
.
	`addAùiÚ
(
»ÇmeAùiÚ
)

253 #add 
Ùh”
 
»quœed
 
aùiÚs


254 
£lf
.
m’u
.
	`pİup
(
QtWidg‘s
.
QCursÜ
.
	`pos
())

258 
def
 
	$go
():

259 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

260 #wšdow = 
	`P›zoReÿlibPª–
('beamline')

261 #wšdow.
	`show
()

262 
wšdow2
 = 
	`P›zoReÿlibPª–
()

263 
wšdow2
.
	`show
()

265 
­p
.
	`exec_
()

268 
def
 
	$´ofe_™
():

272 
´ofe
.
Profe
.
bŸs
 = 9.95500362835e-07

274 
´ofe
.
	`run
('go()', 'testprof.dat')

276 
p
 = 
p¡©s
.
	`Sts
('testprof.dat')

277 
p
.
	`sÜt_¡©s
('cumuÏtive').
	`´št_¡©s
(100)

280 
__Çme__
 == '__main__':

281 
impÜt
 
´ofe


282 
impÜt
 
p¡©s


283 
	`log_to_qt
()

284 
	`go
()

	@widgets/piezoRecalibrate.py

2 
C»©ed
 
	gÚ
 2014-07-15

4 @
	gauthÜ
: 
b”gr


6 
impÜt
 
sys


7 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
	guic
, 
	gQtWidg‘s


9 
impÜt
 
	gtime


10 
impÜt
 
	gQueue


11 
impÜt
 
	g©ex™


13 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
bl10ID01
 
impÜt
 
	gMAIN_OBJ
, 
	gPOS_TYPE_BL
, 
	gPOS_TYPE_ES


14 
äom
 
	gbcm
.
	gdeviû
.
deviû_Çmes
 
	gimpÜt
 *

15 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
p›zo_»ÿl
 
impÜt
 
	gp›zo_»ÿl


17 
äom
 
	gşs
.
	g­p_d©a
.
deçuÉs
 
impÜt
 
	grgb_as_hex
, 
	gma¡”_cŞÜs
, 
	gg‘_¡yË


18 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


20 #mÙÜ 
š‹º®
 
¡©us


21 
	gNONFLOAT
, 
	gOUTSIDE_LIMITS
, 
	gUNCONNECTED
 = -13, -12, -11

22 
	gTIMEOUT
, 
	gTIMEOUT_BUTDONE
 = -8, -7

23 
	gUNKNOWN_ERROR
 = -5

24 
DONEW_SOFTLIM
, 
	gDONEW_HARDLIM
 = -4, -3

25 
	gDONE_OK
 = 0

26 
MOVE_BEGUN
, 
	gMOVE_BEGUN_CONFIRMED
 = 0, 1

27 
	gNOWAIT_SOFTLIM
, 
	gNOWAIT_HARDLIM
 = 4, 3

31 
	g_fbk_nÙ_movšg
 = 
ma¡”_cŞÜs
['app_blue']

34 
_fbk_movšg
 = "rgb(254, 233, 0);"

35 #£tu°
moduË
 
logg”
 
w™h
 
a
  do-
nÙhšg
 
hªdËr


36 
_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

39 
şass
 
	$P›zoReÿlibPª–
(
QtWidg‘s
.
QWidg‘
):

42 :
·¿m
 
pos™iÚ”_£t
: 
a
 
¡ršg
 
th©
 
is
 
u£d
 
to
 
decide
 
which
 
pos™iÚ”s
Ø
šşude
 
Ú
 
the
 
·Ãl
. 
SuµÜ‹d


43 
İtiÚs
 
¬e
:

47 :
ty³
 
¡ršg
:

49 :
»tuºs
: 
NÚe


51 
def
 
	$__š™__
(
£lf
):

52 
	`su³r
(
P›zoReÿlibPª–
, 
£lf
).
	`__š™__
()

55 
£lf
.
po¢”_li¡
 = [
DNM_SAMPLE_X
, 
DNM_SAMPLE_Y
, 
DNM_ZONEPLATE_X
, 
DNM_ZONEPLATE_Y
]

56 
£lf
.
fbk_’abËd
 = 
F®£


57 
£lf
.
mŒ
 = 
NÚe


59 
£lf
.
mŒ_diù
 = {
	}
}

61 
£lf
.
vbox
 = 
QtWidg‘s
.
QVBoxLayout
()

62 
£lf
.
vbox
.
£tCÚ‹ÁsM¬gšs
(0,0,0,0)

63 
	g£lf
.
	gvbox
.
£tS·cšg
(0)

65 
	g£lf
.
	g¡yËBŠ
 = 
QtWidg‘s
.
QPushBu‰Ú
('Update Style')

66 
£lf
.
¡yËBŠ
.
şicked
.
cÚÃù
(£lf.
Ú_upd©e_¡yË
)

68 #£lf.
vbox
.
addWidg‘
(
£lf
.
¡yËBŠ
)

69 
£lf
.
upd©eQueue
 = 
Queue
.Queue()

71 
£lf
.
upd©eTim”
 = 
QtCÜe
.
QTim”
()

72 
£lf
.
upd©eTim”
.
timeout
.
cÚÃù
(£lf.
upd©e_widg‘s
)

75 
£lf
.
£tLayout
(£lf.
vbox
)

76 
£lf
.
mŒ_diù
 = {}

77 #£lf.
qssh“t
 = 
g‘_¡yË
('dark')

78 #£lf.
£tStyËSh“t
(
£lf
.
qssh“t
)

80 
devs
 = 
MAIN_OBJ
.
g‘_deviûs
()

81 #DEVICE_CFG.
g‘_deviû_li¡
()

82 
po¢”
 
š
 
£lf
.
po¢”_li¡
:

83 
po¢”_ui
 = 
p›zo_»ÿl
()

84 
mŒ
 = 
MAIN_OBJ
.
deviû
(
po¢”
)

85 #dev_ui.
£tPosFld
.
š¡®lEv’tF‹r
(
F‹r
())

86 #mŒ = 
MAIN_OBJ
.
deviû
(
dev
)

87 #£lf.
mŒ_diù
[
mŒ
.
g‘_Çme
()] = ( 
po¢”
, 
po¢”_ui
, mtr)

88 
	g£lf
.
cÚÃù_mÙÜ_widg‘s
(
po¢”
, 
po¢”_ui
, 
mŒ
)

89 #_logg”.
debug
('DONE uic.lßdU˜[%s]' % 
dev
)

90 #´šˆ'pos™iÚ”: [%s]…vÇm[%s]' % (
dev
, 
mŒ
.
g‘_Çme
())

91 
	g£lf
.
	gupd©eTim”
.
¡¬t
(100)

92 
	g£lf
.
	gfbk_’abËd
 = 
True


93 #£lf.
lßdMÙÜCÚfig
(
pos™iÚ”
)

94 
©ex™
.(
£lf
.
Ú_ex™
)

96 
def
 
	$Ú_ex™
(
£lf
):

98 
·ss


101 
def
 
	$Ú_upd©e_¡yË
(
£lf
):

103 
£lf
.
qssh“t
 = 
	`g‘_¡yË
('dark')

104 
£lf
.
	`£tStyËSh“t
(£lf.
qssh“t
)

106 
def
 
	$cÚÃù_mÙÜ_widg‘s
(
£lf
, 
Çme
, 
mŒ_ui
, 
mŒ
):

107 #_logg”.
	`debug
('cÚÃù_mÙÜ_widg‘s[%s]' % 
Çme
)

108 
desc
 = 
mŒ
.
	`g‘
('DESC')

109 
pv_Çme
 = 
mŒ
.
	`g‘_Çme
()

111 
mŒ_ui
.
»ûÁ”BŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_»ûÁ”
)

113 #£lf.
po¢”_li¡
 = ['SampleFineX', 'SampleFineY', 'ZoneplateX.X', 'ZoneplateY.Y']

115 
mŒ_ui
.
»ûÁ”BŠ
.
	`£tText
('ReûÁ” %s' % 
Çme
)

116 
mŒ_ui
.
»ûÁ”BŠ
.
	`£tToŞT
(
pv_Çme
)

118 
mŒ
.
	`add_ÿÎback
('DMOV', 
£lf
.
upd©eMovšg
)

119 #_logg”.
	`debug
('add_ÿÎback(RBV [%s]' % 
Çme
)

120 
mŒ
.
	`add_ÿÎback
('RBV', 
£lf
.
upd©eFbk
)

122 #_logg”.
	`debug
('g‘tšg RBV,EGU fÜ [%s]' % 
Çme
)

123 
fbk
 = 
mŒ
.
	`g‘_pos™iÚ
()

124 #_logg”.
	`debug
('add_ÿÎback(EGU [%s]' % 
Çme
)

125 #un™ ğ
	`¡r
(
mŒ
.
	`g‘
('EGU'))

126 #_logg”.
	`debug
('dÚcÚÃùšg [%s]' % 
Çme
)

127 
s
 = '%6.3f' % 
fbk


128 
mŒ_ui
.
posFbkLbl
.
	`£tText
(
s
)

129 
£lf
.
mŒ_diù
[
mŒ
.
	`g‘_Çme
()] = ( 
Çme
, 
mŒ_ui
, mtr)

130 #mŒ_ui.
un™sLbl
.
	`£tText
(
un™s
)

132 #–if(
	`ha§‰r
(
mŒ
, 'changed')):

133 ##
´št
 'Snd¬d PV: unsuµÜ‹d…os™iÚ” [%s]' % 
Çme


136 #´šˆ'unsuµÜ‹d…os™iÚ” [%s]' % 
Çme


138 
£lf
.
vbox
.
	`addWidg‘
(
mŒ_ui
)

139 #_logg”.
	`debug
('DÚe[%s] \n\n' % 
Çme
)

141 
def
 
	$Ú_»ûÁ”
(
£lf
):

142 
bŠ
 = 
£lf
.
	`£nd”
()

143 #txˆğ
	`¡r
(
bŠ
.
	`‹xt
())

144 
pv_Çme
 = 
	`¡r
(
bŠ
.
	`toŞT
().
	`toAscii
().
	`d©a
())

145 
txt
, 
mŒ_ui
, 
mŒ
 = 
£lf
.
mŒ_diù
[
pv_Çme
]

147 if(
txt
.
	`fšd
(
DNM_SAMPLE_X
) > -1):

148 #mŒ = 
£lf
.
mŒ_diù
[
DNM_SAMPLE_X
]

149 
mŒ
.
	`put
('AtzSetCoarsePos', 1)

150 
	`–if
(
txt
.
	`fšd
(
DNM_SAMPLE_Y
) > -1):

151 #mŒ = 
£lf
.
mŒ_diù
[
DNM_SAMPLE_Y
]

152 
mŒ
.
	`put
('AtzSetCoarsePos', 1)

153 
	`–if
(
txt
.
	`fšd
(
DNM_ZONEPLATE_X
) > -1):

154 #mŒ = 
£lf
.
mŒ_diù
[
DNM_ZONEPLATE_X
]

155 
mŒ
.
	`put
('AutoZero', 1)

156 
	`–if
(
txt
.
	`fšd
(
DNM_ZONEPLATE_Y
) > -1):

157 #mŒ = 
£lf
.
mŒ_diù
[
DNM_ZONEPLATE_Y
]

158 
mŒ
.
	`put
('AutoZero', 1)

160 
_logg”
.
	`”rÜ
('Ú_»ûÁ”: UÄecognized mÙÜ [%s]' % 
txt
)

163 
def
 
	$Ú_ed™šg_fšished
(
£lf
):

164 
´št
 'on_editing_finished'

166 
def
 
	$upd©e_widg‘s
(
£lf
):

167 
ÿÎ_sk_dÚe
 = 
F®£


168 
nÙ
 
£lf
.
upd©eQueue
.
	$em±y
():

169 
»¥
 = 
£lf
.
upd©eQueue
.
	`g‘
()

170 if('£tStyËSh“t' 
š
 
»¥
.
	$keys
()):

171 
ss
 
š
 
»¥
['setStyleSheet']:

172 
widg‘
 = 
ss
[0]

173 
şr_¡r
 = 
ss
[1]

174 #´šˆ'upd©e_widg‘s: s‘StyËSh“t(%s)' % 
şr_¡r


175 
widg‘
.
	`£tStyËSh“t
(
şr_¡r
)

176 
ÿÎ_sk_dÚe
 = 
True


178 if('£tText' 
š
 
»¥
.
	$keys
()):

179 
widg‘
 = 
»¥
['setText'][0]

180 
_¡r
 = 
»¥
['setText'][1]

181 #´šˆ'upd©e_widg‘s: s‘Text(%s)' % 
_¡r


182 
widg‘
.
	`£tText
(
_¡r
)

183 
ÿÎ_sk_dÚe
 = 
True


185 if(
ÿÎ_sk_dÚe
):

186 
£lf
.
upd©eQueue
.
	`sk_dÚe
()

189 
def
 
	$¡İ
(
£lf
):

190 
æd
 = 
£lf
.
	`£nd”
()

191 
pvÇme
 = 
	`¡r
(
æd
.
	`¡©usT
())

192 (
dev
, 
dev_ui
, 
mŒ
èğ
£lf
.
mŒ_diù
[
pvÇme
]

193 
mŒ
.
	`¡İ
()

195 
def
 
	$upd©eMovšg
(
£lf
, **
kw¬gs
):

197 
™
 
wl
 
ev’tu®ly
 
sûw
 
up
 
‹h
 
maš
 
GUI
 
th»ad


198 
H’û
 
the
 
u£
 
of
 
a
 
Queue
 
ªd
 
QTim”


200 
pvÇme
 = 
kw¬gs
['pvÇme'].
	`¥l™
('.')[0]

201 (
dev
, 
dev_ui
, 
mŒ
èğ
£lf
.
mŒ_diù
[
pvÇme
]

202 
v®
 = (
kw¬gs
['value'])

203 
txt_şr
 = "color: black;"

204 #thi 
is
 
the
 
DMOV
 
Ü
 
DONE
 
Movšg
, 
I
 
wªt
 Movšg 
so
 
šv”t
 
logic


205 if(
v®
):

206 
şr_¡r
 = 
_fbk_nÙ_movšg


209 
şr_¡r
 = 
_fbk_movšg


212 
_dù
 = {
	}
}

213 
_dù
['£tStyËSh“t'] = [(
dev_ui
.
»ûÁ”BŠ
, "background-cŞÜ: " + 
şr_¡r
), (dev_ui.
posFbkLbl
, 
txt_şr
)]

214 
	g£lf
.
	gupd©eQueue
.
put_nowa™
(
_dù
)

218 
def
 
	$upd©eFbk
(
£lf
, **
kw¬gs
):

220 
™
 
wl
 
ev’tu®ly
 
sûw
 
up
 
‹h
 
maš
 
GUI
 
th»ad


221 
H’û
 
the
 
u£
 
of
 
a
 
Queue
 
ªd
 
QTim”


223 if(
£lf
.
fbk_’abËd
 
is
 
True
):

224 
pvÇme
 = 
kw¬gs
['pvÇme'].
	`¥l™
('.')[0]

225 (
dev
, 
dev_ui
, 
mŒ
èğ
£lf
.
mŒ_diù
[
pvÇme
]

226 
v®
 = (
kw¬gs
['value'])

227 
s
 = '%6.3f' % 
v®


228 
_dù
 = {
	}
}

229 
_dù
['£tText'] = (
dev_ui
.
posFbkLbl
, 
	gs
)

230 
	g£lf
.
	gupd©eQueue
.
put_nowa™
(
_dù
)

233 
def
 
	$cÚ‹xtM’uEv’t
(
£lf
, 
ev’t
):

234 
æd
 = 
£lf
.
	`£nd”
()

235 if(
æd
):

236 
pvÇme
 = 
	`¡r
(
æd
.
	`¡©usT
())

237 (
dev
, 
dev_ui
, 
mŒ
èğ
£lf
.
mŒ_diù
[
pvÇme
]

239 #£lf.
_pvs
['VAL'].
cÚÃùed


240 if(
mŒ
.
_pvs
['VAL'].
cÚÃùed
):

241 
hlm
 = 
mŒ
.
	`g‘
('HLM')

242 
Îm
 = 
mŒ
.
	`g‘
('LLM')

244 if((
Îm
 
is
 
nÙ
 
NÚe
è
	$ªd
 (
hlm
 
is
 
nÙ
 
NÚe
)):

245 
ma_¡r
 = 'mov% absŞu‹ b‘w“À%.2àªd %.2f' % (
dev
, 
Îm
, 
hlm
)

247 
ma_¡r
 = 'MÙÜ % nÙ cÚÃùed' % (
dev
)

249 
£lf
.
m’u
 = 
QtWidg‘s
.
	`QM’u
(self)

250 
»ÇmeAùiÚ
 = 
QtWidg‘s
.
	`QAùiÚ
(
ma_¡r
, 
£lf
)

251 
»ÇmeAùiÚ
.
Œigg”ed
.
	`cÚÃù
(
£lf
.
»ÇmeSlÙ
)

252 
£lf
.
m’u
.
	`addAùiÚ
(
»ÇmeAùiÚ
)

253 #add 
Ùh”
 
»quœed
 
aùiÚs


254 
£lf
.
m’u
.
	`pİup
(
QtWidg‘s
.
QCursÜ
.
	`pos
())

258 
def
 
	$go
():

259 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

260 #wšdow = 
	`P›zoReÿlibPª–
('beamline')

261 #wšdow.
	`show
()

262 
wšdow2
 = 
	`P›zoReÿlibPª–
()

263 
wšdow2
.
	`show
()

265 
­p
.
	`exec_
()

268 
def
 
	$´ofe_™
():

272 
´ofe
.
Profe
.
bŸs
 = 9.95500362835e-07

274 
´ofe
.
	`run
('go()', 'testprof.dat')

276 
p
 = 
p¡©s
.
	`Sts
('testprof.dat')

277 
p
.
	`sÜt_¡©s
('cumuÏtive').
	`´št_¡©s
(100)

280 
__Çme__
 == '__main__':

281 
impÜt
 
´ofe


282 
impÜt
 
p¡©s


283 
	`log_to_qt
()

284 
	`go
()

	@widgets/piezo_recal.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #FÜm 
im¶em’tiÚ
 
g’”©ed
 
äom
 
»adšg
 
ui
 
fe
 'piezoRecal.ui'

4 #
#C»©ed: 
Tue
 
S•
 13 11:08:30 2016

5 #by: 
PyQt4
 
UI
 
code
 
g’”©Ü
 4.8.5

6 #
#WARNING! 
AÎ
 
chªges
 
made
 
š
 
this
 
fe
 
wl
 
be
 
lo¡
!

8 
äom
 
PyQt5
 
impÜt
 
	gQtCÜe
, 
	gQtGui
, 
	gQtWidg‘s


11 #_äomUtf8 = 
QtCÜe
.
QSŒšg
.
äomUtf8


12 #exû± 
A‰ribu‹E¼Ü
:

13 
	g_äomUtf8
 = 
Ïmbda
 
s
: s

15 
şass
 
	$p›zo_»ÿl
(
QtWidg‘s
.
QWidg‘
):

16 
def
 
	$__š™__
(
£lf
):

17 
QtWidg‘s
.
QWidg‘
.
	`__š™__
(
£lf
)

18 
£lf
.
	`£tObjeùName
(
	`_äomUtf8
("Form"))

19 
£lf
.
	`»size
(502, 20)

20 
£lf
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(0, 20))

21 
£lf
.
	`£tWšdowT™Ë
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "FÜm", 
NÚe
))

22 
£lf
.
v”tiÿlLayout
 = 
QtWidg‘s
.
	`QVBoxLayout
(self)

23 
£lf
.
v”tiÿlLayout
.
	`£tS·cšg
(0)

24 
£lf
.
v”tiÿlLayout
.
	`£tSizeCÚ¡¿št
(
QtWidg‘s
.
QLayout
.
S‘NoCÚ¡¿št
)

25 
£lf
.
v”tiÿlLayout
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

26 
£lf
.
v”tiÿlLayout
.
	`£tObjeùName
(
	`_äomUtf8
("verticalLayout"))

27 
£lf
.
hÜizÚlLayout
 = 
QtWidg‘s
.
	`QHBoxLayout
()

28 
£lf
.
hÜizÚlLayout
.
	`£tObjeùName
(
	`_äomUtf8
("horizontalLayout"))

29 
£lf
.
»ûÁ”BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
(self)

30 
£lf
.
»ûÁ”BŠ
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(160, 0))

31 
£lf
.
»ûÁ”BŠ
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(16777215, 20))

32 
£lf
.
»ûÁ”BŠ
.
	`£tText
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "Re-ûÁ” FšeX P›zo", 
NÚe
))

33 
£lf
.
»ûÁ”BŠ
.
	`£tObjeùName
(
	`_äomUtf8
("recenterBtn"))

34 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
»ûÁ”BŠ
)

35 
¥aûrI‹m
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(10, 20, QtWidg‘s.
QSizePŞicy
.
Ex·ndšg
, QtWidg‘s.QSizePŞicy.
Mšimum
)

36 
£lf
.
hÜizÚlLayout
.
	`addI‹m
(
¥aûrI‹m
)

37 
£lf
.
posStsLbl
 = 
QtWidg‘s
.
	`QLab–
(self)

38 
£lf
.
posStsLbl
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(50, 0))

39 
£lf
.
posStsLbl
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(50, 20))

40 
£lf
.
posStsLbl
.
	`£tText
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "STOPPED", 
NÚe
))

41 
£lf
.
posStsLbl
.
	`£tAlignm’t
(
QtCÜe
.
Qt
.
AlignC’‹r
)

42 
£lf
.
posStsLbl
.
	`£tObjeùName
(
	`_äomUtf8
("posStsLbl"))

43 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
posStsLbl
)

44 
¥aûrI‹m1
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(40, 20, QtWidg‘s.
QSizePŞicy
.
Ex·ndšg
, QtWidg‘s.QSizePŞicy.
Mšimum
)

45 
£lf
.
hÜizÚlLayout
.
	`addI‹m
(
¥aûrI‹m1
)

46 
£lf
.
posFbkLbl
 = 
QtWidg‘s
.
	`QLab–
(self)

47 
£lf
.
posFbkLbl
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(80, 17))

48 
£lf
.
posFbkLbl
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(70, 17))

49 
£lf
.
posFbkLbl
.
	`£tBa£Size
(
QtCÜe
.
	`QSize
(0, 0))

50 
·Ë‰e
 = 
QtGui
.
	`QP®‘‹
()

51 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

52 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

53 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

54 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

55 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

56 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

57 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

58 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

59 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Light
, 
brush
)

60 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

61 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

62 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Midlight
, 
brush
)

63 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

64 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

65 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
D¬k
, 
brush
)

66 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

67 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

68 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Mid
, 
brush
)

69 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

70 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

71 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Text
, 
brush
)

72 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

73 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

74 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
BrightText
, 
brush
)

75 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

76 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

77 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

78 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

79 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

80 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Ba£
, 
brush
)

81 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

82 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

83 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

84 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

85 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

86 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Shadow
, 
brush
)

87 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

88 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

89 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

90 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

91 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

92 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

93 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

94 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

95 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

96 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

97 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

98 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

99 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

100 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

101 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

102 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

103 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

104 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Light
, 
brush
)

105 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

106 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

107 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Midlight
, 
brush
)

108 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

109 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

110 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
D¬k
, 
brush
)

111 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

112 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

113 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Mid
, 
brush
)

114 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

115 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

116 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Text
, 
brush
)

117 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

118 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

119 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
BrightText
, 
brush
)

120 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

121 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

122 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

123 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

124 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

125 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Ba£
, 
brush
)

126 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

127 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

128 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

129 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

130 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

131 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Shadow
, 
brush
)

132 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

133 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

134 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

135 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

136 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

137 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

138 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

139 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

140 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

141 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

142 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

143 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

144 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

145 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

146 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

147 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

148 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

149 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Light
, 
brush
)

150 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

151 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

152 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Midlight
, 
brush
)

153 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

154 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

155 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
D¬k
, 
brush
)

156 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

157 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

158 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Mid
, 
brush
)

159 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

160 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

161 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Text
, 
brush
)

162 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

163 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

164 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
BrightText
, 
brush
)

165 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

166 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

167 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

168 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

169 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

170 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Ba£
, 
brush
)

171 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

172 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

173 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

174 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

175 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

176 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Shadow
, 
brush
)

177 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

178 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

179 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

180 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

181 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

182 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

183 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

184 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

185 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

186 
£lf
.
posFbkLbl
.
	`£tP®‘‹
(
·Ë‰e
)

187 
fÚt
 = 
QtGui
.
	`QFÚt
()

188 
fÚt
.
	`£tPoštSize
(8)

189 
fÚt
.
	`£tBŞd
(
True
)

190 
fÚt
.
	`£tWeight
(75)

191 
£lf
.
posFbkLbl
.
	`£tFÚt
(
fÚt
)

192 
£lf
.
posFbkLbl
.
	`£tAutoFlBackground
(
True
)

193 
£lf
.
posFbkLbl
.
	`£tF¿meSh­e
(
QtWidg‘s
.
QF¿me
.
StyËdPª–
)

194 
£lf
.
posFbkLbl
.
	`£tF¿meShadow
(
QtWidg‘s
.
QF¿me
.
Sunk’
)

195 
£lf
.
posFbkLbl
.
	`£tText
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "0.0", 
NÚe
))

196 
£lf
.
posFbkLbl
.
	`£tAlignm’t
(
QtCÜe
.
Qt
.
AlignC’‹r
)

197 
£lf
.
posFbkLbl
.
	`£tObjeùName
(
	`_äomUtf8
("posFbkLbl"))

198 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
posFbkLbl
)

199 
£lf
.
v”tiÿlLayout
.
	`addLayout
(£lf.
hÜizÚlLayout
)

201 
£lf
.
	`»Œª¦©eUi
(self)

202 
QtCÜe
.
QM‘aObjeù
.
	`cÚÃùSlÙsByName
(
£lf
)

204 
def
 
	$»Œª¦©eUi
(
£lf
, 
FÜm
):

205 
·ss


	@widgets/piezo_recal.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #FÜm 
im¶em’tiÚ
 
g’”©ed
 
äom
 
»adšg
 
ui
 
fe
 'piezoRecal.ui'

4 #
#C»©ed: 
Tue
 
S•
 13 11:08:30 2016

5 #by: 
PyQt4
 
UI
 
code
 
g’”©Ü
 4.8.5

6 #
#WARNING! 
AÎ
 
chªges
 
made
 
š
 
this
 
fe
 
wl
 
be
 
lo¡
!

8 
äom
 
PyQt5
 
impÜt
 
	gQtCÜe
, 
	gQtGui
, 
	gQtWidg‘s


11 #_äomUtf8 = 
QtCÜe
.
QSŒšg
.
äomUtf8


12 #exû± 
A‰ribu‹E¼Ü
:

13 
	g_äomUtf8
 = 
Ïmbda
 
s
: s

15 
şass
 
	$p›zo_»ÿl
(
QtWidg‘s
.
QWidg‘
):

16 
def
 
	$__š™__
(
£lf
):

17 
QtWidg‘s
.
QWidg‘
.
	`__š™__
(
£lf
)

18 
£lf
.
	`£tObjeùName
(
	`_äomUtf8
("Form"))

19 
£lf
.
	`»size
(502, 20)

20 
£lf
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(0, 20))

21 
£lf
.
	`£tWšdowT™Ë
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "FÜm", 
NÚe
))

22 
£lf
.
v”tiÿlLayout
 = 
QtWidg‘s
.
	`QVBoxLayout
(self)

23 
£lf
.
v”tiÿlLayout
.
	`£tS·cšg
(0)

24 
£lf
.
v”tiÿlLayout
.
	`£tSizeCÚ¡¿št
(
QtWidg‘s
.
QLayout
.
S‘NoCÚ¡¿št
)

25 
£lf
.
v”tiÿlLayout
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

26 
£lf
.
v”tiÿlLayout
.
	`£tObjeùName
(
	`_äomUtf8
("verticalLayout"))

27 
£lf
.
hÜizÚlLayout
 = 
QtWidg‘s
.
	`QHBoxLayout
()

28 
£lf
.
hÜizÚlLayout
.
	`£tObjeùName
(
	`_äomUtf8
("horizontalLayout"))

29 
£lf
.
»ûÁ”BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
(self)

30 
£lf
.
»ûÁ”BŠ
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(160, 0))

31 
£lf
.
»ûÁ”BŠ
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(16777215, 20))

32 
£lf
.
»ûÁ”BŠ
.
	`£tText
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "Re-ûÁ” FšeX P›zo", 
NÚe
))

33 
£lf
.
»ûÁ”BŠ
.
	`£tObjeùName
(
	`_äomUtf8
("recenterBtn"))

34 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
»ûÁ”BŠ
)

35 
¥aûrI‹m
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(10, 20, QtWidg‘s.
QSizePŞicy
.
Ex·ndšg
, QtWidg‘s.QSizePŞicy.
Mšimum
)

36 
£lf
.
hÜizÚlLayout
.
	`addI‹m
(
¥aûrI‹m
)

37 
£lf
.
posStsLbl
 = 
QtWidg‘s
.
	`QLab–
(self)

38 
£lf
.
posStsLbl
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(50, 0))

39 
£lf
.
posStsLbl
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(50, 20))

40 
£lf
.
posStsLbl
.
	`£tText
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "STOPPED", 
NÚe
))

41 
£lf
.
posStsLbl
.
	`£tAlignm’t
(
QtCÜe
.
Qt
.
AlignC’‹r
)

42 
£lf
.
posStsLbl
.
	`£tObjeùName
(
	`_äomUtf8
("posStsLbl"))

43 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
posStsLbl
)

44 
¥aûrI‹m1
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(40, 20, QtWidg‘s.
QSizePŞicy
.
Ex·ndšg
, QtWidg‘s.QSizePŞicy.
Mšimum
)

45 
£lf
.
hÜizÚlLayout
.
	`addI‹m
(
¥aûrI‹m1
)

46 
£lf
.
posFbkLbl
 = 
QtWidg‘s
.
	`QLab–
(self)

47 
£lf
.
posFbkLbl
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(80, 17))

48 
£lf
.
posFbkLbl
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(70, 17))

49 
£lf
.
posFbkLbl
.
	`£tBa£Size
(
QtCÜe
.
	`QSize
(0, 0))

50 
·Ë‰e
 = 
QtGui
.
	`QP®‘‹
()

51 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

52 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

53 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

54 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

55 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

56 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

57 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

58 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

59 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Light
, 
brush
)

60 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

61 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

62 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Midlight
, 
brush
)

63 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

64 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

65 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
D¬k
, 
brush
)

66 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

67 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

68 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Mid
, 
brush
)

69 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

70 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

71 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Text
, 
brush
)

72 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

73 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

74 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
BrightText
, 
brush
)

75 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

76 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

77 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

78 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

79 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

80 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Ba£
, 
brush
)

81 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

82 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

83 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

84 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

85 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

86 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Shadow
, 
brush
)

87 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

88 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

89 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

90 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

91 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

92 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

93 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

94 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

95 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

96 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

97 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

98 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

99 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

100 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

101 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

102 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

103 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

104 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Light
, 
brush
)

105 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

106 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

107 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Midlight
, 
brush
)

108 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

109 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

110 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
D¬k
, 
brush
)

111 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

112 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

113 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Mid
, 
brush
)

114 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

115 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

116 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Text
, 
brush
)

117 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

118 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

119 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
BrightText
, 
brush
)

120 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

121 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

122 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

123 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

124 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

125 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Ba£
, 
brush
)

126 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

127 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

128 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

129 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

130 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

131 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Shadow
, 
brush
)

132 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

133 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

134 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

135 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

136 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

137 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

138 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

139 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

140 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

141 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

142 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

143 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

144 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

145 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

146 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

147 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

148 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

149 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Light
, 
brush
)

150 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

151 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

152 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Midlight
, 
brush
)

153 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

154 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

155 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
D¬k
, 
brush
)

156 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

157 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

158 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Mid
, 
brush
)

159 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

160 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

161 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Text
, 
brush
)

162 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

163 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

164 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
BrightText
, 
brush
)

165 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

166 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

167 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

168 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

169 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

170 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Ba£
, 
brush
)

171 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

172 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

173 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

174 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

175 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

176 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Shadow
, 
brush
)

177 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

178 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

179 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

180 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

181 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

182 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

183 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

184 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

185 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

186 
£lf
.
posFbkLbl
.
	`£tP®‘‹
(
·Ë‰e
)

187 
fÚt
 = 
QtGui
.
	`QFÚt
()

188 
fÚt
.
	`£tPoštSize
(8)

189 
fÚt
.
	`£tBŞd
(
True
)

190 
fÚt
.
	`£tWeight
(75)

191 
£lf
.
posFbkLbl
.
	`£tFÚt
(
fÚt
)

192 
£lf
.
posFbkLbl
.
	`£tAutoFlBackground
(
True
)

193 
£lf
.
posFbkLbl
.
	`£tF¿meSh­e
(
QtWidg‘s
.
QF¿me
.
StyËdPª–
)

194 
£lf
.
posFbkLbl
.
	`£tF¿meShadow
(
QtWidg‘s
.
QF¿me
.
Sunk’
)

195 
£lf
.
posFbkLbl
.
	`£tText
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "0.0", 
NÚe
))

196 
£lf
.
posFbkLbl
.
	`£tAlignm’t
(
QtCÜe
.
Qt
.
AlignC’‹r
)

197 
£lf
.
posFbkLbl
.
	`£tObjeùName
(
	`_äomUtf8
("posFbkLbl"))

198 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
posFbkLbl
)

199 
£lf
.
v”tiÿlLayout
.
	`addLayout
(£lf.
hÜizÚlLayout
)

201 
£lf
.
	`»Œª¦©eUi
(self)

202 
QtCÜe
.
QM‘aObjeù
.
	`cÚÃùSlÙsByName
(
£lf
)

204 
def
 
	$»Œª¦©eUi
(
£lf
, 
FÜm
):

205 
·ss


	@widgets/prog_dict_utils.py

2 
C»©ed
 
Ú
 
	gJª
 16, 2017

4 @
	gauthÜ
: 
b”g


7 
a
 
cŞËùiÚ
 
of
 
ut™›s
 
th©
 
¬e
 
u£d
 
to
 
ü—‹
‡ 
¡ªd¬d
 
diùiÚ¬y
h© 
is
 u£dØ
communiÿ‹
 
w™h
 
the
 
sÿn_queue_bË
 
widg‘


10 
äom
 
şs
.
uts
.
diù_uts
 
impÜt
 
dù_g‘
, 
	gdù_put


12 
	gPROG_DCT_ID
 = 'PROG_DICT'

13 
PROG_DCT_SPID
 = 'PROG.SPID'

14 
PROG_DCT_PERCENT
 = 'PROG.PERCENT'

15 
PROG_DCT_STATE
 = 'PROG.STATE'

17 
def
 
make_´og»ss_diù
(
¥_id
=
NÚe
, 
³rûÁ
=0.0):

19 
ü—‹
 
a
 
¡ªd¬d
 
diù
 
th©
 
is
 
u£d
 
to
 
£nd
 
šfÜm©iÚ
Ø
the
 
sÿn_q_v›w


22 
dù
 = {}

23 
dù_put
(
dù
, 
PROG_DCT_ID
, PROG_DCT_ID)

24 
dù_put
(
dù
, 
PROG_DCT_SPID
, 
¥_id
)

25 
dù_put
(
dù
, 
PROG_DCT_PERCENT
, 
³rûÁ
)

26 
dù_put
(
dù
, 
PROG_DCT_STATE
, 0)

28 (
	gdù
)

	@widgets/prog_dict_utils.py

2 
C»©ed
 
Ú
 
	gJª
 16, 2017

4 @
	gauthÜ
: 
b”g


7 
a
 
cŞËùiÚ
 
of
 
ut™›s
 
th©
 
¬e
 
u£d
 
to
 
ü—‹
‡ 
¡ªd¬d
 
diùiÚ¬y
h© 
is
 u£dØ
communiÿ‹
 
w™h
 
the
 
sÿn_queue_bË
 
widg‘


10 
äom
 
şs
.
uts
.
diù_uts
 
impÜt
 
dù_g‘
, 
	gdù_put


12 
	gPROG_DCT_ID
 = 'PROG_DICT'

13 
PROG_DCT_SPID
 = 'PROG.SPID'

14 
PROG_DCT_PERCENT
 = 'PROG.PERCENT'

15 
PROG_DCT_STATE
 = 'PROG.STATE'

17 
def
 
make_´og»ss_diù
(
¥_id
=
NÚe
, 
³rûÁ
=0.0):

19 
ü—‹
 
a
 
¡ªd¬d
 
diù
 
th©
 
is
 
u£d
 
to
 
£nd
 
šfÜm©iÚ
Ø
the
 
sÿn_q_v›w


22 
dù
 = {}

23 
dù_put
(
dù
, 
PROG_DCT_ID
, PROG_DCT_ID)

24 
dù_put
(
dù
, 
PROG_DCT_SPID
, 
¥_id
)

25 
dù_put
(
dù
, 
PROG_DCT_PERCENT
, 
³rûÁ
)

26 
dù_put
(
dù
, 
PROG_DCT_STATE
, 0)

28 (
	gdù
)

	@widgets/pvDisplayPanel.py

2 
C»©ed
 
Ú
 
	gNov
 2, 2015

4 @
	gauthÜ
: 
b”gr


7 
C»©ed
 
Ú
 
Nov
 2, 2015

9 @
	gauthÜ
: 
b”gr


12 
C»©ed
 
Ú
 2014-07-15

14 @
authÜ
: 
b”gr


16 
impÜt
 
sys


17 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
	guic
, 
	gQtWidg‘s


19 
impÜt
 
	gtime


20 
impÜt
 
	gQueue


21 
impÜt
 
	g©ex™


23 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	gwidg‘s
.
fbk
 
impÜt
 
	gfbkCÏss


24 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
bl07ID01
 
impÜt
 
	gMAIN_OBJ
, 
	gPOS_TYPE_BL
, 
	gPOS_TYPE_ES


26 
äom
 
	gşs
.
	g­p_d©a
.
deçuÉs
 
impÜt
 
	grgb_as_hex
, 
	gma¡”_cŞÜs
, 
	gg‘_¡yË


27 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


29 #£tu°
moduË
 
logg”
 
w™h
 
a
  do-
nÙhšg
 
hªdËr


30 
	g_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

33 
şass
 
	$PVsPª–
(
QtWidg‘s
.
QWidg‘
):

35 
This
 
is
 
a
 
widg‘
 
th©
 i 
giv’
‡ 
li¡
 
of
 
pv
'shat MUSTƒxist inhe MAIN_OBJ dict‡nd creates Qlabel‡nd ca_aiLabel

36 
—ch


38 :
»tuºs
: 
NÚe


40 
def
 
	`__š™__
(
£lf
, 
pv_diù
, 
egu
='', 
’gš“ršg_nÙ©iÚ
=
F®£
):

41 
	`su³r
(
PVsPª–
, 
£lf
).
	`__š™__
()

43 
£lf
.
pv_dù
 = 
pv_diù


44 
£lf
.
exşude_li¡
 = [ ]

46 
£lf
.
fbk_’abËd
 = 
F®£


47 
£lf
.
tm
 = 
NÚe


48 
£lf
.
tmlib
 = 
NÚe


50 
£lf
.
vbox
 = 
QtWidg‘s
.
	`QVBoxLayout
()

51 
£lf
.
vbox
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

52 
£lf
.
vbox
.
	`£tS·cšg
(0)

54 
£lf
.
	`£tLayout
(£lf.
vbox
)

55 
£lf
.
pv_diù
 = {
	}
}

57 
pv_keys
 = 
£lf
.
pv_dù
.
keys
()

58 
pv_keys
.
sÜt
()

59 
pv_Çme
 
š
 
pv_keys
:

60 if(
pv_Çme
 
š
 
£lf
.
exşude_li¡
):

63 
pv
 = 
£lf
.
pv_dù
[
pv_Çme
]

64 
fbk_v®
 = 
pv
.
g‘_pos™iÚ
()

65 
pv_ui
 = 
fbkCÏss
(
pv
,…v.
DESC
, 
fbk_v®
=fbk_v®, 
’gš“ršg_nÙ©iÚ
=engineering_notation)

66 
pv_ui
.
un™sLbl
.
£tText
(
egu
)

67 
£lf
.
vbox
.
addWidg‘
(
pv_ui
)

69 
£lf
.
pv_diù
[
pv_Çme
] = (…v_Çme, 
	gpv_ui
)#, 
	gÿ_Lbl
)

71 
	g£lf
.
	gfbk_’abËd
 = 
True


72 
©ex™
.(
£lf
.
Ú_ex™
)

74 
def
 
	$Ú_ex™
(
£lf
):

76 
·ss


78 
def
 
	$go
():

79 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

80 
dev_obj
 = 
MAIN_OBJ
.
	`g‘_deviû_obj
()

81 
‹mps
 = 
dev_obj
.
	`g‘_®l_‹m³¿tu»s
(
POS_TYPE_ES
)

82 
wšdow2
 = 
	`PVsPª–
(
‹mps
, 
egu
='deg C')

83 
´s¤s
 = 
dev_obj
.
	`g‘_®l_´essu»s
(
POS_TYPE_ES
)

84 
wšdow3
 = 
	`PVsPª–
(
´s¤s
, 
egu
='tÜr', 
’gš“ršg_nÙ©iÚ
=
True
)

85 
wšdow2
.
	`show
()

86 
wšdow3
.
	`show
()

87 
­p
.
	`exec_
()

90 
def
 
	$´ofe_™
():

92 
´ofe
.
Profe
.
bŸs
 = 9.95500362835e-07

93 
´ofe
.
	`run
('go()', 'testprof.dat')

94 
p
 = 
p¡©s
.
	`Sts
('testprof.dat')

95 
p
.
	`sÜt_¡©s
('cumuÏtive').
	`´št_¡©s
(100)

98 
__Çme__
 == '__main__':

99 #impÜˆ
´ofe


100 #impÜˆ
p¡©s


101 
	`log_to_qt
()

102 
	`go
()

	@widgets/pvDisplayPanel.py

2 
C»©ed
 
Ú
 
	gNov
 2, 2015

4 @
	gauthÜ
: 
b”gr


7 
C»©ed
 
Ú
 
Nov
 2, 2015

9 @
	gauthÜ
: 
b”gr


12 
C»©ed
 
Ú
 2014-07-15

14 @
authÜ
: 
b”gr


16 
impÜt
 
sys


17 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
	guic
, 
	gQtWidg‘s


19 
impÜt
 
	gtime


20 
impÜt
 
	gQueue


21 
impÜt
 
	g©ex™


23 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	gwidg‘s
.
fbk
 
impÜt
 
	gfbkCÏss


24 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
bl07ID01
 
impÜt
 
	gMAIN_OBJ
, 
	gPOS_TYPE_BL
, 
	gPOS_TYPE_ES


26 
äom
 
	gşs
.
	g­p_d©a
.
deçuÉs
 
impÜt
 
	grgb_as_hex
, 
	gma¡”_cŞÜs
, 
	gg‘_¡yË


27 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


29 #£tu°
moduË
 
logg”
 
w™h
 
a
  do-
nÙhšg
 
hªdËr


30 
	g_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

33 
şass
 
	$PVsPª–
(
QtWidg‘s
.
QWidg‘
):

35 
This
 
is
 
a
 
widg‘
 
th©
 i 
giv’
‡ 
li¡
 
of
 
pv
'shat MUSTƒxist inhe MAIN_OBJ dict‡nd creates Qlabel‡nd ca_aiLabel

36 
—ch


38 :
»tuºs
: 
NÚe


40 
def
 
	`__š™__
(
£lf
, 
pv_diù
, 
egu
='', 
’gš“ršg_nÙ©iÚ
=
F®£
):

41 
	`su³r
(
PVsPª–
, 
£lf
).
	`__š™__
()

43 
£lf
.
pv_dù
 = 
pv_diù


44 
£lf
.
exşude_li¡
 = [ ]

46 
£lf
.
fbk_’abËd
 = 
F®£


47 
£lf
.
tm
 = 
NÚe


48 
£lf
.
tmlib
 = 
NÚe


50 
£lf
.
vbox
 = 
QtWidg‘s
.
	`QVBoxLayout
()

51 
£lf
.
vbox
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

52 
£lf
.
vbox
.
	`£tS·cšg
(0)

54 
£lf
.
	`£tLayout
(£lf.
vbox
)

55 
£lf
.
pv_diù
 = {
	}
}

57 
pv_keys
 = 
£lf
.
pv_dù
.
keys
()

58 
pv_keys
.
sÜt
()

59 
pv_Çme
 
š
 
pv_keys
:

60 if(
pv_Çme
 
š
 
£lf
.
exşude_li¡
):

63 
pv
 = 
£lf
.
pv_dù
[
pv_Çme
]

64 
fbk_v®
 = 
pv
.
g‘_pos™iÚ
()

65 
pv_ui
 = 
fbkCÏss
(
pv
,…v.
DESC
, 
fbk_v®
=fbk_v®, 
’gš“ršg_nÙ©iÚ
=engineering_notation)

66 
pv_ui
.
un™sLbl
.
£tText
(
egu
)

67 
£lf
.
vbox
.
addWidg‘
(
pv_ui
)

69 
£lf
.
pv_diù
[
pv_Çme
] = (…v_Çme, 
	gpv_ui
)#, 
	gÿ_Lbl
)

71 
	g£lf
.
	gfbk_’abËd
 = 
True


72 
©ex™
.(
£lf
.
Ú_ex™
)

74 
def
 
	$Ú_ex™
(
£lf
):

76 
·ss


78 
def
 
	$go
():

79 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

80 
dev_obj
 = 
MAIN_OBJ
.
	`g‘_deviû_obj
()

81 
‹mps
 = 
dev_obj
.
	`g‘_®l_‹m³¿tu»s
(
POS_TYPE_ES
)

82 
wšdow2
 = 
	`PVsPª–
(
‹mps
, 
egu
='deg C')

83 
´s¤s
 = 
dev_obj
.
	`g‘_®l_´essu»s
(
POS_TYPE_ES
)

84 
wšdow3
 = 
	`PVsPª–
(
´s¤s
, 
egu
='tÜr', 
’gš“ršg_nÙ©iÚ
=
True
)

85 
wšdow2
.
	`show
()

86 
wšdow3
.
	`show
()

87 
­p
.
	`exec_
()

90 
def
 
	$´ofe_™
():

92 
´ofe
.
Profe
.
bŸs
 = 9.95500362835e-07

93 
´ofe
.
	`run
('go()', 'testprof.dat')

94 
p
 = 
p¡©s
.
	`Sts
('testprof.dat')

95 
p
.
	`sÜt_¡©s
('cumuÏtive').
	`´št_¡©s
(100)

98 
__Çme__
 == '__main__':

99 #impÜˆ
´ofe


100 #impÜˆ
p¡©s


101 
	`log_to_qt
()

102 
	`go
()

	@widgets/sampleSelector.py

2 
C»©ed
 
	gÚ
 2013-07-16

4 @
	gauthÜ
: 
b”gr


7 
C»©ed
 
Ú
 2013-06-28

9 @
authÜ
: 
b”gr


11 #!/
u¤
/
bš
/
pythÚ


13 
impÜt
 
sys


14 
impÜt
 
numpy
 
as
 
Å


16 
äom
 
PyQt5
 
impÜt
 
QtGui
, 
	gQtCÜe
, 
	gQtWidg‘s


18 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
bioXasIM
 
impÜt
 
	gabs_·th_to_ši_fe


19 #äom 
şs
.
sÿÂšg
.
SÿnDef
 
impÜt
 
ImageLšeUniSÿnDef
, 
EÃrgyRegiÚSÿnDef


20 #äom 
şs
.
­¶iÿtiÚs
.
pyStxm
.
bl10ID01
 
impÜt
 
DEVICE_CFG


21 
äom
 
	gşs
.
	guts
.
cfg·r£r
 
impÜt
 
	gCÚfigCÏss


22 
äom
 
	gbcm
.
	g•ics_deviûs
.
mÙÜ_v2
 
impÜt
 
	gMÙÜ_V2


24 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
bl07ID01
 
impÜt
 
	gMAIN_OBJ


26 #»ad 
the
 
ši
 
fe
 
ªd
 
lßd
h 
dœeùÜ›s


27 
	g­pCÚfig
 = 
CÚfigCÏss
(
abs_·th_to_ši_fe
)

28 
uiDœ
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'uiDir')

29 
	gd©aDœ
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'dataDir')

30 
	gmŒcfg
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'mtrcfg')

31 
	gSLASH
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'dirslash')

33 
	g_§m¶e_pos™iÚs
 = {}

35 
xpos_1
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'xpos_1')

36 
	gypos_1
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'ypos_1')

37 
	gxpos_2
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'xpos_2')

38 
	gypos_2
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'ypos_2')

39 
	gxpos_3
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'xpos_3')

40 
	gypos_3
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'ypos_3')

41 
	gxpos_4
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'xpos_4')

42 
	gypos_4
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'ypos_4')

43 
	gxpos_5
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'xpos_5')

44 
	gypos_5
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'ypos_5')

45 
	gxpos_6
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'xpos_6')

46 
	gypos_6
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'ypos_6')

47 
	gxi0pos
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'xi0pos')

48 
	gyi0pos
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'yi0pos')

49 
	g§m¶e_cœşe_dŸm
 = (
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'sample_circle_diam'))

52 
	g_§m¶e_pos™iÚs
['pos1'] = ((
xpos_1
), (
	gypos_1
))

53 
	g_§m¶e_pos™iÚs
['pos2'] = ((
xpos_2
), (
	gypos_2
))

54 
	g_§m¶e_pos™iÚs
['pos3'] = ((
xpos_3
), (
	gypos_3
))

55 
	g_§m¶e_pos™iÚs
['pos4'] = ((
xpos_4
), (
	gypos_4
))

56 
	g_§m¶e_pos™iÚs
['pos5'] = ((
xpos_5
), (
	gypos_5
))

57 
	g_§m¶e_pos™iÚs
['pos6'] = ((
xpos_6
), (
	gypos_6
))

58 
	g_§m¶e_pos™iÚs
['i0pos'] = ((
xi0pos
), (
	gyi0pos
))

60 
	gMOTORFBK_TO_SCREEN_UNITS
 = (52.5 / 5000)

62 
def
 
	$g‘_v–o_fÜ_sÿn
(
¡¬t
, 
¡İ
, 
pošts
, 
dw–l
):

65 :
·¿m
 
sÿn
: 
a
 
v®id
 
sÿnDef
 
objeù
 
th©
 
cÚšs
 
®l
 
the
 
šfÜm©iÚ


66 
»quœed
 
to
 
execu‹
 
the
 
sÿn
.

67 :
ty³
 
sÿn
: 
sÿnDef
.

68 :
·¿m
 
dw–l
: 
the
 dw–È
	$time
 (
š
 
ms
è
¥ecif›d
 iÀ
the
 
’”gy
 
»giÚ
 
defš™iÚ
 
this
 
sÿn


69 :
ty³
 
dw–l
: 

70 :
·¿m
 
accdccD
: 
the
 
acûË¿‹
 
decûË¿‹
 
di¡ªû
 
th©
 
is
 
·dded
 
to
h
¡¬t
 
ªd
 
¡İ
 
of
 
—ch


71 
sÿn
 
move
, 
this
 
di¡ªû
 
is
 
»quœed
 
to
 
give
 
the
 
mÙÜ
 
’ough
 
time
Ø
»ach


72 
cÚ¡ªt
 
v–oc™y
 
befÜe
 
»achšg
 
the
 
pos™iÚ
 
©
 
which
h
shu‰”
 
wl
 
be
 
İ’ed
,

73 
ªd
 
’ough
 
di¡ªû
 
the
 
mÙÜ
 
to
 
go
 
·¡
h
pos™iÚ
 
©
 
which
h
shu‰”
 
wl


74 
şo£
.

75 :
ty³
 
accdccD
: 

77 :
»tuºs
: 
NÚe


80 #maxV–oX = 
sÿn
.
	`g‘_X_pos™iÚ”
().
	`g‘_max_v–oc™y
()

81 
d–
 = 
¡İ
 - 
¡¬t


82 
accRªge
 = 
d–
 * 0.08 #%4 
of
 
desœed
 
lše
 
Ëngth
, 
ªy
 
sm®Ër
 
ªd
 
the
 
sÿn
 
çs
 
due
 
to
 
m¬k”
 
loÿtiÚ
 
too
 
şo£
o

83 
dccRªge
 = 
d–
 * 0.0000001

84 
accdccD
 = 
accRªge
 + 
dccRªge


85 
lšeTime
 = 
pošts
 * (
dw–l
 *0.001)

86 
‰lDi¡
 = (
¡İ
 - 
¡¬t
è/ 1000.0 #tØ
tuº
 
back
 
što
 
mm


87 
v–o
 = 
‰lDi¡
 / 
lšeTime


88 
´št
 'g‘_v–o_fÜ_sÿn:…ošt ğ%d,„ªgğ%.3f, dw–Èğ%.2àms, v–Øğ%.3fàmm/s' % (
pošts
, 
‰lDi¡
, 
dw–l
, 
v–o
)

89 (
v–o
)

92 
şass
 
	$S’d”Objeù
(
QtCÜe
.
QObjeù
):

93 
£Ëùed
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
)

95 
şass
 
	$Node
(
QtWidg‘s
.
QG¿phicsI‹m
):

99 
def
 
	`__š™__
(
£lf
, 
·»Á
 = 
NÚe
, 
Çme
='NONE', 
pos_num
=1, 
x
=10, 
y
=10, 
¿d
 = 10, 
sÿËr
=1.0, 
şr
=
QtCÜe
.
Qt
.
g¿y
):

100 #QtWidg‘s.
QG¿phicsI‹m
.
	`__š™__
(
£lf
,
·»Á
)

101 
	`su³r
(
Node
, 
£lf
).
	`__š™__
(
·»Á
)

102 
£lf
.
sig
 = 
	`S’d”Objeù
()

103 
£lf
.
Çme
 =‚ame

104 
£lf
.
pos_num
 =…os_num

105 #£lf.
	`£tFÏg
(
QtWidg‘s
.
QG¿phicsI‹m
.
I‹mIsMovabË
)

106 
£lf
.
	`£tFÏg
(
QtWidg‘s
.
QG¿phicsI‹m
.
I‹mS’dsGeom‘ryChªges
)

107 
£lf
.
	`£tCacheMode
(
QtWidg‘s
.
QG¿phicsI‹m
.
DeviûCoÜdš©eCache
)

108 
£lf
.
x
 = x - 
¿d


109 
£lf
.
y
 = y - 
¿d


110 
£lf
.
wd
 = 
¿d
 * 2.0

111 
£lf
.
ht
 = 
¿d
 * 2.0

112 
£lf
.
sÿËr
 = scaler

115 
£lf
.
ûÁ”X
 = (£lf.
x
 + (0.5 * s–f.
wd
)è* 
sÿËr


116 
£lf
.
ûÁ”Y
 = (£lf.
y
 + (0.5 * s–f.
wd
)è* 
sÿËr


117 #´šˆ'cœş[%d] cx=%àcy=%f' % (
pos_num
, 
£lf
.
ûÁ”X
, s–f.
ûÁ”Y
)

119 #šˆ
x
, 
y
, 
width
, 
height


121 
£lf
.
äame
 = 
Å
.
	`¬¿y
([£lf.
x
, s–f.
y
, s–f.
wd
, s–f.
ht
]è* 
sÿËr


122 
£lf
.
bndg»ù
 = 
Å
.
	`¬¿y
([£lf.
x
, s–f.
y
, s–f.
wd
, s–f.
ht
]è* 
sÿËr


123 
£lf
.
cœşe
 = 
Å
.
	`¬¿y
([£lf.
x
, s–f.
y
, s–f.
wd
, s–f.
ht
]è* 
sÿËr


124 
£lf
.
şridx
 = 0

125 
£lf
.
şr
 = clr

126 
£lf
.
£Ëùed
 = 
F®£


128 #£lf.
	`upd©e
(
£lf
.
Ëá
, s–f.
tİ
, s–f.
right
, s–f.
btm
)

129 
def
 
	$Ú_£Ëùed
(
£lf
, 
cœşe
):

130 
£lf
.
sig
.
£Ëùed
.
	`em™
(self)

132 
def
 
	$£t_£Ëùed
(
£lf
, 
£l
=
F®£
):

133 
£lf
.
£Ëùed
 = 
£l


134 
£lf
.
	`upd©e
()

136 
def
 
	$boundšgReù
(
£lf
):

137 
adju¡
 = 2.0

138  
QtCÜe
.
	`QReùF
(
£lf
.
bndg»ù
[0] - 
adju¡
, self.bndgrect[1] -‡djust, self.bndgrect[2] +‡djust, self.bndgrect[3] +‡djust)

140 
def
 
	$·št
(
£lf
, 
·š‹r
, 
İtiÚ
, 
widg‘
):

141 #·š‹r.
	`£tP’
(
QtCÜe
.
Qt
.
NoP’
)

142 #·š‹r.
	`£tBrush
(
QtCÜe
.
Qt
.
d¬kG¿y
)

143 #·š‹r.
	`d¿wEÎ£
(
£lf
.
cœşe
[0], self.circle[1], self.circle[2], self.circle[3])

144 #
 = QtGui.QRadŸlG¿d›Á(-3, -3, 10)

145 #ià
İtiÚ
.
¡©e
 & 
QtWidg‘s
.
QStyË
.
S‹_Sunk’
:

146 #g¿d›Á.
	`£tC’‹r
(3, 3)

147 #g¿d›Á.
	`£tFoÿlPošt
(3, 3)

148 #g¿d›Á.
	`£tCŞÜAt
(1, 
QtGui
.
	`QCŞÜ
(
QtCÜe
.
Qt
.
y–low
).
	`light
(120))

149 #g¿d›Á.
	`£tCŞÜAt
(0, 
QtGui
.
	`QCŞÜ
(
QtCÜe
.
Qt
.
d¬kY–low
).
	`light
(120))

151 if(
£lf
.
£Ëùed
):

152 #£lf.
şr
 = 
QtCÜe
.
Qt
.
g»’


153 
£lf
.
şr
 = 
QtCÜe
.
Qt
.
d¬kG»’


155 
£lf
.
şr
 = 
QtCÜe
.
Qt
.
g¿y


157 
g¿d›Á
.
	`£tCŞÜAt
(0, 
£lf
.
şr
)

158 
g¿d›Á
.
	`£tCŞÜAt
(1, 
£lf
.
şr
)

159 #
.£tBrush(QtGui.QBrush(g¿d›Á))

160 
·š‹r
.
	`£tP’
(
QtGui
.
	`QP’
(
£lf
.
şr
, 0))

161 
·š‹r
.
	`d¿wEÎ£
(
£lf
.
äame
[0], self.frame[1], self.frame[2], self.frame[3])

163 
def
 
	$™emChªge
(
£lf
, 
chªge
, 
v®ue
):

164 
chªge
 =ğ
QtWidg‘s
.
QG¿phicsI‹m
.
I‹mPos™iÚHasChªged
:

165 
´št
 '[%s] I‹mPos™iÚ chªged' % 
£lf
.
Çme


167  
	`su³r
(
Node
, 
£lf
).
	`™emChªge
(
chªge
, 
v®ue
)

169 
def
 
	$mou£P»ssEv’t
(
£lf
, 
ev’t
):

170 #´šˆ'[%s] mou£…»s£d' % 
£lf
.
Çme


171 if(
£lf
.
£Ëùed
):

172 
£lf
.
£Ëùed
 = 
F®£


173 #£lf.
şr
 = 
QtCÜe
.
Qt
.
g¿y


175 
£lf
.
£Ëùed
 = 
True


176 #£lf.
şr
 = 
QtCÜe
.
Qt
.
g»’


177 
£lf
.
sig
.
£Ëùed
.
	`em™
(self)

179 #£lf.
şridx
 += 1

180 #if(
£lf
.
şridx
 > 5):

181 #£lf.
şridx
 = 0

182 #
#if(
£lf
.
şridx
 == 0):

183 #£lf.
şr
 = 
QtCÜe
.
Qt
.
blue


184 #–if(
£lf
.
şridx
 == 1):

185 #£lf.
şr
 = 
QtCÜe
.
Qt
.
y–low


186 #–if(
£lf
.
şridx
 == 2):

187 #£lf.
şr
 = 
QtCÜe
.
Qt
.
cyª


188 #–if(
£lf
.
şridx
 == 3):

189 #£lf.
şr
 = 
QtCÜe
.
Qt
.
»d


190 #–if(
£lf
.
şridx
 == 4):

191 #£lf.
şr
 = 
QtCÜe
.
Qt
.
bÏck


192 #–if(
£lf
.
şridx
 == 5):

193 #£lf.
şr
 = 
QtCÜe
.
Qt
.
g»’


194 
£lf
.
	`upd©e
()

195 
	`su³r
(
Node
, 
£lf
).
	`mou£P»ssEv’t
(
ev’t
)

197 
def
 
	$mou£R–—£Ev’t
(
£lf
, 
ev’t
):

198 #´šˆ'[%s] mou£„–—£d' % 
£lf
.
Çme


200 
£lf
.
	`upd©e
()

201 
	`su³r
(
Node
, 
£lf
).
	`mou£R–—£Ev’t
(
ev’t
)

204 
şass
 
	$üossHaœI‹m
(
QtWidg‘s
.
QG¿phicsEÎ£I‹m
):

205 
def
 
	$__š™__
(
£lf
, 
sÿÏr
, 
·»Á
=
NÚe
):

206 
QtWidg‘s
.
QG¿phicsPixm­I‹m
.
	`__š™__
(
£lf
, 
·»Á
)

208 
£lf
.
	`£tFÏg
(
QtWidg‘s
.
QG¿phicsI‹m
.
I‹mIsMovabË
, 
True
)

209 #£lf.
	`£tFÏg
(
QtWidg‘s
.
QG¿phicsI‹m
.
I‹mIsS–eùabË
, 
True
)

210 
£lf
.
ûÁ”X
 = 0

211 
£lf
.
ûÁ”Y
 = 0

212 
£lf
.
¿dius
 = 8

214 
£lf
.
x_fbk
 = 0

215 
£lf
.
y_fbk
 = 0

217 
£lf
.
x_zoff£t
 = 
sÿÏr
 * 125.333

218 
£lf
.
y_zoff£t
 = 
sÿÏr
 * 84.0

220 
£lf
.
	`£tP’
(
QtGui
.
	`QP’
(QtGui.
	`QCŞÜ
(
QtCÜe
.
Qt
.
y–low
)))

221 #£lf.
	`£tP’
(
QtGui
.
	`QP’
(QtGui.
	`QCŞÜ
(
QtCÜe
.
Qt
.
blue
)))

222 
£lf
.
	`£tReù
(
QtCÜe
.
	`QReùF
(£lf.
ûÁ”X
-£lf.
¿dius
, s–f.
ûÁ”Y
-self.radius, self.radius, self.radius))

224 
£lf
.
tim”
 = 
QtCÜe
.
	`QTim”
()

225 
£lf
.
tim”
.
timeout
.
	`cÚÃù
(£lf.
upd©e_fbk
)

226 
£lf
.
tim”
.
	`¡¬t
(20)

228 
def
 
	$ÿlc_üossHaœ_ûÁ”X
(
£lf
, 
fbk
):

229 
chx
 = (
MOTORFBK_TO_SCREEN_UNITS
)*
fbk
 + 
£lf
.
x_zoff£t


230 (
chx
)

232 
def
 
	$ÿlc_üossHaœ_ûÁ”Y
(
£lf
, 
fbk
):

233 
chy
 = -1.0*(
MOTORFBK_TO_SCREEN_UNITS
)*
fbk
 + 
£lf
.
y_zoff£t


234 (
chy
)

236 
def
 
	$£t_x_fbk
(
£lf
, 
fbk
):

237 
£lf
.
x_fbk
 = 
fbk


239 
def
 
	$£t_y_fbk
(
£lf
, 
fbk
):

240 
£lf
.
y_fbk
 = 
fbk


242 
def
 
	$upd©e_fbk
(
£lf
):

243 #´šˆ'upd©e_fbk: xfk=%àyfbk=%f' % (
£lf
.
x_fbk
, s–f.
y_fbk
)

244 
x
 = 
£lf
.
	`ÿlc_üossHaœ_ûÁ”X
(£lf.
x_fbk
)

245 
y
 = 
£lf
.
	`ÿlc_üossHaœ_ûÁ”Y
(£lf.
y_fbk
)

246 #´šˆ'CHAIR: cx=%àcy=%f' % (
x
, 
y
)

247 
£lf
.
	`£t_ûÁ”
(
x
, 
y
)

249 
def
 
	$£t_ûÁ”
(
£lf
, 
x
, 
y
):

251 
£lf
.
ûÁ”X
 = 
x


252 
£lf
.
ûÁ”Y
 = 
y


253 
£lf
.
	`£tReù
(
QtCÜe
.
	`QReùF
(£lf.
ûÁ”X
-£lf.
¿dius
, s–f.
ûÁ”Y
-self.radius, self.radius, self.radius))

255 
def
 
	$move_ûÁ”
(
£lf
, 
x
, 
y
):

256 
£lf
.
ûÁ”X
 +ğ
x


257 
£lf
.
ûÁ”Y
 +ğ
y


258 
£lf
.
	`£tReù
(
QtCÜe
.
	`QReùF
(£lf.
ûÁ”X
-£lf.
¿dius
, s–f.
ûÁ”Y
-self.radius, self.radius, self.radius))

262 
şass
 
	$Sam¶eS–eùÜV›w
(
QtWidg‘s
.
QG¿phicsV›w
):

264 
£Ëùed
 = 
QtCÜe
.
	`pyqtSigÇl
()

266 
def
 
	`__š™__
(
£lf
, 
·»Á
 = 
NÚe
, 
Çme
='NONE', 
ûÁ”x
=10, 
ûÁ”y
=10, 
¿d
 = 10, 
sÿËr
=1.0, 
şr
=
QtCÜe
.
Qt
.
blue
, 
mutu®ly_exşude
=
True
):

267 
QtWidg‘s
.
QG¿phicsV›w
.
	`__š™__
(
£lf
,
·»Á
)

268 
£lf
.
	`£tBackgroundBrush
(
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
lightG¿y
))

270 
£lf
.
sûÃ
 = 
QtWidg‘s
.
	`QG¿phicsSûÃ
()

271 
£lf
.
	`£tMšimumSize
(250, 150)

273 
£lf
.
cœşes
 = []

274 
£lf
.
cœşes
.
	`­³nd
(£lf.
	`add_‹xt
('1',0, 50, 10, 30, 
sÿËr
))

275 
£lf
.
cœşes
.
	`­³nd
(£lf.
	`add_‹xt
('2',1, 120, 10, 30, 
sÿËr
))

276 
£lf
.
cœşes
.
	`­³nd
(£lf.
	`add_‹xt
('3',2, 190, 10, 30, 
sÿËr
))

277 
£lf
.
cœşes
.
	`­³nd
(£lf.
	`add_‹xt
('4',3, 50, 80, 30, 
sÿËr
))

278 
£lf
.
cœşes
.
	`­³nd
(£lf.
	`add_‹xt
('5',4, 120, 80, 30, 
sÿËr
))

279 
£lf
.
cœşes
.
	`­³nd
(£lf.
	`add_‹xt
('6',5, 190, 80, 30, 
sÿËr
))

281 
£lf
.
üosshaœ
 = 
	`üossHaœI‹m
(
sÿËr
)

283 #£lf.
absMŒX
 = 
	`MÙÜ_V2
('IOC:m11')

284 #£lf.
absMŒY
 = 
	`MÙÜ_V2
('IOC:m12')

287 
£lf
.
absMŒX
 = 
MAIN_OBJ
.
	`deviû
('SampleX')

288 
£lf
.
absMŒY
 = 
MAIN_OBJ
.
	`deviû
('SampleY')

291 
£lf
.
absMŒX
.
	`add_ÿÎback
('RBV', s–f.
Ú_xmÙÜ_fbk_chªge
)

292 
£lf
.
absMŒY
.
	`add_ÿÎback
('RBV', s–f.
Ú_ymÙÜ_fbk_chªge
)

293 #£lf.
üosshaœ
 = 
£lf
.
	`add_üossHaœ
('CH',6, 120, 80, 30, 
sÿËr
)

296 
£lf
.
üosshaœ
.
	`£t_x_fbk
(£lf.
absMŒX
.
	`g‘
('RBV'))

297 
£lf
.
üosshaœ
.
	`£t_y_fbk
(£lf.
absMŒY
.
	`g‘
('RBV'))

299 
£lf
.
sûÃ
.
	`addI‹m
(£lf.
üosshaœ
)

300 
£lf
.
	`£tSûÃ
(£lf.
sûÃ
)

302 
£lf
.
mutu®ly_exşude
 = mutually_exclude

305 
def
 
	$Ú_xmÙÜ_fbk_chªge
(
£lf
, **
kw
):

307 
£lf
.
üosshaœ
.
	`£t_x_fbk
(
kw
['value'])

308 #£lf.
üosshaœ
.
	`upd©e_fbk
()

310 
def
 
	$Ú_ymÙÜ_fbk_chªge
(
£lf
, **
kw
):

312 
£lf
.
üosshaœ
.
	`£t_y_fbk
(
kw
['value'])

313 #£lf.
üosshaœ
.
	`upd©e_fbk
()

316 
def
 
	$de£Ëù_®l
(
£lf
):

317 
i
 
š
 
	`¿nge
(
	$Ën
(
£lf
.
cœşes
)):

318 
£lf
.
cœşes
[
i
].
	`£t_£Ëùed
(
F®£
)

321 
def
 
	$Ú_şicked
(
£lf
, 
cœşe
):

322 #´šˆ'% şicked' % 
cœşe
.
Çme


323 
i
 
š
 
	`¿nge
(
	$Ën
(
£lf
.
cœşes
)):

324 #´šˆ
£lf
.
cœşes
[
i
]

325 if(
cœşe
.
Çme
 =ğ
£lf
.
cœşes
[
i
].name):

326 
£lf
.
£Ëùed
.
	`em™
(
i
)

327 
·ss


329 if(
£lf
.
mutu®ly_exşude
):

330 #de£Ëù 
the
 
Ùh”
 
cœşes


331 
£lf
.
cœşes
[
i
].
	`£t_£Ëùed
(
F®£
)

333 
def
 
	$g‘_£Ëùed_pos™iÚs
(
£lf
):

334 
l¡
 = []

335 
i
 
š
 
	`¿nge
(
	$Ën
(
£lf
.
cœşes
)):

336 if(
£lf
.
cœşes
[
i
].
£Ëùed
):

337 
l¡
.
	`­³nd
(
£lf
.
cœşes
[
i
])

338 (
l¡
)

340 
def
 
	$g‘_§m¶e_pos™iÚ
(
£lf
, 
pos
):

341 (
£lf
.
cœşes
[
pos
])

343 
def
 
	$add_‹xt
(
£lf
, 
‹xt
, 
pos_num
, 
x
, 
y
, 
¿d
, 
sÿËr
):

344 
node
 = 
	`Node
(
Çme
='pos' + 
‹xt
, 
pos_num
õos_num, 
x
=x, 
y
=y, 
¿d
ôad, 
sÿËr
=scaler)

345 
node
.
sig
.
£Ëùed
.
	`cÚÃù
(
£lf
.
Ú_şicked
)

346 
£lf
.
sûÃ
.
	`addI‹m
(
node
)

347 
txt
 = 
£lf
.
sûÃ
.
	`addText
(
‹xt
)

348 
fÚtSize
 = (10 * 
sÿËr
)

349 
txt
.
	`£tFÚt
(
QtGui
.
	`QFÚt
('A¿beyesqr', 
fÚtSize
))

350 
ûÁ”x
 = (
x
 - (
fÚtSize
/1.0)+2è* 
sÿËr


351 
ûÁ”y
 = (
y
 - ((
fÚtSize
/2)+8)è* 
sÿËr


352 
txt
.
	`£tPos
(
ûÁ”x
, 
ûÁ”y
)

353 (
node
)

355 
def
 
	$move_üosshaœ
(
£lf
, 
x
, 
y
):

356 
£lf
.
üosshaœ
.
	`move_ûÁ”
(
x
,
y
)

358 
def
 
	$move_mÙÜs
(
£lf
, 
x
, 
y
):

359 
£lf
.
absMŒX
.
	`move
(
x
)

360 
£lf
.
absMŒY
.
	`move
(
y
)

363 
şass
 
	$Sam¶eS–eùÜWidg‘
(
QtWidg‘s
.
QWidg‘
):

365 
do_´ev›w
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
)

366 
abÜt_´ev›w
 = 
QtCÜe
.
	`pyqtSigÇl
()

367 
£Ëùed
 = 
QtCÜe
.
	`pyqtSigÇl
()

369 
def
 
	`__š™__
(
£lf
, 
·»Á
 = 
NÚe
, 
Çme
='NONE', 
ûÁ”x
=10, 
ûÁ”y
=10, 
¿d
 = 10, 
sÿËr
=1.0, 
şr
=
QtCÜe
.
Qt
.
blue
):

370 
QtWidg‘s
.
QWidg‘
.
	`__š™__
(
£lf
,
·»Á
)

371 #£lf.
	`£tGeom‘ry
(50,50,400, 300)

372 #the£ 
¬e
 
the
 
v®ues
 
wh’
 
sÿËr
=1.0, 
nÜm®ized
 
width
 
ªd
 
height


373 
£lf
.
nÜmWidth
 = 275 * 
sÿËr


374 
£lf
.
nÜmHt
 = 300 * 
sÿËr


375 #£lf.
	`£tMšimumSize
(
£lf
.
nÜmWidth
, s–f.
nÜmHt
)

376 #£lf.
	`£tMaximumSize
(
£lf
.
nÜmWidth
, s–f.
nÜmHt
)

377 
£lf
.
bŠs_’abËd
 = 
F®£


378 #£lf.
ş—rBŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("Clear‡ll")

379 #£lf.
ÿlib¿‹BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("Calibrate")

380 #£lf.
´ev›wBŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("Preview")

381 #£lf.
abÜtBŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("Abort")

382 #
#gridLayouˆğ
QtWidg‘s
.
	`QGridLayout
()

383 #£lf.
_20x20BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("20x20")

384 #£lf.
_50x50BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("50x50")

385 #£lf.
_75x75BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("75x75")

386 #£lf.
_100x100BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("100x100")

387 #£lf.
_200x200BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("200x200")

388 #£lf.
_300x300BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("300x300")

389 #
#£lf.
_100x50BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("100x50")

390 #£lf.
_200x50BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("200x50")

391 #£lf.
_300x50BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("300x50")

392 #
#£lf.
_20x20BŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_´ev›wBŠ
)

393 #£lf.
_50x50BŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_´ev›wBŠ
)

394 #£lf.
_75x75BŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_´ev›wBŠ
)

395 #£lf.
_100x100BŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_´ev›wBŠ
)

396 #£lf.
_200x200BŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_´ev›wBŠ
)

397 #£lf.
_300x300BŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_´ev›wBŠ
)

398 #
#£lf.
_100x50BŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_´ev›wBŠ
)

399 #£lf.
_200x50BŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_´ev›wBŠ
)

400 #£lf.
_300x50BŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_´ev›wBŠ
)

401 #
#gridLayout.
	`addWidg‘
(
£lf
.
_20x20BŠ
, 0,0)

402 #gridLayout.
	`addWidg‘
(
£lf
.
_50x50BŠ
, 0,1)

403 #gridLayout.
	`addWidg‘
(
£lf
.
_75x75BŠ
, 0,2)

404 #gridLayout.
	`addWidg‘
(
£lf
.
_100x100BŠ
, 1,0)

405 #gridLayout.
	`addWidg‘
(
£lf
.
_200x200BŠ
, 1,1)

406 #gridLayout.
	`addWidg‘
(
£lf
.
_300x300BŠ
, 1,2)

407 #gridLayout.
	`addWidg‘
(
£lf
.
_100x50BŠ
, 2,0)

408 #gridLayout.
	`addWidg‘
(
£lf
.
_200x50BŠ
, 2,1)

409 #gridLayout.
	`addWidg‘
(
£lf
.
_300x50BŠ
, 2,2)

410 #
#£lf.
’”gyLbl
 = 
QtWidg‘s
.
	`QLab–
("Energy")

411 #£lf.
’”gyFld
 = 
QtWidg‘s
.
	`QLšeEd™
("650.5")

412 #£lf.
’”gyFld
.
	`£tV®id©Ü
(
QtWidg‘s
.
	`QDoubËV®id©Ü
(130.0, 3000.0, 3, 
£lf
))

413 #£lf.
dw–lLbl
 = 
QtWidg‘s
.
	`QLab–
("Dwell")

414 #£lf.
dw–lFbkLbl
 = 
QtWidg‘s
.
	`QLab–
("0.0")

415 #£lf.
dw–lSlid”
 = 
QtWidg‘s
.
	`QSlid”
(
QtCÜe
.
Qt
.
HÜizÚl
)

416 #£lf.
dw–lSlid”
.
	`£tMšimum
(1.0)

417 #£lf.
dw–lSlid”
.
	`£tMaximum
(100.0)

418 #£lf.
dw–lSlid”
.
	`£tV®ue
(2)

419 #£lf.
dw–lFbkLbl
.
	`£tText
('%.1àms' % 
£lf
.
dw–lSlid”
.
	`v®ue
())

420 ##
£lf
.
dw–lSlid”
.
	`£tFocusPŞicy
(
QtCÜe
.
Qt
.
NoFocus
)

421 #£lf.
dw–lSlid”
.
v®ueChªged
.
	`cÚÃù
(
£lf
.
Ú_dw–l_¦id”_chªged
)

422 #
#£lf.
	`’abË_bŠs
(
F®£
)

426 
£lf
.
£Ëùed_pos™iÚ
 = 1

428 #£lf.
ş—rBŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_ş—rBŠ
)

429 #£lf.
ÿlib¿‹BŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_ÿlib¿‹BŠ
)

430 #£lf.
´ev›wBŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_´ev›wBŠ
)

431 #£lf.
abÜtBŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_abÜtBŠ
)

432 #
 = QtWidg‘s.QVBoxLayout()

433 #
#hÏyouˆğ
QtWidg‘s
.
	`QHBoxLayout
()

434 #hÏyout.
	`addWidg‘
(
£lf
.
’”gyLbl
)

435 #hÏyout.
	`addWidg‘
(
£lf
.
’”gyFld
)

436 #
#hÏyout2 = 
QtWidg‘s
.
	`QHBoxLayout
()

437 #hÏyout2.
	`addWidg‘
(
£lf
.
dw–lLbl
)

438 #hÏyout2.
	`addWidg‘
(
£lf
.
dw–lSlid”
)

439 #hÏyout2.
	`addWidg‘
(
£lf
.
dw–lFbkLbl
)

440 #
#hÏyout3 = 
QtWidg‘s
.
	`QHBoxLayout
()

441 ## 
hÏyout3
.
	`addWidg‘
(
£lf
.
ş—rBŠ
)

442 ## 
hÏyout3
.
	`addWidg‘
(
£lf
.
ÿlib¿‹BŠ
)

443 ##
hÏyout3
.
	`addWidg‘
(
£lf
.
´ev›wBŠ
)

444 #hÏyout3.
	`addWidg‘
(
£lf
.
abÜtBŠ
)

445 #
#hÏyout3.
	`£tGeom‘ry
(
QtCÜe
.
	`QReù
(10,10,
£lf
.
	`width
(), s–f.
	`height
()))

447 
£lf
.
v›w
 = 
	`Sam¶eS–eùÜV›w
(
·»Á
õ¬’t, 
Çme
òame, 
ûÁ”x
=ûÁ”x, 
ûÁ”y
=ûÁ”y, 
¿d
 =„ad, 
sÿËr
=sÿËr, 
şr
=clr)

448 
£lf
.
v›w
.
£Ëùed
.
	`cÚÃù
(£lf.
Ú_£Ëùed
)

450 
vÏyout
.
	`addWidg‘
(
£lf
.
v›w
)

451 #vÏyout.
	`addLayout
(
hÏyout
)

452 #vÏyout.
	`addLayout
(
hÏyout2
)

453 #vÏyout.
	`addLayout
(
gridLayout
)

454 #vÏyout.
	`addLayout
(
hÏyout3
)

457 
£lf
.
	`£tLayout
(
vÏyout
)

459 
def
 
	$Ú_£Ëùed
(
£lf
, 
pos_num
):

460 #£lf.
	`’abË_bŠs
(
True
)

461 
£lf
.
£Ëùed_pos™iÚ
 = 
pos_num


462 
£lf
.
£Ëùed
.
	`em™
(
pos_num
)

463 
£lf
.
	`gÙo_pos
(
pos_num
)

465 
def
 
	$gÙo_pos
(
£lf
, 
pos
):

466 
posSŒ
 = 'pos' + (
	`¡r
('%d'%(
pos
+1)))

467 (
x
,
y
èğ
_§m¶e_pos™iÚs
[
posSŒ
]

468 
£lf
.
v›w
.
	`move_mÙÜs
(
x
, 
y
)

471 
def
 
	$’abË_bŠs
(
£lf
, 
’abË
):

472 
£lf
.
_20x20BŠ
.
	`£tEÇbËd
(
’abË
)

473 
£lf
.
_50x50BŠ
.
	`£tEÇbËd
(
’abË
)

474 
£lf
.
_75x75BŠ
.
	`£tEÇbËd
(
’abË
)

475 
£lf
.
_100x100BŠ
.
	`£tEÇbËd
(
’abË
)

476 
£lf
.
_200x200BŠ
.
	`£tEÇbËd
(
’abË
)

477 
£lf
.
_300x300BŠ
.
	`£tEÇbËd
(
’abË
)

478 
£lf
.
_100x50BŠ
.
	`£tEÇbËd
(
’abË
)

479 
£lf
.
_200x50BŠ
.
	`£tEÇbËd
(
’abË
)

480 
£lf
.
_300x50BŠ
.
	`£tEÇbËd
(
’abË
)

481 
£lf
.
abÜtBŠ
.
	`£tEÇbËd
(
’abË
)

482 
£lf
.
dw–lSlid”
.
	`£tEÇbËd
(
’abË
)

484 
def
 
	$g‘_£Ëùed_pos™iÚ
(
£lf
):

485 (
£lf
.
£Ëùed_pos™iÚ
)

487 
def
 
	$Ú_dw–l_¦id”_chªged
(
£lf
, 
v®
):

488 
£lf
.
dw–lFbkLbl
.
	`£tText
('%.1àms' % (
v®
))

491 
def
 
	$Ú_ş—rBŠ
(
£lf
):

492 
£lf
.
v›w
.
	`de£Ëù_®l
()

494 
def
 
	$Ú_abÜtBŠ
(
£lf
):

495 
£lf
.
abÜt_´ev›w
.
	`em™
()

497 
def
 
	$Ú_ÿlib¿‹BŠ
(
£lf
):

498 
·ss


500 
def
 
	$g‘_£Ëùed_li¡
(
£lf
):

501 
sÿn_li¡
 = []

502 
posL¡
 = 
£lf
.
v›w
.
	`g‘_£Ëùed_pos™iÚs
()

503 (
’”gy
, 
v®id
èğ
£lf
.
’”gyFld
.
	`‹xt
().
	`toFlßt
()

504 
dw–l
 = 
£lf
.
dw–lSlid”
.
	`v®ue
()

506 
pos
 
š
 
posL¡
:

507 
pos_num
 = 
pos
.pos_num

508 
po¢ame
 = 
pos
.
Çme


509 (
xC’‹r
, 
yC’‹r
èğ
_§m¶e_pos™iÚs
[
po¢ame
]

510 
¡¬tX
 = 
xC’‹r
 - (0.5 * 
§m¶e_cœşe_dŸm
)

511 
¡İX
 = 
xC’‹r
 + (0.5 * 
§m¶e_cœşe_dŸm
)

512 
¡¬tY
 = 
yC’‹r
 - (0.5 * 
§m¶e_cœşe_dŸm
)

513 
¡İY
 = 
yC’‹r
 + (0.5 * 
§m¶e_cœşe_dŸm
)

514 
sÿn_li¡
.
	`­³nd
Ğ{'pos_num':
pos_num
, 'po¢ame':
po¢ame
, '¡¬tX':
¡¬tX
, '¡İX':
¡İX
, '¡¬tY':
¡¬tY
, '¡İY':
¡İY
, 'xC’‹r':
xC’‹r
, 'yC’‹r':
yC’‹r
, '’”gy':
’”gy
, 'dw–l':
dw–l
} )

516 (
sÿn_li¡
)

518 
def
 
	$Ú_´ev›wBŠ
(
£lf
):

520 
bŠ
 = 
£lf
.
	`£nd”
()

521 
txt
 = 
	`¡r
(
bŠ
.
	`‹xt
())

522 if(
txt
 == '20x20'):

523 
ÅoštsX
 = 20

524 
ÅoštsY
 = 20

525 #£lf.
dw–lSlid”
.
	`£tV®ue
(10)

526 
£lf
.
dw–lSlid”
.
	`£tMšimum
(10.0)

527 
	`–if
(
txt
 == '50x50'):

528 
ÅoštsX
 = 50

529 
ÅoštsY
 = 50

530 
£lf
.
dw–lSlid”
.
	`£tMšimum
(4.0)

531 
	`–if
(
txt
 == '75x75'):

532 
ÅoštsX
 = 75

533 
ÅoštsY
 = 75

534 
	`–if
(
txt
 == '100x100'):

535 
ÅoštsX
 = 100

536 
ÅoštsY
 = 100

537 
	`–if
(
txt
 == '200x200'):

538 
ÅoštsX
 = 200

539 
ÅoštsY
 = 200

540 
	`–if
(
txt
 == '300x300'):

541 
ÅoštsX
 = 300

542 
ÅoštsY
 = 300

543 
	`–if
(
txt
 == '100x50'):

544 
ÅoštsX
 = 100

545 
ÅoštsY
 = 50

546 
	`–if
(
txt
 == '200x50'):

547 
ÅoštsX
 = 200

548 
ÅoštsY
 = 50

549 
	`–if
(
txt
 == '300x50'):

550 
ÅoštsX
 = 300

551 
ÅoštsY
 = 50

553 
ÅoštsX
 = 25

554 
ÅoštsY
 = 25

557 
sÿn_li¡
 = []

558 
posL¡
 = 
£lf
.
v›w
.
	`g‘_£Ëùed_pos™iÚs
()

559 (
’”gy
, 
v®id
èğ
£lf
.
’”gyFld
.
	`‹xt
().
	`toFlßt
()

560 
dw–l
 = 
£lf
.
dw–lSlid”
.
	`v®ue
()

562 
pos
 
š
 
posL¡
:

563 
pos_num
 = 
pos
.pos_num

564 
po¢ame
 = 
pos
.
Çme


565 (
xC’‹r
, 
yC’‹r
èğ
_§m¶e_pos™iÚs
[
po¢ame
]

566 
¡¬tX
 = 
xC’‹r
 - (0.5 * 
§m¶e_cœşe_dŸm
)

567 
¡İX
 = 
xC’‹r
 + (0.5 * 
§m¶e_cœşe_dŸm
)

568 
¡¬tY
 = 
yC’‹r
 - (0.5 * 
§m¶e_cœşe_dŸm
)

569 
¡İY
 = 
yC’‹r
 + (0.5 * 
§m¶e_cœşe_dŸm
)

570 
sÿn_li¡
.
	`­³nd
Ğ{'pos_num':
pos_num
, 'po¢ame':
po¢ame
,

571 '¡¬tX':
¡¬tX
, '¡İX':
¡İX
, '¡¬tY':
¡¬tY
, '¡İY':
¡İY
,

572 'ÅoštsX':
ÅoštsX
, 'ÅoštsY':
ÅoštsY
,

573 'xC’‹r':
xC’‹r
, 'yC’‹r':
yC’‹r
,

574 '’”gy':
’”gy
,

575 'dw–l':
dw–l
} )

577 #g‘_v–o_fÜ_sÿn(
¡¬tX
, 
¡İX
, 
ÅoštsX
, 
dw–l
)

578 
	g£lf
.
	gdo_´ev›w
.
em™
(
sÿn_li¡
)

583 
	g__Çme__
 == "__main__":

584 
­p
 = 
QtWidg‘s
.
QAµliÿtiÚ
(
sys
.
¬gv
)

586 #v›w = 
QtWidg‘s
.
QG¿phicsV›w
(
sûÃ
)

587 
wšdow
 = 
Sam¶eS–eùÜWidg‘
(
sÿËr
=0.75)

588 
wšdow
.
show
()

590 
sys
.
ex™
(
­p
.
exec_
())

	@widgets/sampleSelector.py

2 
C»©ed
 
	gÚ
 2013-07-16

4 @
	gauthÜ
: 
b”gr


7 
C»©ed
 
Ú
 2013-06-28

9 @
authÜ
: 
b”gr


11 #!/
u¤
/
bš
/
pythÚ


13 
impÜt
 
sys


14 
impÜt
 
numpy
 
as
 
Å


16 
äom
 
PyQt5
 
impÜt
 
QtGui
, 
	gQtCÜe
, 
	gQtWidg‘s


18 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
bioXasIM
 
impÜt
 
	gabs_·th_to_ši_fe


19 #äom 
şs
.
sÿÂšg
.
SÿnDef
 
impÜt
 
ImageLšeUniSÿnDef
, 
EÃrgyRegiÚSÿnDef


20 #äom 
şs
.
­¶iÿtiÚs
.
pyStxm
.
bl10ID01
 
impÜt
 
DEVICE_CFG


21 
äom
 
	gşs
.
	guts
.
cfg·r£r
 
impÜt
 
	gCÚfigCÏss


22 
äom
 
	gbcm
.
	g•ics_deviûs
.
mÙÜ_v2
 
impÜt
 
	gMÙÜ_V2


24 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
bl07ID01
 
impÜt
 
	gMAIN_OBJ


26 #»ad 
the
 
ši
 
fe
 
ªd
 
lßd
h 
dœeùÜ›s


27 
	g­pCÚfig
 = 
CÚfigCÏss
(
abs_·th_to_ši_fe
)

28 
uiDœ
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'uiDir')

29 
	gd©aDœ
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'dataDir')

30 
	gmŒcfg
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'mtrcfg')

31 
	gSLASH
 = 
­pCÚfig
.
g‘_v®ue
('DEFAULT', 'dirslash')

33 
	g_§m¶e_pos™iÚs
 = {}

35 
xpos_1
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'xpos_1')

36 
	gypos_1
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'ypos_1')

37 
	gxpos_2
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'xpos_2')

38 
	gypos_2
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'ypos_2')

39 
	gxpos_3
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'xpos_3')

40 
	gypos_3
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'ypos_3')

41 
	gxpos_4
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'xpos_4')

42 
	gypos_4
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'ypos_4')

43 
	gxpos_5
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'xpos_5')

44 
	gypos_5
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'ypos_5')

45 
	gxpos_6
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'xpos_6')

46 
	gypos_6
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'ypos_6')

47 
	gxi0pos
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'xi0pos')

48 
	gyi0pos
 = 
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'yi0pos')

49 
	g§m¶e_cœşe_dŸm
 = (
­pCÚfig
.
g‘_v®ue
('SAMPLE_POSITIONS', 'sample_circle_diam'))

52 
	g_§m¶e_pos™iÚs
['pos1'] = ((
xpos_1
), (
	gypos_1
))

53 
	g_§m¶e_pos™iÚs
['pos2'] = ((
xpos_2
), (
	gypos_2
))

54 
	g_§m¶e_pos™iÚs
['pos3'] = ((
xpos_3
), (
	gypos_3
))

55 
	g_§m¶e_pos™iÚs
['pos4'] = ((
xpos_4
), (
	gypos_4
))

56 
	g_§m¶e_pos™iÚs
['pos5'] = ((
xpos_5
), (
	gypos_5
))

57 
	g_§m¶e_pos™iÚs
['pos6'] = ((
xpos_6
), (
	gypos_6
))

58 
	g_§m¶e_pos™iÚs
['i0pos'] = ((
xi0pos
), (
	gyi0pos
))

60 
	gMOTORFBK_TO_SCREEN_UNITS
 = (52.5 / 5000)

62 
def
 
	$g‘_v–o_fÜ_sÿn
(
¡¬t
, 
¡İ
, 
pošts
, 
dw–l
):

65 :
·¿m
 
sÿn
: 
a
 
v®id
 
sÿnDef
 
objeù
 
th©
 
cÚšs
 
®l
 
the
 
šfÜm©iÚ


66 
»quœed
 
to
 
execu‹
 
the
 
sÿn
.

67 :
ty³
 
sÿn
: 
sÿnDef
.

68 :
·¿m
 
dw–l
: 
the
 dw–È
	$time
 (
š
 
ms
è
¥ecif›d
 iÀ
the
 
’”gy
 
»giÚ
 
defš™iÚ
 
this
 
sÿn


69 :
ty³
 
dw–l
: 

70 :
·¿m
 
accdccD
: 
the
 
acûË¿‹
 
decûË¿‹
 
di¡ªû
 
th©
 
is
 
·dded
 
to
h
¡¬t
 
ªd
 
¡İ
 
of
 
—ch


71 
sÿn
 
move
, 
this
 
di¡ªû
 
is
 
»quœed
 
to
 
give
 
the
 
mÙÜ
 
’ough
 
time
Ø
»ach


72 
cÚ¡ªt
 
v–oc™y
 
befÜe
 
»achšg
 
the
 
pos™iÚ
 
©
 
which
h
shu‰”
 
wl
 
be
 
İ’ed
,

73 
ªd
 
’ough
 
di¡ªû
 
the
 
mÙÜ
 
to
 
go
 
·¡
h
pos™iÚ
 
©
 
which
h
shu‰”
 
wl


74 
şo£
.

75 :
ty³
 
accdccD
: 

77 :
»tuºs
: 
NÚe


80 #maxV–oX = 
sÿn
.
	`g‘_X_pos™iÚ”
().
	`g‘_max_v–oc™y
()

81 
d–
 = 
¡İ
 - 
¡¬t


82 
accRªge
 = 
d–
 * 0.08 #%4 
of
 
desœed
 
lše
 
Ëngth
, 
ªy
 
sm®Ër
 
ªd
 
the
 
sÿn
 
çs
 
due
 
to
 
m¬k”
 
loÿtiÚ
 
too
 
şo£
o

83 
dccRªge
 = 
d–
 * 0.0000001

84 
accdccD
 = 
accRªge
 + 
dccRªge


85 
lšeTime
 = 
pošts
 * (
dw–l
 *0.001)

86 
‰lDi¡
 = (
¡İ
 - 
¡¬t
è/ 1000.0 #tØ
tuº
 
back
 
što
 
mm


87 
v–o
 = 
‰lDi¡
 / 
lšeTime


88 
´št
 'g‘_v–o_fÜ_sÿn:…ošt ğ%d,„ªgğ%.3f, dw–Èğ%.2àms, v–Øğ%.3fàmm/s' % (
pošts
, 
‰lDi¡
, 
dw–l
, 
v–o
)

89 (
v–o
)

92 
şass
 
	$S’d”Objeù
(
QtCÜe
.
QObjeù
):

93 
£Ëùed
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
)

95 
şass
 
	$Node
(
QtWidg‘s
.
QG¿phicsI‹m
):

99 
def
 
	`__š™__
(
£lf
, 
·»Á
 = 
NÚe
, 
Çme
='NONE', 
pos_num
=1, 
x
=10, 
y
=10, 
¿d
 = 10, 
sÿËr
=1.0, 
şr
=
QtCÜe
.
Qt
.
g¿y
):

100 #QtWidg‘s.
QG¿phicsI‹m
.
	`__š™__
(
£lf
,
·»Á
)

101 
	`su³r
(
Node
, 
£lf
).
	`__š™__
(
·»Á
)

102 
£lf
.
sig
 = 
	`S’d”Objeù
()

103 
£lf
.
Çme
 =‚ame

104 
£lf
.
pos_num
 =…os_num

105 #£lf.
	`£tFÏg
(
QtWidg‘s
.
QG¿phicsI‹m
.
I‹mIsMovabË
)

106 
£lf
.
	`£tFÏg
(
QtWidg‘s
.
QG¿phicsI‹m
.
I‹mS’dsGeom‘ryChªges
)

107 
£lf
.
	`£tCacheMode
(
QtWidg‘s
.
QG¿phicsI‹m
.
DeviûCoÜdš©eCache
)

108 
£lf
.
x
 = x - 
¿d


109 
£lf
.
y
 = y - 
¿d


110 
£lf
.
wd
 = 
¿d
 * 2.0

111 
£lf
.
ht
 = 
¿d
 * 2.0

112 
£lf
.
sÿËr
 = scaler

115 
£lf
.
ûÁ”X
 = (£lf.
x
 + (0.5 * s–f.
wd
)è* 
sÿËr


116 
£lf
.
ûÁ”Y
 = (£lf.
y
 + (0.5 * s–f.
wd
)è* 
sÿËr


117 #´šˆ'cœş[%d] cx=%àcy=%f' % (
pos_num
, 
£lf
.
ûÁ”X
, s–f.
ûÁ”Y
)

119 #šˆ
x
, 
y
, 
width
, 
height


121 
£lf
.
äame
 = 
Å
.
	`¬¿y
([£lf.
x
, s–f.
y
, s–f.
wd
, s–f.
ht
]è* 
sÿËr


122 
£lf
.
bndg»ù
 = 
Å
.
	`¬¿y
([£lf.
x
, s–f.
y
, s–f.
wd
, s–f.
ht
]è* 
sÿËr


123 
£lf
.
cœşe
 = 
Å
.
	`¬¿y
([£lf.
x
, s–f.
y
, s–f.
wd
, s–f.
ht
]è* 
sÿËr


124 
£lf
.
şridx
 = 0

125 
£lf
.
şr
 = clr

126 
£lf
.
£Ëùed
 = 
F®£


128 #£lf.
	`upd©e
(
£lf
.
Ëá
, s–f.
tİ
, s–f.
right
, s–f.
btm
)

129 
def
 
	$Ú_£Ëùed
(
£lf
, 
cœşe
):

130 
£lf
.
sig
.
£Ëùed
.
	`em™
(self)

132 
def
 
	$£t_£Ëùed
(
£lf
, 
£l
=
F®£
):

133 
£lf
.
£Ëùed
 = 
£l


134 
£lf
.
	`upd©e
()

136 
def
 
	$boundšgReù
(
£lf
):

137 
adju¡
 = 2.0

138  
QtCÜe
.
	`QReùF
(
£lf
.
bndg»ù
[0] - 
adju¡
, self.bndgrect[1] -‡djust, self.bndgrect[2] +‡djust, self.bndgrect[3] +‡djust)

140 
def
 
	$·št
(
£lf
, 
·š‹r
, 
İtiÚ
, 
widg‘
):

141 #·š‹r.
	`£tP’
(
QtCÜe
.
Qt
.
NoP’
)

142 #·š‹r.
	`£tBrush
(
QtCÜe
.
Qt
.
d¬kG¿y
)

143 #·š‹r.
	`d¿wEÎ£
(
£lf
.
cœşe
[0], self.circle[1], self.circle[2], self.circle[3])

144 #
 = QtGui.QRadŸlG¿d›Á(-3, -3, 10)

145 #ià
İtiÚ
.
¡©e
 & 
QtWidg‘s
.
QStyË
.
S‹_Sunk’
:

146 #g¿d›Á.
	`£tC’‹r
(3, 3)

147 #g¿d›Á.
	`£tFoÿlPošt
(3, 3)

148 #g¿d›Á.
	`£tCŞÜAt
(1, 
QtGui
.
	`QCŞÜ
(
QtCÜe
.
Qt
.
y–low
).
	`light
(120))

149 #g¿d›Á.
	`£tCŞÜAt
(0, 
QtGui
.
	`QCŞÜ
(
QtCÜe
.
Qt
.
d¬kY–low
).
	`light
(120))

151 if(
£lf
.
£Ëùed
):

152 #£lf.
şr
 = 
QtCÜe
.
Qt
.
g»’


153 
£lf
.
şr
 = 
QtCÜe
.
Qt
.
d¬kG»’


155 
£lf
.
şr
 = 
QtCÜe
.
Qt
.
g¿y


157 
g¿d›Á
.
	`£tCŞÜAt
(0, 
£lf
.
şr
)

158 
g¿d›Á
.
	`£tCŞÜAt
(1, 
£lf
.
şr
)

159 #
.£tBrush(QtGui.QBrush(g¿d›Á))

160 
·š‹r
.
	`£tP’
(
QtGui
.
	`QP’
(
£lf
.
şr
, 0))

161 
·š‹r
.
	`d¿wEÎ£
(
£lf
.
äame
[0], self.frame[1], self.frame[2], self.frame[3])

163 
def
 
	$™emChªge
(
£lf
, 
chªge
, 
v®ue
):

164 
chªge
 =ğ
QtWidg‘s
.
QG¿phicsI‹m
.
I‹mPos™iÚHasChªged
:

165 
´št
 '[%s] I‹mPos™iÚ chªged' % 
£lf
.
Çme


167  
	`su³r
(
Node
, 
£lf
).
	`™emChªge
(
chªge
, 
v®ue
)

169 
def
 
	$mou£P»ssEv’t
(
£lf
, 
ev’t
):

170 #´šˆ'[%s] mou£…»s£d' % 
£lf
.
Çme


171 if(
£lf
.
£Ëùed
):

172 
£lf
.
£Ëùed
 = 
F®£


173 #£lf.
şr
 = 
QtCÜe
.
Qt
.
g¿y


175 
£lf
.
£Ëùed
 = 
True


176 #£lf.
şr
 = 
QtCÜe
.
Qt
.
g»’


177 
£lf
.
sig
.
£Ëùed
.
	`em™
(self)

179 #£lf.
şridx
 += 1

180 #if(
£lf
.
şridx
 > 5):

181 #£lf.
şridx
 = 0

182 #
#if(
£lf
.
şridx
 == 0):

183 #£lf.
şr
 = 
QtCÜe
.
Qt
.
blue


184 #–if(
£lf
.
şridx
 == 1):

185 #£lf.
şr
 = 
QtCÜe
.
Qt
.
y–low


186 #–if(
£lf
.
şridx
 == 2):

187 #£lf.
şr
 = 
QtCÜe
.
Qt
.
cyª


188 #–if(
£lf
.
şridx
 == 3):

189 #£lf.
şr
 = 
QtCÜe
.
Qt
.
»d


190 #–if(
£lf
.
şridx
 == 4):

191 #£lf.
şr
 = 
QtCÜe
.
Qt
.
bÏck


192 #–if(
£lf
.
şridx
 == 5):

193 #£lf.
şr
 = 
QtCÜe
.
Qt
.
g»’


194 
£lf
.
	`upd©e
()

195 
	`su³r
(
Node
, 
£lf
).
	`mou£P»ssEv’t
(
ev’t
)

197 
def
 
	$mou£R–—£Ev’t
(
£lf
, 
ev’t
):

198 #´šˆ'[%s] mou£„–—£d' % 
£lf
.
Çme


200 
£lf
.
	`upd©e
()

201 
	`su³r
(
Node
, 
£lf
).
	`mou£R–—£Ev’t
(
ev’t
)

204 
şass
 
	$üossHaœI‹m
(
QtWidg‘s
.
QG¿phicsEÎ£I‹m
):

205 
def
 
	$__š™__
(
£lf
, 
sÿÏr
, 
·»Á
=
NÚe
):

206 
QtWidg‘s
.
QG¿phicsPixm­I‹m
.
	`__š™__
(
£lf
, 
·»Á
)

208 
£lf
.
	`£tFÏg
(
QtWidg‘s
.
QG¿phicsI‹m
.
I‹mIsMovabË
, 
True
)

209 #£lf.
	`£tFÏg
(
QtWidg‘s
.
QG¿phicsI‹m
.
I‹mIsS–eùabË
, 
True
)

210 
£lf
.
ûÁ”X
 = 0

211 
£lf
.
ûÁ”Y
 = 0

212 
£lf
.
¿dius
 = 8

214 
£lf
.
x_fbk
 = 0

215 
£lf
.
y_fbk
 = 0

217 
£lf
.
x_zoff£t
 = 
sÿÏr
 * 125.333

218 
£lf
.
y_zoff£t
 = 
sÿÏr
 * 84.0

220 
£lf
.
	`£tP’
(
QtGui
.
	`QP’
(QtGui.
	`QCŞÜ
(
QtCÜe
.
Qt
.
y–low
)))

221 #£lf.
	`£tP’
(
QtGui
.
	`QP’
(QtGui.
	`QCŞÜ
(
QtCÜe
.
Qt
.
blue
)))

222 
£lf
.
	`£tReù
(
QtCÜe
.
	`QReùF
(£lf.
ûÁ”X
-£lf.
¿dius
, s–f.
ûÁ”Y
-self.radius, self.radius, self.radius))

224 
£lf
.
tim”
 = 
QtCÜe
.
	`QTim”
()

225 
£lf
.
tim”
.
timeout
.
	`cÚÃù
(£lf.
upd©e_fbk
)

226 
£lf
.
tim”
.
	`¡¬t
(20)

228 
def
 
	$ÿlc_üossHaœ_ûÁ”X
(
£lf
, 
fbk
):

229 
chx
 = (
MOTORFBK_TO_SCREEN_UNITS
)*
fbk
 + 
£lf
.
x_zoff£t


230 (
chx
)

232 
def
 
	$ÿlc_üossHaœ_ûÁ”Y
(
£lf
, 
fbk
):

233 
chy
 = -1.0*(
MOTORFBK_TO_SCREEN_UNITS
)*
fbk
 + 
£lf
.
y_zoff£t


234 (
chy
)

236 
def
 
	$£t_x_fbk
(
£lf
, 
fbk
):

237 
£lf
.
x_fbk
 = 
fbk


239 
def
 
	$£t_y_fbk
(
£lf
, 
fbk
):

240 
£lf
.
y_fbk
 = 
fbk


242 
def
 
	$upd©e_fbk
(
£lf
):

243 #´šˆ'upd©e_fbk: xfk=%àyfbk=%f' % (
£lf
.
x_fbk
, s–f.
y_fbk
)

244 
x
 = 
£lf
.
	`ÿlc_üossHaœ_ûÁ”X
(£lf.
x_fbk
)

245 
y
 = 
£lf
.
	`ÿlc_üossHaœ_ûÁ”Y
(£lf.
y_fbk
)

246 #´šˆ'CHAIR: cx=%àcy=%f' % (
x
, 
y
)

247 
£lf
.
	`£t_ûÁ”
(
x
, 
y
)

249 
def
 
	$£t_ûÁ”
(
£lf
, 
x
, 
y
):

251 
£lf
.
ûÁ”X
 = 
x


252 
£lf
.
ûÁ”Y
 = 
y


253 
£lf
.
	`£tReù
(
QtCÜe
.
	`QReùF
(£lf.
ûÁ”X
-£lf.
¿dius
, s–f.
ûÁ”Y
-self.radius, self.radius, self.radius))

255 
def
 
	$move_ûÁ”
(
£lf
, 
x
, 
y
):

256 
£lf
.
ûÁ”X
 +ğ
x


257 
£lf
.
ûÁ”Y
 +ğ
y


258 
£lf
.
	`£tReù
(
QtCÜe
.
	`QReùF
(£lf.
ûÁ”X
-£lf.
¿dius
, s–f.
ûÁ”Y
-self.radius, self.radius, self.radius))

262 
şass
 
	$Sam¶eS–eùÜV›w
(
QtWidg‘s
.
QG¿phicsV›w
):

264 
£Ëùed
 = 
QtCÜe
.
	`pyqtSigÇl
()

266 
def
 
	`__š™__
(
£lf
, 
·»Á
 = 
NÚe
, 
Çme
='NONE', 
ûÁ”x
=10, 
ûÁ”y
=10, 
¿d
 = 10, 
sÿËr
=1.0, 
şr
=
QtCÜe
.
Qt
.
blue
, 
mutu®ly_exşude
=
True
):

267 
QtWidg‘s
.
QG¿phicsV›w
.
	`__š™__
(
£lf
,
·»Á
)

268 
£lf
.
	`£tBackgroundBrush
(
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
lightG¿y
))

270 
£lf
.
sûÃ
 = 
QtWidg‘s
.
	`QG¿phicsSûÃ
()

271 
£lf
.
	`£tMšimumSize
(250, 150)

273 
£lf
.
cœşes
 = []

274 
£lf
.
cœşes
.
	`­³nd
(£lf.
	`add_‹xt
('1',0, 50, 10, 30, 
sÿËr
))

275 
£lf
.
cœşes
.
	`­³nd
(£lf.
	`add_‹xt
('2',1, 120, 10, 30, 
sÿËr
))

276 
£lf
.
cœşes
.
	`­³nd
(£lf.
	`add_‹xt
('3',2, 190, 10, 30, 
sÿËr
))

277 
£lf
.
cœşes
.
	`­³nd
(£lf.
	`add_‹xt
('4',3, 50, 80, 30, 
sÿËr
))

278 
£lf
.
cœşes
.
	`­³nd
(£lf.
	`add_‹xt
('5',4, 120, 80, 30, 
sÿËr
))

279 
£lf
.
cœşes
.
	`­³nd
(£lf.
	`add_‹xt
('6',5, 190, 80, 30, 
sÿËr
))

281 
£lf
.
üosshaœ
 = 
	`üossHaœI‹m
(
sÿËr
)

283 #£lf.
absMŒX
 = 
	`MÙÜ_V2
('IOC:m11')

284 #£lf.
absMŒY
 = 
	`MÙÜ_V2
('IOC:m12')

287 
£lf
.
absMŒX
 = 
MAIN_OBJ
.
	`deviû
('SampleX')

288 
£lf
.
absMŒY
 = 
MAIN_OBJ
.
	`deviû
('SampleY')

291 
£lf
.
absMŒX
.
	`add_ÿÎback
('RBV', s–f.
Ú_xmÙÜ_fbk_chªge
)

292 
£lf
.
absMŒY
.
	`add_ÿÎback
('RBV', s–f.
Ú_ymÙÜ_fbk_chªge
)

293 #£lf.
üosshaœ
 = 
£lf
.
	`add_üossHaœ
('CH',6, 120, 80, 30, 
sÿËr
)

296 
£lf
.
üosshaœ
.
	`£t_x_fbk
(£lf.
absMŒX
.
	`g‘
('RBV'))

297 
£lf
.
üosshaœ
.
	`£t_y_fbk
(£lf.
absMŒY
.
	`g‘
('RBV'))

299 
£lf
.
sûÃ
.
	`addI‹m
(£lf.
üosshaœ
)

300 
£lf
.
	`£tSûÃ
(£lf.
sûÃ
)

302 
£lf
.
mutu®ly_exşude
 = mutually_exclude

305 
def
 
	$Ú_xmÙÜ_fbk_chªge
(
£lf
, **
kw
):

307 
£lf
.
üosshaœ
.
	`£t_x_fbk
(
kw
['value'])

308 #£lf.
üosshaœ
.
	`upd©e_fbk
()

310 
def
 
	$Ú_ymÙÜ_fbk_chªge
(
£lf
, **
kw
):

312 
£lf
.
üosshaœ
.
	`£t_y_fbk
(
kw
['value'])

313 #£lf.
üosshaœ
.
	`upd©e_fbk
()

316 
def
 
	$de£Ëù_®l
(
£lf
):

317 
i
 
š
 
	`¿nge
(
	$Ën
(
£lf
.
cœşes
)):

318 
£lf
.
cœşes
[
i
].
	`£t_£Ëùed
(
F®£
)

321 
def
 
	$Ú_şicked
(
£lf
, 
cœşe
):

322 #´šˆ'% şicked' % 
cœşe
.
Çme


323 
i
 
š
 
	`¿nge
(
	$Ën
(
£lf
.
cœşes
)):

324 #´šˆ
£lf
.
cœşes
[
i
]

325 if(
cœşe
.
Çme
 =ğ
£lf
.
cœşes
[
i
].name):

326 
£lf
.
£Ëùed
.
	`em™
(
i
)

327 
·ss


329 if(
£lf
.
mutu®ly_exşude
):

330 #de£Ëù 
the
 
Ùh”
 
cœşes


331 
£lf
.
cœşes
[
i
].
	`£t_£Ëùed
(
F®£
)

333 
def
 
	$g‘_£Ëùed_pos™iÚs
(
£lf
):

334 
l¡
 = []

335 
i
 
š
 
	`¿nge
(
	$Ën
(
£lf
.
cœşes
)):

336 if(
£lf
.
cœşes
[
i
].
£Ëùed
):

337 
l¡
.
	`­³nd
(
£lf
.
cœşes
[
i
])

338 (
l¡
)

340 
def
 
	$g‘_§m¶e_pos™iÚ
(
£lf
, 
pos
):

341 (
£lf
.
cœşes
[
pos
])

343 
def
 
	$add_‹xt
(
£lf
, 
‹xt
, 
pos_num
, 
x
, 
y
, 
¿d
, 
sÿËr
):

344 
node
 = 
	`Node
(
Çme
='pos' + 
‹xt
, 
pos_num
õos_num, 
x
=x, 
y
=y, 
¿d
ôad, 
sÿËr
=scaler)

345 
node
.
sig
.
£Ëùed
.
	`cÚÃù
(
£lf
.
Ú_şicked
)

346 
£lf
.
sûÃ
.
	`addI‹m
(
node
)

347 
txt
 = 
£lf
.
sûÃ
.
	`addText
(
‹xt
)

348 
fÚtSize
 = (10 * 
sÿËr
)

349 
txt
.
	`£tFÚt
(
QtGui
.
	`QFÚt
('A¿beyesqr', 
fÚtSize
))

350 
ûÁ”x
 = (
x
 - (
fÚtSize
/1.0)+2è* 
sÿËr


351 
ûÁ”y
 = (
y
 - ((
fÚtSize
/2)+8)è* 
sÿËr


352 
txt
.
	`£tPos
(
ûÁ”x
, 
ûÁ”y
)

353 (
node
)

355 
def
 
	$move_üosshaœ
(
£lf
, 
x
, 
y
):

356 
£lf
.
üosshaœ
.
	`move_ûÁ”
(
x
,
y
)

358 
def
 
	$move_mÙÜs
(
£lf
, 
x
, 
y
):

359 
£lf
.
absMŒX
.
	`move
(
x
)

360 
£lf
.
absMŒY
.
	`move
(
y
)

363 
şass
 
	$Sam¶eS–eùÜWidg‘
(
QtWidg‘s
.
QWidg‘
):

365 
do_´ev›w
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
)

366 
abÜt_´ev›w
 = 
QtCÜe
.
	`pyqtSigÇl
()

367 
£Ëùed
 = 
QtCÜe
.
	`pyqtSigÇl
()

369 
def
 
	`__š™__
(
£lf
, 
·»Á
 = 
NÚe
, 
Çme
='NONE', 
ûÁ”x
=10, 
ûÁ”y
=10, 
¿d
 = 10, 
sÿËr
=1.0, 
şr
=
QtCÜe
.
Qt
.
blue
):

370 
QtWidg‘s
.
QWidg‘
.
	`__š™__
(
£lf
,
·»Á
)

371 #£lf.
	`£tGeom‘ry
(50,50,400, 300)

372 #the£ 
¬e
 
the
 
v®ues
 
wh’
 
sÿËr
=1.0, 
nÜm®ized
 
width
 
ªd
 
height


373 
£lf
.
nÜmWidth
 = 275 * 
sÿËr


374 
£lf
.
nÜmHt
 = 300 * 
sÿËr


375 #£lf.
	`£tMšimumSize
(
£lf
.
nÜmWidth
, s–f.
nÜmHt
)

376 #£lf.
	`£tMaximumSize
(
£lf
.
nÜmWidth
, s–f.
nÜmHt
)

377 
£lf
.
bŠs_’abËd
 = 
F®£


378 #£lf.
ş—rBŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("Clear‡ll")

379 #£lf.
ÿlib¿‹BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("Calibrate")

380 #£lf.
´ev›wBŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("Preview")

381 #£lf.
abÜtBŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("Abort")

382 #
#gridLayouˆğ
QtWidg‘s
.
	`QGridLayout
()

383 #£lf.
_20x20BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("20x20")

384 #£lf.
_50x50BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("50x50")

385 #£lf.
_75x75BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("75x75")

386 #£lf.
_100x100BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("100x100")

387 #£lf.
_200x200BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("200x200")

388 #£lf.
_300x300BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("300x300")

389 #
#£lf.
_100x50BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("100x50")

390 #£lf.
_200x50BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("200x50")

391 #£lf.
_300x50BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
("300x50")

392 #
#£lf.
_20x20BŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_´ev›wBŠ
)

393 #£lf.
_50x50BŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_´ev›wBŠ
)

394 #£lf.
_75x75BŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_´ev›wBŠ
)

395 #£lf.
_100x100BŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_´ev›wBŠ
)

396 #£lf.
_200x200BŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_´ev›wBŠ
)

397 #£lf.
_300x300BŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_´ev›wBŠ
)

398 #
#£lf.
_100x50BŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_´ev›wBŠ
)

399 #£lf.
_200x50BŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_´ev›wBŠ
)

400 #£lf.
_300x50BŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_´ev›wBŠ
)

401 #
#gridLayout.
	`addWidg‘
(
£lf
.
_20x20BŠ
, 0,0)

402 #gridLayout.
	`addWidg‘
(
£lf
.
_50x50BŠ
, 0,1)

403 #gridLayout.
	`addWidg‘
(
£lf
.
_75x75BŠ
, 0,2)

404 #gridLayout.
	`addWidg‘
(
£lf
.
_100x100BŠ
, 1,0)

405 #gridLayout.
	`addWidg‘
(
£lf
.
_200x200BŠ
, 1,1)

406 #gridLayout.
	`addWidg‘
(
£lf
.
_300x300BŠ
, 1,2)

407 #gridLayout.
	`addWidg‘
(
£lf
.
_100x50BŠ
, 2,0)

408 #gridLayout.
	`addWidg‘
(
£lf
.
_200x50BŠ
, 2,1)

409 #gridLayout.
	`addWidg‘
(
£lf
.
_300x50BŠ
, 2,2)

410 #
#£lf.
’”gyLbl
 = 
QtWidg‘s
.
	`QLab–
("Energy")

411 #£lf.
’”gyFld
 = 
QtWidg‘s
.
	`QLšeEd™
("650.5")

412 #£lf.
’”gyFld
.
	`£tV®id©Ü
(
QtWidg‘s
.
	`QDoubËV®id©Ü
(130.0, 3000.0, 3, 
£lf
))

413 #£lf.
dw–lLbl
 = 
QtWidg‘s
.
	`QLab–
("Dwell")

414 #£lf.
dw–lFbkLbl
 = 
QtWidg‘s
.
	`QLab–
("0.0")

415 #£lf.
dw–lSlid”
 = 
QtWidg‘s
.
	`QSlid”
(
QtCÜe
.
Qt
.
HÜizÚl
)

416 #£lf.
dw–lSlid”
.
	`£tMšimum
(1.0)

417 #£lf.
dw–lSlid”
.
	`£tMaximum
(100.0)

418 #£lf.
dw–lSlid”
.
	`£tV®ue
(2)

419 #£lf.
dw–lFbkLbl
.
	`£tText
('%.1àms' % 
£lf
.
dw–lSlid”
.
	`v®ue
())

420 ##
£lf
.
dw–lSlid”
.
	`£tFocusPŞicy
(
QtCÜe
.
Qt
.
NoFocus
)

421 #£lf.
dw–lSlid”
.
v®ueChªged
.
	`cÚÃù
(
£lf
.
Ú_dw–l_¦id”_chªged
)

422 #
#£lf.
	`’abË_bŠs
(
F®£
)

426 
£lf
.
£Ëùed_pos™iÚ
 = 1

428 #£lf.
ş—rBŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_ş—rBŠ
)

429 #£lf.
ÿlib¿‹BŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_ÿlib¿‹BŠ
)

430 #£lf.
´ev›wBŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_´ev›wBŠ
)

431 #£lf.
abÜtBŠ
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_abÜtBŠ
)

432 #
 = QtWidg‘s.QVBoxLayout()

433 #
#hÏyouˆğ
QtWidg‘s
.
	`QHBoxLayout
()

434 #hÏyout.
	`addWidg‘
(
£lf
.
’”gyLbl
)

435 #hÏyout.
	`addWidg‘
(
£lf
.
’”gyFld
)

436 #
#hÏyout2 = 
QtWidg‘s
.
	`QHBoxLayout
()

437 #hÏyout2.
	`addWidg‘
(
£lf
.
dw–lLbl
)

438 #hÏyout2.
	`addWidg‘
(
£lf
.
dw–lSlid”
)

439 #hÏyout2.
	`addWidg‘
(
£lf
.
dw–lFbkLbl
)

440 #
#hÏyout3 = 
QtWidg‘s
.
	`QHBoxLayout
()

441 ## 
hÏyout3
.
	`addWidg‘
(
£lf
.
ş—rBŠ
)

442 ## 
hÏyout3
.
	`addWidg‘
(
£lf
.
ÿlib¿‹BŠ
)

443 ##
hÏyout3
.
	`addWidg‘
(
£lf
.
´ev›wBŠ
)

444 #hÏyout3.
	`addWidg‘
(
£lf
.
abÜtBŠ
)

445 #
#hÏyout3.
	`£tGeom‘ry
(
QtCÜe
.
	`QReù
(10,10,
£lf
.
	`width
(), s–f.
	`height
()))

447 
£lf
.
v›w
 = 
	`Sam¶eS–eùÜV›w
(
·»Á
õ¬’t, 
Çme
òame, 
ûÁ”x
=ûÁ”x, 
ûÁ”y
=ûÁ”y, 
¿d
 =„ad, 
sÿËr
=sÿËr, 
şr
=clr)

448 
£lf
.
v›w
.
£Ëùed
.
	`cÚÃù
(£lf.
Ú_£Ëùed
)

450 
vÏyout
.
	`addWidg‘
(
£lf
.
v›w
)

451 #vÏyout.
	`addLayout
(
hÏyout
)

452 #vÏyout.
	`addLayout
(
hÏyout2
)

453 #vÏyout.
	`addLayout
(
gridLayout
)

454 #vÏyout.
	`addLayout
(
hÏyout3
)

457 
£lf
.
	`£tLayout
(
vÏyout
)

459 
def
 
	$Ú_£Ëùed
(
£lf
, 
pos_num
):

460 #£lf.
	`’abË_bŠs
(
True
)

461 
£lf
.
£Ëùed_pos™iÚ
 = 
pos_num


462 
£lf
.
£Ëùed
.
	`em™
(
pos_num
)

463 
£lf
.
	`gÙo_pos
(
pos_num
)

465 
def
 
	$gÙo_pos
(
£lf
, 
pos
):

466 
posSŒ
 = 'pos' + (
	`¡r
('%d'%(
pos
+1)))

467 (
x
,
y
èğ
_§m¶e_pos™iÚs
[
posSŒ
]

468 
£lf
.
v›w
.
	`move_mÙÜs
(
x
, 
y
)

471 
def
 
	$’abË_bŠs
(
£lf
, 
’abË
):

472 
£lf
.
_20x20BŠ
.
	`£tEÇbËd
(
’abË
)

473 
£lf
.
_50x50BŠ
.
	`£tEÇbËd
(
’abË
)

474 
£lf
.
_75x75BŠ
.
	`£tEÇbËd
(
’abË
)

475 
£lf
.
_100x100BŠ
.
	`£tEÇbËd
(
’abË
)

476 
£lf
.
_200x200BŠ
.
	`£tEÇbËd
(
’abË
)

477 
£lf
.
_300x300BŠ
.
	`£tEÇbËd
(
’abË
)

478 
£lf
.
_100x50BŠ
.
	`£tEÇbËd
(
’abË
)

479 
£lf
.
_200x50BŠ
.
	`£tEÇbËd
(
’abË
)

480 
£lf
.
_300x50BŠ
.
	`£tEÇbËd
(
’abË
)

481 
£lf
.
abÜtBŠ
.
	`£tEÇbËd
(
’abË
)

482 
£lf
.
dw–lSlid”
.
	`£tEÇbËd
(
’abË
)

484 
def
 
	$g‘_£Ëùed_pos™iÚ
(
£lf
):

485 (
£lf
.
£Ëùed_pos™iÚ
)

487 
def
 
	$Ú_dw–l_¦id”_chªged
(
£lf
, 
v®
):

488 
£lf
.
dw–lFbkLbl
.
	`£tText
('%.1àms' % (
v®
))

491 
def
 
	$Ú_ş—rBŠ
(
£lf
):

492 
£lf
.
v›w
.
	`de£Ëù_®l
()

494 
def
 
	$Ú_abÜtBŠ
(
£lf
):

495 
£lf
.
abÜt_´ev›w
.
	`em™
()

497 
def
 
	$Ú_ÿlib¿‹BŠ
(
£lf
):

498 
·ss


500 
def
 
	$g‘_£Ëùed_li¡
(
£lf
):

501 
sÿn_li¡
 = []

502 
posL¡
 = 
£lf
.
v›w
.
	`g‘_£Ëùed_pos™iÚs
()

503 (
’”gy
, 
v®id
èğ
£lf
.
’”gyFld
.
	`‹xt
().
	`toFlßt
()

504 
dw–l
 = 
£lf
.
dw–lSlid”
.
	`v®ue
()

506 
pos
 
š
 
posL¡
:

507 
pos_num
 = 
pos
.pos_num

508 
po¢ame
 = 
pos
.
Çme


509 (
xC’‹r
, 
yC’‹r
èğ
_§m¶e_pos™iÚs
[
po¢ame
]

510 
¡¬tX
 = 
xC’‹r
 - (0.5 * 
§m¶e_cœşe_dŸm
)

511 
¡İX
 = 
xC’‹r
 + (0.5 * 
§m¶e_cœşe_dŸm
)

512 
¡¬tY
 = 
yC’‹r
 - (0.5 * 
§m¶e_cœşe_dŸm
)

513 
¡İY
 = 
yC’‹r
 + (0.5 * 
§m¶e_cœşe_dŸm
)

514 
sÿn_li¡
.
	`­³nd
Ğ{'pos_num':
pos_num
, 'po¢ame':
po¢ame
, '¡¬tX':
¡¬tX
, '¡İX':
¡İX
, '¡¬tY':
¡¬tY
, '¡İY':
¡İY
, 'xC’‹r':
xC’‹r
, 'yC’‹r':
yC’‹r
, '’”gy':
’”gy
, 'dw–l':
dw–l
} )

516 (
sÿn_li¡
)

518 
def
 
	$Ú_´ev›wBŠ
(
£lf
):

520 
bŠ
 = 
£lf
.
	`£nd”
()

521 
txt
 = 
	`¡r
(
bŠ
.
	`‹xt
())

522 if(
txt
 == '20x20'):

523 
ÅoštsX
 = 20

524 
ÅoštsY
 = 20

525 #£lf.
dw–lSlid”
.
	`£tV®ue
(10)

526 
£lf
.
dw–lSlid”
.
	`£tMšimum
(10.0)

527 
	`–if
(
txt
 == '50x50'):

528 
ÅoštsX
 = 50

529 
ÅoštsY
 = 50

530 
£lf
.
dw–lSlid”
.
	`£tMšimum
(4.0)

531 
	`–if
(
txt
 == '75x75'):

532 
ÅoštsX
 = 75

533 
ÅoštsY
 = 75

534 
	`–if
(
txt
 == '100x100'):

535 
ÅoštsX
 = 100

536 
ÅoštsY
 = 100

537 
	`–if
(
txt
 == '200x200'):

538 
ÅoštsX
 = 200

539 
ÅoštsY
 = 200

540 
	`–if
(
txt
 == '300x300'):

541 
ÅoštsX
 = 300

542 
ÅoštsY
 = 300

543 
	`–if
(
txt
 == '100x50'):

544 
ÅoštsX
 = 100

545 
ÅoštsY
 = 50

546 
	`–if
(
txt
 == '200x50'):

547 
ÅoštsX
 = 200

548 
ÅoštsY
 = 50

549 
	`–if
(
txt
 == '300x50'):

550 
ÅoštsX
 = 300

551 
ÅoštsY
 = 50

553 
ÅoštsX
 = 25

554 
ÅoštsY
 = 25

557 
sÿn_li¡
 = []

558 
posL¡
 = 
£lf
.
v›w
.
	`g‘_£Ëùed_pos™iÚs
()

559 (
’”gy
, 
v®id
èğ
£lf
.
’”gyFld
.
	`‹xt
().
	`toFlßt
()

560 
dw–l
 = 
£lf
.
dw–lSlid”
.
	`v®ue
()

562 
pos
 
š
 
posL¡
:

563 
pos_num
 = 
pos
.pos_num

564 
po¢ame
 = 
pos
.
Çme


565 (
xC’‹r
, 
yC’‹r
èğ
_§m¶e_pos™iÚs
[
po¢ame
]

566 
¡¬tX
 = 
xC’‹r
 - (0.5 * 
§m¶e_cœşe_dŸm
)

567 
¡İX
 = 
xC’‹r
 + (0.5 * 
§m¶e_cœşe_dŸm
)

568 
¡¬tY
 = 
yC’‹r
 - (0.5 * 
§m¶e_cœşe_dŸm
)

569 
¡İY
 = 
yC’‹r
 + (0.5 * 
§m¶e_cœşe_dŸm
)

570 
sÿn_li¡
.
	`­³nd
Ğ{'pos_num':
pos_num
, 'po¢ame':
po¢ame
,

571 '¡¬tX':
¡¬tX
, '¡İX':
¡İX
, '¡¬tY':
¡¬tY
, '¡İY':
¡İY
,

572 'ÅoštsX':
ÅoštsX
, 'ÅoštsY':
ÅoštsY
,

573 'xC’‹r':
xC’‹r
, 'yC’‹r':
yC’‹r
,

574 '’”gy':
’”gy
,

575 'dw–l':
dw–l
} )

577 #g‘_v–o_fÜ_sÿn(
¡¬tX
, 
¡İX
, 
ÅoštsX
, 
dw–l
)

578 
	g£lf
.
	gdo_´ev›w
.
em™
(
sÿn_li¡
)

583 
	g__Çme__
 == "__main__":

584 
­p
 = 
QtWidg‘s
.
QAµliÿtiÚ
(
sys
.
¬gv
)

586 #v›w = 
QtWidg‘s
.
QG¿phicsV›w
(
sûÃ
)

587 
wšdow
 = 
Sam¶eS–eùÜWidg‘
(
sÿËr
=0.75)

588 
wšdow
.
show
()

590 
sys
.
ex™
(
­p
.
exec_
())

	@widgets/scan_queue_table.py

2 
C»©ed
 
Ú
 
	gFeb
 9, 2016

4 @
	gauthÜ
: 
b”gr


6 
äom
 
şs
.
­¶iÿtiÚs
.
pyStxm
.
widg‘s
.
´og_diù_uts
 
impÜt
 
make_´og»ss_diù


8 
C»©ed
 
Ú
 
Nov
 2, 2015

10 @
	gauthÜ
: 
b”gr


12 
impÜt
 
İ”©Ü


13 
impÜt
 
os


14 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
	gQtWidg‘s


16 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
´og_diù_uts
 
impÜt
 
	gmake_´og»ss_diù
, 
	gPROG_DCT_ID
, 
	gPROG_DCT_SPID
, 
	gPROG_DCT_PERCENT
, 
	gPROG_DCT_STATE


18 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	gd©a
.
bioxas_im_d©a_io
 
impÜt
 
	gBioxasD©aIo


19 
äom
 
	gşs
.
	g­p_d©a
.
deçuÉs
 
impÜt
 
	grgb_as_hex
, 
	gma¡”_cŞÜs
, 
	gma¡”_q_cŞÜs
, 
	gg‘_¡yË


20 
äom
 
	gşs
.
	guts
.
roi_uts
 
impÜt
 
	gg‘_ba£_roi
, 
	gg‘_ba£_’”gy_roi
, 
	gg‘_unique_roi_id
, \

21 
	gg‘_•u_pŞ_dù
, 
	gmake_¥©Ÿl_db_diù
, 
	gwidg‘_com_cmnd_ty³s
, \

22 
	gÚ_¿nge_chªged
, 
	gÚ_Åošts_chªged
, 
	gÚ_¡•_size_chªged
, 
	gÚ_¡¬t_chªged
, 
	gÚ_¡İ_chªged
, \

23 
	gÚ_ûÁ”_chªged
, 
	g»ÿlc_£ošts
, 
	gsÿn_image_ty³s
, 
	gsÿn_ty³s
, 
	gg‘_¥_ids_äom_wdg_com
, 
	gg‘_¥_db_äom_wdg_com


25 
äom
 
	gşs
.
	gsÿÂšg
.
ty³s
 
impÜt
 
	gsÿn_¡©us_ty³s


26 
äom
 
	gşs
.
	guts
.
roi_diù_defs
 
	gimpÜt
 *

28 
äom
 
	gşs
.
	guts
.
diù_uts
 
impÜt
 
	gdù_g‘
, 
	gdù_put


29 
äom
 
	gşs
.
	guts
.
feUts
 
impÜt
 
	gg‘_fe_·th_as_·¹s


30 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”


33 
äom
 
	gbcm
.
	gdeviû
.
•u
 
impÜt
 
	gcÚv”t_w¿µ”_•u_to_¡r


35 #£tu°
moduË
 
logg”
 
w™h
 
a
  do-
nÙhšg
 
hªdËr


36 
	g_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

38 
HDR_FONT_SIZE
 = 8.0

39 
TABLE_FONT_SIZE
 = 8.0

42 
DEFAULT_PIXMAP_COLUMN
 = 5

43 
DEFAULT_PROGESS_BAR_COLUMN
 = 6

45 #bË 
cŞumn
 
width
 
defš™iÚs


46 
FILENAME_WIDTH
 = 120

47 
STACK_FILENAME_WIDTH
 = 170

48 
EV_WIDTH
 = 60

49 
START_WIDTH
 = 100

50 
POLARITY_WIDTH
 = 100

51 
CENTER_WIDTH
 = 150

52 
NPOINTS_WIDTH
 = 100

53 
PMAP_WIDTH
 = 16

54 
PROGRESS_WIDTH
 = 150

56 
şass
 
	$Ba£Mod–
(
QtCÜe
.
QObjeù
):

57 
chªged
 = 
QtCÜe
.
	`pyqtSigÇl
()

59 
def
 
	$__š™__
(
£lf
):

60 
QtCÜe
.
QAb¡¿ùTabËMod–
.
	`__š™__
(
£lf
)

61 
£lf
.
mod–_d©a
 = []

63 
def
 
	$g‘_mod–_d©a
(
£lf
):

64 (
£lf
.
mod–_d©a
)

66 
def
 
	$£t_d©a
(
£lf
, 
row
, 
cŞ
, 
v®
):

68 
U£rs
 
mu¡
 
u£
 
this
 
£t_d©a
 
funùiÚ
 
they
 
wªt
 
to
 
£e
 
the
 
chªges
 
beÿu£
he changes

69 
¬e
 
d•’dªt
 
Ú
 
the
 
chªged
 
sigÇl
 
bešg
 
em™‹d


71 
Œy
:

72 if(
	`Ën
(
£lf
.
mod–_d©a
) > 0):

73 
£lf
.
mod–_d©a
[
row
][
cŞ
] = 
v®


74 
£lf
.
chªged
.
	`em™
()

75 
exû±
 
IndexE¼Ü
:

77 
·ss


80 
şass
 
	$SÿnQueueMod–
(
Ba£Mod–
):

81 
def
 
	$__š™__
(
£lf
):

82 
Ba£Mod–
.
	`__š™__
(
£lf
)

84 
sÿn_q_mod–_şass
 = 
	`SÿnQueueMod–
()

86 
şass
 
	$SÿnQTabËMod–
(
QtCÜe
.
QAb¡¿ùTabËMod–
):

87 
def
 
	$__š™__
(
£lf
, 
·»Á
, 
mod–_d
, 
h—d”
, *
¬gs
):

88 #glob® 
mod–_d©a


89 
QtCÜe
.
QAb¡¿ùTabËMod–
.
	`__š™__
(
£lf
, 
·»Á
, *
¬gs
)

90 
£lf
.
h—d”
 = header

91 
£lf
.
sÿn_q_mod–_şass
 = scan_q_model_class

92 
£lf
.
mod–_d©a
 = 
sÿn_q_mod–_şass
.
	`g‘_mod–_d©a
()

93 
£lf
.
pm­_cŞ
 = 
DEFAULT_PIXMAP_COLUMN


94 
£lf
.
´og_cŞ
 = 
DEFAULT_PROGESS_BAR_COLUMN


96 #cÚÃù 
to
 
the
 
chªged
 
sigÇl
 
so
 
th©
 
chªges
Øth
mod–
 
äom
 
ªywh”e
 
wl
 
be
 
sigÇËd
 
back
 
h”e


97 
£lf
.
sÿn_q_mod–_şass
.
chªged
.
	`cÚÃù
(£lf.
_em™_chªged
)

99 
def
 
	$_em™_chªged
(
£lf
):

100 
£lf
.
d©aChªged
.
	`em™
(
QtCÜe
.
	`QMod–Index
(), QtCore.QModelIndex())

102 
def
 
	$£t_pm­_cŞ
(
£lf
, 
cŞ
):

103 
£lf
.
pm­_cŞ
 = 
cŞ


105 
def
 
	$£t_´og_cŞ
(
£lf
, 
cŞ
):

106 
£lf
.
´og_cŞ
 = 
cŞ


108 
def
 
	$£t_h—d”
(
£lf
, 
hdr_li¡
):

109 
£lf
.
h—d”
 = 
hdr_li¡


111 
def
 
	$£t_mod–
(
£lf
, 
mod–
):

112 
£lf
.
mod–_d©a
 = s–f.
sÿn_q_mod–_şass
.
	`g‘_mod–_d©a
()

113 
r
 
š
 
mod–
:

114 
£lf
.
	`š£¹Row
(
r
)

116 
def
 
	`š£¹Row
(
£lf
, 
™em
, 
·»Á
=
QtCÜe
.
	$QMod–Index
()):

118 
	$š£¹Row
(): 
desütiÚ


120 :
·¿m
 
sÿn
: sÿÀ
desütiÚ


121 :
ty³
 
sÿn
: scanype

123 :
·¿m
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
desütiÚ


124 :
ty³
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
ty³


126 :
»tuºs
: 
NÚe


128 
£lf
.
mod–_d©a
 = s–f.
sÿn_q_mod–_şass
.
	`g‘_mod–_d©a
()

129 
£lf
.
	`begšIn£¹Rows
(
·»Á
, s–f.
	`rowCouÁ
(parent), self.rowCount(parent))

130 
£lf
.
mod–_d©a
.
	`­³nd
(
™em
)

131 
£lf
.
	`’dIn£¹Rows
()

132 
£lf
.
d©aChªged
.
	`em™
(
·»Á
,…arent)

133 (
£lf
.
	`rowCouÁ
(
·»Á
))

135 
def
 
	`»moveAÎ
(
£lf
, 
·»Á
=
QtCÜe
.
	$QMod–Index
()):

136 
£lf
.
mod–_d©a
 = s–f.
sÿn_q_mod–_şass
.
	`g‘_mod–_d©a
()

137 
£lf
.
	`rowCouÁ
() > 0:

138 
£lf
.
	`begšRemoveRows
(
·»Á
, 0, 
	`Ën
(£lf.
mod–_d©a
))

139 
i
 
š
 
	`¿nge
(0, 
£lf
.
	$rowCouÁ
()) :

140 
	`d–
(
£lf
.
mod–_d©a
[0])

141 
£lf
.
	`»moveRows
(0, s–f.
	`rowCouÁ
())

142 
£lf
.
	`’dRemoveRows
()

143 
£lf
.
d©aChªged
.
	`em™
(
·»Á
,…arent)

144 
£lf
.
mod–_d©a
 = s–f.
sÿn_q_mod–_şass
.
	`g‘_mod–_d©a
()

146 
def
 
	`rowCouÁ
(
£lf
, 
·»Á
=
QtCÜe
.
	$QMod–Index
()):

147  
	`Ën
(
£lf
.
mod–_d©a
)

149 
def
 
	`cŞumnCouÁ
(
£lf
, 
·»Á
=
QtCÜe
.
	$QMod–Index
()):

150 (
	`Ën
(
£lf
.
h—d”
))

152 
def
 
	$d©a
(
£lf
, 
šdex
, 
rŞe
=
QtCÜe
.
Qt
.
Di¥ÏyRŞe
):

153 
nÙ
 
šdex
.
	$isV®id
():

154  
NÚe


156 
row
 = 
šdex
.
	`row
()

157 
cŞ
 = 
šdex
.
	`cŞumn
()

158 
¡s
 = 
£lf
.
mod–_d©a
[
row
][£lf.
pm­_cŞ
]

160 if(
row
 > 
£lf
.
	$rowCouÁ
()):

161 (
NÚe
)

163 if((
cŞ
 =ğ0è
	$ªd
 (
rŞe
 =ğ
QtCÜe
.
Qt
.
TextAlignm’tRŞe
)):

164  
QtCÜe
.
Qt
.
AlignLeá


166 
	`–if
((
cŞ
 > 0è
	$ªd
 (
rŞe
 =ğ
QtCÜe
.
Qt
.
TextAlignm’tRŞe
)):

167  
QtCÜe
.
Qt
.
AlignC’‹r


170 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
BackgroundRŞe
:

172 if(
¡s
 =ğ
sÿn_¡©us_ty³s
.
STOPPED
):

173 
bg
 = 
ma¡”_q_cŞÜs
['app_medgray']

174 
	$–if
(
¡s
 =ğ
sÿn_¡©us_ty³s
.
PAUSED
):

175 
bg
 = 
ma¡”_q_cŞÜs
['app_yellow']

176 
	$–if
(
¡s
 =ğ
sÿn_¡©us_ty³s
.
RUNNING
):

177 
bg
 = 
ma¡”_q_cŞÜs
['scan_sts_blue']

178 
	$–if
(
¡s
 =ğ
sÿn_¡©us_ty³s
.
ABORTED
):

179 
bg
 = 
ma¡”_q_cŞÜs
['app_red']

181 
bg
 = 
ma¡”_q_cŞÜs
['app_drkgray']

183  
bg


185 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
FÜegroundRŞe
:

186 if(
¡s
 =ğ
sÿn_¡©us_ty³s
.
STOPPED
):

187 
fg
 = 
ma¡”_q_cŞÜs
['app_superltgray']

188 
	$–if
(
¡s
 =ğ
sÿn_¡©us_ty³s
.
PAUSED
):

189 
fg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
bÏck
)

190 
	$–if
(
¡s
 =ğ
sÿn_¡©us_ty³s
.
RUNNING
):

191 
fg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
wh™e
)

192 
	$–if
(
¡s
 =ğ
sÿn_¡©us_ty³s
.
ABORTED
):

193 
fg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
wh™e
)

194 
	$–if
(
¡s
 =ğ
sÿn_¡©us_ty³s
.
DONE
):

195 
fg
 = 
ma¡”_q_cŞÜs
['app_blue']

197 
_logg”
.
	`”rÜ
('unknowÀsÿÀ¡©us[%d]' % 
¡s
)

198 
fg
 = 
NÚe


199  
fg


201 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
Di¥ÏyRŞe
:

203  
£lf
.
mod–_d©a
[
row
][
cŞ
]

205  
NÚe


208 
def
 
	$h—d”D©a
(
£lf
, 
cŞ
, 
Ü›Á©iÚ
, 
rŞe
=
QtCÜe
.
Qt
.
Di¥ÏyRŞe
):

209 
Ü›Á©iÚ
 =ğ
QtCÜe
.
Qt
.
HÜizÚl
 
ªd
 
rŞe
 =ğQtCÜe.Qt.
Di¥ÏyRŞe
:

210  
£lf
.
h—d”
[
cŞ
]

211  
NÚe


213 
def
 
	$£tD©a
(
£lf
, 
šdex
, 
v®ue
, 
rŞe
=
QtCÜe
.
Qt
.
Di¥ÏyRŞe
):

214 
row
 = 
šdex
.
	`row
()

215 
cŞ
 = 
šdex
.
	`cŞumn
()

216 if((
cŞ
 =ğ
£lf
.
´og_cŞ
è
	`ªd
 (£lf.
mod–_d©a
[
row
][self.prog_col] == 100.0)):

217 
´št
 ''

219 
£lf
.
mod–_d©a
[
row
][
cŞ
] = 
v®ue


220  
True


222 
def
 
	$modify_d©a
(
£lf
, 
row
, 
cŞ
, 
v®ue
):

223 
£lf
.
mod–_d©a
[
row
][
cŞ
] = 
v®ue


224 
£lf
.
d©aChªged
.
	`em™
(
QtCÜe
.
	`QMod–Index
(), QtCore.QModelIndex())

226 
def
 
	$æags
(
£lf
, 
šdex
):

227  
QtCÜe
.
Qt
.
I‹mIsEÇbËd
 | QtCÜe.Qt.
I‹mIsS–eùabË


229 
şass
 
	$SÿnQTabËV›w
(
QtWidg‘s
.
QTabËV›w
):

231 
A
 
sim¶e
 
bË


233 
def
 
	$__š™__
(
£lf
, 
h—d”
, **
kw¬gs
):

234 
QtWidg‘s
.
QTabËV›w
.
	`__š™__
(
£lf
)

235 
£lf
.
	`£tObjeùName
('scan_q_tblview')

237 if('´og_cŞ' 
š
 
kw¬gs
.
	$keys
()):

238 
£lf
.
´og_cŞ
 = 
kw¬gs
['prog_col']

240 
£lf
.
´og_cŞ
 = 
DEFAULT_PROGESS_BAR_COLUMN


242 if('pm­_cŞ' 
š
 
kw¬gs
.
	$keys
()):

243 
£lf
.
pm­_cŞ
 = 
kw¬gs
['pmap_col']

245 
£lf
.
pm­_cŞ
 = 
DEFAULT_PIXMAP_COLUMN


247 
£lf
.
hdr_li¡
 = 
h—d”


248 
£lf
.
	`£tS–eùiÚBehaviÜ
(
QtWidg‘s
.
QAb¡¿ùI‹mV›w
.
S–eùRows
)

249 
£lf
.
	`v”tiÿlH—d”
().
	`£tDeçuÉSeùiÚSize
(15)

251 #tuº 
bŞd
 
off


252 
fÚt
 = 
£lf
.
	`hÜizÚlH—d”
().
	`fÚt
()

253 
fÚt
.
	`£tBŞd
(
F®£
)

254 
fÚt
.
	`£tPoštSize
(
HDR_FONT_SIZE
)

255 
£lf
.
	`hÜizÚlH—d”
().
	`£tFÚt
(
fÚt
)

257 
£lf
.
	`š™_d–eg©es
()

258 #£lf.
	`£tAÉ”ÇtšgRowCŞÜs
(
True
)

259 #£lf.
	`£tCÚ‹ÁsM¬gšs
(1, 10, 10, 1)

261 
def
 
	$£t_pm­_cŞ
(
£lf
, 
cŞ
):

262 
£lf
.
pm­_cŞ
 = 
cŞ


264 
def
 
	$£t_´og_cŞ
(
£lf
, 
cŞ
):

265 
£lf
.
´og_cŞ
 = 
cŞ


267 
def
 
	$£t_´og»ss
(
£lf
, 
row
, 
´og
):

268 
£lf
.
	`mod–
().
	`modify_d©a
(
row
, s–f.
´og_cŞ
, 
´og
)

270 
def
 
	$£t_pixm­
(
£lf
, 
row
, 
pm­
):

271 
£lf
.
	`mod–
().
	`modify_d©a
(
row
, s–f.
pm­_cŞ
, 
pm­
)

273 
def
 
	$š™_d–eg©es
(
£lf
):

274 
num_cŞs
 = 
	`Ën
(
£lf
.
hdr_li¡
)

275 #®way 
the
 
Ï¡
 2

276 
£lf
.
	`£tI‹mD–eg©eFÜCŞumn
(
num_cŞs
 -1, 
	`Prog»ssB¬D–eg©e
(self))

277 
£lf
.
	`£tI‹mD–eg©eFÜCŞumn
(
num_cŞs
 -2 , 
	`Pixm­D–eg©e
(self))

280 
def
 
	$£t_h—d”
(
£lf
, 
hdr_li¡
):

281 
£lf
.
	`mod–
().
	`£t_h—d”
(
hdr_li¡
)

282 
£lf
.
hdr_li¡
 = hdr_list

283 
£lf
.
	`š™_d–eg©es
()

285 
def
 
	$»move_mod–
(
£lf
):

286 
£lf
.
	`mod–
().
	`»moveAÎ
()

288 
def
 
	$£t_mod–
(
£lf
, 
mod–
):

289 
£lf
.
	`mod–
().
	`£t_mod–
(
mod–
)

291 
def
 
	$£t_mod–_cŞumn_deçuÉs
(
£lf
):

293 
	$£t_mod–_cŞumn_deçuÉs
(): 
desütiÚ


295 :
»tuºs
: 
NÚe


297 
£lf
.
	`mod–
().
	`£t_cŞ_»adÚly
(0)

298 
i
 
š
 
	`¿nge
(1,
	$Ën
(
£lf
.
hdr_li¡
)):

299 
£lf
.
	`hÜizÚlH—d”
().
	`£tSeùiÚResizeMode
(
i
, 
QtWidg‘s
.
QH—d”V›w
.
SŒ‘ch
)

302 
şass
 
	$Prog»ssB¬D–eg©e
(
QtWidg‘s
.
QI‹mD–eg©e
):

304 
A
 
d–eg©e
 
th©
 
¶aûs
 
a
 
fuÎy
 
funùiÚšg
 
QProg»ssB¬
 
š
 
ev”y


305 
ûÎ
 
of
 
the
 
cŞumn
 
to
 
which
 
™
's‡pplied

307 
The
 
fÜm©tšg
 
of
 
the
 
sÿn_´og
 
´og»ss
 
b¬
 
is
 
dÚe
 
š
 
‹h
 
QProg»sb¬
 
¡yËsh“t


309 
def
 
	$__š™__
(
£lf
, 
·»Á
):

311 
QtWidg‘s
.
QI‹mD–eg©e
.
	`__š™__
(
£lf
, 
·»Á
)

312 
£lf
.
´og_¡©us
 = 
sÿn_¡©us_ty³s
.
STOPPED


314 
def
 
	$ü—‹Ed™Ü
(
£lf
, 
·»Á
, 
İtiÚ
, 
šdex
):

315 
pb¬
 = 
QtWidg‘s
.
	`QProg»ssB¬
(
·»Á
)

316 
pb¬
.
	`£tObjeùName
('scan_progbar')

317 
pb¬
.
	`£tMšimumWidth
(150)

318 
pb¬
.
	`£tMaximumHeight
(15)

319 
pb¬
.
	`£tRªge
(0,100)

320 #pb¬.
‹xtAlignm’t
 = 
Qt
.
AlignC’‹r


321 
pb¬
.
	`£tV®ue
(10)

322 #£lf.
	`cÚÃù
(
pb¬
, 
	`SIGNAL
("toggËd(boŞ)"), 
£lf
, 
	`SLOT
("on_toggled()"))

323  
pb¬


326 
def
 
	$£tEd™ÜD©a
(
£lf
, 
ed™Ü
, 
šdex
):

327 
ed™Ü
.
	`blockSigÇls
(
True
)

328 
d©a
 = 
šdex
.
	`mod–
().
	`d©a
(šdex, 
QtCÜe
.
Qt
.
Di¥ÏyRŞe
)

329 
ed™Ü
.
	`£tV®ue
(
d©a
)

331 if(
d©a
 == 0.0):

332 
ed™Ü
.
	`£tStyËSh“t
("*::chunk{ background-cŞÜ: % }" % 
ma¡”_cŞÜs
['app_drkgray'])

333 
ed™Ü
.
	`£tStyËSh“t
("*{ cŞÜ: % }" % 
ma¡”_cŞÜs
['white'])

334 
	`–if
(
d©a
 < 100.0):

335 
ed™Ü
.
	`£tStyËSh“t
("*::chunk{ background-cŞÜ: % }" % 
ma¡”_cŞÜs
['scan_sts_blue'])

336 
ed™Ü
.
	`£tStyËSh“t
("*{ cŞÜ: % }" % 
ma¡”_cŞÜs
['white'])

338 
	`–if
(
d©a
 >= 100.0):

339 
ed™Ü
.
	`£tStyËSh“t
("*{ cŞÜ: % } \À*::chunk{ background-cŞÜ: % }" % (
ma¡”_cŞÜs
['app_blue'], master_colors['app_drkgray']))

340 #ed™Ü.
	`£tStyËSh“t
("*{ cŞÜ: % }" % 
ma¡”_cŞÜs
['app_blue'])

342 
·ss


344 
ed™Ü
.
	`blockSigÇls
(
F®£
)

346 
def
 
	$£tMod–D©a
(
£lf
, 
ed™Ü
, 
mod–
, 
šdex
):

347 
d©a
 = 
šdex
.
	`mod–
().
	`d©a
(šdex, 
QtCÜe
.
Qt
.
Di¥ÏyRŞe
)

348 
mod–
.
	`£tD©a
(
šdex
, 
d©a
, 
QtCÜe
.
Qt
.
Ed™RŞe
)

350 @
QtCÜe
.
	`pyqtSlÙ
()

351 
def
 
	$Ú_toggËd
(
£lf
):

352 
£lf
.
comm™D©a
.
	`em™
(£lf.
	`£nd”
())

355 
def
 
	$g‘_pixm­
(
âame
):

356 
pm­
 = 
QtGui
.
	`QPixm­
(
âame
)

357 #pm­.
	`sÿËd
(64, 64)#, 
a¥eùR©ioMode
=
Qt_IgnÜeA¥eùR©io
, 
ŒªsfÜmMode
=
Qt_Fa¡T¿nsfÜm©iÚ
)

358 
pm­
 =…m­.
	`sÿËd
(
QtCÜe
.
	`QSize
(16,16), QtCÜe.
Qt
.
K“pA¥eùR©io
)

359 (
pm­
)

361 
şass
 
	$Pixm­D–eg©e
(
QtWidg‘s
.
QI‹mD–eg©e
):

363 
A
 
d–eg©e
 
th©
 
¶aûs
 
a
 
fuÎy
 
funùiÚšg
 
QProg»ssB¬
 
š
 
ev”y


364 
ûÎ
 
of
 
the
 
cŞumn
 
to
 
which
 
™
's‡pplied

366 
Ãed
 
ª
 
icÚ
 
—ch
 
¡©us


367 
sÿn_¡©us_ty³s
 = 
	`Enum
('STOPPED', 'PAUSED', 'RUNNING', 'ABORTED', 'DONE')

369 
def
 
	$__š™__
(
£lf
, 
·»Á
):

371 
QtWidg‘s
.
QI‹mD–eg©e
.
	`__š™__
(
£lf
, 
·»Á
)

373 
£lf
.
dœ
 = 
r
'C:\\controls\\py2.7\\Beamlines\\sm\\stxm_control\\icons\\png\\'

374 
£lf
.
psize
 = '\\64x64\\'

375 
£lf
.
·u£_şr
 = 'yellow'

376 
£lf
.
ruÂšg_şr
 = 'blue'

377 
£lf
.
¡İ³d_şr
 = 'gray'

378 
£lf
.
abÜ‹d_şr
 = 'red'

379 
£lf
.
dÚe_şr
 = 'blue'

381 
£lf
.
·u£d_pm­
 = 
	`g‘_pixm­
(£lf.
dœ
 + s–f.
·u£_şr
 + s–f.
psize
 + 'pause.png')

382 
£lf
.
ruÂšg_pm­
 = 
	`g‘_pixm­
(£lf.
dœ
 + s–f.
ruÂšg_şr
 + s–f.
psize
 + 'loop.png')

383 
£lf
.
¡İ³d_pm­
 = 
	`g‘_pixm­
(£lf.
dœ
 + s–f.
¡İ³d_şr
 + s–f.
psize
 + 'stop.png')

384 
£lf
.
abÜ‹d_pm­
 = 
	`g‘_pixm­
(£lf.
dœ
 + s–f.
abÜ‹d_şr
 + s–f.
psize
 + 'flag.png')

385 
£lf
.
dÚe_pm­
 = 
	`g‘_pixm­
(£lf.
dœ
 + s–f.
dÚe_şr
 + s–f.
psize
 + 'check.png')

387 
£lf
.
pm­
 = s–f.
·u£d_pm­


389 
def
 
	$ü—‹Ed™Ü
(
£lf
, 
·»Á
, 
İtiÚ
, 
šdex
):

390 
Ïb–
 = 
QtWidg‘s
.
	`QLab–
(
·»Á
)

391 
Ïb–
.
	`£tMaximumHeight
(15)

392 
£lf
.
pm­
 = s–f.
·u£d_pm­


393 
Ïb–
.
	`£tPixm­
(
£lf
.
pm­
)

394 (
Ïb–
)

396 
def
 
	$g‘_cur_pixm­
(
£lf
):

397 (
£lf
.
pm­
)

399 
def
 
	$£t_cur_pixm­
(
£lf
, 
pm­
):

400 
£lf
.
pm­
 =…map

402 
def
 
	$£tEd™ÜD©a
(
£lf
, 
ed™Ü
, 
šdex
):

404 
sÿn_¡©us_ty³s
 = 
	`Enum
('STOPPED', 'PAUSED', 'RUNNING', 'ABORTED', 'DONE')

406 
ed™Ü
.
	`blockSigÇls
(
True
)

407 
d©a
 = (
šdex
.
	`mod–
().
	`d©a
(šdex, 
QtCÜe
.
Qt
.
Di¥ÏyRŞe
))

408 if(
d©a
 =ğ
sÿn_¡©us_ty³s
.
STOPPED
):

409 
ed™Ü
.
	`£tPixm­
(
£lf
.
¡İ³d_pm­
)

410 
	$–if
(
d©a
 =ğ
sÿn_¡©us_ty³s
.
PAUSED
):

411 
ed™Ü
.
	`£tPixm­
(
£lf
.
·u£d_pm­
)

412 
	$–if
(
d©a
 =ğ
sÿn_¡©us_ty³s
.
RUNNING
):

413 
ed™Ü
.
	`£tPixm­
(
£lf
.
ruÂšg_pm­
)

414 
	$–if
(
d©a
 =ğ
sÿn_¡©us_ty³s
.
ABORTED
):

415 
ed™Ü
.
	`£tPixm­
(
£lf
.
abÜ‹d_pm­
)

416 
	$–if
(
d©a
 =ğ
sÿn_¡©us_ty³s
.
DONE
):

417 
ed™Ü
.
	`£tPixm­
(
£lf
.
dÚe_pm­
)

419 
_logg”
.
	`”rÜ
('sÿÀ¡©u [%d]‚Ù suµÜ‹d' % 
d©a
)

420 
ed™Ü
.
	`upd©e
()

421 
ed™Ü
.
	`blockSigÇls
(
F®£
)

423 
def
 
	$£tMod–D©a
(
£lf
, 
ed™Ü
, 
mod–
, 
šdex
):

424 
d©a
 = 
šdex
.
	`mod–
().
	`d©a
(šdex, 
QtCÜe
.
Qt
.
Di¥ÏyRŞe
)

425 
mod–
.
	`£tD©a
(
šdex
, 
d©a
, 
QtCÜe
.
Qt
.
Ed™RŞe
)

429 
şass
 
	$SÿnQueueTabËWidg‘
(
QtWidg‘s
.
QWidg‘
):

430 
def
 
	$__š™__
(
£lf
, **
kw¬gs
):

431 
QtWidg‘s
.
QWidg‘
.
	`__š™__
(
£lf
)

432 #£tGeom‘ry(
x_pos
, 
y_pos
, 
width
, 
height
)

433 
£lf
.
	`£tGeom‘ry
(300, 200, 870, 450)

434 
h—d”
 = [' File', 'ƒV', 'Pol', 'Range', '# Points', '', ' Progress']

436 
£lf
.
pm­_cŞ
 = 
DEFAULT_PIXMAP_COLUMN


437 
£lf
.
´og_cŞ
 = 
DEFAULT_PROGESS_BAR_COLUMN


439 
£lf
.
âame_li¡
 = []

440 
£lf
.
¥id_to_row_dù
 = {
	}
}

441 #u£ 
numb”s
 
num”ic
 
d©a
 
to
 
sÜt
 
´İ”ly


442 
d©a_li¡
 = []

443 
bË_mod–
 = 
SÿnQTabËMod–
(
£lf
, 
d©a_li¡
, 
h—d”
)

444 
	gbË_v›w
 = 
SÿnQTabËV›w
(
h—d”
, 
´og_cŞ
=
£lf
.´og_cŞ, 
pm­_cŞ
=self.pmap_col)

445 
bË_v›w
.
£tMod–
(
bË_mod–
)

447 
row
 
š
 
¿nge
(0, 
bË_mod–
.
	$rowCouÁ
()):

448 
bË_v›w
.
	`İ’P”si¡’tEd™Ü
(
bË_mod–
.
	`šdex
(
row
, 
£lf
.
´og_cŞ
))

449 
bË_v›w
.
	`İ’P”si¡’tEd™Ü
(
bË_mod–
.
	`šdex
(
row
, 
£lf
.
pm­_cŞ
))

450 
bË_v›w
.
	`£tRowHeight
(
row
, 15)

453 
bË_v›w
.
	`£tCŞumnWidth
(0, 
FILENAME_WIDTH
)

454 
bË_v›w
.
	`£tCŞumnWidth
(1, 
EV_WIDTH
)

455 
bË_v›w
.
	`£tCŞumnWidth
(2, 
POLARITY_WIDTH
)

456 
bË_v›w
.
	`£tCŞumnWidth
(3, 
CENTER_WIDTH
)

457 
bË_v›w
.
	`£tCŞumnWidth
(4, 
NPOINTS_WIDTH
)

458 
bË_v›w
.
	`£tCŞumnWidth
(5, 
PMAP_WIDTH
)

459 
bË_v›w
.
	`£tCŞumnWidth
(6, 
PROGRESS_WIDTH
)

461 
£lf
.
bË_v›w
 =able_view

462 #£ˆ
fÚt


463 #fÚˆğ
bË_v›w
.
	`fÚt
()

464 #fÚt.
	`£tPoštSizeF
(7)

465 
fÚt
 = 
QtGui
.
	`QFÚt
("Cour›¸New", 
TABLE_FONT_SIZE
)

466 
bË_v›w
.
	`£tFÚt
(
fÚt
)

467 #£ˆ
cŞumn
 
width
 
to
 
f™
 
	`cÚ‹Ás
 (
£t
 
fÚt
 
fœ¡
!)

468 #bË_v›w.
	`»sizeCŞumnsToCÚ‹Ás
()

469 #’abË 
sÜtšg


470 
bË_v›w
.
	`£tSÜtšgEÇbËd
(
F®£
)

472 
£lf
.
¡yËBŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
('Update Style')

473 
£lf
.
¡yËBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_upd©e_¡yË
)

475 
£lf
.
lßdSÿnBŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
('Load Scan')

476 
£lf
.
lßdSÿnBŠ
.
şicked
.
	`cÚÃù
(£lf.
İ’fe
)

478 
£lf
.
dœLab–
 = 
QtWidg‘s
.
	`QLab–
('Directory: ')

479 
fÚt
 = 
£lf
.
dœLab–
.
	`fÚt
()

480 
fÚt
.
	`£tBŞd
(
True
)

481 
£lf
.
dœLab–
.
	`£tFÚt
(
fÚt
)

483 #£lf.
thumbÇLbl
 = 
QtWidg‘s
.
	`QLab–
()

484 #£lf.
thumbÇLbl
.
	`£tMšimumSize
(150, 150)

485 #pm­ = 
QtGui
.
	`QPixm­
(
r
'C:\\controls\\py2.7\\Beamlines\\sm\\stxm_control\\widgets\\icons\\black.jpg')

486 #pm­ = 
pm­
.
	`sÿËd
(
QtCÜe
.
	`QSize
(150,150), QtCÜe.
Qt
.
K“pA¥eùR©io
)

487 #£lf.
thumbÇLbl
.
	`£tPixm­
(
pm­
)

489 
Ïyout
 = 
QtWidg‘s
.
	`QVBoxLayout
(
£lf
)

490 
hÏyout
 = 
QtWidg‘s
.
	`QHBoxLayout
()

492 
hÏyout
.
	`addWidg‘
(
bË_v›w
)

493 
hÏyout
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

494 
Ïyout
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

495 
Ïyout
.
	`addWidg‘
(
£lf
.
dœLab–
)

496 
Ïyout
.
	`addLayout
(
hÏyout
)

498 if('loÿl_‹¡' 
š
 
kw¬gs
.
	$keys
()):

499 
£lf
.
rowFld
 = 
QtWidg‘s
.
	`QLšeEd™
("0")

500 
£lf
.
rowFld
.
	`£tToŞT
('Row Field')

501 
£lf
.
rowFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_£t_row
)

502 
£lf
.
´ogFld
 = 
QtWidg‘s
.
	`QLšeEd™
("0")

503 
£lf
.
´ogFld
.
	`£tToŞT
('Progress Field')

504 
£lf
.
´ogFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_£t_´og»ss
)

505 
£lf
.
pm­Fld
 = 
QtWidg‘s
.
	`QLšeEd™
("0")

506 
£lf
.
pm­Fld
.
	`£tToŞT
('Pixmap Field')

507 
£lf
.
pm­Fld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_£t_pixm­
)

509 
Ïyout
.
	`addWidg‘
(
£lf
.
lßdSÿnBŠ
)

510 
Ïyout
.
	`addWidg‘
(
£lf
.
rowFld
)

511 
Ïyout
.
	`addWidg‘
(
£lf
.
´ogFld
)

512 
Ïyout
.
	`addWidg‘
(
£lf
.
pm­Fld
)

514 #bË_v›w.
	`hÜizÚlH—d”
().
	`£tSeùiÚResizeMode
(
QH—d”V›w
.
ResizeToCÚ‹Ás
)

515 
bË_v›w
.
	`hÜizÚlH—d”
().
	`£tSŒ‘chLa¡SeùiÚ
(
True
)

517 
£lf
.
fe_suffix
 = 'hdf5'

519 
def
 
	$Ú_£t_row
(
£lf
):

520 
row
 = (
	`¡r
(
£lf
.
rowFld
.
	`‹xt
()))

521 
£lf
.
	`süŞl_to_row
(
row
)

523 
def
 
	$Ú_£t_´og»ss
(
£lf
):

524 
row
 = (
	`¡r
(
£lf
.
rowFld
.
	`‹xt
()))

525 
v®
 = (
	`¡r
(
£lf
.
´ogFld
.
	`‹xt
()))

526 
£lf
.
	`£t_´og»ss
(
row
, 
v®
)

528 
def
 
	$Ú_£t_pixm­
(
£lf
):

529 
row
 = (
	`¡r
(
£lf
.
rowFld
.
	`‹xt
()))

530 
v®
 = (
	`¡r
(
£lf
.
pm­Fld
.
	`‹xt
()))

531 
£lf
.
	`£t_pixm­
(
row
, 
v®
)

533 
def
 
	$£t_dœeùÜy_Ïb–
(
£lf
, 
dœÇme
):

534 
£lf
.
dœLab–
.
	`£tText
('DœeùÜy: %s' % 
dœÇme
)

536 
def
 
	$£t_´og»ss_cŞumn
(
£lf
, 
cŞ
):

538 
£t
 
™
 
bÙh
 
the
 
TabËV›w
 
ªd
h
Mod–


540 
£lf
.
	`blockSigÇls
(
True
)

541 
£lf
.
bË_v›w
.
	`£t_´og_cŞ
(
cŞ
)

542 
mod–
 = 
£lf
.
bË_v›w
.
	`mod–
()

543 
mod–
.
	`£t_´og_cŞ
(
cŞ
)

544 
£lf
.
´og_cŞ
 = 
cŞ


545 
£lf
.
	`blockSigÇls
(
F®£
)

547 
def
 
	$£t_pixm­_cŞumn
(
£lf
, 
cŞ
):

548 
£lf
.
	`blockSigÇls
(
True
)

549 
£lf
.
bË_v›w
.
	`£t_pm­_cŞ
(
cŞ
)

550 
mod–
 = 
£lf
.
bË_v›w
.
	`mod–
()

551 
mod–
.
	`£t_pm­_cŞ
(
cŞ
)

552 
£lf
.
pm­_cŞ
 = 
cŞ


553 
£lf
.
	`blockSigÇls
(
F®£
)

556 
def
 
	$£t_queue_fe_li¡
(
£lf
, 
âames
):

558 
assign
 
the
 
fe
 
Çmes
 
th©
 
wl
 
be
 
di¥Ïyed
 
š
 
th
 
bË
. 
Som‘imes
h
f’ames
 
¬e
 
g’”©ed


561 
£lf
.
âame_li¡
 = 
âames


563 
def
 
	$Ú_upd©e_¡yË
(
£lf
):

565 
£lf
.
qssh“t
 = 
	`g‘_¡yË
('dark')

566 
£lf
.
	`£tStyËSh“t
(£lf.
qssh“t
)

568 
def
 
	$süŞl_to_row_w™h_¥id
(
£lf
, 
¥_id
):

569 if(
¥_id
 
š
 
£lf
.
¥id_to_row_dù
.
	$keys
()):

570 
row
 = 
£lf
.
¥id_to_row_dù
[
¥_id
]

571 #´šˆ'süŞl_to_row_w™h_¥id:„ow=%d' % 
row


572 
£lf
.
	`süŞl_to_row
(
row
)

573 (
row
)

575 
_logg”
.
	`”rÜ
('süŞl_to_row_w™h_¥id: sp_id[%d] dÛ nÙƒxi¡ iÀbË' % 
¥_id
)

576 
´št
 
£lf
.
¥id_to_row_dù


578 
def
 
	$süŞl_to_row
(
£lf
, 
row
):

579 
row
 > -1:

580 
h
 = 
£lf
.
bË_v›w
.
	`hÜizÚlH—d”
()

581 
i
 
š
 
	`¿nge
(
h
.
	$couÁ
()):

582 
nÙ
 
h
.
	$isSeùiÚHidd’
(
i
è
ªd
 
h
.
	`£ùiÚV›wpÜtPos™iÚ
(i) >= 0:

583 
£lf
.
bË_v›w
.
	`süŞlTo
(£lf.bË_v›w.
	`mod–
().
	`šdex
(
row
, 
i
), s–f.bË_v›w.
Pos™iÚAtC’‹r
)

584 
£lf
.
bË_v›w
.
	`£tCu¼’tIndex
(£lf.bË_v›w.
	`mod–
().
	`šdex
(
row
, 
i
))

587 
def
 
	$£t_´og»ss
(
£lf
, 
row
, 
v®
):

589 
exam¶es
 
of
 
£‰šg
 
a
 
glob®
 
mod–
 
ªd
 
™
 
wl
 
sigÇl
 
the
 
bËmod–
‡nd 
bËv›w
 
th©
 iˆ
has
 
chªged


591 
glob®
 
sÿn_q_mod–_şass


594 #row = 
£lf
.
	`süŞl_to_row_w™h_¥id
(
¥_id
)

595 #dù = 
	`make_´og»ss_diù
(
¥_id
=¥_id, 
³rûÁ
=
v®
)

596 #£lf.
	`£t_´og»ss_by_¥id
(
dù
)

598 
£lf
.
	`süŞl_to_row
(
row
)

599 
sÿn_q_mod–_şass
.
	`£t_d©a
(
row
, 
£lf
.
´og_cŞ
, 
v®
)

600 if(
v®
 > 90.0):

601 
sÿn_q_mod–_şass
.
	`£t_d©a
(
row
, 
£lf
.
pm­_cŞ
, 
sÿn_¡©us_ty³s
.
DONE
)

603 
def
 
	`£t_´og»ss_by_¥id
(
£lf
, 
¥_id
, 
v®
, 
idx
=0):

604 #deà
	`£t_´og»ss_by_¥id
(
£lf
, 
´og_dù
={
PROG_DCT_ID
: 'INVALID'
	}
}):

606 
dù_put
(
dù
, 
PROG_DCT_ID
, PROG_DCT_ID)

607 
dù_put
(
dù
, 
PROG_DCT_SPID
, 
¥_id
)

608 
dù_put
(
dù
, 
PROG_DCT_PERCENT
, 
³rûÁ
)

610 
exam¶es
 
of
 
£‰šg
 
a
 
glob®
 
mod–
 
ªd
 
™
 
wl
 
sigÇl
 
the
 
bËmod–
‡nd 
bËv›w
 
th©
 iˆ
has
 
	gchªged


612 
glob®
 
	gsÿn_q_mod–_şass


613 #if(
dù_g‘
(
´og_dù
, 
PROG_DCT_ID
è
is
 
nÙ
 PROG_DCT_ID):

614 #_logg”.
”rÜ
('Unsupported dictype')

616 #¥_id = 
dù_g‘
(
´og_dù
, 
PROG_DCT_SPID
)

617 #v® = 
dù_g‘
(
´og_dù
, 
PROG_DCT_PERCENT
)

618 #v® = (
¡r
(
£lf
.
´ogFld
.
‹xt
()))

619 #£lf.
bË_v›w
.
£t_´og»ss
(0, 
v®
)

620 #m_m¬k”sProjeùiÚTabËV›w->
süŞlTo
Ğ
šdexLi¡
[0], 
QAb¡¿ùI‹mV›w
::
Ensu»VisibË
);

621 
	grow
 = 
£lf
.
süŞl_to_row_w™h_¥id
(
¥_id
)

622 if(
row
 > -1):

623 
sÿn_q_mod–_şass
.
£t_d©a
(
row
, 
£lf
.
´og_cŞ
, 
v®
)

624 if(
	gv®
 > 90.0):

625 
sÿn_q_mod–_şass
.
£t_d©a
(
row
, 
£lf
.
pm­_cŞ
, 
sÿn_¡©us_ty³s
.
DONE
)

627 
def
 
	$£t_pixm­
(
£lf
, 
row
, 
v®
):

629 
exam¶es
 
of
 
£‰šg
 
a
 
glob®
 
mod–
 
ªd
 
™
 
wl
 
sigÇl
 
the
 
bËmod–
‡nd 
bËv›w
 
th©
 iˆ
has
 
chªged


630 
sÿn_¡©us_ty³s
 = 
	`Enum
('STOPPED', 'RUNNING', 'PAUSED', 'DONE', 'ABORTED')

633 
glob®
 
sÿn_q_mod–_şass


635 
£lf
.
	`süŞl_to_row
(
row
)

636 
choiûs
 = 
sÿn_¡©us_ty³s
.
	`g‘_choiûs
()

637 if(
v®
 < 0):

638 
v®
 = 0

639 if(
v®
 > 
	$Ën
(
choiûs
)):

640 
v®
 = 
	`Ën
(
choiûs
)

641 #£lf.
bË_v›w
.
	`£t_pixm­
(0, 
v®
)

642 
sÿn_q_mod–_şass
.
	`£t_d©a
(
row
, 
£lf
.
pm­_cŞ
, 
v®
)

645 
def
 
	$£t_pixm­_by_¥id
(
£lf
, 
¥_id
, 
v®
):

647 
exam¶es
 
of
 
£‰šg
 
a
 
glob®
 
mod–
 
ªd
 
™
 
wl
 
sigÇl
 
the
 
bËmod–
‡nd 
bËv›w
 
th©
 iˆ
has
 
chªged


648 
sÿn_¡©us_ty³s
 = 
	`Enum
('STOPPED', 'RUNNING', 'PAUSED', 'DONE', 'ABORTED')

651 
glob®
 
sÿn_q_mod–_şass


653 
row
 = 
£lf
.
	`süŞl_to_row_w™h_¥id
(
¥_id
)

654 if(
row
):

655 #v® = (
	`¡r
(
£lf
.
pm­Fld
.
	`‹xt
()))

656 
choiûs
 = 
sÿn_¡©us_ty³s
.
	`g‘_choiûs
()

657 if(
v®
 < 0):

658 
v®
 = 0

659 if(
v®
 > 
	$Ën
(
choiûs
)):

660 
v®
 = 
	`Ën
(
choiûs
)

661 #£lf.
bË_v›w
.
	`£t_pixm­
(0, 
v®
)

662 
sÿn_q_mod–_şass
.
	`£t_d©a
(
row
, 
£lf
.
pm­_cŞ
, 
v®
)

664 
def
 
	$İ’fe
(
£lf
):

666 
	$İ’fe
(): 
desütiÚ


668 :
·¿m
 
âame
: fÇm
desütiÚ


669 :
ty³
 
âame
: fnameype

671 :
·¿m
 
addimages
=
F®£
:‡ddimages=F®£ 
desütiÚ


672 :
ty³
 
addimages
=
F®£
:‡ddimages=Falseype

674 :
»tuºs
: 
NÚe


676 
äom
 
şs
.
­pWidg‘s
.
dŸlogs
 
impÜt
 
g‘O³nFeName


678 
âame
 = 
	`g‘O³nFeName
("O³Àhdf5 fe", 
f‹r_¡r
="hdf5 Fe (*.hdf5)", 
£¬ch_·th
=
r
'S:\STXM-data\Cryo-STXM\2017\guest\0113')

679 if(
âame
):

681 
âame
 = 
	`¡r
(fname)

682 
d©a_dœ
, 
å»fix
, 
fsuffix
 = 
	`g‘_fe_·th_as_·¹s
(
âame
)

683 if(
d©a_dœ
 
is
 
NÚe
):

684 
_logg”
.
	`”rÜ
('ProbËm w™h f[%s]' % 
âame
)

686 
£lf
.
	`£t_dœeùÜy_Ïb–
(
d©a_dœ
)

687 
£lf
.
fe_suffix
 = 
fsuffix
[1:]

689 
d©a_io
 = 
	`BioxasD©aIo
(
d©a_dœ
, 
å»fix
)

690 
’Œy_dù
 = 
d©a_io
.
	`lßd
()

691 
ekey
 = 
’Œy_dù
.
	`keys
()[0]

692 
wdg_com
 = 
d©a_io
.
	`g‘_wdg_com_äom_’Œy
(
’Œy_dù
, 
ekey
)

693 #wdg_com = 
	`dù_g‘
(
ado_obj
, 
ADO_CFG_WDG_COM
)

694 
£lf
.
	`lßd_wdg_com
(
wdg_com
)

696 
def
 
	$ş—r_bË
(
£lf
):

697 
£lf
.
bË_v›w
.
	`»move_mod–
()

700 
def
 
	$lßd_wdg_com
(
£lf
, 
wdg_com
):

702 
ke
 
ª
 
widg‘
 
communiÿtiÚs
 
obj
 
ªd
 
ü—‹
 
a
 
sÿn
 
queue
 
which
 
is
‡ 
li¡
 
of


705 
¥_roi_dù
 = 
	`dù_g‘
(
wdg_com
, 
WDGCOM_SPATIAL_ROIS
)

706 
¥_ids
 = 
¥_roi_dù
.
	`keys
()

708 
sÿn_q_li¡
, 
sÿn_ty³
 = 
£lf
.
	`wdg_com_to_sÿn_queue
(
wdg_com
)

709 if(
sÿn_q_li¡
):

710 
£lf
.
bË_v›w
.
	`»move_mod–
()

711 
£lf
.
bË_v›w
.
	`£t_mod–
(
sÿn_q_li¡
)

712 
£lf
.
	`£t_d–eg©es
(
sÿn_ty³
)

713 #´šˆ
sÿn_q_li¡


715 
def
 
	$wdg_com_to_sÿn_queue
(
£lf
, 
wdg_com
):

717 if(
wdg_com
 
is
 
nÙ
 
NÚe
):

718 
¥_ids
 = 
	`g‘_¥_ids_äom_wdg_com
(
wdg_com
)

719 
sÿn_queue_li¡
 = []

720 
£lf
.
¥id_to_row_dù
 = {
	}
}

721 
row
 = 0

722 
¥_id
 
š
 
¥_ids
:

723 
¥_db
 = 
g‘_¥_db_äom_wdg_com
(
wdg_com
, 
¥_id
)

724 
	grow_’Œy_li¡
, 
	gsÿn_ty³
 = 
£lf
.
make_sÿn_queue_li¡
(
¥_db
)

725 if(
row_’Œy_li¡
):

726 
ado
 = 
dù_g‘
(
¥_db
, 
SPDB_ACTIVE_DATA_OBJECT
)

727 
	gâame
 = 
dù_g‘
(
ado
, 
ADO_CFG_DATA_FILE_NAME
)

728 
	g£lf
.
	g¥id_to_row_dù
[
¥_db
[
SPDB_ID_VAL
]] = 
row


729 
sÿn_queue_li¡
 = sÿn_queue_li¡ + 
row_’Œy_li¡


730 
row
 += 1

732 (
NÚe
, 
	gsÿn_ty³
)

733 (
	gsÿn_queue_li¡
, 
	gsÿn_ty³
)

735 
def
 
	$£t_d–eg©es
(
£lf
, 
sÿn_ty³
):

736 if(
sÿn_ty³
 =ğ
sÿn_ty³s
.
DETECTOR_IMAGE
):

737 
£lf
.
	`£t_d–eg©es_ev
()

739 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
OSA_IMAGE
):

740 
£lf
.
	`£t_d–eg©es_ev
()

742 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
OSA_FOCUS
):

743 
£lf
.
	`£t_d–eg©es_focus
()

745 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_FOCUS
):

746 
£lf
.
	`£t_d–eg©es_focus
()

748 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE
):

749 
£lf
.
	`£t_d–eg©es_muÉi_ev
()

751 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE_STACK
):

752 
£lf
.
	`£t_d–eg©es_muÉi_ev
()

754 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_POINT_SPECTRUM
):

755 
£lf
.
	`£t_d–eg©es_pošt_¥ec
()

757 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
ZP_IMAGE_SCAN
):

758 
£lf
.
	`£t_d–eg©es_muÉi_ev
()

760 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
):

761 
£lf
.
	`£t_d–eg©es_muÉi_ev
()

763 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
GENERIC_SCAN
):

764 
£lf
.
	`£t_d–eg©es_ev
()

766 
´št
 '£t_d–eg©es: sÿÀty³‚Ù suµÜ‹d y‘ [%d]' % 
sÿn_ty³


769 
def
 
	$make_sÿn_queue_li¡
(
£lf
, 
¥_db
):

771 
ke
 
ª
 
’tœe
 
¥©Ÿl
 
»giÚ
 
ªd
 
ü—‹
 
the
 
­´İrŸ‹
 
numb”
 
of
 
row
 
’Œ›s


772 
sÿn_ty³s
 = 
	`Enum
('Detector_Image', \

784 
sÿn_ty³
 = 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
)

787 if(
sÿn_ty³
 =ğ
sÿn_ty³s
.
DETECTOR_IMAGE
):

788 
rows
 = 
£lf
.
	`make_sšgË_ev_row_’Œ›s
(
¥_db
)

790 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
OSA_IMAGE
):

791 
rows
 = 
£lf
.
	`make_sšgË_ev_row_’Œ›s
(
¥_db
)

793 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
OSA_FOCUS
):

794 
rows
 = 
£lf
.
	`make_focus_row_’Œ›s
(
¥_db
)

796 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_FOCUS
):

797 
rows
 = 
£lf
.
	`make_focus_row_’Œ›s
(
¥_db
)

799 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE
):

800 
rows
 = 
£lf
.
	`make_sšgË_ev_row_’Œ›s
(
¥_db
)

802 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE_STACK
):

803 
rows
 = 
£lf
.
	`make_muÉi_ev_row_’Œ›s
(
¥_db
, 
¡ack_dœ
=
True
)

805 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
ZP_IMAGE_SCAN
):

806 
rows
 = 
£lf
.
	`make_muÉi_ev_row_’Œ›s
(
¥_db
)

808 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_POINT_SPECTRUM
):

809 
rows
 = 
£lf
.
	`make_pošt_sÿn_row_’Œ›s
(
¥_db
)

811 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
):

812 
rows
 = 
£lf
.
	`make_sšgË_ev_row_’Œ›s
(
¥_db
)

813 #»tuº 
NÚe
, 
sÿn_ty³


815 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
GENERIC_SCAN
):

816 
rows
 = 
£lf
.
	`make_sšgË_ev_row_’Œ›s
(
¥_db
)

818 
´št
 'make_sÿn_queue_li¡: sÿÀty³‚Ù suµÜ‹d y‘ [%d]' % 
sÿn_ty³


819  
NÚe
, 
sÿn_ty³


822 (
rows
, 
sÿn_ty³
)

824 
def
 
	$£t_d–eg©es_ev
(
£lf
):

826 
h—d”
 = ['Filename', 'ƒV', 'Pol', 'Range', '# Points', '', ' Progress']

830 
tm
 = 
£lf
.
bË_v›w
.
	`mod–
()

831 
row
 
š
 
	`¿nge
(0, 
tm
.
	$rowCouÁ
()):

832 
£lf
.
bË_v›w
.
	`İ’P”si¡’tEd™Ü
(
tm
.
	`šdex
(
row
, s–f.
´og_cŞ
))

833 
£lf
.
bË_v›w
.
	`İ’P”si¡’tEd™Ü
(
tm
.
	`šdex
(
row
, s–f.
pm­_cŞ
))

834 #£lf.
bË_v›w
.
	`£tRowHeight
(
row
, 15)

837 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(0, 
FILENAME_WIDTH
)

838 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(1, 
EV_WIDTH
)

839 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(2, 
POLARITY_WIDTH
)

840 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(3, 
CENTER_WIDTH
)

841 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(4, 
NPOINTS_WIDTH
)

842 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(£lf.
pm­_cŞ
, 
PMAP_WIDTH
)

843 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(£lf.
´og_cŞ
, 
PROGRESS_WIDTH
)

845 
def
 
	$£t_d–eg©es_muÉi_ev
(
£lf
):

847 
h—d”
 = ['Filename', 'ƒV', 'Pol', 'Range', '# Points', '', ' Progress']

851 
tm
 = 
£lf
.
bË_v›w
.
	`mod–
()

852 
row
 
š
 
	`¿nge
(0, 
tm
.
	$rowCouÁ
()):

853 
£lf
.
bË_v›w
.
	`İ’P”si¡’tEd™Ü
(
tm
.
	`šdex
(
row
, s–f.
´og_cŞ
))

854 
£lf
.
bË_v›w
.
	`İ’P”si¡’tEd™Ü
(
tm
.
	`šdex
(
row
, s–f.
pm­_cŞ
))

855 #£lf.
bË_v›w
.
	`£tRowHeight
(
row
, 15)

858 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(0, 
STACK_FILENAME_WIDTH
)

859 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(1, 
EV_WIDTH
)

860 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(2, 
POLARITY_WIDTH
)

861 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(3, 
CENTER_WIDTH
)

862 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(4, 
NPOINTS_WIDTH
)

863 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(£lf.
pm­_cŞ
, 
PMAP_WIDTH
)

864 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(£lf.
´og_cŞ
, 
PROGRESS_WIDTH
)

866 
def
 
	$£t_d–eg©es_pošt_¥ec
(
£lf
):

868 
h—d”
 = [' File', ' StartƒV', 'StopƒV', 'Pol', 'Center', '# Points', '', ' Progress']

872 
tm
 = 
£lf
.
bË_v›w
.
	`mod–
()

873 
row
 
š
 
	`¿nge
(0, 
tm
.
	$rowCouÁ
()):

874 
£lf
.
bË_v›w
.
	`İ’P”si¡’tEd™Ü
(
tm
.
	`šdex
(
row
, s–f.
´og_cŞ
))

875 
£lf
.
bË_v›w
.
	`İ’P”si¡’tEd™Ü
(
tm
.
	`šdex
(
row
, s–f.
pm­_cŞ
))

876 #£lf.
bË_v›w
.
	`£tRowHeight
(
row
, 15)

879 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(0, 
FILENAME_WIDTH
)

880 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(1, 
EV_WIDTH
)

881 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(2, 
EV_WIDTH
)

882 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(3, 
POLARITY_WIDTH
)

883 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(4, 
CENTER_WIDTH
)

884 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(5, 
NPOINTS_WIDTH
)

885 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(£lf.
pm­_cŞ
, 
PMAP_WIDTH
)

886 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(£lf.
´og_cŞ
, 
PROGRESS_WIDTH
)

888 
def
 
	$£t_d–eg©es_focus
(
£lf
):

891 
h—d”
 = ['Filename', ' Z Start', 'Z Stop', 'Z Step', 'Z #pts', '', ' Progress']

893 
tm
 = 
£lf
.
bË_v›w
.
	`mod–
()

894 
row
 
š
 
	`¿nge
(0, 
tm
.
	$rowCouÁ
()):

895 #£lf.
bË_v›w
.
	`£tRowHeight
(
row
, 15)

896 
£lf
.
bË_v›w
.
	`İ’P”si¡’tEd™Ü
(
tm
.
	`šdex
(
row
, s–f.
´og_cŞ
))

897 
£lf
.
bË_v›w
.
	`İ’P”si¡’tEd™Ü
(
tm
.
	`šdex
(
row
, s–f.
pm­_cŞ
))

900 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(0, 
FILENAME_WIDTH
)

901 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(1, 
START_WIDTH
)

902 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(2, 
START_WIDTH
)

903 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(3, 
START_WIDTH
)

904 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(4, 
NPOINTS_WIDTH
)

905 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(£lf.
pm­_cŞ
, 
PMAP_WIDTH
)

906 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(£lf.
´og_cŞ
, 
PROGRESS_WIDTH
)

908 
def
 
	`make_focus_row_’Œ›s
(
£lf
, 
¥_db
, 
§m¶e_pos
=1):

910 
Take
 
ª
 
	$focus
 (
OSA
 
Ü
 
§m¶e
è
¥_db
 
ªd
 
ü—‹
 
a
 
row
 
’Œy
 ¨
d‘eùÜ
 
sÿn


911 
The
 
»suÉs
 
should
 
be
 
a
 
sšgË
 
row
 
’Œy
:

914 
h—d”
 = [' File', ' Zpz Start', 'Zpz Stop', 'Zpz Step', 'Zpz #Points', '', ' Progress']

915 
£lf
.
bË_v›w
.
	`£t_h—d”
(
h—d”
)

916 
£lf
.
bË_v›w
.
	`upd©e
()

918 
l¡
 = []

919 
x_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_X
)

920 
y_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_Y
)

921 
z_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_Z
)

922 
e_rois
 = 
	`dù_g‘
(
¥_db
, 
SPDB_EV_ROIS
)

923 
e_roi
 = 
e_rois
[0]

924 
numX
 = (
x_roi
['NPOINTS'])

925 
numY
 = (
y_roi
['NPOINTS'])

926 
numZ
 = (
z_roi
['NPOINTS'])

927 
numE²ts
 = (
	`dù_g‘
(
¥_db
, 
SPDB_EV_NPOINTS
))

929 
row_num
 = 0

931 
´fx
 = 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_DATAFILE_PFX
)

932 
âame
 = 
£lf
.
	`make_âame
(
´fx
, 
row_num
, 
§m¶e_pos
)

934 
l¡
.
	`­³nd
(
âame
)

935 
l¡
.
	`­³nd
('%.2f' % 
z_roi
['START'])

936 
l¡
.
	`­³nd
('%.2f' % 
z_roi
['STOP'])

937 
l¡
.
	`­³nd
('%.2àum' % (
z_roi
['STEP']))

938 
l¡
.
	`­³nd
('%d' % (
z_roi
['NPOINTS']))

939 
l¡
.
	`­³nd
(0)

940 
l¡
.
	`­³nd
(
row_num
)

941 ([
l¡
])

943 
def
 
	`make_sšgË_ev_row_’Œ›s
(
£lf
, 
¥_db
, 
§m¶e_pos
=1):

945 
Take
 
ª
 
sšgË
 
ev
 
	$¥_db
 (
d‘eùÜ
, 
o§
è
ªd
 
ü—‹
 
a
 
row
 
’Œy
 ¨d‘eùÜ 
sÿn


946 
The
 
»suÉs
 
should
 
be
 
a
 
sšgË
 
row
 
’Œy
:

949 
h—d”
 = [' File', 'ƒV', 'Pol', 'Range', '# Points', '', ' Progress']

950 
£lf
.
bË_v›w
.
	`£t_h—d”
(
h—d”
)

951 
£lf
.
	`£t_´og»ss_cŞumn
(6)

952 
£lf
.
	`£t_pixm­_cŞumn
(5)

953 
£lf
.
bË_v›w
.
	`upd©e
()

955 
l¡
 = []

956 
x_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_X
)

957 
y_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_Y
)

958 
z_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_Z
)

959 
e_rois
 = 
	`dù_g‘
(
¥_db
, 
SPDB_EV_ROIS
)

960 
e_roi
 = 
e_rois
[0]

961 
numX
 = (
x_roi
['NPOINTS'])

962 
numY
 = (
y_roi
['NPOINTS'])

963 
numZ
 = (
z_roi
['NPOINTS'])

964 
numE²ts
 = (
	`dù_g‘
(
¥_db
, 
SPDB_EV_NPOINTS
))

966 
row_num
 = 0

968 
´fx
 = 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_DATAFILE_PFX
)

969 
ado_obj
 = 
	`dù_g‘
(
¥_db
, 
SPDB_ACTIVE_DATA_OBJECT
)

970 
âame
 = 
	`dù_g‘
(
ado_obj
, 
ADO_CFG_DATA_FILE_NAME
)

972 #âamğ
£lf
.
	`make_âame
(
´fx
, 
row_num
, 
§m¶e_pos
)

974 
l¡
.
	`­³nd
(
âame
)

975 
l¡
.
	`­³nd
('%.2f' % 
e_roi
['START'])

976 
•u_¡r
 = 
	`cÚv”t_w¿µ”_•u_to_¡r
(
e_roi
['EPU_POL_PNTS'][0])

977 
l¡
.
	`­³nd
('%s' % 
•u_¡r
)

978 
l¡
.
	`­³nd
('%.2àx %.2àum' % (
x_roi
['RANGE'], 
y_roi
['RANGE']))

979 
l¡
.
	`­³nd
('%dx%d ' % (
x_roi
['NPOINTS'], 
y_roi
['NPOINTS']))

980 
l¡
.
	`­³nd
(0)

981 
l¡
.
	`­³nd
(
row_num
)

982 ([
l¡
])

984 
def
 
	`make_pošt_sÿn_row_’Œ›s
(
£lf
, 
¥_db
, 
§m¶e_pos
=1):

986 
Take
 
ª
 
sšgË
 
ev
 
	$¥_db
 (
d‘eùÜ
, 
o§
è
ªd
 
ü—‹
 
a
 
row
 
’Œy
 ¨d‘eùÜ 
sÿn


987 
The
 
»suÉs
 
should
 
be
 
a
 
sšgË
 
row
 
’Œy
:

990 
h—d”
 = [' File', ' StartƒV', 'StopƒV', 'Pol', 'Center', '# Points', '', ' Progress']

992 
£lf
.
bË_v›w
.
	`£t_h—d”
(
h—d”
)

993 
£lf
.
	`£t_´og»ss_cŞumn
(7)

994 
£lf
.
	`£t_pixm­_cŞumn
(6)

995 
£lf
.
bË_v›w
.
	`upd©e
()

997 
x_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_X
)

998 
y_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_Y
)

999 
z_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_Z
)

1000 
e_rois
 = 
	`dù_g‘
(
¥_db
, 
SPDB_EV_ROIS
)

1002 
numX
 = (
x_roi
['NPOINTS'])

1003 
numY
 = (
y_roi
['NPOINTS'])

1004 
numZ
 = (
z_roi
['NPOINTS'])

1005 
numE²ts
 = (
	`dù_g‘
(
¥_db
, 
SPDB_EV_NPOINTS
))

1007 
row_num
 = 0

1009 
´fx
 = 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_DATAFILE_PFX
)

1010 
ado_obj
 = 
	`dù_g‘
(
¥_db
, 
SPDB_ACTIVE_DATA_OBJECT
)

1011 
âame
 = 
	`dù_g‘
(
ado_obj
, 
ADO_CFG_DATA_FILE_NAME
)

1013 if(
	`Ën
(
e_rois
) == 0):

1014 
_logg”
.
	`”rÜ
('something wrong withehƒ_roi here')

1017 
e¡¬t
 = 
e_rois
[0]['START']

1018 
e¡İ
 = 
e_rois
[-1]['STOP']

1019 
pŞ
 = 
e_rois
[0]['EPU_POL_PNTS'][0]

1021 
l¡
 = []

1022 
l¡
.
	`­³nd
(
âame
)

1023 
l¡
.
	`­³nd
('%.2f' % 
e¡¬t
)

1024 
l¡
.
	`­³nd
('%.2f' % 
e¡İ
)

1025 
•u_¡r
 = 
	`cÚv”t_w¿µ”_•u_to_¡r
(
pŞ
)

1026 
l¡
.
	`­³nd
('%s' % 
•u_¡r
)

1027 
l¡
.
	`­³nd
('%.2àx %.2àum' % (
x_roi
['CENTER'], 
y_roi
['CENTER']))

1028 
l¡
.
	`­³nd
('%d ' % (
numE²ts
))

1029 
l¡
.
	`­³nd
(0)

1030 
l¡
.
	`­³nd
(
row_num
)

1032 ([ 
l¡
 ])

1034 
def
 
	`make_muÉi_ev_row_’Œ›s
(
£lf
, 
¥_db
, 
§m¶e_pos
=1, 
is_pošt
=
F®£
, 
¡ack_dœ
=False):

1036 
Take
 
ª
 
sšgË
 
ev
 
	$¥_db
 (
d‘eùÜ
, 
o§
è
ªd
 
ü—‹
 
a
 
row
 
’Œy
 ¨d‘eùÜ 
sÿn


1037 
The
 
»suÉs
 
should
 
be
 
a
 
sšgË
 
row
 
’Œy
:

1040 if(
is_pošt
):

1041 
h—d”
 = [' File', 'ƒV', 'Pol', 'Center', '# Points', '', ' Progress']

1043 
h—d”
 = [' File', 'ƒV', 'Pol', 'Range', '# Points', '', ' Progress']

1045 
£lf
.
bË_v›w
.
	`£t_h—d”
(
h—d”
)

1046 
£lf
.
bË_v›w
.
	`upd©e
()

1048 
maš_l¡
 = []

1049 #sÿn_ty³ = 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
)

1050 
x_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_X
)

1051 
y_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_Y
)

1052 
z_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_Z
)

1053 
e_rois
 = 
	`dù_g‘
(
¥_db
, 
SPDB_EV_ROIS
)

1055 
numX
 = (
x_roi
['NPOINTS'])

1056 
numY
 = (
y_roi
['NPOINTS'])

1057 
numZ
 = (
z_roi
['NPOINTS'])

1058 
numE²ts
 = (
	`dù_g‘
(
¥_db
, 
SPDB_EV_NPOINTS
))

1060 
row_num
 = 0

1062 
´fx
 = 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_DATAFILE_PFX
)

1063 
ado_obj
 = 
	`dù_g‘
(
¥_db
, 
SPDB_ACTIVE_DATA_OBJECT
)

1064 
d©afe_Çme
 = 
	`dù_g‘
(
ado_obj
, 
ADO_CFG_DATA_FILE_NAME
)

1066 
idx
 = 0

1067 
e_roi
 
š
 
e_rois
:

1068 
e
 
š
 
e_roi
['SETPOINTS']:

1069 
pŞ
 
š
 
e_roi
['EPU_POL_PNTS']:

1070 
l¡
 = []

1071 if((
d©afe_Çme
 
is
 
NÚe
è
	$Ü
 (
¡ack_dœ
)):

1072 
âame
 = 
£lf
.
	`make_image_âame
(
´fx
, 
idx
, 
§m¶e_pos
)

1074 #âamğ
d©afe_Çme


1075 if(
	`Ën
(
£lf
.
âame_li¡
) > 0):

1076 
âame
 = 
£lf
.
âame_li¡
[0]

1078 
âame
 = 'C000000.hdf5'

1079 
l¡
.
	`­³nd
(
âame
)

1080 
l¡
.
	`­³nd
('%.2f' % 
e
)

1081 
•u_¡r
 = 
	`cÚv”t_w¿µ”_•u_to_¡r
(
pŞ
)

1082 
l¡
.
	`­³nd
('%s' % 
•u_¡r
)

1083 if(
is_pošt
):

1084 
l¡
.
	`­³nd
('%.2àx %.2àum' % (
x_roi
['CENTER'], 
y_roi
['CENTER']))

1086 
l¡
.
	`­³nd
('%.2àx %.2àum' % (
x_roi
['RANGE'], 
y_roi
['RANGE']))

1088 
l¡
.
	`­³nd
('%dx%d ' % (
x_roi
['NPOINTS'], 
y_roi
['NPOINTS']))

1089 
l¡
.
	`­³nd
(0)

1090 
l¡
.
	`­³nd
(
row_num
)

1091 
maš_l¡
.
	`­³nd
(
l¡
)

1092 
idx
 += 1

1093 (
maš_l¡
)

1096 
def
 
	`make_lše_¥ec_muÉi_ev_row_’Œ›s
(
£lf
, 
¥_db
, 
§m¶e_pos
=1):

1098 
Take
 
ª
 
sšgË
 
ev
 
	$¥_db
 (
d‘eùÜ
, 
o§
è
ªd
 
ü—‹
 
a
 
row
 
’Œy
 ¨d‘eùÜ 
sÿn


1099 
The
 
»suÉs
 
should
 
be
 
a
 
sšgË
 
row
 
’Œy
:

1102 
maš_l¡
 = []

1103 #sÿn_ty³ = 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
)

1104 
x_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_X
)

1105 
y_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_Y
)

1106 
z_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_Z
)

1107 
e_rois
 = 
	`dù_g‘
(
¥_db
, 
SPDB_EV_ROIS
)

1109 
numX
 = (
x_roi
['NPOINTS'])

1110 
numY
 = (
y_roi
['NPOINTS'])

1111 
numZ
 = (
z_roi
['NPOINTS'])

1112 
numE²ts
 = (
	`dù_g‘
(
¥_db
, 
SPDB_EV_NPOINTS
))

1114 
row_num
 = 0

1116 
´fx
 = 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_DATAFILE_PFX
)

1118 
idx
 = 0

1119 
e_roi
 
š
 
e_rois
:

1120 #fÜ 
e
 
š
 
e_roi
['SETPOINTS']:

1121 
pŞ
 
š
 
e_roi
['EPU_POL_PNTS']:

1122 
e
 = 
e_roi
['SETPOINTS'][0]

1123 
âame
 = 
£lf
.
	`make_image_âame
(
´fx
, 
idx
, 
§m¶e_pos
)

1124 
l¡
 = []

1125 
l¡
.
	`­³nd
(
âame
)

1126 
l¡
.
	`­³nd
('%.2f' % 
e
)

1127 
•u_¡r
 = 
	`cÚv”t_w¿µ”_•u_to_¡r
(
pŞ
)

1128 
l¡
.
	`­³nd
('%s' % 
•u_¡r
)

1129 
l¡
.
	`­³nd
('%.2àx %.2àum' % (
x_roi
['RANGE'], 
y_roi
['RANGE']))

1130 
l¡
.
	`­³nd
('%dx%d ' % (
x_roi
['NPOINTS'], 
y_roi
['NPOINTS']))

1131 
l¡
.
	`­³nd
(0)

1132 
l¡
.
	`­³nd
(
row_num
)

1134 
maš_l¡
.
	`­³nd
(
l¡
)

1135 
idx
 += 1

1136 (
maš_l¡
)

1138 
def
 
	`make_âame
(
£lf
, 
´fx
, 
row_num
, 
§m¶e_pos
=1):

1139 
âame
 = '%s%d-%05d%s' % (
´fx
, 
§m¶e_pos
, 
row_num
, 
£lf
.
fe_suffix
)

1140 if(
row_num
 < 
	$Ën
(
£lf
.
âame_li¡
)):

1141 
âame
 = 
£lf
.
âame_li¡
[
row_num
]

1142 #âamğ'%s' % (
´fx
, 
row_num
, 
£lf
.
fe_suffix
)

1143 (
âame
)

1145 
def
 
	`make_image_âame
(
£lf
, 
´fx
, 
row_num
, 
§m¶e_pos
=1):

1146 
âame
 = '%s%d-%05d% img/%d' % (
´fx
, 
§m¶e_pos
, 0, 
£lf
.
fe_suffix
, 
row_num
)

1147 if(
row_num
 < 
	$Ën
(
£lf
.
âame_li¡
)):

1148 #â = 
£lf
.
âame_li¡
[
row_num
]

1149 
âame
 = 
£lf
.
âame_li¡
[
row_num
]

1150 #âamğ'% img/%d' % (
â
, 
row_num
)

1151 (
âame
)

1155 
__Çme__
=="__main__":

1157 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
([])

1159 
wš
 = 
	`SÿnQueueTabËWidg‘
(
loÿl_‹¡
=
True
)

1160 
qssh“t
 = 
	`g‘_¡yË
('dark')

1161 
wš
.
	`£tStyËSh“t
(
qssh“t
)

1162 
wš
.
	`show
()

1163 #wš.
	`İ’fe
()

1164 
­p
.
	`exec_
()

	@widgets/scan_queue_table.py

2 
C»©ed
 
Ú
 
	gFeb
 9, 2016

4 @
	gauthÜ
: 
b”gr


6 
äom
 
şs
.
­¶iÿtiÚs
.
pyStxm
.
widg‘s
.
´og_diù_uts
 
impÜt
 
make_´og»ss_diù


8 
C»©ed
 
Ú
 
Nov
 2, 2015

10 @
	gauthÜ
: 
b”gr


12 
impÜt
 
İ”©Ü


13 
impÜt
 
os


14 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
	gQtWidg‘s


16 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
´og_diù_uts
 
impÜt
 
	gmake_´og»ss_diù
, 
	gPROG_DCT_ID
, 
	gPROG_DCT_SPID
, 
	gPROG_DCT_PERCENT
, 
	gPROG_DCT_STATE


18 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	gd©a
.
bioxas_im_d©a_io
 
impÜt
 
	gBioxasD©aIo


19 
äom
 
	gşs
.
	g­p_d©a
.
deçuÉs
 
impÜt
 
	grgb_as_hex
, 
	gma¡”_cŞÜs
, 
	gma¡”_q_cŞÜs
, 
	gg‘_¡yË


20 
äom
 
	gşs
.
	guts
.
roi_uts
 
impÜt
 
	gg‘_ba£_roi
, 
	gg‘_ba£_’”gy_roi
, 
	gg‘_unique_roi_id
, \

21 
	gg‘_•u_pŞ_dù
, 
	gmake_¥©Ÿl_db_diù
, 
	gwidg‘_com_cmnd_ty³s
, \

22 
	gÚ_¿nge_chªged
, 
	gÚ_Åošts_chªged
, 
	gÚ_¡•_size_chªged
, 
	gÚ_¡¬t_chªged
, 
	gÚ_¡İ_chªged
, \

23 
	gÚ_ûÁ”_chªged
, 
	g»ÿlc_£ošts
, 
	gsÿn_image_ty³s
, 
	gsÿn_ty³s
, 
	gg‘_¥_ids_äom_wdg_com
, 
	gg‘_¥_db_äom_wdg_com


25 
äom
 
	gşs
.
	gsÿÂšg
.
ty³s
 
impÜt
 
	gsÿn_¡©us_ty³s


26 
äom
 
	gşs
.
	guts
.
roi_diù_defs
 
	gimpÜt
 *

28 
äom
 
	gşs
.
	guts
.
diù_uts
 
impÜt
 
	gdù_g‘
, 
	gdù_put


29 
äom
 
	gşs
.
	guts
.
feUts
 
impÜt
 
	gg‘_fe_·th_as_·¹s


30 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”


33 
äom
 
	gbcm
.
	gdeviû
.
•u
 
impÜt
 
	gcÚv”t_w¿µ”_•u_to_¡r


35 #£tu°
moduË
 
logg”
 
w™h
 
a
  do-
nÙhšg
 
hªdËr


36 
	g_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

38 
HDR_FONT_SIZE
 = 8.0

39 
TABLE_FONT_SIZE
 = 8.0

42 
DEFAULT_PIXMAP_COLUMN
 = 5

43 
DEFAULT_PROGESS_BAR_COLUMN
 = 6

45 #bË 
cŞumn
 
width
 
defš™iÚs


46 
FILENAME_WIDTH
 = 120

47 
STACK_FILENAME_WIDTH
 = 170

48 
EV_WIDTH
 = 60

49 
START_WIDTH
 = 100

50 
POLARITY_WIDTH
 = 100

51 
CENTER_WIDTH
 = 150

52 
NPOINTS_WIDTH
 = 100

53 
PMAP_WIDTH
 = 16

54 
PROGRESS_WIDTH
 = 150

56 
şass
 
	$Ba£Mod–
(
QtCÜe
.
QObjeù
):

57 
chªged
 = 
QtCÜe
.
	`pyqtSigÇl
()

59 
def
 
	$__š™__
(
£lf
):

60 
QtCÜe
.
QAb¡¿ùTabËMod–
.
	`__š™__
(
£lf
)

61 
£lf
.
mod–_d©a
 = []

63 
def
 
	$g‘_mod–_d©a
(
£lf
):

64 (
£lf
.
mod–_d©a
)

66 
def
 
	$£t_d©a
(
£lf
, 
row
, 
cŞ
, 
v®
):

68 
U£rs
 
mu¡
 
u£
 
this
 
£t_d©a
 
funùiÚ
 
they
 
wªt
 
to
 
£e
 
the
 
chªges
 
beÿu£
he changes

69 
¬e
 
d•’dªt
 
Ú
 
the
 
chªged
 
sigÇl
 
bešg
 
em™‹d


71 
Œy
:

72 if(
	`Ën
(
£lf
.
mod–_d©a
) > 0):

73 
£lf
.
mod–_d©a
[
row
][
cŞ
] = 
v®


74 
£lf
.
chªged
.
	`em™
()

75 
exû±
 
IndexE¼Ü
:

77 
·ss


80 
şass
 
	$SÿnQueueMod–
(
Ba£Mod–
):

81 
def
 
	$__š™__
(
£lf
):

82 
Ba£Mod–
.
	`__š™__
(
£lf
)

84 
sÿn_q_mod–_şass
 = 
	`SÿnQueueMod–
()

86 
şass
 
	$SÿnQTabËMod–
(
QtCÜe
.
QAb¡¿ùTabËMod–
):

87 
def
 
	$__š™__
(
£lf
, 
·»Á
, 
mod–_d
, 
h—d”
, *
¬gs
):

88 #glob® 
mod–_d©a


89 
QtCÜe
.
QAb¡¿ùTabËMod–
.
	`__š™__
(
£lf
, 
·»Á
, *
¬gs
)

90 
£lf
.
h—d”
 = header

91 
£lf
.
sÿn_q_mod–_şass
 = scan_q_model_class

92 
£lf
.
mod–_d©a
 = 
sÿn_q_mod–_şass
.
	`g‘_mod–_d©a
()

93 
£lf
.
pm­_cŞ
 = 
DEFAULT_PIXMAP_COLUMN


94 
£lf
.
´og_cŞ
 = 
DEFAULT_PROGESS_BAR_COLUMN


96 #cÚÃù 
to
 
the
 
chªged
 
sigÇl
 
so
 
th©
 
chªges
Øth
mod–
 
äom
 
ªywh”e
 
wl
 
be
 
sigÇËd
 
back
 
h”e


97 
£lf
.
sÿn_q_mod–_şass
.
chªged
.
	`cÚÃù
(£lf.
_em™_chªged
)

99 
def
 
	$_em™_chªged
(
£lf
):

100 
£lf
.
d©aChªged
.
	`em™
(
QtCÜe
.
	`QMod–Index
(), QtCore.QModelIndex())

102 
def
 
	$£t_pm­_cŞ
(
£lf
, 
cŞ
):

103 
£lf
.
pm­_cŞ
 = 
cŞ


105 
def
 
	$£t_´og_cŞ
(
£lf
, 
cŞ
):

106 
£lf
.
´og_cŞ
 = 
cŞ


108 
def
 
	$£t_h—d”
(
£lf
, 
hdr_li¡
):

109 
£lf
.
h—d”
 = 
hdr_li¡


111 
def
 
	$£t_mod–
(
£lf
, 
mod–
):

112 
£lf
.
mod–_d©a
 = s–f.
sÿn_q_mod–_şass
.
	`g‘_mod–_d©a
()

113 
r
 
š
 
mod–
:

114 
£lf
.
	`š£¹Row
(
r
)

116 
def
 
	`š£¹Row
(
£lf
, 
™em
, 
·»Á
=
QtCÜe
.
	$QMod–Index
()):

118 
	$š£¹Row
(): 
desütiÚ


120 :
·¿m
 
sÿn
: sÿÀ
desütiÚ


121 :
ty³
 
sÿn
: scanype

123 :
·¿m
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
desütiÚ


124 :
ty³
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
ty³


126 :
»tuºs
: 
NÚe


128 
£lf
.
mod–_d©a
 = s–f.
sÿn_q_mod–_şass
.
	`g‘_mod–_d©a
()

129 
£lf
.
	`begšIn£¹Rows
(
·»Á
, s–f.
	`rowCouÁ
(parent), self.rowCount(parent))

130 
£lf
.
mod–_d©a
.
	`­³nd
(
™em
)

131 
£lf
.
	`’dIn£¹Rows
()

132 
£lf
.
d©aChªged
.
	`em™
(
·»Á
,…arent)

133 (
£lf
.
	`rowCouÁ
(
·»Á
))

135 
def
 
	`»moveAÎ
(
£lf
, 
·»Á
=
QtCÜe
.
	$QMod–Index
()):

136 
£lf
.
mod–_d©a
 = s–f.
sÿn_q_mod–_şass
.
	`g‘_mod–_d©a
()

137 
£lf
.
	`rowCouÁ
() > 0:

138 
£lf
.
	`begšRemoveRows
(
·»Á
, 0, 
	`Ën
(£lf.
mod–_d©a
))

139 
i
 
š
 
	`¿nge
(0, 
£lf
.
	$rowCouÁ
()) :

140 
	`d–
(
£lf
.
mod–_d©a
[0])

141 
£lf
.
	`»moveRows
(0, s–f.
	`rowCouÁ
())

142 
£lf
.
	`’dRemoveRows
()

143 
£lf
.
d©aChªged
.
	`em™
(
·»Á
,…arent)

144 
£lf
.
mod–_d©a
 = s–f.
sÿn_q_mod–_şass
.
	`g‘_mod–_d©a
()

146 
def
 
	`rowCouÁ
(
£lf
, 
·»Á
=
QtCÜe
.
	$QMod–Index
()):

147  
	`Ën
(
£lf
.
mod–_d©a
)

149 
def
 
	`cŞumnCouÁ
(
£lf
, 
·»Á
=
QtCÜe
.
	$QMod–Index
()):

150 (
	`Ën
(
£lf
.
h—d”
))

152 
def
 
	$d©a
(
£lf
, 
šdex
, 
rŞe
=
QtCÜe
.
Qt
.
Di¥ÏyRŞe
):

153 
nÙ
 
šdex
.
	$isV®id
():

154  
NÚe


156 
row
 = 
šdex
.
	`row
()

157 
cŞ
 = 
šdex
.
	`cŞumn
()

158 
¡s
 = 
£lf
.
mod–_d©a
[
row
][£lf.
pm­_cŞ
]

160 if(
row
 > 
£lf
.
	$rowCouÁ
()):

161 (
NÚe
)

163 if((
cŞ
 =ğ0è
	$ªd
 (
rŞe
 =ğ
QtCÜe
.
Qt
.
TextAlignm’tRŞe
)):

164  
QtCÜe
.
Qt
.
AlignLeá


166 
	`–if
((
cŞ
 > 0è
	$ªd
 (
rŞe
 =ğ
QtCÜe
.
Qt
.
TextAlignm’tRŞe
)):

167  
QtCÜe
.
Qt
.
AlignC’‹r


170 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
BackgroundRŞe
:

172 if(
¡s
 =ğ
sÿn_¡©us_ty³s
.
STOPPED
):

173 
bg
 = 
ma¡”_q_cŞÜs
['app_medgray']

174 
	$–if
(
¡s
 =ğ
sÿn_¡©us_ty³s
.
PAUSED
):

175 
bg
 = 
ma¡”_q_cŞÜs
['app_yellow']

176 
	$–if
(
¡s
 =ğ
sÿn_¡©us_ty³s
.
RUNNING
):

177 
bg
 = 
ma¡”_q_cŞÜs
['scan_sts_blue']

178 
	$–if
(
¡s
 =ğ
sÿn_¡©us_ty³s
.
ABORTED
):

179 
bg
 = 
ma¡”_q_cŞÜs
['app_red']

181 
bg
 = 
ma¡”_q_cŞÜs
['app_drkgray']

183  
bg


185 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
FÜegroundRŞe
:

186 if(
¡s
 =ğ
sÿn_¡©us_ty³s
.
STOPPED
):

187 
fg
 = 
ma¡”_q_cŞÜs
['app_superltgray']

188 
	$–if
(
¡s
 =ğ
sÿn_¡©us_ty³s
.
PAUSED
):

189 
fg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
bÏck
)

190 
	$–if
(
¡s
 =ğ
sÿn_¡©us_ty³s
.
RUNNING
):

191 
fg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
wh™e
)

192 
	$–if
(
¡s
 =ğ
sÿn_¡©us_ty³s
.
ABORTED
):

193 
fg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
wh™e
)

194 
	$–if
(
¡s
 =ğ
sÿn_¡©us_ty³s
.
DONE
):

195 
fg
 = 
ma¡”_q_cŞÜs
['app_blue']

197 
_logg”
.
	`”rÜ
('unknowÀsÿÀ¡©us[%d]' % 
¡s
)

198 
fg
 = 
NÚe


199  
fg


201 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
Di¥ÏyRŞe
:

203  
£lf
.
mod–_d©a
[
row
][
cŞ
]

205  
NÚe


208 
def
 
	$h—d”D©a
(
£lf
, 
cŞ
, 
Ü›Á©iÚ
, 
rŞe
=
QtCÜe
.
Qt
.
Di¥ÏyRŞe
):

209 
Ü›Á©iÚ
 =ğ
QtCÜe
.
Qt
.
HÜizÚl
 
ªd
 
rŞe
 =ğQtCÜe.Qt.
Di¥ÏyRŞe
:

210  
£lf
.
h—d”
[
cŞ
]

211  
NÚe


213 
def
 
	$£tD©a
(
£lf
, 
šdex
, 
v®ue
, 
rŞe
=
QtCÜe
.
Qt
.
Di¥ÏyRŞe
):

214 
row
 = 
šdex
.
	`row
()

215 
cŞ
 = 
šdex
.
	`cŞumn
()

216 if((
cŞ
 =ğ
£lf
.
´og_cŞ
è
	`ªd
 (£lf.
mod–_d©a
[
row
][self.prog_col] == 100.0)):

217 
´št
 ''

219 
£lf
.
mod–_d©a
[
row
][
cŞ
] = 
v®ue


220  
True


222 
def
 
	$modify_d©a
(
£lf
, 
row
, 
cŞ
, 
v®ue
):

223 
£lf
.
mod–_d©a
[
row
][
cŞ
] = 
v®ue


224 
£lf
.
d©aChªged
.
	`em™
(
QtCÜe
.
	`QMod–Index
(), QtCore.QModelIndex())

226 
def
 
	$æags
(
£lf
, 
šdex
):

227  
QtCÜe
.
Qt
.
I‹mIsEÇbËd
 | QtCÜe.Qt.
I‹mIsS–eùabË


229 
şass
 
	$SÿnQTabËV›w
(
QtWidg‘s
.
QTabËV›w
):

231 
A
 
sim¶e
 
bË


233 
def
 
	$__š™__
(
£lf
, 
h—d”
, **
kw¬gs
):

234 
QtWidg‘s
.
QTabËV›w
.
	`__š™__
(
£lf
)

235 
£lf
.
	`£tObjeùName
('scan_q_tblview')

237 if('´og_cŞ' 
š
 
kw¬gs
.
	$keys
()):

238 
£lf
.
´og_cŞ
 = 
kw¬gs
['prog_col']

240 
£lf
.
´og_cŞ
 = 
DEFAULT_PROGESS_BAR_COLUMN


242 if('pm­_cŞ' 
š
 
kw¬gs
.
	$keys
()):

243 
£lf
.
pm­_cŞ
 = 
kw¬gs
['pmap_col']

245 
£lf
.
pm­_cŞ
 = 
DEFAULT_PIXMAP_COLUMN


247 
£lf
.
hdr_li¡
 = 
h—d”


248 
£lf
.
	`£tS–eùiÚBehaviÜ
(
QtWidg‘s
.
QAb¡¿ùI‹mV›w
.
S–eùRows
)

249 
£lf
.
	`v”tiÿlH—d”
().
	`£tDeçuÉSeùiÚSize
(15)

251 #tuº 
bŞd
 
off


252 
fÚt
 = 
£lf
.
	`hÜizÚlH—d”
().
	`fÚt
()

253 
fÚt
.
	`£tBŞd
(
F®£
)

254 
fÚt
.
	`£tPoštSize
(
HDR_FONT_SIZE
)

255 
£lf
.
	`hÜizÚlH—d”
().
	`£tFÚt
(
fÚt
)

257 
£lf
.
	`š™_d–eg©es
()

258 #£lf.
	`£tAÉ”ÇtšgRowCŞÜs
(
True
)

259 #£lf.
	`£tCÚ‹ÁsM¬gšs
(1, 10, 10, 1)

261 
def
 
	$£t_pm­_cŞ
(
£lf
, 
cŞ
):

262 
£lf
.
pm­_cŞ
 = 
cŞ


264 
def
 
	$£t_´og_cŞ
(
£lf
, 
cŞ
):

265 
£lf
.
´og_cŞ
 = 
cŞ


267 
def
 
	$£t_´og»ss
(
£lf
, 
row
, 
´og
):

268 
£lf
.
	`mod–
().
	`modify_d©a
(
row
, s–f.
´og_cŞ
, 
´og
)

270 
def
 
	$£t_pixm­
(
£lf
, 
row
, 
pm­
):

271 
£lf
.
	`mod–
().
	`modify_d©a
(
row
, s–f.
pm­_cŞ
, 
pm­
)

273 
def
 
	$š™_d–eg©es
(
£lf
):

274 
num_cŞs
 = 
	`Ën
(
£lf
.
hdr_li¡
)

275 #®way 
the
 
Ï¡
 2

276 
£lf
.
	`£tI‹mD–eg©eFÜCŞumn
(
num_cŞs
 -1, 
	`Prog»ssB¬D–eg©e
(self))

277 
£lf
.
	`£tI‹mD–eg©eFÜCŞumn
(
num_cŞs
 -2 , 
	`Pixm­D–eg©e
(self))

280 
def
 
	$£t_h—d”
(
£lf
, 
hdr_li¡
):

281 
£lf
.
	`mod–
().
	`£t_h—d”
(
hdr_li¡
)

282 
£lf
.
hdr_li¡
 = hdr_list

283 
£lf
.
	`š™_d–eg©es
()

285 
def
 
	$»move_mod–
(
£lf
):

286 
£lf
.
	`mod–
().
	`»moveAÎ
()

288 
def
 
	$£t_mod–
(
£lf
, 
mod–
):

289 
£lf
.
	`mod–
().
	`£t_mod–
(
mod–
)

291 
def
 
	$£t_mod–_cŞumn_deçuÉs
(
£lf
):

293 
	$£t_mod–_cŞumn_deçuÉs
(): 
desütiÚ


295 :
»tuºs
: 
NÚe


297 
£lf
.
	`mod–
().
	`£t_cŞ_»adÚly
(0)

298 
i
 
š
 
	`¿nge
(1,
	$Ën
(
£lf
.
hdr_li¡
)):

299 
£lf
.
	`hÜizÚlH—d”
().
	`£tSeùiÚResizeMode
(
i
, 
QtWidg‘s
.
QH—d”V›w
.
SŒ‘ch
)

302 
şass
 
	$Prog»ssB¬D–eg©e
(
QtWidg‘s
.
QI‹mD–eg©e
):

304 
A
 
d–eg©e
 
th©
 
¶aûs
 
a
 
fuÎy
 
funùiÚšg
 
QProg»ssB¬
 
š
 
ev”y


305 
ûÎ
 
of
 
the
 
cŞumn
 
to
 
which
 
™
's‡pplied

307 
The
 
fÜm©tšg
 
of
 
the
 
sÿn_´og
 
´og»ss
 
b¬
 
is
 
dÚe
 
š
 
‹h
 
QProg»sb¬
 
¡yËsh“t


309 
def
 
	$__š™__
(
£lf
, 
·»Á
):

311 
QtWidg‘s
.
QI‹mD–eg©e
.
	`__š™__
(
£lf
, 
·»Á
)

312 
£lf
.
´og_¡©us
 = 
sÿn_¡©us_ty³s
.
STOPPED


314 
def
 
	$ü—‹Ed™Ü
(
£lf
, 
·»Á
, 
İtiÚ
, 
šdex
):

315 
pb¬
 = 
QtWidg‘s
.
	`QProg»ssB¬
(
·»Á
)

316 
pb¬
.
	`£tObjeùName
('scan_progbar')

317 
pb¬
.
	`£tMšimumWidth
(150)

318 
pb¬
.
	`£tMaximumHeight
(15)

319 
pb¬
.
	`£tRªge
(0,100)

320 #pb¬.
‹xtAlignm’t
 = 
Qt
.
AlignC’‹r


321 
pb¬
.
	`£tV®ue
(10)

322 #£lf.
	`cÚÃù
(
pb¬
, 
	`SIGNAL
("toggËd(boŞ)"), 
£lf
, 
	`SLOT
("on_toggled()"))

323  
pb¬


326 
def
 
	$£tEd™ÜD©a
(
£lf
, 
ed™Ü
, 
šdex
):

327 
ed™Ü
.
	`blockSigÇls
(
True
)

328 
d©a
 = 
šdex
.
	`mod–
().
	`d©a
(šdex, 
QtCÜe
.
Qt
.
Di¥ÏyRŞe
)

329 
ed™Ü
.
	`£tV®ue
(
d©a
)

331 if(
d©a
 == 0.0):

332 
ed™Ü
.
	`£tStyËSh“t
("*::chunk{ background-cŞÜ: % }" % 
ma¡”_cŞÜs
['app_drkgray'])

333 
ed™Ü
.
	`£tStyËSh“t
("*{ cŞÜ: % }" % 
ma¡”_cŞÜs
['white'])

334 
	`–if
(
d©a
 < 100.0):

335 
ed™Ü
.
	`£tStyËSh“t
("*::chunk{ background-cŞÜ: % }" % 
ma¡”_cŞÜs
['scan_sts_blue'])

336 
ed™Ü
.
	`£tStyËSh“t
("*{ cŞÜ: % }" % 
ma¡”_cŞÜs
['white'])

338 
	`–if
(
d©a
 >= 100.0):

339 
ed™Ü
.
	`£tStyËSh“t
("*{ cŞÜ: % } \À*::chunk{ background-cŞÜ: % }" % (
ma¡”_cŞÜs
['app_blue'], master_colors['app_drkgray']))

340 #ed™Ü.
	`£tStyËSh“t
("*{ cŞÜ: % }" % 
ma¡”_cŞÜs
['app_blue'])

342 
·ss


344 
ed™Ü
.
	`blockSigÇls
(
F®£
)

346 
def
 
	$£tMod–D©a
(
£lf
, 
ed™Ü
, 
mod–
, 
šdex
):

347 
d©a
 = 
šdex
.
	`mod–
().
	`d©a
(šdex, 
QtCÜe
.
Qt
.
Di¥ÏyRŞe
)

348 
mod–
.
	`£tD©a
(
šdex
, 
d©a
, 
QtCÜe
.
Qt
.
Ed™RŞe
)

350 @
QtCÜe
.
	`pyqtSlÙ
()

351 
def
 
	$Ú_toggËd
(
£lf
):

352 
£lf
.
comm™D©a
.
	`em™
(£lf.
	`£nd”
())

355 
def
 
	$g‘_pixm­
(
âame
):

356 
pm­
 = 
QtGui
.
	`QPixm­
(
âame
)

357 #pm­.
	`sÿËd
(64, 64)#, 
a¥eùR©ioMode
=
Qt_IgnÜeA¥eùR©io
, 
ŒªsfÜmMode
=
Qt_Fa¡T¿nsfÜm©iÚ
)

358 
pm­
 =…m­.
	`sÿËd
(
QtCÜe
.
	`QSize
(16,16), QtCÜe.
Qt
.
K“pA¥eùR©io
)

359 (
pm­
)

361 
şass
 
	$Pixm­D–eg©e
(
QtWidg‘s
.
QI‹mD–eg©e
):

363 
A
 
d–eg©e
 
th©
 
¶aûs
 
a
 
fuÎy
 
funùiÚšg
 
QProg»ssB¬
 
š
 
ev”y


364 
ûÎ
 
of
 
the
 
cŞumn
 
to
 
which
 
™
's‡pplied

366 
Ãed
 
ª
 
icÚ
 
—ch
 
¡©us


367 
sÿn_¡©us_ty³s
 = 
	`Enum
('STOPPED', 'PAUSED', 'RUNNING', 'ABORTED', 'DONE')

369 
def
 
	$__š™__
(
£lf
, 
·»Á
):

371 
QtWidg‘s
.
QI‹mD–eg©e
.
	`__š™__
(
£lf
, 
·»Á
)

373 
£lf
.
dœ
 = 
r
'C:\\controls\\py2.7\\Beamlines\\sm\\stxm_control\\icons\\png\\'

374 
£lf
.
psize
 = '\\64x64\\'

375 
£lf
.
·u£_şr
 = 'yellow'

376 
£lf
.
ruÂšg_şr
 = 'blue'

377 
£lf
.
¡İ³d_şr
 = 'gray'

378 
£lf
.
abÜ‹d_şr
 = 'red'

379 
£lf
.
dÚe_şr
 = 'blue'

381 
£lf
.
·u£d_pm­
 = 
	`g‘_pixm­
(£lf.
dœ
 + s–f.
·u£_şr
 + s–f.
psize
 + 'pause.png')

382 
£lf
.
ruÂšg_pm­
 = 
	`g‘_pixm­
(£lf.
dœ
 + s–f.
ruÂšg_şr
 + s–f.
psize
 + 'loop.png')

383 
£lf
.
¡İ³d_pm­
 = 
	`g‘_pixm­
(£lf.
dœ
 + s–f.
¡İ³d_şr
 + s–f.
psize
 + 'stop.png')

384 
£lf
.
abÜ‹d_pm­
 = 
	`g‘_pixm­
(£lf.
dœ
 + s–f.
abÜ‹d_şr
 + s–f.
psize
 + 'flag.png')

385 
£lf
.
dÚe_pm­
 = 
	`g‘_pixm­
(£lf.
dœ
 + s–f.
dÚe_şr
 + s–f.
psize
 + 'check.png')

387 
£lf
.
pm­
 = s–f.
·u£d_pm­


389 
def
 
	$ü—‹Ed™Ü
(
£lf
, 
·»Á
, 
İtiÚ
, 
šdex
):

390 
Ïb–
 = 
QtWidg‘s
.
	`QLab–
(
·»Á
)

391 
Ïb–
.
	`£tMaximumHeight
(15)

392 
£lf
.
pm­
 = s–f.
·u£d_pm­


393 
Ïb–
.
	`£tPixm­
(
£lf
.
pm­
)

394 (
Ïb–
)

396 
def
 
	$g‘_cur_pixm­
(
£lf
):

397 (
£lf
.
pm­
)

399 
def
 
	$£t_cur_pixm­
(
£lf
, 
pm­
):

400 
£lf
.
pm­
 =…map

402 
def
 
	$£tEd™ÜD©a
(
£lf
, 
ed™Ü
, 
šdex
):

404 
sÿn_¡©us_ty³s
 = 
	`Enum
('STOPPED', 'PAUSED', 'RUNNING', 'ABORTED', 'DONE')

406 
ed™Ü
.
	`blockSigÇls
(
True
)

407 
d©a
 = (
šdex
.
	`mod–
().
	`d©a
(šdex, 
QtCÜe
.
Qt
.
Di¥ÏyRŞe
))

408 if(
d©a
 =ğ
sÿn_¡©us_ty³s
.
STOPPED
):

409 
ed™Ü
.
	`£tPixm­
(
£lf
.
¡İ³d_pm­
)

410 
	$–if
(
d©a
 =ğ
sÿn_¡©us_ty³s
.
PAUSED
):

411 
ed™Ü
.
	`£tPixm­
(
£lf
.
·u£d_pm­
)

412 
	$–if
(
d©a
 =ğ
sÿn_¡©us_ty³s
.
RUNNING
):

413 
ed™Ü
.
	`£tPixm­
(
£lf
.
ruÂšg_pm­
)

414 
	$–if
(
d©a
 =ğ
sÿn_¡©us_ty³s
.
ABORTED
):

415 
ed™Ü
.
	`£tPixm­
(
£lf
.
abÜ‹d_pm­
)

416 
	$–if
(
d©a
 =ğ
sÿn_¡©us_ty³s
.
DONE
):

417 
ed™Ü
.
	`£tPixm­
(
£lf
.
dÚe_pm­
)

419 
_logg”
.
	`”rÜ
('sÿÀ¡©u [%d]‚Ù suµÜ‹d' % 
d©a
)

420 
ed™Ü
.
	`upd©e
()

421 
ed™Ü
.
	`blockSigÇls
(
F®£
)

423 
def
 
	$£tMod–D©a
(
£lf
, 
ed™Ü
, 
mod–
, 
šdex
):

424 
d©a
 = 
šdex
.
	`mod–
().
	`d©a
(šdex, 
QtCÜe
.
Qt
.
Di¥ÏyRŞe
)

425 
mod–
.
	`£tD©a
(
šdex
, 
d©a
, 
QtCÜe
.
Qt
.
Ed™RŞe
)

429 
şass
 
	$SÿnQueueTabËWidg‘
(
QtWidg‘s
.
QWidg‘
):

430 
def
 
	$__š™__
(
£lf
, **
kw¬gs
):

431 
QtWidg‘s
.
QWidg‘
.
	`__š™__
(
£lf
)

432 #£tGeom‘ry(
x_pos
, 
y_pos
, 
width
, 
height
)

433 
£lf
.
	`£tGeom‘ry
(300, 200, 870, 450)

434 
h—d”
 = [' File', 'ƒV', 'Pol', 'Range', '# Points', '', ' Progress']

436 
£lf
.
pm­_cŞ
 = 
DEFAULT_PIXMAP_COLUMN


437 
£lf
.
´og_cŞ
 = 
DEFAULT_PROGESS_BAR_COLUMN


439 
£lf
.
âame_li¡
 = []

440 
£lf
.
¥id_to_row_dù
 = {
	}
}

441 #u£ 
numb”s
 
num”ic
 
d©a
 
to
 
sÜt
 
´İ”ly


442 
d©a_li¡
 = []

443 
bË_mod–
 = 
SÿnQTabËMod–
(
£lf
, 
d©a_li¡
, 
h—d”
)

444 
	gbË_v›w
 = 
SÿnQTabËV›w
(
h—d”
, 
´og_cŞ
=
£lf
.´og_cŞ, 
pm­_cŞ
=self.pmap_col)

445 
bË_v›w
.
£tMod–
(
bË_mod–
)

447 
row
 
š
 
¿nge
(0, 
bË_mod–
.
	$rowCouÁ
()):

448 
bË_v›w
.
	`İ’P”si¡’tEd™Ü
(
bË_mod–
.
	`šdex
(
row
, 
£lf
.
´og_cŞ
))

449 
bË_v›w
.
	`İ’P”si¡’tEd™Ü
(
bË_mod–
.
	`šdex
(
row
, 
£lf
.
pm­_cŞ
))

450 
bË_v›w
.
	`£tRowHeight
(
row
, 15)

453 
bË_v›w
.
	`£tCŞumnWidth
(0, 
FILENAME_WIDTH
)

454 
bË_v›w
.
	`£tCŞumnWidth
(1, 
EV_WIDTH
)

455 
bË_v›w
.
	`£tCŞumnWidth
(2, 
POLARITY_WIDTH
)

456 
bË_v›w
.
	`£tCŞumnWidth
(3, 
CENTER_WIDTH
)

457 
bË_v›w
.
	`£tCŞumnWidth
(4, 
NPOINTS_WIDTH
)

458 
bË_v›w
.
	`£tCŞumnWidth
(5, 
PMAP_WIDTH
)

459 
bË_v›w
.
	`£tCŞumnWidth
(6, 
PROGRESS_WIDTH
)

461 
£lf
.
bË_v›w
 =able_view

462 #£ˆ
fÚt


463 #fÚˆğ
bË_v›w
.
	`fÚt
()

464 #fÚt.
	`£tPoštSizeF
(7)

465 
fÚt
 = 
QtGui
.
	`QFÚt
("Cour›¸New", 
TABLE_FONT_SIZE
)

466 
bË_v›w
.
	`£tFÚt
(
fÚt
)

467 #£ˆ
cŞumn
 
width
 
to
 
f™
 
	`cÚ‹Ás
 (
£t
 
fÚt
 
fœ¡
!)

468 #bË_v›w.
	`»sizeCŞumnsToCÚ‹Ás
()

469 #’abË 
sÜtšg


470 
bË_v›w
.
	`£tSÜtšgEÇbËd
(
F®£
)

472 
£lf
.
¡yËBŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
('Update Style')

473 
£lf
.
¡yËBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_upd©e_¡yË
)

475 
£lf
.
lßdSÿnBŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
('Load Scan')

476 
£lf
.
lßdSÿnBŠ
.
şicked
.
	`cÚÃù
(£lf.
İ’fe
)

478 
£lf
.
dœLab–
 = 
QtWidg‘s
.
	`QLab–
('Directory: ')

479 
fÚt
 = 
£lf
.
dœLab–
.
	`fÚt
()

480 
fÚt
.
	`£tBŞd
(
True
)

481 
£lf
.
dœLab–
.
	`£tFÚt
(
fÚt
)

483 #£lf.
thumbÇLbl
 = 
QtWidg‘s
.
	`QLab–
()

484 #£lf.
thumbÇLbl
.
	`£tMšimumSize
(150, 150)

485 #pm­ = 
QtGui
.
	`QPixm­
(
r
'C:\\controls\\py2.7\\Beamlines\\sm\\stxm_control\\widgets\\icons\\black.jpg')

486 #pm­ = 
pm­
.
	`sÿËd
(
QtCÜe
.
	`QSize
(150,150), QtCÜe.
Qt
.
K“pA¥eùR©io
)

487 #£lf.
thumbÇLbl
.
	`£tPixm­
(
pm­
)

489 
Ïyout
 = 
QtWidg‘s
.
	`QVBoxLayout
(
£lf
)

490 
hÏyout
 = 
QtWidg‘s
.
	`QHBoxLayout
()

492 
hÏyout
.
	`addWidg‘
(
bË_v›w
)

493 
hÏyout
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

494 
Ïyout
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

495 
Ïyout
.
	`addWidg‘
(
£lf
.
dœLab–
)

496 
Ïyout
.
	`addLayout
(
hÏyout
)

498 if('loÿl_‹¡' 
š
 
kw¬gs
.
	$keys
()):

499 
£lf
.
rowFld
 = 
QtWidg‘s
.
	`QLšeEd™
("0")

500 
£lf
.
rowFld
.
	`£tToŞT
('Row Field')

501 
£lf
.
rowFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_£t_row
)

502 
£lf
.
´ogFld
 = 
QtWidg‘s
.
	`QLšeEd™
("0")

503 
£lf
.
´ogFld
.
	`£tToŞT
('Progress Field')

504 
£lf
.
´ogFld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_£t_´og»ss
)

505 
£lf
.
pm­Fld
 = 
QtWidg‘s
.
	`QLšeEd™
("0")

506 
£lf
.
pm­Fld
.
	`£tToŞT
('Pixmap Field')

507 
£lf
.
pm­Fld
.
»tuºP»s£d
.
	`cÚÃù
(£lf.
Ú_£t_pixm­
)

509 
Ïyout
.
	`addWidg‘
(
£lf
.
lßdSÿnBŠ
)

510 
Ïyout
.
	`addWidg‘
(
£lf
.
rowFld
)

511 
Ïyout
.
	`addWidg‘
(
£lf
.
´ogFld
)

512 
Ïyout
.
	`addWidg‘
(
£lf
.
pm­Fld
)

514 #bË_v›w.
	`hÜizÚlH—d”
().
	`£tSeùiÚResizeMode
(
QH—d”V›w
.
ResizeToCÚ‹Ás
)

515 
bË_v›w
.
	`hÜizÚlH—d”
().
	`£tSŒ‘chLa¡SeùiÚ
(
True
)

517 
£lf
.
fe_suffix
 = 'hdf5'

519 
def
 
	$Ú_£t_row
(
£lf
):

520 
row
 = (
	`¡r
(
£lf
.
rowFld
.
	`‹xt
()))

521 
£lf
.
	`süŞl_to_row
(
row
)

523 
def
 
	$Ú_£t_´og»ss
(
£lf
):

524 
row
 = (
	`¡r
(
£lf
.
rowFld
.
	`‹xt
()))

525 
v®
 = (
	`¡r
(
£lf
.
´ogFld
.
	`‹xt
()))

526 
£lf
.
	`£t_´og»ss
(
row
, 
v®
)

528 
def
 
	$Ú_£t_pixm­
(
£lf
):

529 
row
 = (
	`¡r
(
£lf
.
rowFld
.
	`‹xt
()))

530 
v®
 = (
	`¡r
(
£lf
.
pm­Fld
.
	`‹xt
()))

531 
£lf
.
	`£t_pixm­
(
row
, 
v®
)

533 
def
 
	$£t_dœeùÜy_Ïb–
(
£lf
, 
dœÇme
):

534 
£lf
.
dœLab–
.
	`£tText
('DœeùÜy: %s' % 
dœÇme
)

536 
def
 
	$£t_´og»ss_cŞumn
(
£lf
, 
cŞ
):

538 
£t
 
™
 
bÙh
 
the
 
TabËV›w
 
ªd
h
Mod–


540 
£lf
.
	`blockSigÇls
(
True
)

541 
£lf
.
bË_v›w
.
	`£t_´og_cŞ
(
cŞ
)

542 
mod–
 = 
£lf
.
bË_v›w
.
	`mod–
()

543 
mod–
.
	`£t_´og_cŞ
(
cŞ
)

544 
£lf
.
´og_cŞ
 = 
cŞ


545 
£lf
.
	`blockSigÇls
(
F®£
)

547 
def
 
	$£t_pixm­_cŞumn
(
£lf
, 
cŞ
):

548 
£lf
.
	`blockSigÇls
(
True
)

549 
£lf
.
bË_v›w
.
	`£t_pm­_cŞ
(
cŞ
)

550 
mod–
 = 
£lf
.
bË_v›w
.
	`mod–
()

551 
mod–
.
	`£t_pm­_cŞ
(
cŞ
)

552 
£lf
.
pm­_cŞ
 = 
cŞ


553 
£lf
.
	`blockSigÇls
(
F®£
)

556 
def
 
	$£t_queue_fe_li¡
(
£lf
, 
âames
):

558 
assign
 
the
 
fe
 
Çmes
 
th©
 
wl
 
be
 
di¥Ïyed
 
š
 
th
 
bË
. 
Som‘imes
h
f’ames
 
¬e
 
g’”©ed


561 
£lf
.
âame_li¡
 = 
âames


563 
def
 
	$Ú_upd©e_¡yË
(
£lf
):

565 
£lf
.
qssh“t
 = 
	`g‘_¡yË
('dark')

566 
£lf
.
	`£tStyËSh“t
(£lf.
qssh“t
)

568 
def
 
	$süŞl_to_row_w™h_¥id
(
£lf
, 
¥_id
):

569 if(
¥_id
 
š
 
£lf
.
¥id_to_row_dù
.
	$keys
()):

570 
row
 = 
£lf
.
¥id_to_row_dù
[
¥_id
]

571 #´šˆ'süŞl_to_row_w™h_¥id:„ow=%d' % 
row


572 
£lf
.
	`süŞl_to_row
(
row
)

573 (
row
)

575 
_logg”
.
	`”rÜ
('süŞl_to_row_w™h_¥id: sp_id[%d] dÛ nÙƒxi¡ iÀbË' % 
¥_id
)

576 
´št
 
£lf
.
¥id_to_row_dù


578 
def
 
	$süŞl_to_row
(
£lf
, 
row
):

579 
row
 > -1:

580 
h
 = 
£lf
.
bË_v›w
.
	`hÜizÚlH—d”
()

581 
i
 
š
 
	`¿nge
(
h
.
	$couÁ
()):

582 
nÙ
 
h
.
	$isSeùiÚHidd’
(
i
è
ªd
 
h
.
	`£ùiÚV›wpÜtPos™iÚ
(i) >= 0:

583 
£lf
.
bË_v›w
.
	`süŞlTo
(£lf.bË_v›w.
	`mod–
().
	`šdex
(
row
, 
i
), s–f.bË_v›w.
Pos™iÚAtC’‹r
)

584 
£lf
.
bË_v›w
.
	`£tCu¼’tIndex
(£lf.bË_v›w.
	`mod–
().
	`šdex
(
row
, 
i
))

587 
def
 
	$£t_´og»ss
(
£lf
, 
row
, 
v®
):

589 
exam¶es
 
of
 
£‰šg
 
a
 
glob®
 
mod–
 
ªd
 
™
 
wl
 
sigÇl
 
the
 
bËmod–
‡nd 
bËv›w
 
th©
 iˆ
has
 
chªged


591 
glob®
 
sÿn_q_mod–_şass


594 #row = 
£lf
.
	`süŞl_to_row_w™h_¥id
(
¥_id
)

595 #dù = 
	`make_´og»ss_diù
(
¥_id
=¥_id, 
³rûÁ
=
v®
)

596 #£lf.
	`£t_´og»ss_by_¥id
(
dù
)

598 
£lf
.
	`süŞl_to_row
(
row
)

599 
sÿn_q_mod–_şass
.
	`£t_d©a
(
row
, 
£lf
.
´og_cŞ
, 
v®
)

600 if(
v®
 > 90.0):

601 
sÿn_q_mod–_şass
.
	`£t_d©a
(
row
, 
£lf
.
pm­_cŞ
, 
sÿn_¡©us_ty³s
.
DONE
)

603 
def
 
	`£t_´og»ss_by_¥id
(
£lf
, 
¥_id
, 
v®
, 
idx
=0):

604 #deà
	`£t_´og»ss_by_¥id
(
£lf
, 
´og_dù
={
PROG_DCT_ID
: 'INVALID'
	}
}):

606 
dù_put
(
dù
, 
PROG_DCT_ID
, PROG_DCT_ID)

607 
dù_put
(
dù
, 
PROG_DCT_SPID
, 
¥_id
)

608 
dù_put
(
dù
, 
PROG_DCT_PERCENT
, 
³rûÁ
)

610 
exam¶es
 
of
 
£‰šg
 
a
 
glob®
 
mod–
 
ªd
 
™
 
wl
 
sigÇl
 
the
 
bËmod–
‡nd 
bËv›w
 
th©
 iˆ
has
 
	gchªged


612 
glob®
 
	gsÿn_q_mod–_şass


613 #if(
dù_g‘
(
´og_dù
, 
PROG_DCT_ID
è
is
 
nÙ
 PROG_DCT_ID):

614 #_logg”.
”rÜ
('Unsupported dictype')

616 #¥_id = 
dù_g‘
(
´og_dù
, 
PROG_DCT_SPID
)

617 #v® = 
dù_g‘
(
´og_dù
, 
PROG_DCT_PERCENT
)

618 #v® = (
¡r
(
£lf
.
´ogFld
.
‹xt
()))

619 #£lf.
bË_v›w
.
£t_´og»ss
(0, 
v®
)

620 #m_m¬k”sProjeùiÚTabËV›w->
süŞlTo
Ğ
šdexLi¡
[0], 
QAb¡¿ùI‹mV›w
::
Ensu»VisibË
);

621 
	grow
 = 
£lf
.
süŞl_to_row_w™h_¥id
(
¥_id
)

622 if(
row
 > -1):

623 
sÿn_q_mod–_şass
.
£t_d©a
(
row
, 
£lf
.
´og_cŞ
, 
v®
)

624 if(
	gv®
 > 90.0):

625 
sÿn_q_mod–_şass
.
£t_d©a
(
row
, 
£lf
.
pm­_cŞ
, 
sÿn_¡©us_ty³s
.
DONE
)

627 
def
 
	$£t_pixm­
(
£lf
, 
row
, 
v®
):

629 
exam¶es
 
of
 
£‰šg
 
a
 
glob®
 
mod–
 
ªd
 
™
 
wl
 
sigÇl
 
the
 
bËmod–
‡nd 
bËv›w
 
th©
 iˆ
has
 
chªged


630 
sÿn_¡©us_ty³s
 = 
	`Enum
('STOPPED', 'RUNNING', 'PAUSED', 'DONE', 'ABORTED')

633 
glob®
 
sÿn_q_mod–_şass


635 
£lf
.
	`süŞl_to_row
(
row
)

636 
choiûs
 = 
sÿn_¡©us_ty³s
.
	`g‘_choiûs
()

637 if(
v®
 < 0):

638 
v®
 = 0

639 if(
v®
 > 
	$Ën
(
choiûs
)):

640 
v®
 = 
	`Ën
(
choiûs
)

641 #£lf.
bË_v›w
.
	`£t_pixm­
(0, 
v®
)

642 
sÿn_q_mod–_şass
.
	`£t_d©a
(
row
, 
£lf
.
pm­_cŞ
, 
v®
)

645 
def
 
	$£t_pixm­_by_¥id
(
£lf
, 
¥_id
, 
v®
):

647 
exam¶es
 
of
 
£‰šg
 
a
 
glob®
 
mod–
 
ªd
 
™
 
wl
 
sigÇl
 
the
 
bËmod–
‡nd 
bËv›w
 
th©
 iˆ
has
 
chªged


648 
sÿn_¡©us_ty³s
 = 
	`Enum
('STOPPED', 'RUNNING', 'PAUSED', 'DONE', 'ABORTED')

651 
glob®
 
sÿn_q_mod–_şass


653 
row
 = 
£lf
.
	`süŞl_to_row_w™h_¥id
(
¥_id
)

654 if(
row
):

655 #v® = (
	`¡r
(
£lf
.
pm­Fld
.
	`‹xt
()))

656 
choiûs
 = 
sÿn_¡©us_ty³s
.
	`g‘_choiûs
()

657 if(
v®
 < 0):

658 
v®
 = 0

659 if(
v®
 > 
	$Ën
(
choiûs
)):

660 
v®
 = 
	`Ën
(
choiûs
)

661 #£lf.
bË_v›w
.
	`£t_pixm­
(0, 
v®
)

662 
sÿn_q_mod–_şass
.
	`£t_d©a
(
row
, 
£lf
.
pm­_cŞ
, 
v®
)

664 
def
 
	$İ’fe
(
£lf
):

666 
	$İ’fe
(): 
desütiÚ


668 :
·¿m
 
âame
: fÇm
desütiÚ


669 :
ty³
 
âame
: fnameype

671 :
·¿m
 
addimages
=
F®£
:‡ddimages=F®£ 
desütiÚ


672 :
ty³
 
addimages
=
F®£
:‡ddimages=Falseype

674 :
»tuºs
: 
NÚe


676 
äom
 
şs
.
­pWidg‘s
.
dŸlogs
 
impÜt
 
g‘O³nFeName


678 
âame
 = 
	`g‘O³nFeName
("O³Àhdf5 fe", 
f‹r_¡r
="hdf5 Fe (*.hdf5)", 
£¬ch_·th
=
r
'S:\STXM-data\Cryo-STXM\2017\guest\0113')

679 if(
âame
):

681 
âame
 = 
	`¡r
(fname)

682 
d©a_dœ
, 
å»fix
, 
fsuffix
 = 
	`g‘_fe_·th_as_·¹s
(
âame
)

683 if(
d©a_dœ
 
is
 
NÚe
):

684 
_logg”
.
	`”rÜ
('ProbËm w™h f[%s]' % 
âame
)

686 
£lf
.
	`£t_dœeùÜy_Ïb–
(
d©a_dœ
)

687 
£lf
.
fe_suffix
 = 
fsuffix
[1:]

689 
d©a_io
 = 
	`BioxasD©aIo
(
d©a_dœ
, 
å»fix
)

690 
’Œy_dù
 = 
d©a_io
.
	`lßd
()

691 
ekey
 = 
’Œy_dù
.
	`keys
()[0]

692 
wdg_com
 = 
d©a_io
.
	`g‘_wdg_com_äom_’Œy
(
’Œy_dù
, 
ekey
)

693 #wdg_com = 
	`dù_g‘
(
ado_obj
, 
ADO_CFG_WDG_COM
)

694 
£lf
.
	`lßd_wdg_com
(
wdg_com
)

696 
def
 
	$ş—r_bË
(
£lf
):

697 
£lf
.
bË_v›w
.
	`»move_mod–
()

700 
def
 
	$lßd_wdg_com
(
£lf
, 
wdg_com
):

702 
ke
 
ª
 
widg‘
 
communiÿtiÚs
 
obj
 
ªd
 
ü—‹
 
a
 
sÿn
 
queue
 
which
 
is
‡ 
li¡
 
of


705 
¥_roi_dù
 = 
	`dù_g‘
(
wdg_com
, 
WDGCOM_SPATIAL_ROIS
)

706 
¥_ids
 = 
¥_roi_dù
.
	`keys
()

708 
sÿn_q_li¡
, 
sÿn_ty³
 = 
£lf
.
	`wdg_com_to_sÿn_queue
(
wdg_com
)

709 if(
sÿn_q_li¡
):

710 
£lf
.
bË_v›w
.
	`»move_mod–
()

711 
£lf
.
bË_v›w
.
	`£t_mod–
(
sÿn_q_li¡
)

712 
£lf
.
	`£t_d–eg©es
(
sÿn_ty³
)

713 #´šˆ
sÿn_q_li¡


715 
def
 
	$wdg_com_to_sÿn_queue
(
£lf
, 
wdg_com
):

717 if(
wdg_com
 
is
 
nÙ
 
NÚe
):

718 
¥_ids
 = 
	`g‘_¥_ids_äom_wdg_com
(
wdg_com
)

719 
sÿn_queue_li¡
 = []

720 
£lf
.
¥id_to_row_dù
 = {
	}
}

721 
row
 = 0

722 
¥_id
 
š
 
¥_ids
:

723 
¥_db
 = 
g‘_¥_db_äom_wdg_com
(
wdg_com
, 
¥_id
)

724 
	grow_’Œy_li¡
, 
	gsÿn_ty³
 = 
£lf
.
make_sÿn_queue_li¡
(
¥_db
)

725 if(
row_’Œy_li¡
):

726 
ado
 = 
dù_g‘
(
¥_db
, 
SPDB_ACTIVE_DATA_OBJECT
)

727 
	gâame
 = 
dù_g‘
(
ado
, 
ADO_CFG_DATA_FILE_NAME
)

728 
	g£lf
.
	g¥id_to_row_dù
[
¥_db
[
SPDB_ID_VAL
]] = 
row


729 
sÿn_queue_li¡
 = sÿn_queue_li¡ + 
row_’Œy_li¡


730 
row
 += 1

732 (
NÚe
, 
	gsÿn_ty³
)

733 (
	gsÿn_queue_li¡
, 
	gsÿn_ty³
)

735 
def
 
	$£t_d–eg©es
(
£lf
, 
sÿn_ty³
):

736 if(
sÿn_ty³
 =ğ
sÿn_ty³s
.
DETECTOR_IMAGE
):

737 
£lf
.
	`£t_d–eg©es_ev
()

739 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
OSA_IMAGE
):

740 
£lf
.
	`£t_d–eg©es_ev
()

742 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
OSA_FOCUS
):

743 
£lf
.
	`£t_d–eg©es_focus
()

745 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_FOCUS
):

746 
£lf
.
	`£t_d–eg©es_focus
()

748 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE
):

749 
£lf
.
	`£t_d–eg©es_muÉi_ev
()

751 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE_STACK
):

752 
£lf
.
	`£t_d–eg©es_muÉi_ev
()

754 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_POINT_SPECTRUM
):

755 
£lf
.
	`£t_d–eg©es_pošt_¥ec
()

757 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
ZP_IMAGE_SCAN
):

758 
£lf
.
	`£t_d–eg©es_muÉi_ev
()

760 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
):

761 
£lf
.
	`£t_d–eg©es_muÉi_ev
()

763 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
GENERIC_SCAN
):

764 
£lf
.
	`£t_d–eg©es_ev
()

766 
´št
 '£t_d–eg©es: sÿÀty³‚Ù suµÜ‹d y‘ [%d]' % 
sÿn_ty³


769 
def
 
	$make_sÿn_queue_li¡
(
£lf
, 
¥_db
):

771 
ke
 
ª
 
’tœe
 
¥©Ÿl
 
»giÚ
 
ªd
 
ü—‹
 
the
 
­´İrŸ‹
 
numb”
 
of
 
row
 
’Œ›s


772 
sÿn_ty³s
 = 
	`Enum
('Detector_Image', \

784 
sÿn_ty³
 = 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
)

787 if(
sÿn_ty³
 =ğ
sÿn_ty³s
.
DETECTOR_IMAGE
):

788 
rows
 = 
£lf
.
	`make_sšgË_ev_row_’Œ›s
(
¥_db
)

790 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
OSA_IMAGE
):

791 
rows
 = 
£lf
.
	`make_sšgË_ev_row_’Œ›s
(
¥_db
)

793 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
OSA_FOCUS
):

794 
rows
 = 
£lf
.
	`make_focus_row_’Œ›s
(
¥_db
)

796 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_FOCUS
):

797 
rows
 = 
£lf
.
	`make_focus_row_’Œ›s
(
¥_db
)

799 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE
):

800 
rows
 = 
£lf
.
	`make_sšgË_ev_row_’Œ›s
(
¥_db
)

802 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_IMAGE_STACK
):

803 
rows
 = 
£lf
.
	`make_muÉi_ev_row_’Œ›s
(
¥_db
, 
¡ack_dœ
=
True
)

805 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
ZP_IMAGE_SCAN
):

806 
rows
 = 
£lf
.
	`make_muÉi_ev_row_’Œ›s
(
¥_db
)

808 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_POINT_SPECTRUM
):

809 
rows
 = 
£lf
.
	`make_pošt_sÿn_row_’Œ›s
(
¥_db
)

811 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
SAMPLE_LINE_SPECTRUM
):

812 
rows
 = 
£lf
.
	`make_sšgË_ev_row_’Œ›s
(
¥_db
)

813 #»tuº 
NÚe
, 
sÿn_ty³


815 
	$–if
(
sÿn_ty³
 =ğ
sÿn_ty³s
.
GENERIC_SCAN
):

816 
rows
 = 
£lf
.
	`make_sšgË_ev_row_’Œ›s
(
¥_db
)

818 
´št
 'make_sÿn_queue_li¡: sÿÀty³‚Ù suµÜ‹d y‘ [%d]' % 
sÿn_ty³


819  
NÚe
, 
sÿn_ty³


822 (
rows
, 
sÿn_ty³
)

824 
def
 
	$£t_d–eg©es_ev
(
£lf
):

826 
h—d”
 = ['Filename', 'ƒV', 'Pol', 'Range', '# Points', '', ' Progress']

830 
tm
 = 
£lf
.
bË_v›w
.
	`mod–
()

831 
row
 
š
 
	`¿nge
(0, 
tm
.
	$rowCouÁ
()):

832 
£lf
.
bË_v›w
.
	`İ’P”si¡’tEd™Ü
(
tm
.
	`šdex
(
row
, s–f.
´og_cŞ
))

833 
£lf
.
bË_v›w
.
	`İ’P”si¡’tEd™Ü
(
tm
.
	`šdex
(
row
, s–f.
pm­_cŞ
))

834 #£lf.
bË_v›w
.
	`£tRowHeight
(
row
, 15)

837 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(0, 
FILENAME_WIDTH
)

838 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(1, 
EV_WIDTH
)

839 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(2, 
POLARITY_WIDTH
)

840 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(3, 
CENTER_WIDTH
)

841 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(4, 
NPOINTS_WIDTH
)

842 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(£lf.
pm­_cŞ
, 
PMAP_WIDTH
)

843 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(£lf.
´og_cŞ
, 
PROGRESS_WIDTH
)

845 
def
 
	$£t_d–eg©es_muÉi_ev
(
£lf
):

847 
h—d”
 = ['Filename', 'ƒV', 'Pol', 'Range', '# Points', '', ' Progress']

851 
tm
 = 
£lf
.
bË_v›w
.
	`mod–
()

852 
row
 
š
 
	`¿nge
(0, 
tm
.
	$rowCouÁ
()):

853 
£lf
.
bË_v›w
.
	`İ’P”si¡’tEd™Ü
(
tm
.
	`šdex
(
row
, s–f.
´og_cŞ
))

854 
£lf
.
bË_v›w
.
	`İ’P”si¡’tEd™Ü
(
tm
.
	`šdex
(
row
, s–f.
pm­_cŞ
))

855 #£lf.
bË_v›w
.
	`£tRowHeight
(
row
, 15)

858 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(0, 
STACK_FILENAME_WIDTH
)

859 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(1, 
EV_WIDTH
)

860 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(2, 
POLARITY_WIDTH
)

861 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(3, 
CENTER_WIDTH
)

862 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(4, 
NPOINTS_WIDTH
)

863 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(£lf.
pm­_cŞ
, 
PMAP_WIDTH
)

864 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(£lf.
´og_cŞ
, 
PROGRESS_WIDTH
)

866 
def
 
	$£t_d–eg©es_pošt_¥ec
(
£lf
):

868 
h—d”
 = [' File', ' StartƒV', 'StopƒV', 'Pol', 'Center', '# Points', '', ' Progress']

872 
tm
 = 
£lf
.
bË_v›w
.
	`mod–
()

873 
row
 
š
 
	`¿nge
(0, 
tm
.
	$rowCouÁ
()):

874 
£lf
.
bË_v›w
.
	`İ’P”si¡’tEd™Ü
(
tm
.
	`šdex
(
row
, s–f.
´og_cŞ
))

875 
£lf
.
bË_v›w
.
	`İ’P”si¡’tEd™Ü
(
tm
.
	`šdex
(
row
, s–f.
pm­_cŞ
))

876 #£lf.
bË_v›w
.
	`£tRowHeight
(
row
, 15)

879 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(0, 
FILENAME_WIDTH
)

880 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(1, 
EV_WIDTH
)

881 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(2, 
EV_WIDTH
)

882 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(3, 
POLARITY_WIDTH
)

883 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(4, 
CENTER_WIDTH
)

884 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(5, 
NPOINTS_WIDTH
)

885 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(£lf.
pm­_cŞ
, 
PMAP_WIDTH
)

886 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(£lf.
´og_cŞ
, 
PROGRESS_WIDTH
)

888 
def
 
	$£t_d–eg©es_focus
(
£lf
):

891 
h—d”
 = ['Filename', ' Z Start', 'Z Stop', 'Z Step', 'Z #pts', '', ' Progress']

893 
tm
 = 
£lf
.
bË_v›w
.
	`mod–
()

894 
row
 
š
 
	`¿nge
(0, 
tm
.
	$rowCouÁ
()):

895 #£lf.
bË_v›w
.
	`£tRowHeight
(
row
, 15)

896 
£lf
.
bË_v›w
.
	`İ’P”si¡’tEd™Ü
(
tm
.
	`šdex
(
row
, s–f.
´og_cŞ
))

897 
£lf
.
bË_v›w
.
	`İ’P”si¡’tEd™Ü
(
tm
.
	`šdex
(
row
, s–f.
pm­_cŞ
))

900 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(0, 
FILENAME_WIDTH
)

901 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(1, 
START_WIDTH
)

902 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(2, 
START_WIDTH
)

903 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(3, 
START_WIDTH
)

904 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(4, 
NPOINTS_WIDTH
)

905 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(£lf.
pm­_cŞ
, 
PMAP_WIDTH
)

906 
£lf
.
bË_v›w
.
	`£tCŞumnWidth
(£lf.
´og_cŞ
, 
PROGRESS_WIDTH
)

908 
def
 
	`make_focus_row_’Œ›s
(
£lf
, 
¥_db
, 
§m¶e_pos
=1):

910 
Take
 
ª
 
	$focus
 (
OSA
 
Ü
 
§m¶e
è
¥_db
 
ªd
 
ü—‹
 
a
 
row
 
’Œy
 ¨
d‘eùÜ
 
sÿn


911 
The
 
»suÉs
 
should
 
be
 
a
 
sšgË
 
row
 
’Œy
:

914 
h—d”
 = [' File', ' Zpz Start', 'Zpz Stop', 'Zpz Step', 'Zpz #Points', '', ' Progress']

915 
£lf
.
bË_v›w
.
	`£t_h—d”
(
h—d”
)

916 
£lf
.
bË_v›w
.
	`upd©e
()

918 
l¡
 = []

919 
x_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_X
)

920 
y_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_Y
)

921 
z_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_Z
)

922 
e_rois
 = 
	`dù_g‘
(
¥_db
, 
SPDB_EV_ROIS
)

923 
e_roi
 = 
e_rois
[0]

924 
numX
 = (
x_roi
['NPOINTS'])

925 
numY
 = (
y_roi
['NPOINTS'])

926 
numZ
 = (
z_roi
['NPOINTS'])

927 
numE²ts
 = (
	`dù_g‘
(
¥_db
, 
SPDB_EV_NPOINTS
))

929 
row_num
 = 0

931 
´fx
 = 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_DATAFILE_PFX
)

932 
âame
 = 
£lf
.
	`make_âame
(
´fx
, 
row_num
, 
§m¶e_pos
)

934 
l¡
.
	`­³nd
(
âame
)

935 
l¡
.
	`­³nd
('%.2f' % 
z_roi
['START'])

936 
l¡
.
	`­³nd
('%.2f' % 
z_roi
['STOP'])

937 
l¡
.
	`­³nd
('%.2àum' % (
z_roi
['STEP']))

938 
l¡
.
	`­³nd
('%d' % (
z_roi
['NPOINTS']))

939 
l¡
.
	`­³nd
(0)

940 
l¡
.
	`­³nd
(
row_num
)

941 ([
l¡
])

943 
def
 
	`make_sšgË_ev_row_’Œ›s
(
£lf
, 
¥_db
, 
§m¶e_pos
=1):

945 
Take
 
ª
 
sšgË
 
ev
 
	$¥_db
 (
d‘eùÜ
, 
o§
è
ªd
 
ü—‹
 
a
 
row
 
’Œy
 ¨d‘eùÜ 
sÿn


946 
The
 
»suÉs
 
should
 
be
 
a
 
sšgË
 
row
 
’Œy
:

949 
h—d”
 = [' File', 'ƒV', 'Pol', 'Range', '# Points', '', ' Progress']

950 
£lf
.
bË_v›w
.
	`£t_h—d”
(
h—d”
)

951 
£lf
.
	`£t_´og»ss_cŞumn
(6)

952 
£lf
.
	`£t_pixm­_cŞumn
(5)

953 
£lf
.
bË_v›w
.
	`upd©e
()

955 
l¡
 = []

956 
x_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_X
)

957 
y_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_Y
)

958 
z_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_Z
)

959 
e_rois
 = 
	`dù_g‘
(
¥_db
, 
SPDB_EV_ROIS
)

960 
e_roi
 = 
e_rois
[0]

961 
numX
 = (
x_roi
['NPOINTS'])

962 
numY
 = (
y_roi
['NPOINTS'])

963 
numZ
 = (
z_roi
['NPOINTS'])

964 
numE²ts
 = (
	`dù_g‘
(
¥_db
, 
SPDB_EV_NPOINTS
))

966 
row_num
 = 0

968 
´fx
 = 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_DATAFILE_PFX
)

969 
ado_obj
 = 
	`dù_g‘
(
¥_db
, 
SPDB_ACTIVE_DATA_OBJECT
)

970 
âame
 = 
	`dù_g‘
(
ado_obj
, 
ADO_CFG_DATA_FILE_NAME
)

972 #âamğ
£lf
.
	`make_âame
(
´fx
, 
row_num
, 
§m¶e_pos
)

974 
l¡
.
	`­³nd
(
âame
)

975 
l¡
.
	`­³nd
('%.2f' % 
e_roi
['START'])

976 
•u_¡r
 = 
	`cÚv”t_w¿µ”_•u_to_¡r
(
e_roi
['EPU_POL_PNTS'][0])

977 
l¡
.
	`­³nd
('%s' % 
•u_¡r
)

978 
l¡
.
	`­³nd
('%.2àx %.2àum' % (
x_roi
['RANGE'], 
y_roi
['RANGE']))

979 
l¡
.
	`­³nd
('%dx%d ' % (
x_roi
['NPOINTS'], 
y_roi
['NPOINTS']))

980 
l¡
.
	`­³nd
(0)

981 
l¡
.
	`­³nd
(
row_num
)

982 ([
l¡
])

984 
def
 
	`make_pošt_sÿn_row_’Œ›s
(
£lf
, 
¥_db
, 
§m¶e_pos
=1):

986 
Take
 
ª
 
sšgË
 
ev
 
	$¥_db
 (
d‘eùÜ
, 
o§
è
ªd
 
ü—‹
 
a
 
row
 
’Œy
 ¨d‘eùÜ 
sÿn


987 
The
 
»suÉs
 
should
 
be
 
a
 
sšgË
 
row
 
’Œy
:

990 
h—d”
 = [' File', ' StartƒV', 'StopƒV', 'Pol', 'Center', '# Points', '', ' Progress']

992 
£lf
.
bË_v›w
.
	`£t_h—d”
(
h—d”
)

993 
£lf
.
	`£t_´og»ss_cŞumn
(7)

994 
£lf
.
	`£t_pixm­_cŞumn
(6)

995 
£lf
.
bË_v›w
.
	`upd©e
()

997 
x_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_X
)

998 
y_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_Y
)

999 
z_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_Z
)

1000 
e_rois
 = 
	`dù_g‘
(
¥_db
, 
SPDB_EV_ROIS
)

1002 
numX
 = (
x_roi
['NPOINTS'])

1003 
numY
 = (
y_roi
['NPOINTS'])

1004 
numZ
 = (
z_roi
['NPOINTS'])

1005 
numE²ts
 = (
	`dù_g‘
(
¥_db
, 
SPDB_EV_NPOINTS
))

1007 
row_num
 = 0

1009 
´fx
 = 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_DATAFILE_PFX
)

1010 
ado_obj
 = 
	`dù_g‘
(
¥_db
, 
SPDB_ACTIVE_DATA_OBJECT
)

1011 
âame
 = 
	`dù_g‘
(
ado_obj
, 
ADO_CFG_DATA_FILE_NAME
)

1013 if(
	`Ën
(
e_rois
) == 0):

1014 
_logg”
.
	`”rÜ
('something wrong withehƒ_roi here')

1017 
e¡¬t
 = 
e_rois
[0]['START']

1018 
e¡İ
 = 
e_rois
[-1]['STOP']

1019 
pŞ
 = 
e_rois
[0]['EPU_POL_PNTS'][0]

1021 
l¡
 = []

1022 
l¡
.
	`­³nd
(
âame
)

1023 
l¡
.
	`­³nd
('%.2f' % 
e¡¬t
)

1024 
l¡
.
	`­³nd
('%.2f' % 
e¡İ
)

1025 
•u_¡r
 = 
	`cÚv”t_w¿µ”_•u_to_¡r
(
pŞ
)

1026 
l¡
.
	`­³nd
('%s' % 
•u_¡r
)

1027 
l¡
.
	`­³nd
('%.2àx %.2àum' % (
x_roi
['CENTER'], 
y_roi
['CENTER']))

1028 
l¡
.
	`­³nd
('%d ' % (
numE²ts
))

1029 
l¡
.
	`­³nd
(0)

1030 
l¡
.
	`­³nd
(
row_num
)

1032 ([ 
l¡
 ])

1034 
def
 
	`make_muÉi_ev_row_’Œ›s
(
£lf
, 
¥_db
, 
§m¶e_pos
=1, 
is_pošt
=
F®£
, 
¡ack_dœ
=False):

1036 
Take
 
ª
 
sšgË
 
ev
 
	$¥_db
 (
d‘eùÜ
, 
o§
è
ªd
 
ü—‹
 
a
 
row
 
’Œy
 ¨d‘eùÜ 
sÿn


1037 
The
 
»suÉs
 
should
 
be
 
a
 
sšgË
 
row
 
’Œy
:

1040 if(
is_pošt
):

1041 
h—d”
 = [' File', 'ƒV', 'Pol', 'Center', '# Points', '', ' Progress']

1043 
h—d”
 = [' File', 'ƒV', 'Pol', 'Range', '# Points', '', ' Progress']

1045 
£lf
.
bË_v›w
.
	`£t_h—d”
(
h—d”
)

1046 
£lf
.
bË_v›w
.
	`upd©e
()

1048 
maš_l¡
 = []

1049 #sÿn_ty³ = 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
)

1050 
x_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_X
)

1051 
y_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_Y
)

1052 
z_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_Z
)

1053 
e_rois
 = 
	`dù_g‘
(
¥_db
, 
SPDB_EV_ROIS
)

1055 
numX
 = (
x_roi
['NPOINTS'])

1056 
numY
 = (
y_roi
['NPOINTS'])

1057 
numZ
 = (
z_roi
['NPOINTS'])

1058 
numE²ts
 = (
	`dù_g‘
(
¥_db
, 
SPDB_EV_NPOINTS
))

1060 
row_num
 = 0

1062 
´fx
 = 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_DATAFILE_PFX
)

1063 
ado_obj
 = 
	`dù_g‘
(
¥_db
, 
SPDB_ACTIVE_DATA_OBJECT
)

1064 
d©afe_Çme
 = 
	`dù_g‘
(
ado_obj
, 
ADO_CFG_DATA_FILE_NAME
)

1066 
idx
 = 0

1067 
e_roi
 
š
 
e_rois
:

1068 
e
 
š
 
e_roi
['SETPOINTS']:

1069 
pŞ
 
š
 
e_roi
['EPU_POL_PNTS']:

1070 
l¡
 = []

1071 if((
d©afe_Çme
 
is
 
NÚe
è
	$Ü
 (
¡ack_dœ
)):

1072 
âame
 = 
£lf
.
	`make_image_âame
(
´fx
, 
idx
, 
§m¶e_pos
)

1074 #âamğ
d©afe_Çme


1075 if(
	`Ën
(
£lf
.
âame_li¡
) > 0):

1076 
âame
 = 
£lf
.
âame_li¡
[0]

1078 
âame
 = 'C000000.hdf5'

1079 
l¡
.
	`­³nd
(
âame
)

1080 
l¡
.
	`­³nd
('%.2f' % 
e
)

1081 
•u_¡r
 = 
	`cÚv”t_w¿µ”_•u_to_¡r
(
pŞ
)

1082 
l¡
.
	`­³nd
('%s' % 
•u_¡r
)

1083 if(
is_pošt
):

1084 
l¡
.
	`­³nd
('%.2àx %.2àum' % (
x_roi
['CENTER'], 
y_roi
['CENTER']))

1086 
l¡
.
	`­³nd
('%.2àx %.2àum' % (
x_roi
['RANGE'], 
y_roi
['RANGE']))

1088 
l¡
.
	`­³nd
('%dx%d ' % (
x_roi
['NPOINTS'], 
y_roi
['NPOINTS']))

1089 
l¡
.
	`­³nd
(0)

1090 
l¡
.
	`­³nd
(
row_num
)

1091 
maš_l¡
.
	`­³nd
(
l¡
)

1092 
idx
 += 1

1093 (
maš_l¡
)

1096 
def
 
	`make_lše_¥ec_muÉi_ev_row_’Œ›s
(
£lf
, 
¥_db
, 
§m¶e_pos
=1):

1098 
Take
 
ª
 
sšgË
 
ev
 
	$¥_db
 (
d‘eùÜ
, 
o§
è
ªd
 
ü—‹
 
a
 
row
 
’Œy
 ¨d‘eùÜ 
sÿn


1099 
The
 
»suÉs
 
should
 
be
 
a
 
sšgË
 
row
 
’Œy
:

1102 
maš_l¡
 = []

1103 #sÿn_ty³ = 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
)

1104 
x_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_X
)

1105 
y_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_Y
)

1106 
z_roi
 = 
	`dù_g‘
(
¥_db
, 
SPDB_Z
)

1107 
e_rois
 = 
	`dù_g‘
(
¥_db
, 
SPDB_EV_ROIS
)

1109 
numX
 = (
x_roi
['NPOINTS'])

1110 
numY
 = (
y_roi
['NPOINTS'])

1111 
numZ
 = (
z_roi
['NPOINTS'])

1112 
numE²ts
 = (
	`dù_g‘
(
¥_db
, 
SPDB_EV_NPOINTS
))

1114 
row_num
 = 0

1116 
´fx
 = 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_DATAFILE_PFX
)

1118 
idx
 = 0

1119 
e_roi
 
š
 
e_rois
:

1120 #fÜ 
e
 
š
 
e_roi
['SETPOINTS']:

1121 
pŞ
 
š
 
e_roi
['EPU_POL_PNTS']:

1122 
e
 = 
e_roi
['SETPOINTS'][0]

1123 
âame
 = 
£lf
.
	`make_image_âame
(
´fx
, 
idx
, 
§m¶e_pos
)

1124 
l¡
 = []

1125 
l¡
.
	`­³nd
(
âame
)

1126 
l¡
.
	`­³nd
('%.2f' % 
e
)

1127 
•u_¡r
 = 
	`cÚv”t_w¿µ”_•u_to_¡r
(
pŞ
)

1128 
l¡
.
	`­³nd
('%s' % 
•u_¡r
)

1129 
l¡
.
	`­³nd
('%.2àx %.2àum' % (
x_roi
['RANGE'], 
y_roi
['RANGE']))

1130 
l¡
.
	`­³nd
('%dx%d ' % (
x_roi
['NPOINTS'], 
y_roi
['NPOINTS']))

1131 
l¡
.
	`­³nd
(0)

1132 
l¡
.
	`­³nd
(
row_num
)

1134 
maš_l¡
.
	`­³nd
(
l¡
)

1135 
idx
 += 1

1136 (
maš_l¡
)

1138 
def
 
	`make_âame
(
£lf
, 
´fx
, 
row_num
, 
§m¶e_pos
=1):

1139 
âame
 = '%s%d-%05d%s' % (
´fx
, 
§m¶e_pos
, 
row_num
, 
£lf
.
fe_suffix
)

1140 if(
row_num
 < 
	$Ën
(
£lf
.
âame_li¡
)):

1141 
âame
 = 
£lf
.
âame_li¡
[
row_num
]

1142 #âamğ'%s' % (
´fx
, 
row_num
, 
£lf
.
fe_suffix
)

1143 (
âame
)

1145 
def
 
	`make_image_âame
(
£lf
, 
´fx
, 
row_num
, 
§m¶e_pos
=1):

1146 
âame
 = '%s%d-%05d% img/%d' % (
´fx
, 
§m¶e_pos
, 0, 
£lf
.
fe_suffix
, 
row_num
)

1147 if(
row_num
 < 
	$Ën
(
£lf
.
âame_li¡
)):

1148 #â = 
£lf
.
âame_li¡
[
row_num
]

1149 
âame
 = 
£lf
.
âame_li¡
[
row_num
]

1150 #âamğ'% img/%d' % (
â
, 
row_num
)

1151 (
âame
)

1155 
__Çme__
=="__main__":

1157 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
([])

1159 
wš
 = 
	`SÿnQueueTabËWidg‘
(
loÿl_‹¡
=
True
)

1160 
qssh“t
 = 
	`g‘_¡yË
('dark')

1161 
wš
.
	`£tStyËSh“t
(
qssh“t
)

1162 
wš
.
	`show
()

1163 #wš.
	`İ’fe
()

1164 
­p
.
	`exec_
()

	@widgets/scan_table_view/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

	@widgets/scan_table_view/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

	@widgets/scan_table_view/a0_pointSpecWidget.py

3 
äom
 
PyQt5
 
impÜt
 
	gQtGui
, 
	gQtCÜe
, 
	guic
, 
QtWidg‘s


5 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
ba£SÿnTabË
 
impÜt
 *

7 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
muÉiRegiÚWidg‘
 
impÜt
 
MuÉiRegiÚWidg‘


8 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
¥©ŸlS–Widg‘
 
impÜt
 
S·tŸlS–Widg‘


9 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
evS–Widg‘
 
impÜt
 
EÃrgyS–Widg‘


10 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
pŞ¬™yS–Widg‘
 
impÜt
 
PŞ¬™yS–Widg‘


12 
äom
 
	gşs
.
	gsÿÂšg
.
¶ugšs
 
impÜt
 
¶ugš_dœ


15 
şass
 
	$A0_CÚfigWidg‘
(
QtWidg‘s
.
QF¿me
):

17 
A
 
QWidg‘
 
th©
 
cÚšs
 
ª
 
EÃrgySÿnTabËV›w


20 
def
 
	$__š™__
(
£lf
, 
¥£l
, 
ev£l
, 
pŞ£l
):

22 
	$__š™__
(): 
desütiÚ


24 :
·¿m
 
pŞ_£l_widg‘
=
NÚe
:…Ş_£l_widg‘=NÚ
desütiÚ


25 :
ty³
 
pŞ_£l_widg‘
=
NÚe
:…ol_sel_widget=Noneype

27 :
»tuºs
: 
NÚe


29 
QtWidg‘s
.
QF¿me
.
	$__š™__
(
£lf
)

30 
uic
.
	`lßdUi
Ğ
¶ugš_dœ
 + '/twİošt_pošt_¥ec.ui', 
£lf
)

32 
£lf
.
muÉi
 = 
	$MuÉiRegiÚWidg‘
(
u£_ûÁ”
=
F®£
, 
is_pošt
=
True
, 
’abË_muÉi_¥©Ÿl
=True, 
sšgË_ev_mod–
=True)

33 
£lf
.
muÉi
.
	$’abË_add_¥©Ÿl_»giÚ_m’u
(
True
)

34 
£lf
.
muÉi
.
	$show_lßd_bŠ
()

35 
£lf
.
muÉi
.
	$show_g‘d©a_bŠ
()

37 
£lf
.
¥_mod–
 = s–f.
muÉi
.
	$g‘_¥©Ÿl_mod–
()

38 
£lf
.
ev_mod–
 = s–f.
muÉi
.
	$g‘_’”gy_mod–
()

40 
vbox
 = 
QtWidg‘s
.
	$QVBoxLayout
()

41 
vbox
.
	$addWidg‘
(
£lf
.
muÉi
)

43 
£lf
.
¥©ŸlG½Box
.
	$£tLayout
(
vbox
)

45 
def
 
	$Ú_£l_bŠ_şicked
(
£lf
, 
chkd
):

46 
bŠ
 = 
£lf
.
	$£nd”
()

47 
´št
 
bŠ


48 if(
chkd
):

49 
´št
 'btn is checked'

51 
´št
 'btn is NOT checked'

53 
__Çme__
 == '__main__':

54 
impÜt
 
sys


55 
äom
 
şs
.
­pWidg‘s
.
¥yd”_cÚsŞe
 
impÜt
 
Sh–lWidg‘
#, 
Sh–lDock


57 
	$log_to_qt
()

58 
­p
 = 
QtWidg‘s
.
	$QAµliÿtiÚ
(
sys
.
¬gv
)

60 
pŞ£l
 = 
	$PŞ¬™yS–Widg‘
()

61 
ev£l
 = 
	$EÃrgyS–Widg‘
(
pŞ_£l_widg‘
=
pŞ£l
)

62 
ev£l
.
	$’abË_add_»giÚ
(
True
)

63 
¥£l
 = 
	$S·tŸlS–Widg‘
(
ev_£l_widg‘
=
ev£l
)

64 
maš
 = 
	$A0_CÚfigWidg‘
(
¥£l
, 
ev£l
, 
pŞ£l
)

66 
ns
 = {'ev£l': 
ev£l
, 'pŞ£l': 
pŞ£l
, 'maš': 
maš
, 'g':
	`glob®s
(è
	}
}

68 
pythÚsh–l
 = 
	$Sh–lWidg‘
(
·»Á
=
NÚe
, 
Çme¥aû
=
ns
,
commªds
=[], 
muÉ™h»aded
=
True
)

70 #maš.
	`Ïyout
().
	`addWidg‘
(
pythÚsh–l
)

72 
maš
.
	$show
()

74 
sys
.
	`ex™
(
­p
.
	`exec_
())

	@widgets/scan_table_view/a0_pointSpecWidget.py

3 
äom
 
PyQt5
 
impÜt
 
	gQtGui
, 
	gQtCÜe
, 
	guic
, 
QtWidg‘s


5 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
ba£SÿnTabË
 
impÜt
 *

7 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
muÉiRegiÚWidg‘
 
impÜt
 
MuÉiRegiÚWidg‘


8 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
¥©ŸlS–Widg‘
 
impÜt
 
S·tŸlS–Widg‘


9 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
evS–Widg‘
 
impÜt
 
EÃrgyS–Widg‘


10 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
pŞ¬™yS–Widg‘
 
impÜt
 
PŞ¬™yS–Widg‘


12 
äom
 
	gşs
.
	gsÿÂšg
.
¶ugšs
 
impÜt
 
¶ugš_dœ


15 
şass
 
	$A0_CÚfigWidg‘
(
QtWidg‘s
.
QF¿me
):

17 
A
 
QWidg‘
 
th©
 
cÚšs
 
ª
 
EÃrgySÿnTabËV›w


20 
def
 
	$__š™__
(
£lf
, 
¥£l
, 
ev£l
, 
pŞ£l
):

22 
	$__š™__
(): 
desütiÚ


24 :
·¿m
 
pŞ_£l_widg‘
=
NÚe
:…Ş_£l_widg‘=NÚ
desütiÚ


25 :
ty³
 
pŞ_£l_widg‘
=
NÚe
:…ol_sel_widget=Noneype

27 :
»tuºs
: 
NÚe


29 
QtWidg‘s
.
QF¿me
.
	$__š™__
(
£lf
)

30 
uic
.
	`lßdUi
Ğ
¶ugš_dœ
 + '/twİošt_pošt_¥ec.ui', 
£lf
)

32 
£lf
.
muÉi
 = 
	$MuÉiRegiÚWidg‘
(
u£_ûÁ”
=
F®£
, 
is_pošt
=
True
, 
’abË_muÉi_¥©Ÿl
=True, 
sšgË_ev_mod–
=True)

33 
£lf
.
muÉi
.
	$’abË_add_¥©Ÿl_»giÚ_m’u
(
True
)

34 
£lf
.
muÉi
.
	$show_lßd_bŠ
()

35 
£lf
.
muÉi
.
	$show_g‘d©a_bŠ
()

37 
£lf
.
¥_mod–
 = s–f.
muÉi
.
	$g‘_¥©Ÿl_mod–
()

38 
£lf
.
ev_mod–
 = s–f.
muÉi
.
	$g‘_’”gy_mod–
()

40 
vbox
 = 
QtWidg‘s
.
	$QVBoxLayout
()

41 
vbox
.
	$addWidg‘
(
£lf
.
muÉi
)

43 
£lf
.
¥©ŸlG½Box
.
	$£tLayout
(
vbox
)

45 
def
 
	$Ú_£l_bŠ_şicked
(
£lf
, 
chkd
):

46 
bŠ
 = 
£lf
.
	$£nd”
()

47 
´št
 
bŠ


48 if(
chkd
):

49 
´št
 'btn is checked'

51 
´št
 'btn is NOT checked'

53 
__Çme__
 == '__main__':

54 
impÜt
 
sys


55 
äom
 
şs
.
­pWidg‘s
.
¥yd”_cÚsŞe
 
impÜt
 
Sh–lWidg‘
#, 
Sh–lDock


57 
	$log_to_qt
()

58 
­p
 = 
QtWidg‘s
.
	$QAµliÿtiÚ
(
sys
.
¬gv
)

60 
pŞ£l
 = 
	$PŞ¬™yS–Widg‘
()

61 
ev£l
 = 
	$EÃrgyS–Widg‘
(
pŞ_£l_widg‘
=
pŞ£l
)

62 
ev£l
.
	$’abË_add_»giÚ
(
True
)

63 
¥£l
 = 
	$S·tŸlS–Widg‘
(
ev_£l_widg‘
=
ev£l
)

64 
maš
 = 
	$A0_CÚfigWidg‘
(
¥£l
, 
ev£l
, 
pŞ£l
)

66 
ns
 = {'ev£l': 
ev£l
, 'pŞ£l': 
pŞ£l
, 'maš': 
maš
, 'g':
	`glob®s
(è
	}
}

68 
pythÚsh–l
 = 
	$Sh–lWidg‘
(
·»Á
=
NÚe
, 
Çme¥aû
=
ns
,
commªds
=[], 
muÉ™h»aded
=
True
)

70 #maš.
	`Ïyout
().
	`addWidg‘
(
pythÚsh–l
)

72 
maš
.
	$show
()

74 
sys
.
	`ex™
(
­p
.
	`exec_
())

	@widgets/scan_table_view/arbitraryLineTableModel.py

2 
C»©ed
 
Ú
 
	gNov
 16, 2016

4 @
	gauthÜ
: 
b”gr


7 
äom
 
şs
.
­¶iÿtiÚs
.
pyStxm
.
widg‘s
.
sÿn_bË_v›w
.
ba£SÿnTabË
 
impÜt
 *

8 
äom
 
şs
.
uts
.
roi_diù_defs
 
impÜt
 *

11 
şass
 
	$Arb™¿ryLšeSÿnTabËMod–
(
Ba£SÿnTabËMod–
):

13 
def
 
	$__š™__
(
£lf
, 
hdrLi¡
, 
d©aš
, 
·»Á
 = 
NÚe
, 
u£_ûÁ”
=
F®£
, *
¬gs
):

15 
	$__š™__
(): 
desütiÚ


17 :
·¿m
 
hdrLi¡
: hdrLi¡ 
desütiÚ


18 :
ty³
 
hdrLi¡
: hdrListype

20 :
·¿m
 
d©aš
: d©aš 
desütiÚ


21 :
ty³
 
d©aš
: datainype

23 :
·¿m
 
·»Á
=
NÚe
:…¬’t=NÚ
desütiÚ


24 :
ty³
 
·»Á
=
NÚe
:…arent=Noneype

26 :
·¿m
 *
¬gs
: *¬g 
desütiÚ


27 :
ty³
 *
¬gs
: *argsype

29 :
»tuºs
: 
NÚe


31 #QtCÜe.
QAb¡¿ùTabËMod–
.
	`__š™__
(
£lf
, 
·»Á
, *
¬gs
)

32 
	`su³r
(
Arb™¿ryLšeSÿnTabËMod–
, 
£lf
).
	`__š™__
Ğ
hdrLi¡
, 
d©aš
, 
·»Á
, *
¬gs
)

33 #¨
diù
 
th©
 
wl
 
u£
 
¥©Ÿl
 
»giÚ
 
sÿn_id
' a keyØEÃrgyRegiÚSÿnDef'
s


34 
£lf
.
cur_sÿn_row
 = 
NÚe


35 
£lf
.
sÿnLi¡D©a
 = 
d©aš


36 
£lf
.
ed™abË
 = 
F®£


37 if('C’‹rX' 
š
 
hdrLi¡
):

38 
£lf
.
cŞumn_m­
 = 
C_SPATIAL_DCT


40 
£lf
.
cŞumn_m­
 = 
S_SPATIAL_DCT


42 
£lf
.
	`£t_mš_rows
(0)

43 
£lf
.
	`£t_max_rows
(20)

46 
def
 
	$d©a
(
£lf
, 
šdex
, 
rŞe
):

48 
ov”ride
 
ba£
 
bË
 
mod–
 
d©a
 
funùiÚ


49 
	$d©a
(): 
desütiÚ


51 :
·¿m
 
šdex
: index 
desütiÚ


52 :
ty³
 
šdex
: indexype

54 :
·¿m
 
rŞe
:„Ş
desütiÚ


55 :
ty³
 
rŞe
:„oleype

57 :
»tuºs
: 
NÚe


60 
row
 = 
šdex
.
	`row
()

61 
cŞ
 = 
šdex
.
	`cŞumn
()

62 
’abËd
 = 
F®£


64 
nÙ
 
šdex
.
	$isV®id
():

65 
´št
 'index is invalid'

66  
NÚe


68 
æags
 = 
šdex
.
	`æags
()

69 
æags
 & 
QtCÜe
.
Qt
.
I‹mIsEd™abË
:

70 
’abËd
 = 
True


72 
rŞe
 =ğ
QtCÜe
.
Qt
.
Di¥ÏyRŞe
:

73 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

74 if(
cŞ
 == 0):

75 
v
 = 
sÿn
[
SPDB_ID_VAL
]

77 
v
 = 
	`g‘_v®_äom_¥_db
(
£lf
.
cŞumn_m­
[
cŞ
]['hdr'], 
sÿn
)

78 #v = 
sÿn
[
£lf
.
cŞumn_m­
[
cŞ
]['hdr']]

80 if(
	$ty³
(
v
è
is
 
¡r
):

81 (
v
)

82 if(
	$ty³
(
v
è
is
 
Å
.
æßt64
):

83 
v®
 = '%.3f' % 
v


84 (
v®
)

85 if(
	$ty³
(
v
è
is
 ):

86 
v®
 = '%.3f' % 
v


87 (
v®
)

88 if(
	$ty³
(
v
è
is
 ):

89 
v®
 = '%d' % 
v


90 (
v®
)

91 if(
	$ty³
(
v
è
is
 ):

92 
v®
 = '%d' % 
v


93 (
v®
)

94 if(
	$ty³
(
v
è
is
 
boŞ
):

95 if(
v
):

100 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
BackgroundRŞe
:

101 if(
cŞ
 == 0):

102 
bg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
g¿y
)

103 
	`–if
(
cŞ
 < 5):

104 
bg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
lightG¿y
)

107 if(
’abËd
):

108 
bg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
wh™e
)

110 
bg
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(220, 220, 220))

111  
bg


112 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
FÜegroundRŞe
:

113 if(
’abËd
):

114 
fg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
bÏck
)

116 
fg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
blue
)

117  
fg


118 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
FÚtRŞe
:

119 
ât
 = 
QtGui
.
	`QFÚt
()

120 
ât
.
	`£tPoštSize
(
TABLE_FONT_SIZE
)

121 if(
cŞ
 == 0):

122 
ât
.
	`£tBŞd
(
True
)

123  
ât


124 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
TextAlignm’tRŞe
:

125 ià(
cŞ
 == 0):

126 (
QtCÜe
.
Qt
.
AlignLeá
)

128 #»tuº(
QtCÜe
.
Qt
.
AlignRight
)

129 (
QtCÜe
.
Qt
.
AlignC’‹r
)

132 #´šˆ'»tuºšg NÚ[%d,%d]„Şğ%d' % (
row
,
cŞ
, 
rŞe
)

133  
NÚe


135 
def
 
	$£tD©a
(
£lf
, 
šdex
, 
v®ue
, 
rŞe
, 
»ÿlc
=
True
, 
do_sigÇl
=True):

137 
	$£tD©a
(): 
desütiÚ


139 :
·¿m
 
šdex
: index 
desütiÚ


140 :
ty³
 
šdex
: indexype

142 :
·¿m
 
v®ue
: v®u
desütiÚ


143 :
ty³
 
v®ue
: valueype

145 :
·¿m
 
rŞe
:„Ş
desütiÚ


146 :
ty³
 
rŞe
:„oleype

148 :
·¿m
 
»ÿlc
=
True
:„eÿlc=Tru
desütiÚ


149 :
ty³
 
»ÿlc
=
True
:„ecalc=Trueype

151 :
·¿m
 
do_sigÇl
=
True
: do_sigÇl=Tru
desütiÚ


152 :
ty³
 
do_sigÇl
=
True
: do_signal=Trueype

154 :
»tuºs
: 
NÚe


156 
row
 = 
šdex
.
	`row
()

157 
cŞ
 = 
šdex
.
	`cŞumn
()

158 
ok
 = 
True


159 if(
rŞe
 =ğ
QtCÜe
.
Qt
.
Ed™RŞe
):

161 if(
cŞ
 == 0):

162  
True


163 #v®, 
ok
 = 
v®ue
.
	`toLÚgLÚg
()

164 
	`–if
(
cŞ
 == 10):

165 
v®
 = 
	`¡r
(
v®ue
.
	`toSŒšg
())

166 if(
	`Ën
(
v®
) < 1):

167 
ok
 = 
F®£


169 
v®
 = (
v®ue
)

171 #ÿÎ 
the
 
assocŸ‹d
 
£‰”
 
funùiÚ
 
this
 
	`cŞumn
 (thi 
is
 
£tup
 
š
h
sÿn
 
defš™iÚ
 
şass


172 if(
ok
):

173 #Úly 
chªge
 
the
 
v®ue
 th
u£r
 
’‹»d
 
a
 value

174 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

175 
roi
 = 
	`g‘_roi_äom_¥_db
(
£lf
.
cŞumn_m­
[
cŞ
]['hdr'], 
sÿn
)

176 
	`£t_f›ld_v®_š_¥_db
(
£lf
.
cŞumn_m­
[
cŞ
]['hdr'], 
v®
, 
sÿn
)

177 
func
 = 
£lf
.
cŞumn_m­
[
cŞ
]['func']

179 if(
£lf
.
cŞumn_m­
[
cŞ
]['hdr'] == 'NPOINTSX'):

180 
func
 = 
£lf
.
cŞumn_m­
[
cŞ
]['func']

181 #now 
ÿÎ
 
the
 
»£pùive
 
funùiÚ
 
to
 
»ÿlc
h
sÿn
 
·¿ms


182 
	`func
(
roi
)

183 #£ˆ
the
 
NPOINTSY
 
f›ld
 
to
 
be
 
§me
 
numb”
 
of
 
pošts


184 
roi
 = 
	`g‘_roi_äom_¥_db
(
£lf
.
cŞumn_m­
[
cŞ
+1]['hdr'], 
sÿn
)

185 
	`£t_f›ld_v®_š_¥_db
(
£lf
.
cŞumn_m­
[
cŞ
+1]['hdr'], 
v®
, 
sÿn
)

186 
func
 = 
£lf
.
cŞumn_m­
[
cŞ
+1]['func']

187 #now 
ÿÎ
 
the
 
»£pùive
 
funùiÚ
 
to
 
»ÿlc
h
sÿn
 
·¿ms


188 
	`func
(
roi
)

190 if(
£lf
.
cŞumn_m­
[
cŞ
]['hdr'] == 'STEPX'):

191 
func
 = 
£lf
.
cŞumn_m­
[
cŞ
]['func']

192 #now 
ÿÎ
 
the
 
»£pùive
 
funùiÚ
 
to
 
»ÿlc
h
sÿn
 
·¿ms


193 
	`func
(
roi
)

194 #£ˆ
the
 
STEPY
 
f›ld
 
to
 
be
 
§me
 
¡•
 
size


195 
roi
 = 
	`g‘_roi_äom_¥_db
(
£lf
.
cŞumn_m­
[
cŞ
+1]['hdr'], 
sÿn
)

196 
	`£t_f›ld_v®_š_¥_db
(
£lf
.
cŞumn_m­
[
cŞ
+1]['hdr'], 
v®
, 
sÿn
)

197 
func
 = 
£lf
.
cŞumn_m­
[
cŞ
+1]['func']

198 #now 
ÿÎ
 
the
 
»£pùive
 
funùiÚ
 
to
 
»ÿlc
h
sÿn
 
·¿ms


199 
	`func
(
roi
)

202 #fÜû 
the
 
row
 
to
 
»ÿlc


203 if(
»ÿlc
):

204 #now 
ÿÎ
 
the
 
»£pùive
 
funùiÚ
 
to
 
»ÿlc
h
sÿn
 
·¿ms


205 
	`func
(
roi
)

206 #´šˆ'£tD©¨BTM:„eù' , 
sÿn
[
SPDB_RECT
]

207 if((
rŞe
 =ğ
QtCÜe
.
Qt
.
Ed™RŞe
è
	$Ü
 (
rŞe
 =ğ
QtCÜe
.
Qt
.
Di¥ÏyRŞe
)):

208 #mu¡ 
em™
 
this
 
as
 
·¹
 
of
 
the
 
äamewÜk
 
suµÜt
 
ª
 
ed™abË
 
Ab¡¿ùTabËMod–


209 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

210 
£lf
.
d©aChªged
.
	`em™
(
šdex
, index)

212 if(
do_sigÇl
):

214 
£lf
.
sÿn_chªged
.
	`em™
(
row
, 
sÿn
)

216  
True


218 
def
 
	$modify_d©a
(
£lf
, 
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
=
F®£
):

220 
	$modify_d©a
(): 
desütiÚ


222 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


223 :
ty³
 
sÿn_id
: scan_idype

225 :
·¿m
 
Ãwsÿn
:‚ewsÿÀ
desütiÚ


226 :
ty³
 
Ãwsÿn
:‚ewscanype

228 :
·¿m
 
do_¡•_Åts
=
F®£
: do_¡•_Åts=F®£ 
desütiÚ


229 :
ty³
 
do_¡•_Åts
=
F®£
: do_step_npts=Falseype

231 :
»tuºs
: 
NÚe


234 
£lf
.
	`»¶aû_sÿn
(
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
)

235 
£lf
.
d©aChªged
.
	`em™
(
QtCÜe
.
	`QMod–Index
(), QtCore.QModelIndex())

	@widgets/scan_table_view/arbitraryLineTableModel.py

2 
C»©ed
 
Ú
 
	gNov
 16, 2016

4 @
	gauthÜ
: 
b”gr


7 
äom
 
şs
.
­¶iÿtiÚs
.
pyStxm
.
widg‘s
.
sÿn_bË_v›w
.
ba£SÿnTabË
 
impÜt
 *

8 
äom
 
şs
.
uts
.
roi_diù_defs
 
impÜt
 *

11 
şass
 
	$Arb™¿ryLšeSÿnTabËMod–
(
Ba£SÿnTabËMod–
):

13 
def
 
	$__š™__
(
£lf
, 
hdrLi¡
, 
d©aš
, 
·»Á
 = 
NÚe
, 
u£_ûÁ”
=
F®£
, *
¬gs
):

15 
	$__š™__
(): 
desütiÚ


17 :
·¿m
 
hdrLi¡
: hdrLi¡ 
desütiÚ


18 :
ty³
 
hdrLi¡
: hdrListype

20 :
·¿m
 
d©aš
: d©aš 
desütiÚ


21 :
ty³
 
d©aš
: datainype

23 :
·¿m
 
·»Á
=
NÚe
:…¬’t=NÚ
desütiÚ


24 :
ty³
 
·»Á
=
NÚe
:…arent=Noneype

26 :
·¿m
 *
¬gs
: *¬g 
desütiÚ


27 :
ty³
 *
¬gs
: *argsype

29 :
»tuºs
: 
NÚe


31 #QtCÜe.
QAb¡¿ùTabËMod–
.
	`__š™__
(
£lf
, 
·»Á
, *
¬gs
)

32 
	`su³r
(
Arb™¿ryLšeSÿnTabËMod–
, 
£lf
).
	`__š™__
Ğ
hdrLi¡
, 
d©aš
, 
·»Á
, *
¬gs
)

33 #¨
diù
 
th©
 
wl
 
u£
 
¥©Ÿl
 
»giÚ
 
sÿn_id
' a keyØEÃrgyRegiÚSÿnDef'
s


34 
£lf
.
cur_sÿn_row
 = 
NÚe


35 
£lf
.
sÿnLi¡D©a
 = 
d©aš


36 
£lf
.
ed™abË
 = 
F®£


37 if('C’‹rX' 
š
 
hdrLi¡
):

38 
£lf
.
cŞumn_m­
 = 
C_SPATIAL_DCT


40 
£lf
.
cŞumn_m­
 = 
S_SPATIAL_DCT


42 
£lf
.
	`£t_mš_rows
(0)

43 
£lf
.
	`£t_max_rows
(20)

46 
def
 
	$d©a
(
£lf
, 
šdex
, 
rŞe
):

48 
ov”ride
 
ba£
 
bË
 
mod–
 
d©a
 
funùiÚ


49 
	$d©a
(): 
desütiÚ


51 :
·¿m
 
šdex
: index 
desütiÚ


52 :
ty³
 
šdex
: indexype

54 :
·¿m
 
rŞe
:„Ş
desütiÚ


55 :
ty³
 
rŞe
:„oleype

57 :
»tuºs
: 
NÚe


60 
row
 = 
šdex
.
	`row
()

61 
cŞ
 = 
šdex
.
	`cŞumn
()

62 
’abËd
 = 
F®£


64 
nÙ
 
šdex
.
	$isV®id
():

65 
´št
 'index is invalid'

66  
NÚe


68 
æags
 = 
šdex
.
	`æags
()

69 
æags
 & 
QtCÜe
.
Qt
.
I‹mIsEd™abË
:

70 
’abËd
 = 
True


72 
rŞe
 =ğ
QtCÜe
.
Qt
.
Di¥ÏyRŞe
:

73 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

74 if(
cŞ
 == 0):

75 
v
 = 
sÿn
[
SPDB_ID_VAL
]

77 
v
 = 
	`g‘_v®_äom_¥_db
(
£lf
.
cŞumn_m­
[
cŞ
]['hdr'], 
sÿn
)

78 #v = 
sÿn
[
£lf
.
cŞumn_m­
[
cŞ
]['hdr']]

80 if(
	$ty³
(
v
è
is
 
¡r
):

81 (
v
)

82 if(
	$ty³
(
v
è
is
 
Å
.
æßt64
):

83 
v®
 = '%.3f' % 
v


84 (
v®
)

85 if(
	$ty³
(
v
è
is
 ):

86 
v®
 = '%.3f' % 
v


87 (
v®
)

88 if(
	$ty³
(
v
è
is
 ):

89 
v®
 = '%d' % 
v


90 (
v®
)

91 if(
	$ty³
(
v
è
is
 ):

92 
v®
 = '%d' % 
v


93 (
v®
)

94 if(
	$ty³
(
v
è
is
 
boŞ
):

95 if(
v
):

100 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
BackgroundRŞe
:

101 if(
cŞ
 == 0):

102 
bg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
g¿y
)

103 
	`–if
(
cŞ
 < 5):

104 
bg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
lightG¿y
)

107 if(
’abËd
):

108 
bg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
wh™e
)

110 
bg
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(220, 220, 220))

111  
bg


112 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
FÜegroundRŞe
:

113 if(
’abËd
):

114 
fg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
bÏck
)

116 
fg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
blue
)

117  
fg


118 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
FÚtRŞe
:

119 
ât
 = 
QtGui
.
	`QFÚt
()

120 
ât
.
	`£tPoštSize
(
TABLE_FONT_SIZE
)

121 if(
cŞ
 == 0):

122 
ât
.
	`£tBŞd
(
True
)

123  
ât


124 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
TextAlignm’tRŞe
:

125 ià(
cŞ
 == 0):

126 (
QtCÜe
.
Qt
.
AlignLeá
)

128 #»tuº(
QtCÜe
.
Qt
.
AlignRight
)

129 (
QtCÜe
.
Qt
.
AlignC’‹r
)

132 #´šˆ'»tuºšg NÚ[%d,%d]„Şğ%d' % (
row
,
cŞ
, 
rŞe
)

133  
NÚe


135 
def
 
	$£tD©a
(
£lf
, 
šdex
, 
v®ue
, 
rŞe
, 
»ÿlc
=
True
, 
do_sigÇl
=True):

137 
	$£tD©a
(): 
desütiÚ


139 :
·¿m
 
šdex
: index 
desütiÚ


140 :
ty³
 
šdex
: indexype

142 :
·¿m
 
v®ue
: v®u
desütiÚ


143 :
ty³
 
v®ue
: valueype

145 :
·¿m
 
rŞe
:„Ş
desütiÚ


146 :
ty³
 
rŞe
:„oleype

148 :
·¿m
 
»ÿlc
=
True
:„eÿlc=Tru
desütiÚ


149 :
ty³
 
»ÿlc
=
True
:„ecalc=Trueype

151 :
·¿m
 
do_sigÇl
=
True
: do_sigÇl=Tru
desütiÚ


152 :
ty³
 
do_sigÇl
=
True
: do_signal=Trueype

154 :
»tuºs
: 
NÚe


156 
row
 = 
šdex
.
	`row
()

157 
cŞ
 = 
šdex
.
	`cŞumn
()

158 
ok
 = 
True


159 if(
rŞe
 =ğ
QtCÜe
.
Qt
.
Ed™RŞe
):

161 if(
cŞ
 == 0):

162  
True


163 #v®, 
ok
 = 
v®ue
.
	`toLÚgLÚg
()

164 
	`–if
(
cŞ
 == 10):

165 
v®
 = 
	`¡r
(
v®ue
.
	`toSŒšg
())

166 if(
	`Ën
(
v®
) < 1):

167 
ok
 = 
F®£


169 
v®
 = (
v®ue
)

171 #ÿÎ 
the
 
assocŸ‹d
 
£‰”
 
funùiÚ
 
this
 
	`cŞumn
 (thi 
is
 
£tup
 
š
h
sÿn
 
defš™iÚ
 
şass


172 if(
ok
):

173 #Úly 
chªge
 
the
 
v®ue
 th
u£r
 
’‹»d
 
a
 value

174 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

175 
roi
 = 
	`g‘_roi_äom_¥_db
(
£lf
.
cŞumn_m­
[
cŞ
]['hdr'], 
sÿn
)

176 
	`£t_f›ld_v®_š_¥_db
(
£lf
.
cŞumn_m­
[
cŞ
]['hdr'], 
v®
, 
sÿn
)

177 
func
 = 
£lf
.
cŞumn_m­
[
cŞ
]['func']

179 if(
£lf
.
cŞumn_m­
[
cŞ
]['hdr'] == 'NPOINTSX'):

180 
func
 = 
£lf
.
cŞumn_m­
[
cŞ
]['func']

181 #now 
ÿÎ
 
the
 
»£pùive
 
funùiÚ
 
to
 
»ÿlc
h
sÿn
 
·¿ms


182 
	`func
(
roi
)

183 #£ˆ
the
 
NPOINTSY
 
f›ld
 
to
 
be
 
§me
 
numb”
 
of
 
pošts


184 
roi
 = 
	`g‘_roi_äom_¥_db
(
£lf
.
cŞumn_m­
[
cŞ
+1]['hdr'], 
sÿn
)

185 
	`£t_f›ld_v®_š_¥_db
(
£lf
.
cŞumn_m­
[
cŞ
+1]['hdr'], 
v®
, 
sÿn
)

186 
func
 = 
£lf
.
cŞumn_m­
[
cŞ
+1]['func']

187 #now 
ÿÎ
 
the
 
»£pùive
 
funùiÚ
 
to
 
»ÿlc
h
sÿn
 
·¿ms


188 
	`func
(
roi
)

190 if(
£lf
.
cŞumn_m­
[
cŞ
]['hdr'] == 'STEPX'):

191 
func
 = 
£lf
.
cŞumn_m­
[
cŞ
]['func']

192 #now 
ÿÎ
 
the
 
»£pùive
 
funùiÚ
 
to
 
»ÿlc
h
sÿn
 
·¿ms


193 
	`func
(
roi
)

194 #£ˆ
the
 
STEPY
 
f›ld
 
to
 
be
 
§me
 
¡•
 
size


195 
roi
 = 
	`g‘_roi_äom_¥_db
(
£lf
.
cŞumn_m­
[
cŞ
+1]['hdr'], 
sÿn
)

196 
	`£t_f›ld_v®_š_¥_db
(
£lf
.
cŞumn_m­
[
cŞ
+1]['hdr'], 
v®
, 
sÿn
)

197 
func
 = 
£lf
.
cŞumn_m­
[
cŞ
+1]['func']

198 #now 
ÿÎ
 
the
 
»£pùive
 
funùiÚ
 
to
 
»ÿlc
h
sÿn
 
·¿ms


199 
	`func
(
roi
)

202 #fÜû 
the
 
row
 
to
 
»ÿlc


203 if(
»ÿlc
):

204 #now 
ÿÎ
 
the
 
»£pùive
 
funùiÚ
 
to
 
»ÿlc
h
sÿn
 
·¿ms


205 
	`func
(
roi
)

206 #´šˆ'£tD©¨BTM:„eù' , 
sÿn
[
SPDB_RECT
]

207 if((
rŞe
 =ğ
QtCÜe
.
Qt
.
Ed™RŞe
è
	$Ü
 (
rŞe
 =ğ
QtCÜe
.
Qt
.
Di¥ÏyRŞe
)):

208 #mu¡ 
em™
 
this
 
as
 
·¹
 
of
 
the
 
äamewÜk
 
suµÜt
 
ª
 
ed™abË
 
Ab¡¿ùTabËMod–


209 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

210 
£lf
.
d©aChªged
.
	`em™
(
šdex
, index)

212 if(
do_sigÇl
):

214 
£lf
.
sÿn_chªged
.
	`em™
(
row
, 
sÿn
)

216  
True


218 
def
 
	$modify_d©a
(
£lf
, 
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
=
F®£
):

220 
	$modify_d©a
(): 
desütiÚ


222 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


223 :
ty³
 
sÿn_id
: scan_idype

225 :
·¿m
 
Ãwsÿn
:‚ewsÿÀ
desütiÚ


226 :
ty³
 
Ãwsÿn
:‚ewscanype

228 :
·¿m
 
do_¡•_Åts
=
F®£
: do_¡•_Åts=F®£ 
desütiÚ


229 :
ty³
 
do_¡•_Åts
=
F®£
: do_step_npts=Falseype

231 :
»tuºs
: 
NÚe


234 
£lf
.
	`»¶aû_sÿn
(
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
)

235 
£lf
.
d©aChªged
.
	`em™
(
QtCÜe
.
	`QMod–Index
(), QtCore.QModelIndex())

	@widgets/scan_table_view/baseScanTable.py

2 
C»©ed
 
	gÚ
 2013-05-16

4 @
	gauthÜ
: 
b”gr


6 
impÜt
 
numpy
 
as
 
Å


7 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
	gQtWidg‘s


8 
impÜt
 
	gcİy


10 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


11 
äom
 
	gşs
.
	guts
.
roi_uts
 
impÜt
 
	gg‘_ba£_roi
, 
	gg‘_ba£_’”gy_roi
, \

12 
	gg‘_•u_pŞ_dù
, 
	gmake_¥©Ÿl_db_diù
, 
	gwidg‘_com_cmnd_ty³s
, \

13 
	gÚ_¿nge_chªged
, 
	gÚ_Åošts_chªged
, 
	gÚ_¡•_size_chªged
, 
	gÚ_¡¬t_chªged
, 
	gÚ_¡İ_chªged
, \

14 
	gÚ_ûÁ”_chªged
, 
	g»ÿlc_£ošts
, 
	gg‘_unique_roi_id


16 
äom
 
	gşs
.
	gsÿÂšg
.
¡xmTy³s
 
impÜt
 
	gsÿn_ty³s
, 
	gsÿn_·Ãl_Üd”
, 
	gsÿn_image_ty³s
, 
	g¥©Ÿl_ty³_´efix
, 
	gIMAGE_LXL
, 
	gIMAGE_PXP
, 
	g’”gy_sÿn_Üd”_ty³s


17 
äom
 
	gşs
.
	guts
.
diù_uts
 
impÜt
 
	gdù_put
, 
	gdù_g‘


18 
äom
 
	gşs
.
	guts
.
roi_diù_defs
 
	gimpÜt
 *

20 
äom
 
	gbcm
.
	gdeviû
.
deviû_Çmes
 
	gimpÜt
 *

22 
	g_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

24 #thi 
is
 
the
 
v®ue
 
th©
 
wl
 
be
 
added
 
to
h
¡¬t
 
ªd
 
’d
 
of
 
—ch
 
exŒa
 
EV
 
»giÚ


25 
EV_SCAN_EDGE_RANGE
 = 0.2

26 
TABLE_FONT_SIZE
 = 8

28 
SPATIAL_CNTR
 = 1000

29 
EV_CNTR
 = 500

30 
POL_CNTR
 = 0

32 
MAX_SPATIAL_ROWS
 = 20

33 #£lf.
£tStyËSh“t
("color: blue;"

34 #"
background
-
cŞÜ
: 
rgb
(114, 148, 240);"

35 #"
£ËùiÚ
-
cŞÜ
: 
y–low
;"

36 #"
£ËùiÚ
-
background
-
cŞÜ
: 
blue
;")

39 
SPATIAL_SS
 = "QHeaderView::section {background:„gb(200,200, 200);background-color:„gb(200,200, 200); selection-background-color: ; selection-color: ;} background-color:„gb(200,200, 200); selection-background-color: ; selection-color: ;"

40 
EV_SS
 = "QHeaderView::section {background:„gb(200,200, 200);background-color:„gb(200,200, 200); selection-background-color: ; selection-color: ;}background-color:„gb(220,220, 220); selection-background-color: ; selection-color: ;"

41 
POL_SS
 = "QHeaderView::section {background:„gb(200,200, 200);background-color:„gb(200,200, 200); selection-background-color: ; selection-color: ;}background-color:„gb(240,240, 240); selection-background-color: ; selection-color: ;"

43 
SPATIAL_SS
 = ""

44 
EV_SS
 = ""

45 
POL_SS
 = ""

47 
def
 
	$make_1d_¬¿y
(
num±s
, 
v®
):

48 
¬r
 = 
Å
.
	`Úes
(
num±s
)

49 
¬r
[:] = 
v®


50 (
¬r
)

52 
şass
 
	$SÿnO±iÚE¼Ü
(
Exû±iÚ
):

54 
def
 
	$__š™__
(
£lf
, 
msg
):

56 
	$__š™__
(): 
desütiÚ


58 :
·¿m
 
msg
: msg 
desütiÚ


59 :
ty³
 
msg
: msgype

61 :
»tuºs
: 
NÚe


63 
£lf
.
msg
 = msg

64 
def
 
	$__¡r__
(
£lf
):

66 
	$__¡r__
(): 
desütiÚ


68 :
»tuºs
: 
NÚe


70  
	`»´
(
£lf
.
msg
)

73 #QTabËWidg‘ 
sigÇls


74 #void 
	`ûÎAùiv©ed
 ( 
row
, 
cŞumn
 )

75 #void 
	`ûÎChªged
 ( 
row
, 
cŞumn
 )

76 #void 
	`ûÎClicked
 ( 
row
, 
cŞumn
 )

77 #void 
	`ûÎDoubËClicked
 ( 
row
, 
cŞumn
 )

78 #void 
	`ûÎEÁ”ed
 ( 
row
, 
cŞumn
 )

79 #void 
	`ûÎP»s£d
 ( 
row
, 
cŞumn
 )

80 #void 
	`cu¼’tC–lChªged
 ( 
cu¼’tRow
, 
cu¼’tCŞumn
, 
´eviousRow
, 
´eviousCŞumn
 )

81 #void 
	`cu¼’tI‹mChªged
 ( 
QTabËWidg‘I‹m
 * 
cu¼’t
, QTabËWidg‘I‹m * 
´evious
 )

82 #void 
	`™emAùiv©ed
 ( 
QTabËWidg‘I‹m
 * 
™em
 )

83 #void 
	`™emChªged
 ( 
QTabËWidg‘I‹m
 * 
™em
 )

84 #void 
	`™emClicked
 ( 
QTabËWidg‘I‹m
 * 
™em
 )

85 #void 
	`™emDoubËClicked
 ( 
QTabËWidg‘I‹m
 * 
™em
 )

86 #void 
	`™emEÁ”ed
 ( 
QTabËWidg‘I‹m
 * 
™em
 )

87 #void 
	`™emP»s£d
 ( 
QTabËWidg‘I‹m
 * 
™em
 )

88 #void 
	`™emS–eùiÚChªged
 ()

91 
şass
 
	$Ba£SÿnTabËMod–
(
QtCÜe
.
QAb¡¿ùTabËMod–
):

93 
sÿn_chªged
 = 
QtCÜe
.
	`pyqtSigÇl
(, 
objeù
)

95 
def
 
	$__š™__
(
£lf
, 
hdrLi¡
=[], 
d©aš
=[[]], 
·»Á
 = 
NÚe
, *
¬gs
):

97 
	$__š™__
(): 
desütiÚ


99 :
·¿m
 
hdrLi¡
=[]: hdrLi¡=[] 
desütiÚ


100 :
ty³
 
hdrLi¡
=[]: hdrList=[]ype

102 :
·¿m
 
d©aš
=[[]]: d©aš=[[]] 
desütiÚ


103 :
ty³
 
d©aš
=[[]]: datain=[[]]ype

105 :
·¿m
 
·»Á
=
NÚe
:…¬’t=NÚ
desütiÚ


106 :
ty³
 
·»Á
=
NÚe
:…arent=Noneype

108 :
·¿m
 *
¬gs
: *¬g 
desütiÚ


109 :
ty³
 *
¬gs
: *argsype

111 :
»tuºs
: 
NÚe


113 #QtCÜe.
QAb¡¿ùTabËMod–
.
	`__š™__
(
£lf
, 
·»Á
, *
¬gs
)

114 
	`su³r
(
Ba£SÿnTabËMod–
, 
£lf
).
	`__š™__
(
·»Á
, *
¬gs
)

115 
£lf
.
sÿnLi¡D©a
 = 
	`li¡
(
d©aš
)

116 
£lf
.
hdrLi¡
 = 
	`li¡
(hdrList)

117 
£lf
.
sÿnProg»ss
 = {
	}
}

118 
£lf
.
cur_sÿn_id
 = 0

119 
£lf
.
cŞumn_m­
 = 
NÚe


121 
£lf
.
mš_rows
 = 0

122 
£lf
.
max_rows
 = 1

124 
£lf
.
v®id_¿nge
 = (
NÚe
, None, None, None)

126 #hav
a
 
way
 
to
 
£t
 
¥ecific
 
rows
 
Ü
 
cŞumns
 
»ad
 
Úly


127 
£lf
.
rd_Úly_rows
 = {}

128 
£lf
.
rd_Úly_cŞs
 = {}

130 
£lf
.
_g‘_funcs
 = []

131 
£lf
.
_£t_funcs
 = []

133 
def
 
	$g‘_cŞumn_w™h_Çme
(
£lf
, 
Çme
):

134 
i
 = 0

135 
™em
 
š
 
£lf
.
cŞumn_m­
:

136 if(
™em
['hdr'] =ğ
Çme
):

137 (
i
)

138 
i
 += 1

139 (
NÚe
)

141 
def
 
	$£t_mš_rows
(
£lf
, 
v®
):

143 
	$£t_mš_rows
(): 
desütiÚ


145 :
·¿m
 
v®
: v® 
desütiÚ


146 :
ty³
 
v®
: valype

148 :
»tuºs
: 
NÚe


150 
£lf
.
mš_rows
 = 
v®


152 
def
 
	$£t_max_rows
(
£lf
, 
v®
):

154 
	$£t_max_rows
(): 
desütiÚ


156 :
·¿m
 
v®
: v® 
desütiÚ


157 :
ty³
 
v®
: valype

159 :
»tuºs
: 
NÚe


161 
£lf
.
max_rows
 = 
v®


163 
def
 
	$£t_sÿn_li¡
(
£lf
, 
sÿnLi¡
):

165 
	$£t_sÿn_li¡
(): 
desütiÚ


167 :
·¿m
 
sÿnLi¡
: sÿnLi¡ 
desütiÚ


168 :
ty³
 
sÿnLi¡
: scanListype

170 :
»tuºs
: 
NÚe


172 
£lf
.
sÿnLi¡D©a
 = 
sÿnLi¡
[:]

174 
def
 
	$g‘_sÿn_li¡
(
£lf
):

176 
	$g‘_sÿn_li¡
(): 
desütiÚ


178 :
»tuºs
: 
NÚe


180 #»tuº 
a
 
cİy


181 (
£lf
.
sÿnLi¡D©a
[:])

183 
def
 
	$£t_ed™abË
(
£lf
, 
ed
):

185 
	$£t_ed™abË
(): 
desütiÚ


187 :
·¿m
 
ed
:ƒd 
desütiÚ


188 :
ty³
 
ed
:ƒdype

190 :
»tuºs
: 
NÚe


192 
£lf
.
ed™abË
 = 
ed


194 
def
 
	$g‘_sÿns
(
£lf
):

196 
	$g‘_sÿns
(): 
desütiÚ


198 :
»tuºs
: 
NÚe


200 #»tuº 
a
 
cİy


201 (
£lf
.
sÿnLi¡D©a
[:])

203 
def
 
	$g‘_ûÎ
(
£lf
, 
row
, 
cŞ
):

205 
	$g‘_ûÎ
(): 
desütiÚ


207 :
·¿m
 
row
:„ow 
desütiÚ


208 :
ty³
 
row
:„owype

210 :
·¿m
 
cŞ
: cŞ 
desütiÚ


211 :
ty³
 
cŞ
: colype

213 :
»tuºs
: 
NÚe


215 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

216 (
	`¡r
(
sÿn
[
£lf
.
cŞumn_m­
[
cŞ
]]))

218 
def
 
	$£t_g‘£t_funcs
(
£lf
, 
funşi¡
):

220 
	$£t_g‘£t_funcs
(): 
desütiÚ


222 :
·¿m
 
funşi¡
: funşi¡ 
desütiÚ


223 :
ty³
 
funşi¡
: funclistype

225 :
»tuºs
: 
NÚe


228 
the
 
v›w
 
ÿn
 
£t
 
a
 
cu¡om
 
li¡
 
of
 
funùiÚs
 

229 
g‘tšg
 
ªd
 
£‰šg
 
—ch
 
cŞumn
 
š
 
the
 
bË


231 
f
 
š
 
funşi¡
:

232 
£lf
.
_g‘_funcs
.
	`­³nd
('g‘_' + 
f
)

233 
£lf
.
_£t_funcs
.
	`­³nd
('£t_' + 
f
)

236 
def
 
	$£t_row_»adÚly
(
£lf
, 
row
, 
rdÚly
=
True
):

238 
	$£t_row_»adÚly
(): 
desütiÚ


240 :
·¿m
 
row
:„ow 
desütiÚ


241 :
ty³
 
row
:„owype

243 :
·¿m
 
rdÚly
=
True
:„dÚly=Tru
desütiÚ


244 :
ty³
 
rdÚly
=
True
:„donly=Trueype

246 :
»tuºs
: 
NÚe


248 if(
rdÚly
):

249 
£lf
.
rd_Úly_rows
[
row
] = 
rdÚly


251 
d–
 
£lf
.
rd_Úly_rows
[
row
]

253 
def
 
	$£t_cŞ_»adÚly
(
£lf
, 
cŞ
, 
rdÚly
=
True
):

255 
	$£t_cŞ_»adÚly
(): 
desütiÚ


257 :
·¿m
 
cŞ
: cŞ 
desütiÚ


258 :
ty³
 
cŞ
: colype

260 :
·¿m
 
rdÚly
=
True
:„dÚly=Tru
desütiÚ


261 :
ty³
 
rdÚly
=
True
:„donly=Trueype

263 :
»tuºs
: 
NÚe


265 if(
rdÚly
):

266 
£lf
.
rd_Úly_cŞs
[
cŞ
] = 
rdÚly


268 
d–
 
£lf
.
rd_Úly_cŞs
[
cŞ
]

270 
def
 
	$_sÿn_nÙ_exi¡
(
£lf
, 
sÿn_id
):

272 
	$_sÿn_nÙ_exi¡
(): 
desütiÚ


274 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


275 :
ty³
 
sÿn_id
: scan_idype

277 :
»tuºs
: 
NÚe


279 
sÿn
 
š
 
£lf
.
sÿnLi¡D©a
:

280 #if(
	`ha§‰r
(
sÿn
, 
SPDB_ID_VAL
)):

281 if(
SPDB_ID_VAL
 
š
 
sÿn
.
	$keys
()):

282 if(
sÿn
[
SPDB_ID_VAL
] =ğ
sÿn_id
):

283 #´šˆ'_g‘_sÿn_rowidx:„‘uºšg %d' % 
row


284 (
F®£
)

285 (
True
)

287 
def
 
	$add_sÿn
(
£lf
, 
sÿn
):

289 
	$add_sÿn
(): 
desütiÚ


291 :
·¿m
 
sÿn
: sÿÀ
desütiÚ


292 :
ty³
 
sÿn
: scanype

294 :
»tuºs
: 
NÚe


298 
SPATIAL_CNTR
 = 10000

299 
EV_CNTR
 = 5000

300 
POL_CNTR
 = 0

302 if(
£lf
.
	`rowCouÁ
(è>ğ£lf.
max_rows
):

305 if(
sÿn
[
SPDB_ID_VAL
] 
is
 
NÚe
):

306 #th
mod–
 
is
 
bešg
 
š™Ÿlized


307 
sÿn
[
SPDB_ID_VAL
] = 0

309 if(
£lf
.
	$_sÿn_nÙ_exi¡
(
sÿn
[
SPDB_ID_VAL
])):

310 
£lf
.
	`š£¹Row
(
sÿn
)

311 (
True
)

313 (
F®£
)

315 
def
 
	`š£¹Row
(
£lf
, 
sÿn
, 
·»Á
=
QtCÜe
.
	$QMod–Index
()):

317 
	$š£¹Row
(): 
desütiÚ


319 :
·¿m
 
sÿn
: sÿÀ
desütiÚ


320 :
ty³
 
sÿn
: scanype

322 :
·¿m
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
desütiÚ


323 :
ty³
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
ty³


325 :
»tuºs
: 
NÚe


327 
£lf
.
	`begšIn£¹Rows
(
·»Á
, s–f.
	`rowCouÁ
(parent), self.rowCount(parent))

328 
£lf
.
sÿnLi¡D©a
.
	`­³nd
(
sÿn
)

329 
£lf
.
	`’dIn£¹Rows
()

330 #£lf.
d©aChªged
.
	`em™
(
·»Á
,…arent)

331 (
£lf
.
	`rowCouÁ
(
·»Á
))

333 
def
 
	`»moveRow
(
£lf
, 
row
, 
·»Á
=
QtCÜe
.
	$QMod–Index
()):

335 
	$»moveRow
(): 
desütiÚ


337 :
·¿m
 
row
:„ow 
desütiÚ


338 :
ty³
 
row
:„owype

340 :
·¿m
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
desütiÚ


341 :
ty³
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
ty³


343 :
»tuºs
: 
NÚe


345 #row = 
£lf
.
	`g‘_sÿn_rowidx
(
sÿn_id
)

346 if(
£lf
.
	`rowCouÁ
(è=ğ£lf.
mš_rows
):

348 if(
row
 !ğ
NÚe
):

349 
£lf
.
	`begšRemoveRows
(
·»Á
, 
row
,„ow)

350 
	`d–
(
£lf
.
sÿnLi¡D©a
[
row
])

351 
£lf
.
	`’dRemoveRows
()

352 
£lf
.
d©aChªged
.
	`em™
(
·»Á
,…arent)

355 
def
 
	`»moveAÎ
(
£lf
, 
·»Á
=
QtCÜe
.
	$QMod–Index
()):

357 
	$»moveAÎ
(): 
desütiÚ


359 :
·¿m
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
desütiÚ


360 :
ty³
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
ty³


362 :
»tuºs
: 
NÚe


364 
£lf
.
	`begšRemoveRows
(
·»Á
, 0, 
	`Ën
(£lf.
sÿnLi¡D©a
))

365 #£lf.
sÿnLi¡D©a
 = []

366 
row
 
š
 
	`¿nge
(
	$Ën
(
£lf
.
sÿnLi¡D©a
)):

367 #th
li¡
 
shršks
 
—ch
 
time
 
so
 
Úly
 
d–‘e
 
äom
 
‹h
 
tİ


368 
	`d–
(
£lf
.
sÿnLi¡D©a
[0])

369 
£lf
.
	`’dRemoveRows
()

370 
£lf
.
d©aChªged
.
	`em™
(
·»Á
,…arent)

372 
def
 
	$£t_sÿn_fÜ_sšgË_ev
(
£lf
):

374 
	$£t_sÿn_fÜ_sšgË_ev
(): 
desütiÚ


376 :
»tuºs
: 
NÚe


378 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[0]

379 
sÿn
['STOP'] = scan['START']

380 
sÿn
['RANGE'] = 0.0

381 
sÿn
['NPOINTS'] = 1

382 
sÿn
['STEP'] = 0.0

384 
def
 
	`»move_®l_exû±_fœ¡
(
£lf
, 
sÿn_id
, 
·»Á
=
QtCÜe
.
	$QMod–Index
()):

386 
	$»move_®l_exû±_fœ¡
(): 
desütiÚ


388 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


389 :
ty³
 
sÿn_id
: scan_idype

391 :
·¿m
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
desütiÚ


392 :
ty³
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
ty³


394 :
»tuºs
: 
NÚe


396 
l
 = 
	`¿nge
(1, 
	`Ën
(
£lf
.
sÿnLi¡D©a
))

397 
l
.
	`»v”£
()

398 
£lf
.
	`begšRemoveRows
(
·»Á
, 1, 
	`Ën
(
l
))

400 
row
 
š
 
l
:

401 
	`d–
(
£lf
.
sÿnLi¡D©a
[
row
])

402 
£lf
.
	`’dRemoveRows
()

403 
£lf
.
	`£t_sÿn_fÜ_sšgË_ev
()

404 
£lf
.
d©aChªged
.
	`em™
(
·»Á
,…arent)

406 
def
 
	$g‘_sÿn_rowidx
(
£lf
, 
sÿn_id
):

408 
	$g‘_sÿn_rowidx
(): 
desütiÚ


410 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


411 :
ty³
 
sÿn_id
: scan_idype

413 :
»tuºs
: 
NÚe


416 
row
 = 0

417 #´šˆ'checkšg fÜ sÿn_id = %d' % 
sÿn_id


418 
sÿn
 
š
 
£lf
.
sÿnLi¡D©a
:

419 #´šˆ'g‘_sÿn_rowidx: [%d] = %d' % (
row
, 
sÿn
['ID'])

420 if(
sÿn
[
SPDB_ID_VAL
] =ğ
sÿn_id
):

421 #´šˆ'_g‘_sÿn_rowidx:„‘uºšg %d' % 
row


422 (
row
)

423 
row
 += 1

424 (
NÚe
)

426 
def
 
	$»¶aû_sÿn
(
£lf
, 
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
=
True
):

428 
	$»¶aû_sÿn
(): 
desütiÚ


430 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


431 :
ty³
 
sÿn_id
: scan_idype

433 :
·¿m
 
Ãwsÿn
:‚ewsÿÀ
desütiÚ


434 :
ty³
 
Ãwsÿn
:‚ewscanype

436 :
·¿m
 
do_¡•_Åts
=
True
: do_¡•_Åts=Tru
desütiÚ


437 :
ty³
 
do_¡•_Åts
=
True
: do_step_npts=Trueype

439 :
»tuºs
: 
NÚe


442 
row
 = 0

443 
sÿn
 
š
 
£lf
.
sÿnLi¡D©a
:

444 #´šˆ'g‘_sÿn_rowidx: [%d] = %d' % (
row
, 
sÿn
['ID'])

445 if(
sÿn
[
SPDB_ID_VAL
] =ğ
sÿn_id
):

446 
£lf
.
sÿnLi¡D©a
[
row
][
SPDB_X
]['CENTER'] = 
Ãwsÿn
[SPDB_X]['CENTER']

447 
£lf
.
sÿnLi¡D©a
[
row
][
SPDB_Y
]['CENTER'] = 
Ãwsÿn
[SPDB_Y]['CENTER']

448 
£lf
.
sÿnLi¡D©a
[
row
][
SPDB_X
]['RANGE'] = 
Ãwsÿn
[SPDB_X]['RANGE']

449 
£lf
.
sÿnLi¡D©a
[
row
][
SPDB_Y
]['RANGE'] = 
Ãwsÿn
[SPDB_Y]['RANGE']

450 #if(
do_¡•_Åts
):

451 
£lf
.
sÿnLi¡D©a
[
row
][
SPDB_X
]['STEP'] = 
Ãwsÿn
[SPDB_X]['STEP']

452 
£lf
.
sÿnLi¡D©a
[
row
][
SPDB_Y
]['STEP'] = 
Ãwsÿn
[SPDB_Y]['STEP']

453 
£lf
.
sÿnLi¡D©a
[
row
][
SPDB_X
]['NPOINTS'] = 
Ãwsÿn
[SPDB_X]['NPOINTS']

454 
£lf
.
sÿnLi¡D©a
[
row
][
SPDB_Y
]['NPOINTS'] = 
Ãwsÿn
[SPDB_Y]['NPOINTS']

455 
row
 += 1

458 
def
 
	$g‘_sÿn_by_row
(
£lf
, 
row
):

460 
	$g‘_sÿn_by_row
(): 
desütiÚ


462 :
·¿m
 
row
:„ow 
desütiÚ


463 :
ty³
 
row
:„owype

465 :
»tuºs
: 
NÚe


468 #´šˆ'checkšg fÜ sÿn_id = %d' % 
sÿn_id


469 (
£lf
.
sÿnLi¡D©a
[
row
])

471 
def
 
	$g‘_sÿn
(
£lf
, 
sÿn_id
):

473 
	$g‘_sÿn
(): 
desütiÚ


475 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


476 :
ty³
 
sÿn_id
: scan_idype

478 :
»tuºs
: 
NÚe


481 #´šˆ'checkšg fÜ sÿn_id = %d' % 
sÿn_id


482 
sÿn
 
š
 
£lf
.
sÿnLi¡D©a
:

483 #´šˆ'g‘_sÿn_rowidx: [%d] = %d' % (
row
, 
sÿn
['ID'])

484 if(
sÿn
[
SPDB_ID_VAL
] =ğ
sÿn_id
):

485 #´šˆ'_g‘_sÿn_rowidx:„‘uºšg %d' % 
row


486 (
sÿn
)

487 (
NÚe
)

489 
def
 
	$£t_cur_sÿn_´og»ss
(
£lf
, 
´og»ss
, 
sÿn_id
):

491 
	$£t_cur_sÿn_´og»ss
(): 
desütiÚ


493 :
·¿m
 
´og»ss
:…rog»s 
desütiÚ


494 :
ty³
 
´og»ss
:…rogressype

496 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


497 :
ty³
 
sÿn_id
: scan_idype

499 :
»tuºs
: 
NÚe


502 
sÿn
 
š
 
£lf
.
sÿnLi¡D©a
:

503 if(
sÿn
[
SPDB_ID_VAL
] =ğ
sÿn_id
):

504 
£lf
.
sÿnProg»ss
[
sÿn_id
] = 
´og»ss


505 
£lf
.
cur_sÿn_id
 = 
sÿn_id


506 #Ãed 
to
 
fœe
 
the
 
sigÇl
 
so
 
th©
h
di¥Ïy
 
rŞe
 
wl
 
g‘
 
´oûs£d


507 
row
 = 
£lf
.
	`_g‘_sÿn_rowidx
(
sÿn_id
)

508 
šdex
 = 
QtCÜe
.
	`QMod–Index
()

509 
£lf
.
d©aChªged
.
	`em™
(
šdex
, index)

511 #_logg”.
	`šfo
('cu¼’ˆsÿÀID [%ld] ha ´og»s %f' % (
sÿn_id
, 
´og»ss
))

513 
def
 
	$£t_h—d”
(
£lf
, 
hdrLi¡
):

515 
	$£t_h—d”
(): 
desütiÚ


517 :
·¿m
 
hdrLi¡
: hdrLi¡ 
desütiÚ


518 :
ty³
 
hdrLi¡
: hdrListype

520 :
»tuºs
: 
NÚe


522 
hdr
 
š
 
hdrLi¡
:

523 
£lf
.
hdrLi¡
.
	`­³nd
(
hdr
)

525 
def
 
	`rowCouÁ
(
£lf
, 
·»Á
=
QtCÜe
.
	$QMod–Index
()):

527 
	$rowCouÁ
(): 
desütiÚ


529 :
·¿m
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
desütiÚ


530 :
ty³
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
ty³


532 :
»tuºs
: 
NÚe


534  
	`Ën
(
£lf
.
sÿnLi¡D©a
)

536 
def
 
	`cŞumnCouÁ
(
£lf
, 
·»Á
=
QtCÜe
.
	$QMod–Index
()):

538 
	$cŞumnCouÁ
(): 
desütiÚ


540 :
·¿m
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
desütiÚ


541 :
ty³
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
ty³


543 :
»tuºs
: 
NÚe


545  
	`Ën
(
£lf
.
hdrLi¡
)

548 
def
 
	$h—d”D©a
(
£lf
, 
£ùiÚ
, 
Ü›Á©iÚ
, 
rŞe
):

550 
	$h—d”D©a
(): 
desütiÚ


552 :
·¿m
 
£ùiÚ
: seùiÚ 
desütiÚ


553 :
ty³
 
£ùiÚ
: sectionype

555 :
·¿m
 
Ü›Á©iÚ
: or›Á©iÚ 
desütiÚ


556 :
ty³
 
Ü›Á©iÚ
: orientationype

558 :
·¿m
 
rŞe
:„Ş
desütiÚ


559 :
ty³
 
rŞe
:„oleype

561 :
»tuºs
: 
NÚe


564 
Œy
:

565 ià(
rŞe
 =ğ
QtCÜe
.
Qt
.
Di¥ÏyRŞe
):

566 ià(
Ü›Á©iÚ
 =ğ
QtCÜe
.
Qt
.
HÜizÚl
):

567 #»tuº 
QtCÜe
.
	`QSŒšg
(
£lf
.
hdrLi¡
[
£ùiÚ
])

568  
£lf
.
hdrLi¡
[
£ùiÚ
]

569 
exû±
 
IndexE¼Ü
:

570 
s
 = "Index[%d]ƒ¼Ü iÀh—d”†i¡" % 
£ùiÚ


571 
¿i£
 
	`SÿnO±iÚE¼Ü
(
s
)

573  
QtCÜe
.
	`QV¬ŸÁ
()

575 
def
 
	$d©a
(
£lf
, 
šdex
, 
rŞe
):

577 
	$d©a
(): 
desütiÚ


579 :
·¿m
 
šdex
: index 
desütiÚ


580 :
ty³
 
šdex
: indexype

582 :
·¿m
 
rŞe
:„Ş
desütiÚ


583 :
ty³
 
rŞe
:„oleype

585 :
»tuºs
: 
NÚe


588 
row
 = 
šdex
.
	`row
()

589 
cŞ
 = 
šdex
.
	`cŞumn
()

590 
’abËd
 = 
F®£


592 
nÙ
 
šdex
.
	$isV®id
():

593 
´št
 'index is invalid'

594  
NÚe


596 
æags
 = 
šdex
.
	`æags
()

597 
æags
 & 
QtCÜe
.
Qt
.
I‹mIsEd™abË
:

598 
’abËd
 = 
True


600 
rŞe
 =ğ
QtCÜe
.
Qt
.
Di¥ÏyRŞe
:

601 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

602 if(
cŞ
 == 0):

603 
v
 = 
sÿn
[
SPDB_ID_VAL
]

605 
v
 = 
sÿn
[
£lf
.
cŞumn_m­
[
cŞ
]]

607 if(
	$ty³
(
v
è
is
 
¡r
):

608 (
v
)

609 if(
	$ty³
(
v
è
is
 
Å
.
æßt64
):

610 
v®
 = '%.3f' % 
v


611 (
v®
)

612 if(
	$ty³
(
v
è
is
 ):

613 
v®
 = '%.3f' % 
v


614 (
v®
)

615 if(
	$ty³
(
v
è
is
 ):

616 
v®
 = '%d' % 
v


617 (
v®
)

618 if(
	$ty³
(
v
è
is
 ):

619 
v®
 = '%d' % 
v


620 (
v®
)

621 if(
	$ty³
(
v
è
is
 
boŞ
):

622 if(
v
):

627 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
BackgroundRŞe
:

628 if(
cŞ
 == 0):

629 
bg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
g¿y
)

630 
	`–if
(
cŞ
 < 5):

631 
bg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
lightG¿y
)

634 if(
’abËd
):

635 
bg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
wh™e
)

637 
bg
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(220, 220, 220))

638  
bg


639 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
FÜegroundRŞe
:

640 if(
’abËd
):

641 
fg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
bÏck
)

643 
fg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
blue
)

644  
fg


645 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
FÚtRŞe
:

646 
ât
 = 
QtGui
.
	`QFÚt
()

647 
ât
.
	`£tPoštSize
(
TABLE_FONT_SIZE
)

648 if(
cŞ
 == 0):

649 
ât
.
	`£tBŞd
(
True
)

650  
ât


651 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
TextAlignm’tRŞe
:

652 ià(
cŞ
 == 0):

653 (
QtCÜe
.
Qt
.
AlignLeá
)

655 #»tuº(
QtCÜe
.
Qt
.
AlignRight
)

656 (
QtCÜe
.
Qt
.
AlignC’‹r
)

659 #´šˆ'»tuºšg NÚ[%d,%d]„Şğ%d' % (
row
,
cŞ
, 
rŞe
)

660  
NÚe


662 
def
 
	$modify_d©a
(
£lf
, 
sÿn_id
, 
sÿn
):

664 
	$modify_d©a
(): 
desütiÚ


666 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


667 :
ty³
 
sÿn_id
: scan_idype

669 :
·¿m
 
sÿn
: sÿÀ
desütiÚ


670 :
ty³
 
sÿn
: scanype

672 :
»tuºs
: 
NÚe


675 
·ss


677 
def
 
	$£tD©a
(
£lf
, 
šdex
, 
v®ue
, 
rŞe
, 
»ÿlc
=
True
):

679 
	$£tD©a
(): 
desütiÚ


681 :
·¿m
 
šdex
: index 
desütiÚ


682 :
ty³
 
šdex
: indexype

684 :
·¿m
 
v®ue
: v®u
desütiÚ


685 :
ty³
 
v®ue
: valueype

687 :
·¿m
 
rŞe
:„Ş
desütiÚ


688 :
ty³
 
rŞe
:„oleype

690 :
·¿m
 
»ÿlc
=
True
:„eÿlc=Tru
desütiÚ


691 :
ty³
 
»ÿlc
=
True
:„ecalc=Trueype

693 :
»tuºs
: 
NÚe


696 
·ss


698 
def
 
	$æags
(
£lf
, 
šdex
):

700 
	$æags
(): 
desütiÚ


702 :
·¿m
 
šdex
: index 
desütiÚ


703 :
ty³
 
šdex
: indexype

705 :
»tuºs
: 
NÚe


708 #´šˆ'%d, %d' % (
šdex
.
	`row
(), index.
	`cŞumn
())

709 
row
 = 
šdex
.
	`row
()

710 
cŞ
 = 
šdex
.
	`cŞumn
()

711 
rowRdOÆy
 = 
row
 
š
 
£lf
.
rd_Úly_rows
.
	`keys
()

712 
cŞRdOÆy
 = 
cŞ
 
š
 
£lf
.
rd_Úly_cŞs
.
	`keys
()

713 if(
rowRdOÆy
):

714  
QtCÜe
.
Qt
.
I‹mIsEd™abË
 | QtCÜe.Qt.
I‹mIsS–eùabË


715 
	$–if
(
cŞRdOÆy
):

716  
QtCÜe
.
Qt
.
I‹mIsEÇbËd
 | QtCÜe.Qt.
I‹mIsS–eùabË


718  
QtCÜe
.
Qt
.
I‹mIsEd™abË
 | QtCÜe.Qt.
I‹mIsEÇbËd
 | QtCÜe.Qt.
I‹mIsS–eùabË


721 
def
 
	$g’_¥©Ÿl_mod–_obj
(
hdr_Çme
, 
func
, 
æoÜ_v®
, 
ûšg_v®
):

722 
dù
 = {
	}
}

723 
dù
['hdr'] = 
hdr_Çme


724 
dù
['func'] = 
func


725 
dù
['æoÜ_v®'] = 
æoÜ_v®


726 
dù
['ûšg_v®'] = 
ûšg_v®


727 (
dù
)

729 #th
C_
 
is
 
C’‹r


730 
C_SPATIAL_DCT
 = []

731 
C_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('ID',
NÚe
,None,None))

732 
C_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('CENTERX', 
Ú_ûÁ”_chªged
, 
NÚe
, None))

733 
C_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('RANGEX', 
Ú_¿nge_chªged
, 
NÚe
, None))

734 
C_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('CENTERY', 
Ú_ûÁ”_chªged
, 
NÚe
, None))

735 
C_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('RANGEY', 
Ú_¿nge_chªged
, 
NÚe
, None))

736 
C_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('STEPX', 
Ú_¡•_size_chªged
, 
NÚe
, None))

737 
C_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('STEPY', 
Ú_¡•_size_chªged
, 
NÚe
, None))

738 
C_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('NPOINTSX', 
Ú_Åošts_chªged
, 0, 20000))

739 
C_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('NPOINTSY', 
Ú_Åošts_chªged
, 0, 20000))

742 #th
S_
 
is
 
S¹


743 
S_SPATIAL_DCT
 = []

744 
S_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('ID',
NÚe
,None,None))

745 
S_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('STARTX',
Ú_¡¬t_chªged
, 
NÚe
, None))

746 
S_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('STOPX',
Ú_¡İ_chªged
, 
NÚe
, None))

747 
S_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('STARTY',
Ú_¡¬t_chªged
, 
NÚe
, None))

748 
S_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('STOPY',
Ú_¡İ_chªged
, 
NÚe
, None))

749 
S_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('STEPX', 
Ú_¡•_size_chªged
, 
NÚe
, None))

750 
S_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('STEPY', 
Ú_¡•_size_chªged
, 
NÚe
, None))

751 
S_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('NPOINTSX', 
Ú_Åošts_chªged
, 0, 20000))

752 
S_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('NPOINTSY', 
Ú_Åošts_chªged
, 0, 20000))

755 
def
 
	$g‘_v®_äom_roi
(
¥_db
, 
f›ld
, 
roi_key
):

756 if(
roi_key
 
š
 
¥_db
.
	$keys
()):

757 
roi
 = 
¥_db
[
roi_key
]

759 (
NÚe
)

761 if(
f›ld
 
š
 
roi
.
	$keys
()):

762 (
roi
[
f›ld
])

764 (
NÚe
)

766 
def
 
	$g‘_v®_äom_¥_db
(
f›ld
, 
¥_db
):

767 
axis_key
 = 
f›ld
[-1]

768 
subæd
 = 
f›ld
[0:-1]

770 (
	`g‘_v®_äom_roi
(
¥_db
, 
subæd
, 
axis_key
))

773 
def
 
	$£t_v®_š_roi
(
¥_db
, 
f›ld
, 
roi_key
, 
v®
):

774 if(
roi_key
 
š
 
¥_db
.
	$keys
()):

775 
roi
 = 
¥_db
[
roi_key
]

777 (
NÚe
)

779 if(
f›ld
 
š
 
roi
.
	$keys
()):

780 
roi
[
f›ld
] = 
v®


782 
_logg”
.
	`”rÜ
('f›ld [%s] dÛ¢ˆexi¡ iÀ¥_db' % 
f›ld
)

784 
def
 
	$£t_f›ld_v®_š_¥_db
(
f›ld
, 
v®
, 
¥_db
):

785 
axis_key
 = 
f›ld
[-1]

786 
subæd
 = 
f›ld
[0:-1]

787 
	`£t_v®_š_roi
(
¥_db
, 
subæd
, 
axis_key
, 
v®
)

790 
def
 
	$g‘_roi_äom_¥_db
(
f›ld
, 
¥_db
):

791 
axis_key
 = 
f›ld
[-1]

792 if(
axis_key
 
š
 
¥_db
.
	$keys
()):

793 (
¥_db
[
axis_key
])

795 
_logg”
.
	`”rÜ
('axis_key [%s] dÛ¢ˆexi¡ iÀ¥_db' % 
axis_key
)

798 
şass
 
	$Ba£SÿnTabËV›w
(
QtWidg‘s
.
QTabËV›w
):

800 
This
 
is
 
a
 
widg‘
 
to
 
di¥Ïy
 
the
 
·¿m‘”s
 
of
 
šdividu®
 
sÿns
,hwidg‘ 
»¥Úds
Ø
ûÎ
 
ed™s


801 
ªd
 
fÜûs
 
a
 
»ÿlc
 
of
 
row
 
–em’ts
 
Ãed
 
be
.

803 
row_£Ëùed
 = 
QtCÜe
.
	$pyqtSigÇl
(
objeù
è#row 
d©a


804 
add_»giÚ
 = 
QtCÜe
.
	`pyqtSigÇl
()

805 
d–_»giÚ
 = 
QtCÜe
.
	`pyqtSigÇl
()

806 
sÿn_chªged
 = 
QtCÜe
.
	`pyqtSigÇl
(, 
objeù
)

808 
def
 
	$__š™__
(
£lf
, 
hdrLi¡
, 
sÿnLi¡
, 
bËmod–_şass
, 
·»Á
=
NÚe
):

810 
	$__š™__
(): 
desütiÚ


812 :
·¿m
 
hdrLi¡
: hdrLi¡ 
desütiÚ


813 :
ty³
 
hdrLi¡
: hdrListype

815 :
·¿m
 
sÿnLi¡
: sÿnLi¡ 
desütiÚ


816 :
ty³
 
sÿnLi¡
: scanListype

818 :
·¿m
 
bËmod–_şass
:abËmod–_şas 
desütiÚ


819 :
ty³
 
bËmod–_şass
:ablemodel_classype

821 :
·¿m
 
·»Á
=
NÚe
:…¬’t=NÚ
desütiÚ


822 :
ty³
 
·»Á
=
NÚe
:…arent=Noneype

824 :
»tuºs
: 
NÚe


826 
	`su³r
(
Ba£SÿnTabËV›w
, 
£lf
).
	`__š™__
(
·»Á
)

827 
£lf
.
hdrLi¡
 = hdrList

828 
£lf
.
sÿns
 = 
sÿnLi¡


829 
£lf
.
bËmod–
 = 
NÚe


830 
£lf
.
mod–s
 = {
	}
}

831 
£lf
.
mod–_id_¡¬t_v®
 = 
NÚe


832 
£lf
.
mod–_id
 = 0

833 
£lf
.
mod–_id_l¡
 = []

834 
£lf
.
sigÇls_cÚÃùed
 = 
F®£


836 
£lf
.
v”tiÿlH—d”
().
£tSeùiÚResizeMode
(
QtWidg‘s
.
QH—d”V›w
.
Fixed
)

837 
£lf
.
v”tiÿlH—d”
().
£tDeçuÉSeùiÚSize
(20)

839 
£lf
.
£tS–eùiÚBehaviÜ
(
QtWidg‘s
.
QAb¡¿ùI‹mV›w
.
S–eùRows
)

840 
£lf
.
£tAÉ”ÇtšgRowCŞÜs
(
True
)

842 
ât
 = 
QtGui
.
QFÚt
()

843 
ât
.
£tPoštSize
(
TABLE_FONT_SIZE
)

844 
£lf
.
£tFÚt
(
ât
)

846 
£lf
.
v”tiÿlH—d”
().
£tDeçuÉSeùiÚSize
(15)

848 
£lf
.
_cur_£Ëùed_sÿn
 = 
NÚe


849 
£lf
.
bËmod–_şass
 =ablemodel_class

851 #£lf.
£tS–eùiÚBehaviÜ
(
QtWidg‘s
.
QAb¡¿ùI‹mV›w
.
S–eùI‹ms
)

852 #£lf.
£tHÜizÚlSüŞlMode
(
QtWidg‘s
.
QAb¡¿ùI‹mV›w
.
SüŞlP”Pix–
)

853 #£lf.
hÜizÚlH—d”
().
£tSeùiÚResizeMode
(
QtWidg‘s
.
QH—d”V›w
.
SŒ‘ch
)

854 #£lf.
hÜizÚlH—d”
().
£tSeùiÚResizeMode
(
QtWidg‘s
.
QH—d”V›w
.
IÁ”aùive
)

855 #£lf.
hÜizÚlH—d”
().
£tSeùiÚResizeMode
(
QtWidg‘s
.
QH—d”V›w
.
¡»tchLa¡SeùiÚ
)

856 
£lf
.
sÿnFÏgs
 = {}

857 
£lf
.
_block_upd©es
 = 
F®£


858 #£lf.
şicked
.
cÚÃù
(
£lf
.
Ú_şicked
)

859 #£lf.
£tS–eùiÚBehaviÜ
(
QtWidg‘s
.
QAb¡¿ùI‹mV›w
.
S–eùRows
)

860 #£lf.
£ËùiÚMod–
().
£ËùiÚChªged
.
cÚÃù
(
£lf
.
£lChªged
)

861 
£lf
.
şicked
.
cÚÃù
(£lf.
Ú_şicked
)

863 
def
 
	$cÚ‹xtM’uEv’t
(
£lf
, 
ev’t
):

865 
	$cÚ‹xtM’uEv’t
(): 
desütiÚ


867 :
·¿m
 
ev’t
:ƒv’ˆ
desütiÚ


868 :
ty³
 
ev’t
:ƒventype

870 :
»tuºs
: 
NÚe


872 
m’u
 = 
QtWidg‘s
.
	`QM’u
(
£lf
)

873 
addAùiÚ
 = 
m’u
.
	`addAùiÚ
("Add„egion")

874 
d–AùiÚ
 = 
m’u
.
	`addAùiÚ
("Delete„egion")

875 
dmpMod–AùiÚ
 = 
m’u
.
	`addAùiÚ
("Dump Selected Model")

876 
aùiÚ
 = 
m’u
.
	`exec_
(
£lf
.
	`m­ToGlob®
(
ev’t
.
	`pos
()))

877 
aùiÚ
 =ğ
addAùiÚ
:

878 
£lf
.
add_»giÚ
.
	`em™
()

879 
–if
 
aùiÚ
 =ğ
d–AùiÚ
:

880 
£lf
.
d–_»giÚ
.
	`em™
()

881 
–if
 
aùiÚ
 =ğ
dmpMod–AùiÚ
:

882 
£lf
.
	`dump_mod–_keys
()

884 
def
 
	$cÚÃù_sigÇls
(
£lf
):

886 
	$cÚÃù_sigÇls
(): 
desütiÚ


888 :
»tuºs
: 
NÚe


890 
£lf
.
	`£tMod–
(£lf.
bËmod–
)

891 
£lf
.
	`£ËùiÚMod–
().
£ËùiÚChªged
.
	`cÚÃù
(£lf.
£lChªged
)

892 
£lf
.
bËmod–
.
d©aChªged
.
	`cÚÃù
(£lf.
Ú_ûÎ_chªged
)

893 
£lf
.
bËmod–
.
sÿn_chªged
.
	`cÚÃù
(£lf.
Ú_mod–_chªged
)

894 #£lf.
_numHdrCŞs
 = 
£lf
.
bËmod–
.
	`cŞumnCouÁ
(self)

895 #£lf.
şicked
.
	`cÚÃù
(
£lf
.
Ú_şicked
)

896 
£lf
.
sigÇls_cÚÃùed
 = 
True


898 
def
 
	$discÚÃù_sigÇls
(
£lf
):

900 
	$discÚÃù_sigÇls
(): 
desütiÚ


902 :
»tuºs
: 
NÚe


904 
Œy
:

905 
£lf
.
	`£ËùiÚMod–
().
£ËùiÚChªged
.
	`discÚÃù
(£lf.
£lChªged
)

906 
£lf
.
bËmod–
.
d©aChªged
.
	`discÚÃù
(£lf.
Ú_ûÎ_chªged
)

907 
£lf
.
bËmod–
.
sÿn_chªged
.
	`discÚÃù
(£lf.
Ú_mod–_chªged
)

908 #£lf.
şicked
.
	`discÚÃù
(
£lf
.
Ú_şicked
)

909 
£lf
.
sigÇls_cÚÃùed
 = 
F®£


910 
exû±
:

911 
·ss


913 
def
 
	$š™_mod–
(
£lf
):

915 
	$š™_mod–
(): 
desütiÚ


917 :
»tuºs
: 
NÚe


920 
·ss


922 
def
 
	$£t_mod–_ed™abË
(
£lf
, 
ed
):

924 
	$£t_mod–_ed™abË
(): 
desütiÚ


926 :
·¿m
 
ed
:ƒd 
desütiÚ


927 :
ty³
 
ed
:ƒdype

929 :
»tuºs
: 
NÚe


931 if(
£lf
.
bËmod–
 
is
 
nÙ
 
NÚe
):

932 
£lf
.
bËmod–
.
	`£t_ed™abË
(
ed
)

934 
def
 
	$Ú_şicked
(
£lf
, 
šdex
):

936 
	$Ú_şicked
(): 
desütiÚ


938 :
·¿m
 
šdex
: index 
desütiÚ


939 :
ty³
 
šdex
: indexype

941 :
»tuºs
: 
NÚe


943 
row
 = 
šdex
.
	`row
()

944 
sÿn
 = 
£lf
.
	`g‘_row_d©a
(
row
)

945 #£lf.
row_£Ëùed
.
	`em™
(
sÿn
)

946 
£lf
.
_cur_£Ëùed_sÿn
 = 
sÿn


948 
def
 
	$g‘_Ãxt_mod–_id
(
£lf
):

949 #m_key ğ
	`sÜ‹d
(
£lf
.
mod–s
.
	`keys
())

950 #»tuº(
m_keys
[-1] + 1)

951 
id_l¡
 = []

952 
sÿn
 
š
 
£lf
.
bËmod–
.
sÿnLi¡D©a
:

953 
id_l¡
.
	`­³nd
(
sÿn
[
SPDB_ID_VAL
])

954 if(
	`Ën
(
id_l¡
) == 0):

957 
ids
 = 
	`sÜ‹d
(
id_l¡
)

958 (
ids
[-1] + 1)

963 
def
 
	$£t_mod–_id_¡¬t_v®
(
£lf
, 
v®
):

965 
	$£t_mod–_id_¡¬t_v®
(): 
desütiÚ


967 :
·¿m
 
v®
: v® 
desütiÚ


968 :
ty³
 
v®
: valype

970 :
»tuºs
: 
NÚe


973 
This
 
is
 
the
 
v®ue
 
th©
 
this
 
mod–
 
wl
 
START
 
coutšg
 
äom


974 
the
 
roi
 
id
's

976 
£lf
.
mod–_id_¡¬t_v®
 = 
v®


977 
£lf
.
mod–_id
 = 
v®


979 
def
 
	$g‘_mod–_id_¡¬t_v®
(
£lf
):

981 
	$g‘_mod–_id_¡¬t_v®
(): 
desütiÚ


983 :
»tuºs
: 
NÚe


986 
This
 
is
 
the
 
v®ue
 
th©
 
this
 
mod–
 
wl
 
START
 
coutšg
 
äom


987 
the
 
roi
 
id
's

989 (
£lf
.
mod–_id_¡¬t_v®
)

991 
def
 
	$dump_mod–_keys
(
£lf
):

993 
	$dump_mod–_keys
(): 
desütiÚ


995 :
»tuºs
: 
NÚe


997 
mod–
 = 
£lf
.
bËmod–
.
	`g‘_sÿn_li¡
()

998 #´šˆ
£lf
.
bËmod–_şass


999 
m
 
š
 
mod–
:

1000 
´št
 'Mod– ID = %d' % 
£lf
.
mod–_id


1001 
´št
 '\ˆ[%d]' % 
m
[
SPDB_ID_VAL
]

1003 
def
 
	$£t_sÿn_li¡
(
£lf
, 
sÿnLi¡
):

1005 
	$£t_sÿn_li¡
(): 
desütiÚ


1007 :
·¿m
 
sÿnLi¡
: sÿnLi¡ 
desütiÚ


1008 :
ty³
 
sÿnLi¡
: scanListype

1010 :
»tuºs
: 
NÚe


1012 
£lf
.
bËmod–
.
	`£t_sÿn_li¡
(
sÿnLi¡
)

1014 
def
 
	$g‘_sÿn_li¡
(
£lf
, 
mod–_id
=
NÚe
):

1016 
	$g‘_sÿn_li¡
(): 
desütiÚ


1018 :
·¿m
 
mod–_id
=
NÚe
: mod–_id=NÚ
desütiÚ


1019 :
ty³
 
mod–_id
=
NÚe
: model_id=Noneype

1021 :
»tuºs
: 
NÚe


1023 if(
mod–_id
 
is
 
nÙ
 
NÚe
):

1024 if(
mod–_id
 
š
 
£lf
.
mod–s
.
	$keys
()):

1025 (
£lf
.
mod–s
[
mod–_id
].
	`g‘_sÿn_li¡
())

1027 
´št
 'Mod–[%d] dÛ nÙƒxi¡' % 
mod–_id


1030 (
£lf
.
bËmod–
.
	`g‘_sÿn_li¡
())

1032 
def
 
	$g‘_num_sÿns
(
£lf
):

1034 
	$g‘_num_sÿns
(): 
desütiÚ


1036 :
»tuºs
: 
NÚe


1038 
sÿns
 = 
£lf
.
	`g‘_sÿn_li¡
()

1039 (
	`Ën
(
sÿns
))

1041 
def
 
	$g‘_sÿn
(
£lf
, 
sÿn_id
):

1043 
	$g‘_sÿn
(): 
desütiÚ


1045 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


1046 :
ty³
 
sÿn_id
: scan_idype

1048 :
»tuºs
: 
NÚe


1050 (
£lf
.
bËmod–
.
	`g‘_sÿn
(
sÿn_id
))

1052 
def
 
	$g‘_mod–
(
£lf
, 
mod–_id
):

1054 
	$g‘_mod–
(): 
desütiÚ


1056 :
·¿m
 
mod–_id
: mod–_id 
desütiÚ


1057 :
ty³
 
mod–_id
: model_idype

1059 :
»tuºs
: 
NÚe


1061 if(
mod–_id
 
š
 
£lf
.
mod–s
.
	$keys
()):

1062 (
£lf
.
mod–s
[
mod–_id
])

1064 
def
 
	$»move_mod–
(
£lf
, 
mod–_id
):

1066 
	$»move_mod–
(): 
desütiÚ


1068 :
·¿m
 
mod–_id
: mod–_id 
desütiÚ


1069 :
ty³
 
mod–_id
: model_idype

1071 :
»tuºs
: 
NÚe


1073 if(
mod–_id
 
š
 
£lf
.
mod–s
.
	$keys
()):

1074 
£lf
.
mod–s
[
mod–_id
].
	`»moveAÎ
()

1075 
d–
 
£lf
.
mod–s
[
mod–_id
]

1077 
def
 
	$»move_®l_mod–s
(
£lf
):

1079 
	$»move_®l_mod–s
(): 
desütiÚ


1081 :
»tuºs
: 
NÚe


1083 
mod–_id
 
š
 
£lf
.
mod–s
.
	$keys
():

1084 
£lf
.
	`»move_mod–
(
mod–_id
)

1087 
def
 
	$g‘_cur_£Ëùed_sÿn
(
£lf
):

1089 
	$g‘_cur_£Ëùed_sÿn
(): 
desütiÚ


1091 :
»tuºs
: 
NÚe


1093 (
£lf
.
_cur_£Ëùed_sÿn
)

1095 
def
 
	$£t_g‘£t_funcs
(
£lf
, 
funşi¡
):

1097 
	$£t_g‘£t_funcs
(): 
desütiÚ


1099 :
·¿m
 
funşi¡
: funşi¡ 
desütiÚ


1100 :
ty³
 
funşi¡
: funclistype

1102 :
»tuºs
: 
NÚe


1104 
£lf
.
bËmod–
.
	`£t_g‘£t_funcs
(
funşi¡
)

1106 
def
 
	$£lChªged
(
£lf
, 
£Ëùed
, 
de£Ëùed
):

1108 
	$£lChªged
(): 
desütiÚ


1110 :
·¿m
 
£Ëùed
: s–eùed 
desütiÚ


1111 :
ty³
 
£Ëùed
: selectedype

1113 :
·¿m
 
de£Ëùed
: de£Ëùed 
desütiÚ


1114 :
ty³
 
de£Ëùed
: deselectedype

1116 :
»tuºs
: 
NÚe


1118 
idxs
 = 
£Ëùed
.
	`šdexes
()

1119 if(
	`Ën
(
idxs
) > 0):

1120 
idx
 = 
idxs
.
	`pİ
()

1121 
row
 = 
idx
.
	`row
()

1122 
sÿn
 = 
£lf
.
	`g‘_row_d©a
(
row
)

1123 
£lf
.
row_£Ëùed
.
	`em™
(
sÿn
)

1124 
£lf
.
_cur_£Ëùed_sÿn
 = 
sÿn


1126 
£lf
.
_cur_£Ëùed_sÿn
 = 
NÚe


1128 
def
 
	$modify_sÿn
(
£lf
, 
sÿn_id
, 
Ãwsÿn
):

1130 
	$modify_sÿn
(): 
desütiÚ


1132 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


1133 :
ty³
 
sÿn_id
: scan_idype

1135 :
·¿m
 
Ãwsÿn
:‚ewsÿÀ
desütiÚ


1136 :
ty³
 
Ãwsÿn
:‚ewscanype

1138 :
»tuºs
: 
NÚe


1141 
·ss


1143 
def
 
	$»move_sÿn
(
£lf
, 
sÿn_id
):

1145 
	$»move_sÿn
(): 
desütiÚ


1147 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


1148 :
ty³
 
sÿn_id
: scan_idype

1150 :
»tuºs
: 
NÚe


1152 
row
 = 
£lf
.
bËmod–
.
	`g‘_sÿn_rowidx
(
sÿn_id
)

1153 if(
row
 
is
 
nÙ
 
NÚe
):

1154 
£lf
.
bËmod–
.
	`»moveRow
(
row
)

1156 
def
 
	$»move_®l
(
£lf
):

1158 
	$»move_®l
(): 
desütiÚ


1160 :
»tuºs
: 
NÚe


1162 
£lf
.
bËmod–
.
	`»moveAÎ
()

1164 
def
 
	$cÚÃù_´og»ss_¦Ù
(
£lf
, 
_sigÇl
):

1166 
	$cÚÃù_´og»ss_¦Ù
(): 
desütiÚ


1168 :
·¿m
 
_sigÇl
: _sigÇÈ
desütiÚ


1169 :
ty³
 
_sigÇl
: _signalype

1171 :
»tuºs
: 
NÚe


1173 
_sigÇl
.
	`cÚÃù
(
£lf
.
£Ëù_row
)

1175 #deà
	`£Ëù_row
(
£lf
, 
sÿn_id
=
NÚe
, 
´og»ss
=0.0):

1176 
def
 
	`£Ëù_row
(
£lf
, 
row_idx
=
NÚe
, 
´og»ss
=0.0):

1178 
	$£Ëù_row
(): 
desütiÚ


1180 :
·¿m
 
sÿn_id
=
NÚe
: sÿn_id=NÚ
desütiÚ


1181 :
ty³
 
sÿn_id
=
NÚe
: scan_id=Noneype

1183 :
·¿m
 
´og»ss
=0.0:…rog»ss=0.0 
desütiÚ


1184 :
ty³
 
´og»ss
=0.0:…rogress=0.0ype

1186 :
»tuºs
: 
NÚe


1188 if(
row_idx
 
is
 
NÚe
):

1189 
row_idx
 = 0

1190 
£lf
.
	`£ËùRow
(
row_idx
)

1192 
def
 
	$di§bË_upd©es
(
£lf
):

1194 
	$di§bË_upd©es
(): 
desütiÚ


1196 :
»tuºs
: 
NÚe


1198 
£lf
.
_block_upd©es
 = 
True


1200 
def
 
	$’abË_upd©es
(
£lf
):

1202 
	$’abË_upd©es
(): 
desütiÚ


1204 :
»tuºs
: 
NÚe


1206 
£lf
.
_block_upd©es
 = 
F®£


1208 
def
 
	$g‘_num_rows
(
£lf
):

1210 
	$g‘_num_rows
(): 
desütiÚ


1212 :
»tuºs
: 
NÚe


1214 (
£lf
.
bËmod–
.
	`rowCouÁ
(
NÚe
))

1216 
def
 
	$g‘_row_d©a
(
£lf
, 
row
):

1218 
	$g‘_row_d©a
(): 
desütiÚ


1220 :
·¿m
 
row
:„ow 
desütiÚ


1221 :
ty³
 
row
:„owype

1223 :
»tuºs
: 
NÚe


1225 
sÿn
 = 
£lf
.
bËmod–
.
	`g‘_sÿn_by_row
(
row
)

1226 (
sÿn
)

1228 
def
 
	$Ú_ûÎ_chªged
(
£lf
, 
idx
, 
idx2
):

1230 
	$Ú_ûÎ_chªged
(): 
desütiÚ


1232 :
·¿m
 
idx
: idx 
desütiÚ


1233 :
ty³
 
idx
: idxype

1235 :
·¿m
 
idx2
: idx2 
desütiÚ


1236 :
ty³
 
idx2
: idx2ype

1238 :
»tuºs
: 
NÚe


1240 
d
 = 
idx
.
	`d©a
()

1241 if(
d
 
is
 
nÙ
 
NÚe
):

1242 
v®
 = (
d
)

1244 (
NÚe
, 
F®£
)

1246 
def
 
	$ü—‹_Ãw_mod–
(
£lf
, 
sÿns
=
NÚe
, 
mod–_id
=NÚe, 
u£_ûÁ”
=
True
):

1248 
	$ü—‹_Ãw_mod–
(): 
desütiÚ


1250 :
·¿m
 
sÿns
=
NÚe
: sÿns=NÚ
desütiÚ


1251 :
ty³
 
sÿns
=
NÚe
: scans=Noneype

1253 :
»tuºs
: 
NÚe


1256 
bË
 
mod–s
 
th©
 
is
 
šdexed
 
by
 
the
 
mod–_id
 
·s£d
 
š
 
äom
h
·»Á
 
bËV›w
 
	`Ú_Ãw_»giÚ
()

1257 
¦Ù


1259 
impÜt
 
time
, 
d©‘ime


1260 #cÚÃù 
the
 
mod–s
 
sigÇl
 
to
 
em™
h
v›ws
 
sÿn_chªged
 signal

1261 
£lf
.
	`discÚÃù_sigÇls
()

1262 if(
sÿns
 
is
 
NÚe
):

1263 
sÿÆi¡
 = []

1265 
sÿÆi¡
 = 
sÿns


1267 if(
mod–_id
 
is
 
NÚe
):

1268 #šüem’ˆ
mod–
 
id


1269 
£lf
.
mod–_id
 
š
 s–f.
mod–s
.
	$keys
():

1270 #£lf.
mod–_id
 += 1

1271 
£lf
.
mod–_id
 = 
	`g‘_unique_roi_id
()

1273 
£lf
.
mod–_id
 = model_id

1275 
bËmod–
 = 
£lf
.
	`bËmod–_şass
(£lf.
hdrLi¡
, [], self)

1276 
£lf
.
mod–s
[£lf.
mod–_id
] = 
bËmod–


1277 
sÿn
 
š
 
sÿÆi¡
:

1278 
£lf
.
	`add_sÿn
(
sÿn
)

1280 #£ˆ
the
 
Ãw
 
mod–
 
to
 
be
h
cu¼’t
 model

1281 
£lf
.
	`sw™ch_mod–s
(£lf.
mod–_id
)

1282 
£lf
.
	`£t_mod–_cŞumn_deçuÉs
()

1283 
£lf
.
	`cÚÃù_sigÇls
()

1284 (
£lf
.
mod–_id
)

1286 
def
 
	$sw™ch_mod–s
(
£lf
, 
mod–_id
):

1288 
	$sw™ch_mod–s
(): 
desütiÚ


1290 :
·¿m
 
mod–_id
: mod–_id 
desütiÚ


1291 :
ty³
 
mod–_id
: model_idype

1293 :
»tuºs
: 
NÚe


1296 #´šˆ'sw™ch_mod–s: mod–_id [%d]' % 
mod–_id


1297 if(
mod–_id
 
š
 
£lf
.
mod–s
.
	$keys
()):

1298 
£lf
.
bËmod–
ğ£lf.
mod–s
[
mod–_id
]

1299 
£lf
.
mod–_id
 = model_id

1300 
£lf
.
	`£tMod–
(£lf.
bËmod–
)

1301 
£lf
.
	`discÚÃù_sigÇls
()

1302 
£lf
.
	`cÚÃù_sigÇls
()

1303 (
True
)

1304 (
F®£
)

1306 
def
 
	$Ú_mod–_chªged
(
£lf
, 
row
, 
sÿn
):

1308 
	$Ú_mod–_chªged
(): 
desütiÚ


1310 :
·¿m
 
row
:„ow 
desütiÚ


1311 :
ty³
 
row
:„owype

1313 :
·¿m
 
sÿn
: sÿÀ
desütiÚ


1314 :
ty³
 
sÿn
: scanype

1316 :
»tuºs
: 
NÚe


1319 
£lf
.
sÿn_chªged
.
	`em™
(
row
, 
sÿn
)

1321 
def
 
	$add_sÿn
(
£lf
, 
sÿn
, 
sÿn_id
):

1323 
	$add_sÿn
(): 
desütiÚ


1325 :
·¿m
 
sÿn
: sÿÀ
desütiÚ


1326 :
ty³
 
sÿn
: scanype

1328 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


1329 :
ty³
 
sÿn_id
: scan_idype

1331 :
»tuºs
: 
NÚe


1334 
sucûss
 = 
F®£


1335 #mak
su»
 
th©
 
the
 
sÿn_id
 
is
 
ª
 
š‹g”
 
™
 i 
¡l
 
a
 
¡ršg


1336 
sÿn
[
SPDB_ID_VAL
] = (
sÿn_id
)

1337 
sucûss
 = 
£lf
.
bËmod–
.
	`add_sÿn
(
sÿn
)

1338 
£lf
.
_cur_£Ëùed_sÿn
 = 
sÿn


1339 
£lf
.
	`£t_mod–_cŞumn_deçuÉs
()

1340 
sucûss
 = 
True


1341 (
sucûss
)

1344 
şass
 
	$Ba£S–eùiÚWidg‘
(
QtWidg‘s
.
QWidg‘
):

1345 
mod–_chªge
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
)

1346 
chªged
 = 
QtCÜe
.
	`pyqtSigÇl
()

1348 
def
 
	$__š™__
(
£lf
):

1350 
	$__š™__
(): 
desütiÚ


1352 :
·¿m
 
ev_£l_widg‘
=
NÚe
:ƒv_£l_widg‘=NÚ
desütiÚ


1353 :
ty³
 
ev_£l_widg‘
=
NÚe
:ƒv_sel_widget=Noneype

1355 :
»tuºs
: 
NÚe


1357 
QtWidg‘s
.
QWidg‘
.
	`__š™__
(
£lf
)

1358 
£lf
.
add_»giÚ_’abËd
 = 
True


	@widgets/scan_table_view/baseScanTable.py

2 
C»©ed
 
	gÚ
 2013-05-16

4 @
	gauthÜ
: 
b”gr


6 
impÜt
 
numpy
 
as
 
Å


7 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
	gQtWidg‘s


8 
impÜt
 
	gcİy


10 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


11 
äom
 
	gşs
.
	guts
.
roi_uts
 
impÜt
 
	gg‘_ba£_roi
, 
	gg‘_ba£_’”gy_roi
, \

12 
	gg‘_•u_pŞ_dù
, 
	gmake_¥©Ÿl_db_diù
, 
	gwidg‘_com_cmnd_ty³s
, \

13 
	gÚ_¿nge_chªged
, 
	gÚ_Åošts_chªged
, 
	gÚ_¡•_size_chªged
, 
	gÚ_¡¬t_chªged
, 
	gÚ_¡İ_chªged
, \

14 
	gÚ_ûÁ”_chªged
, 
	g»ÿlc_£ošts
, 
	gg‘_unique_roi_id


16 
äom
 
	gşs
.
	gsÿÂšg
.
¡xmTy³s
 
impÜt
 
	gsÿn_ty³s
, 
	gsÿn_·Ãl_Üd”
, 
	gsÿn_image_ty³s
, 
	g¥©Ÿl_ty³_´efix
, 
	gIMAGE_LXL
, 
	gIMAGE_PXP
, 
	g’”gy_sÿn_Üd”_ty³s


17 
äom
 
	gşs
.
	guts
.
diù_uts
 
impÜt
 
	gdù_put
, 
	gdù_g‘


18 
äom
 
	gşs
.
	guts
.
roi_diù_defs
 
	gimpÜt
 *

20 
äom
 
	gbcm
.
	gdeviû
.
deviû_Çmes
 
	gimpÜt
 *

22 
	g_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

24 #thi 
is
 
the
 
v®ue
 
th©
 
wl
 
be
 
added
 
to
h
¡¬t
 
ªd
 
’d
 
of
 
—ch
 
exŒa
 
EV
 
»giÚ


25 
EV_SCAN_EDGE_RANGE
 = 0.2

26 
TABLE_FONT_SIZE
 = 8

28 
SPATIAL_CNTR
 = 1000

29 
EV_CNTR
 = 500

30 
POL_CNTR
 = 0

32 
MAX_SPATIAL_ROWS
 = 20

33 #£lf.
£tStyËSh“t
("color: blue;"

34 #"
background
-
cŞÜ
: 
rgb
(114, 148, 240);"

35 #"
£ËùiÚ
-
cŞÜ
: 
y–low
;"

36 #"
£ËùiÚ
-
background
-
cŞÜ
: 
blue
;")

39 
SPATIAL_SS
 = "QHeaderView::section {background:„gb(200,200, 200);background-color:„gb(200,200, 200); selection-background-color: ; selection-color: ;} background-color:„gb(200,200, 200); selection-background-color: ; selection-color: ;"

40 
EV_SS
 = "QHeaderView::section {background:„gb(200,200, 200);background-color:„gb(200,200, 200); selection-background-color: ; selection-color: ;}background-color:„gb(220,220, 220); selection-background-color: ; selection-color: ;"

41 
POL_SS
 = "QHeaderView::section {background:„gb(200,200, 200);background-color:„gb(200,200, 200); selection-background-color: ; selection-color: ;}background-color:„gb(240,240, 240); selection-background-color: ; selection-color: ;"

43 
SPATIAL_SS
 = ""

44 
EV_SS
 = ""

45 
POL_SS
 = ""

47 
def
 
	$make_1d_¬¿y
(
num±s
, 
v®
):

48 
¬r
 = 
Å
.
	`Úes
(
num±s
)

49 
¬r
[:] = 
v®


50 (
¬r
)

52 
şass
 
	$SÿnO±iÚE¼Ü
(
Exû±iÚ
):

54 
def
 
	$__š™__
(
£lf
, 
msg
):

56 
	$__š™__
(): 
desütiÚ


58 :
·¿m
 
msg
: msg 
desütiÚ


59 :
ty³
 
msg
: msgype

61 :
»tuºs
: 
NÚe


63 
£lf
.
msg
 = msg

64 
def
 
	$__¡r__
(
£lf
):

66 
	$__¡r__
(): 
desütiÚ


68 :
»tuºs
: 
NÚe


70  
	`»´
(
£lf
.
msg
)

73 #QTabËWidg‘ 
sigÇls


74 #void 
	`ûÎAùiv©ed
 ( 
row
, 
cŞumn
 )

75 #void 
	`ûÎChªged
 ( 
row
, 
cŞumn
 )

76 #void 
	`ûÎClicked
 ( 
row
, 
cŞumn
 )

77 #void 
	`ûÎDoubËClicked
 ( 
row
, 
cŞumn
 )

78 #void 
	`ûÎEÁ”ed
 ( 
row
, 
cŞumn
 )

79 #void 
	`ûÎP»s£d
 ( 
row
, 
cŞumn
 )

80 #void 
	`cu¼’tC–lChªged
 ( 
cu¼’tRow
, 
cu¼’tCŞumn
, 
´eviousRow
, 
´eviousCŞumn
 )

81 #void 
	`cu¼’tI‹mChªged
 ( 
QTabËWidg‘I‹m
 * 
cu¼’t
, QTabËWidg‘I‹m * 
´evious
 )

82 #void 
	`™emAùiv©ed
 ( 
QTabËWidg‘I‹m
 * 
™em
 )

83 #void 
	`™emChªged
 ( 
QTabËWidg‘I‹m
 * 
™em
 )

84 #void 
	`™emClicked
 ( 
QTabËWidg‘I‹m
 * 
™em
 )

85 #void 
	`™emDoubËClicked
 ( 
QTabËWidg‘I‹m
 * 
™em
 )

86 #void 
	`™emEÁ”ed
 ( 
QTabËWidg‘I‹m
 * 
™em
 )

87 #void 
	`™emP»s£d
 ( 
QTabËWidg‘I‹m
 * 
™em
 )

88 #void 
	`™emS–eùiÚChªged
 ()

91 
şass
 
	$Ba£SÿnTabËMod–
(
QtCÜe
.
QAb¡¿ùTabËMod–
):

93 
sÿn_chªged
 = 
QtCÜe
.
	`pyqtSigÇl
(, 
objeù
)

95 
def
 
	$__š™__
(
£lf
, 
hdrLi¡
=[], 
d©aš
=[[]], 
·»Á
 = 
NÚe
, *
¬gs
):

97 
	$__š™__
(): 
desütiÚ


99 :
·¿m
 
hdrLi¡
=[]: hdrLi¡=[] 
desütiÚ


100 :
ty³
 
hdrLi¡
=[]: hdrList=[]ype

102 :
·¿m
 
d©aš
=[[]]: d©aš=[[]] 
desütiÚ


103 :
ty³
 
d©aš
=[[]]: datain=[[]]ype

105 :
·¿m
 
·»Á
=
NÚe
:…¬’t=NÚ
desütiÚ


106 :
ty³
 
·»Á
=
NÚe
:…arent=Noneype

108 :
·¿m
 *
¬gs
: *¬g 
desütiÚ


109 :
ty³
 *
¬gs
: *argsype

111 :
»tuºs
: 
NÚe


113 #QtCÜe.
QAb¡¿ùTabËMod–
.
	`__š™__
(
£lf
, 
·»Á
, *
¬gs
)

114 
	`su³r
(
Ba£SÿnTabËMod–
, 
£lf
).
	`__š™__
(
·»Á
, *
¬gs
)

115 
£lf
.
sÿnLi¡D©a
 = 
	`li¡
(
d©aš
)

116 
£lf
.
hdrLi¡
 = 
	`li¡
(hdrList)

117 
£lf
.
sÿnProg»ss
 = {
	}
}

118 
£lf
.
cur_sÿn_id
 = 0

119 
£lf
.
cŞumn_m­
 = 
NÚe


121 
£lf
.
mš_rows
 = 0

122 
£lf
.
max_rows
 = 1

124 
£lf
.
v®id_¿nge
 = (
NÚe
, None, None, None)

126 #hav
a
 
way
 
to
 
£t
 
¥ecific
 
rows
 
Ü
 
cŞumns
 
»ad
 
Úly


127 
£lf
.
rd_Úly_rows
 = {}

128 
£lf
.
rd_Úly_cŞs
 = {}

130 
£lf
.
_g‘_funcs
 = []

131 
£lf
.
_£t_funcs
 = []

133 
def
 
	$g‘_cŞumn_w™h_Çme
(
£lf
, 
Çme
):

134 
i
 = 0

135 
™em
 
š
 
£lf
.
cŞumn_m­
:

136 if(
™em
['hdr'] =ğ
Çme
):

137 (
i
)

138 
i
 += 1

139 (
NÚe
)

141 
def
 
	$£t_mš_rows
(
£lf
, 
v®
):

143 
	$£t_mš_rows
(): 
desütiÚ


145 :
·¿m
 
v®
: v® 
desütiÚ


146 :
ty³
 
v®
: valype

148 :
»tuºs
: 
NÚe


150 
£lf
.
mš_rows
 = 
v®


152 
def
 
	$£t_max_rows
(
£lf
, 
v®
):

154 
	$£t_max_rows
(): 
desütiÚ


156 :
·¿m
 
v®
: v® 
desütiÚ


157 :
ty³
 
v®
: valype

159 :
»tuºs
: 
NÚe


161 
£lf
.
max_rows
 = 
v®


163 
def
 
	$£t_sÿn_li¡
(
£lf
, 
sÿnLi¡
):

165 
	$£t_sÿn_li¡
(): 
desütiÚ


167 :
·¿m
 
sÿnLi¡
: sÿnLi¡ 
desütiÚ


168 :
ty³
 
sÿnLi¡
: scanListype

170 :
»tuºs
: 
NÚe


172 
£lf
.
sÿnLi¡D©a
 = 
sÿnLi¡
[:]

174 
def
 
	$g‘_sÿn_li¡
(
£lf
):

176 
	$g‘_sÿn_li¡
(): 
desütiÚ


178 :
»tuºs
: 
NÚe


180 #»tuº 
a
 
cİy


181 (
£lf
.
sÿnLi¡D©a
[:])

183 
def
 
	$£t_ed™abË
(
£lf
, 
ed
):

185 
	$£t_ed™abË
(): 
desütiÚ


187 :
·¿m
 
ed
:ƒd 
desütiÚ


188 :
ty³
 
ed
:ƒdype

190 :
»tuºs
: 
NÚe


192 
£lf
.
ed™abË
 = 
ed


194 
def
 
	$g‘_sÿns
(
£lf
):

196 
	$g‘_sÿns
(): 
desütiÚ


198 :
»tuºs
: 
NÚe


200 #»tuº 
a
 
cİy


201 (
£lf
.
sÿnLi¡D©a
[:])

203 
def
 
	$g‘_ûÎ
(
£lf
, 
row
, 
cŞ
):

205 
	$g‘_ûÎ
(): 
desütiÚ


207 :
·¿m
 
row
:„ow 
desütiÚ


208 :
ty³
 
row
:„owype

210 :
·¿m
 
cŞ
: cŞ 
desütiÚ


211 :
ty³
 
cŞ
: colype

213 :
»tuºs
: 
NÚe


215 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

216 (
	`¡r
(
sÿn
[
£lf
.
cŞumn_m­
[
cŞ
]]))

218 
def
 
	$£t_g‘£t_funcs
(
£lf
, 
funşi¡
):

220 
	$£t_g‘£t_funcs
(): 
desütiÚ


222 :
·¿m
 
funşi¡
: funşi¡ 
desütiÚ


223 :
ty³
 
funşi¡
: funclistype

225 :
»tuºs
: 
NÚe


228 
the
 
v›w
 
ÿn
 
£t
 
a
 
cu¡om
 
li¡
 
of
 
funùiÚs
 

229 
g‘tšg
 
ªd
 
£‰šg
 
—ch
 
cŞumn
 
š
 
the
 
bË


231 
f
 
š
 
funşi¡
:

232 
£lf
.
_g‘_funcs
.
	`­³nd
('g‘_' + 
f
)

233 
£lf
.
_£t_funcs
.
	`­³nd
('£t_' + 
f
)

236 
def
 
	$£t_row_»adÚly
(
£lf
, 
row
, 
rdÚly
=
True
):

238 
	$£t_row_»adÚly
(): 
desütiÚ


240 :
·¿m
 
row
:„ow 
desütiÚ


241 :
ty³
 
row
:„owype

243 :
·¿m
 
rdÚly
=
True
:„dÚly=Tru
desütiÚ


244 :
ty³
 
rdÚly
=
True
:„donly=Trueype

246 :
»tuºs
: 
NÚe


248 if(
rdÚly
):

249 
£lf
.
rd_Úly_rows
[
row
] = 
rdÚly


251 
d–
 
£lf
.
rd_Úly_rows
[
row
]

253 
def
 
	$£t_cŞ_»adÚly
(
£lf
, 
cŞ
, 
rdÚly
=
True
):

255 
	$£t_cŞ_»adÚly
(): 
desütiÚ


257 :
·¿m
 
cŞ
: cŞ 
desütiÚ


258 :
ty³
 
cŞ
: colype

260 :
·¿m
 
rdÚly
=
True
:„dÚly=Tru
desütiÚ


261 :
ty³
 
rdÚly
=
True
:„donly=Trueype

263 :
»tuºs
: 
NÚe


265 if(
rdÚly
):

266 
£lf
.
rd_Úly_cŞs
[
cŞ
] = 
rdÚly


268 
d–
 
£lf
.
rd_Úly_cŞs
[
cŞ
]

270 
def
 
	$_sÿn_nÙ_exi¡
(
£lf
, 
sÿn_id
):

272 
	$_sÿn_nÙ_exi¡
(): 
desütiÚ


274 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


275 :
ty³
 
sÿn_id
: scan_idype

277 :
»tuºs
: 
NÚe


279 
sÿn
 
š
 
£lf
.
sÿnLi¡D©a
:

280 #if(
	`ha§‰r
(
sÿn
, 
SPDB_ID_VAL
)):

281 if(
SPDB_ID_VAL
 
š
 
sÿn
.
	$keys
()):

282 if(
sÿn
[
SPDB_ID_VAL
] =ğ
sÿn_id
):

283 #´šˆ'_g‘_sÿn_rowidx:„‘uºšg %d' % 
row


284 (
F®£
)

285 (
True
)

287 
def
 
	$add_sÿn
(
£lf
, 
sÿn
):

289 
	$add_sÿn
(): 
desütiÚ


291 :
·¿m
 
sÿn
: sÿÀ
desütiÚ


292 :
ty³
 
sÿn
: scanype

294 :
»tuºs
: 
NÚe


298 
SPATIAL_CNTR
 = 10000

299 
EV_CNTR
 = 5000

300 
POL_CNTR
 = 0

302 if(
£lf
.
	`rowCouÁ
(è>ğ£lf.
max_rows
):

305 if(
sÿn
[
SPDB_ID_VAL
] 
is
 
NÚe
):

306 #th
mod–
 
is
 
bešg
 
š™Ÿlized


307 
sÿn
[
SPDB_ID_VAL
] = 0

309 if(
£lf
.
	$_sÿn_nÙ_exi¡
(
sÿn
[
SPDB_ID_VAL
])):

310 
£lf
.
	`š£¹Row
(
sÿn
)

311 (
True
)

313 (
F®£
)

315 
def
 
	`š£¹Row
(
£lf
, 
sÿn
, 
·»Á
=
QtCÜe
.
	$QMod–Index
()):

317 
	$š£¹Row
(): 
desütiÚ


319 :
·¿m
 
sÿn
: sÿÀ
desütiÚ


320 :
ty³
 
sÿn
: scanype

322 :
·¿m
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
desütiÚ


323 :
ty³
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
ty³


325 :
»tuºs
: 
NÚe


327 
£lf
.
	`begšIn£¹Rows
(
·»Á
, s–f.
	`rowCouÁ
(parent), self.rowCount(parent))

328 
£lf
.
sÿnLi¡D©a
.
	`­³nd
(
sÿn
)

329 
£lf
.
	`’dIn£¹Rows
()

330 #£lf.
d©aChªged
.
	`em™
(
·»Á
,…arent)

331 (
£lf
.
	`rowCouÁ
(
·»Á
))

333 
def
 
	`»moveRow
(
£lf
, 
row
, 
·»Á
=
QtCÜe
.
	$QMod–Index
()):

335 
	$»moveRow
(): 
desütiÚ


337 :
·¿m
 
row
:„ow 
desütiÚ


338 :
ty³
 
row
:„owype

340 :
·¿m
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
desütiÚ


341 :
ty³
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
ty³


343 :
»tuºs
: 
NÚe


345 #row = 
£lf
.
	`g‘_sÿn_rowidx
(
sÿn_id
)

346 if(
£lf
.
	`rowCouÁ
(è=ğ£lf.
mš_rows
):

348 if(
row
 !ğ
NÚe
):

349 
£lf
.
	`begšRemoveRows
(
·»Á
, 
row
,„ow)

350 
	`d–
(
£lf
.
sÿnLi¡D©a
[
row
])

351 
£lf
.
	`’dRemoveRows
()

352 
£lf
.
d©aChªged
.
	`em™
(
·»Á
,…arent)

355 
def
 
	`»moveAÎ
(
£lf
, 
·»Á
=
QtCÜe
.
	$QMod–Index
()):

357 
	$»moveAÎ
(): 
desütiÚ


359 :
·¿m
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
desütiÚ


360 :
ty³
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
ty³


362 :
»tuºs
: 
NÚe


364 
£lf
.
	`begšRemoveRows
(
·»Á
, 0, 
	`Ën
(£lf.
sÿnLi¡D©a
))

365 #£lf.
sÿnLi¡D©a
 = []

366 
row
 
š
 
	`¿nge
(
	$Ën
(
£lf
.
sÿnLi¡D©a
)):

367 #th
li¡
 
shršks
 
—ch
 
time
 
so
 
Úly
 
d–‘e
 
äom
 
‹h
 
tİ


368 
	`d–
(
£lf
.
sÿnLi¡D©a
[0])

369 
£lf
.
	`’dRemoveRows
()

370 
£lf
.
d©aChªged
.
	`em™
(
·»Á
,…arent)

372 
def
 
	$£t_sÿn_fÜ_sšgË_ev
(
£lf
):

374 
	$£t_sÿn_fÜ_sšgË_ev
(): 
desütiÚ


376 :
»tuºs
: 
NÚe


378 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[0]

379 
sÿn
['STOP'] = scan['START']

380 
sÿn
['RANGE'] = 0.0

381 
sÿn
['NPOINTS'] = 1

382 
sÿn
['STEP'] = 0.0

384 
def
 
	`»move_®l_exû±_fœ¡
(
£lf
, 
sÿn_id
, 
·»Á
=
QtCÜe
.
	$QMod–Index
()):

386 
	$»move_®l_exû±_fœ¡
(): 
desütiÚ


388 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


389 :
ty³
 
sÿn_id
: scan_idype

391 :
·¿m
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
desütiÚ


392 :
ty³
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
ty³


394 :
»tuºs
: 
NÚe


396 
l
 = 
	`¿nge
(1, 
	`Ën
(
£lf
.
sÿnLi¡D©a
))

397 
l
.
	`»v”£
()

398 
£lf
.
	`begšRemoveRows
(
·»Á
, 1, 
	`Ën
(
l
))

400 
row
 
š
 
l
:

401 
	`d–
(
£lf
.
sÿnLi¡D©a
[
row
])

402 
£lf
.
	`’dRemoveRows
()

403 
£lf
.
	`£t_sÿn_fÜ_sšgË_ev
()

404 
£lf
.
d©aChªged
.
	`em™
(
·»Á
,…arent)

406 
def
 
	$g‘_sÿn_rowidx
(
£lf
, 
sÿn_id
):

408 
	$g‘_sÿn_rowidx
(): 
desütiÚ


410 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


411 :
ty³
 
sÿn_id
: scan_idype

413 :
»tuºs
: 
NÚe


416 
row
 = 0

417 #´šˆ'checkšg fÜ sÿn_id = %d' % 
sÿn_id


418 
sÿn
 
š
 
£lf
.
sÿnLi¡D©a
:

419 #´šˆ'g‘_sÿn_rowidx: [%d] = %d' % (
row
, 
sÿn
['ID'])

420 if(
sÿn
[
SPDB_ID_VAL
] =ğ
sÿn_id
):

421 #´šˆ'_g‘_sÿn_rowidx:„‘uºšg %d' % 
row


422 (
row
)

423 
row
 += 1

424 (
NÚe
)

426 
def
 
	$»¶aû_sÿn
(
£lf
, 
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
=
True
):

428 
	$»¶aû_sÿn
(): 
desütiÚ


430 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


431 :
ty³
 
sÿn_id
: scan_idype

433 :
·¿m
 
Ãwsÿn
:‚ewsÿÀ
desütiÚ


434 :
ty³
 
Ãwsÿn
:‚ewscanype

436 :
·¿m
 
do_¡•_Åts
=
True
: do_¡•_Åts=Tru
desütiÚ


437 :
ty³
 
do_¡•_Åts
=
True
: do_step_npts=Trueype

439 :
»tuºs
: 
NÚe


442 
row
 = 0

443 
sÿn
 
š
 
£lf
.
sÿnLi¡D©a
:

444 #´šˆ'g‘_sÿn_rowidx: [%d] = %d' % (
row
, 
sÿn
['ID'])

445 if(
sÿn
[
SPDB_ID_VAL
] =ğ
sÿn_id
):

446 
£lf
.
sÿnLi¡D©a
[
row
][
SPDB_X
]['CENTER'] = 
Ãwsÿn
[SPDB_X]['CENTER']

447 
£lf
.
sÿnLi¡D©a
[
row
][
SPDB_Y
]['CENTER'] = 
Ãwsÿn
[SPDB_Y]['CENTER']

448 
£lf
.
sÿnLi¡D©a
[
row
][
SPDB_X
]['RANGE'] = 
Ãwsÿn
[SPDB_X]['RANGE']

449 
£lf
.
sÿnLi¡D©a
[
row
][
SPDB_Y
]['RANGE'] = 
Ãwsÿn
[SPDB_Y]['RANGE']

450 #if(
do_¡•_Åts
):

451 
£lf
.
sÿnLi¡D©a
[
row
][
SPDB_X
]['STEP'] = 
Ãwsÿn
[SPDB_X]['STEP']

452 
£lf
.
sÿnLi¡D©a
[
row
][
SPDB_Y
]['STEP'] = 
Ãwsÿn
[SPDB_Y]['STEP']

453 
£lf
.
sÿnLi¡D©a
[
row
][
SPDB_X
]['NPOINTS'] = 
Ãwsÿn
[SPDB_X]['NPOINTS']

454 
£lf
.
sÿnLi¡D©a
[
row
][
SPDB_Y
]['NPOINTS'] = 
Ãwsÿn
[SPDB_Y]['NPOINTS']

455 
row
 += 1

458 
def
 
	$g‘_sÿn_by_row
(
£lf
, 
row
):

460 
	$g‘_sÿn_by_row
(): 
desütiÚ


462 :
·¿m
 
row
:„ow 
desütiÚ


463 :
ty³
 
row
:„owype

465 :
»tuºs
: 
NÚe


468 #´šˆ'checkšg fÜ sÿn_id = %d' % 
sÿn_id


469 (
£lf
.
sÿnLi¡D©a
[
row
])

471 
def
 
	$g‘_sÿn
(
£lf
, 
sÿn_id
):

473 
	$g‘_sÿn
(): 
desütiÚ


475 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


476 :
ty³
 
sÿn_id
: scan_idype

478 :
»tuºs
: 
NÚe


481 #´šˆ'checkšg fÜ sÿn_id = %d' % 
sÿn_id


482 
sÿn
 
š
 
£lf
.
sÿnLi¡D©a
:

483 #´šˆ'g‘_sÿn_rowidx: [%d] = %d' % (
row
, 
sÿn
['ID'])

484 if(
sÿn
[
SPDB_ID_VAL
] =ğ
sÿn_id
):

485 #´šˆ'_g‘_sÿn_rowidx:„‘uºšg %d' % 
row


486 (
sÿn
)

487 (
NÚe
)

489 
def
 
	$£t_cur_sÿn_´og»ss
(
£lf
, 
´og»ss
, 
sÿn_id
):

491 
	$£t_cur_sÿn_´og»ss
(): 
desütiÚ


493 :
·¿m
 
´og»ss
:…rog»s 
desütiÚ


494 :
ty³
 
´og»ss
:…rogressype

496 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


497 :
ty³
 
sÿn_id
: scan_idype

499 :
»tuºs
: 
NÚe


502 
sÿn
 
š
 
£lf
.
sÿnLi¡D©a
:

503 if(
sÿn
[
SPDB_ID_VAL
] =ğ
sÿn_id
):

504 
£lf
.
sÿnProg»ss
[
sÿn_id
] = 
´og»ss


505 
£lf
.
cur_sÿn_id
 = 
sÿn_id


506 #Ãed 
to
 
fœe
 
the
 
sigÇl
 
so
 
th©
h
di¥Ïy
 
rŞe
 
wl
 
g‘
 
´oûs£d


507 
row
 = 
£lf
.
	`_g‘_sÿn_rowidx
(
sÿn_id
)

508 
šdex
 = 
QtCÜe
.
	`QMod–Index
()

509 
£lf
.
d©aChªged
.
	`em™
(
šdex
, index)

511 #_logg”.
	`šfo
('cu¼’ˆsÿÀID [%ld] ha ´og»s %f' % (
sÿn_id
, 
´og»ss
))

513 
def
 
	$£t_h—d”
(
£lf
, 
hdrLi¡
):

515 
	$£t_h—d”
(): 
desütiÚ


517 :
·¿m
 
hdrLi¡
: hdrLi¡ 
desütiÚ


518 :
ty³
 
hdrLi¡
: hdrListype

520 :
»tuºs
: 
NÚe


522 
hdr
 
š
 
hdrLi¡
:

523 
£lf
.
hdrLi¡
.
	`­³nd
(
hdr
)

525 
def
 
	`rowCouÁ
(
£lf
, 
·»Á
=
QtCÜe
.
	$QMod–Index
()):

527 
	$rowCouÁ
(): 
desütiÚ


529 :
·¿m
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
desütiÚ


530 :
ty³
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
ty³


532 :
»tuºs
: 
NÚe


534  
	`Ën
(
£lf
.
sÿnLi¡D©a
)

536 
def
 
	`cŞumnCouÁ
(
£lf
, 
·»Á
=
QtCÜe
.
	$QMod–Index
()):

538 
	$cŞumnCouÁ
(): 
desütiÚ


540 :
·¿m
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
desütiÚ


541 :
ty³
 
·»Á
=
QtCÜe
.
	$QMod–Index
(): 
·»Á
=
QtCÜe
.
	$QMod–Index
(è
ty³


543 :
»tuºs
: 
NÚe


545  
	`Ën
(
£lf
.
hdrLi¡
)

548 
def
 
	$h—d”D©a
(
£lf
, 
£ùiÚ
, 
Ü›Á©iÚ
, 
rŞe
):

550 
	$h—d”D©a
(): 
desütiÚ


552 :
·¿m
 
£ùiÚ
: seùiÚ 
desütiÚ


553 :
ty³
 
£ùiÚ
: sectionype

555 :
·¿m
 
Ü›Á©iÚ
: or›Á©iÚ 
desütiÚ


556 :
ty³
 
Ü›Á©iÚ
: orientationype

558 :
·¿m
 
rŞe
:„Ş
desütiÚ


559 :
ty³
 
rŞe
:„oleype

561 :
»tuºs
: 
NÚe


564 
Œy
:

565 ià(
rŞe
 =ğ
QtCÜe
.
Qt
.
Di¥ÏyRŞe
):

566 ià(
Ü›Á©iÚ
 =ğ
QtCÜe
.
Qt
.
HÜizÚl
):

567 #»tuº 
QtCÜe
.
	`QSŒšg
(
£lf
.
hdrLi¡
[
£ùiÚ
])

568  
£lf
.
hdrLi¡
[
£ùiÚ
]

569 
exû±
 
IndexE¼Ü
:

570 
s
 = "Index[%d]ƒ¼Ü iÀh—d”†i¡" % 
£ùiÚ


571 
¿i£
 
	`SÿnO±iÚE¼Ü
(
s
)

573  
QtCÜe
.
	`QV¬ŸÁ
()

575 
def
 
	$d©a
(
£lf
, 
šdex
, 
rŞe
):

577 
	$d©a
(): 
desütiÚ


579 :
·¿m
 
šdex
: index 
desütiÚ


580 :
ty³
 
šdex
: indexype

582 :
·¿m
 
rŞe
:„Ş
desütiÚ


583 :
ty³
 
rŞe
:„oleype

585 :
»tuºs
: 
NÚe


588 
row
 = 
šdex
.
	`row
()

589 
cŞ
 = 
šdex
.
	`cŞumn
()

590 
’abËd
 = 
F®£


592 
nÙ
 
šdex
.
	$isV®id
():

593 
´št
 'index is invalid'

594  
NÚe


596 
æags
 = 
šdex
.
	`æags
()

597 
æags
 & 
QtCÜe
.
Qt
.
I‹mIsEd™abË
:

598 
’abËd
 = 
True


600 
rŞe
 =ğ
QtCÜe
.
Qt
.
Di¥ÏyRŞe
:

601 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

602 if(
cŞ
 == 0):

603 
v
 = 
sÿn
[
SPDB_ID_VAL
]

605 
v
 = 
sÿn
[
£lf
.
cŞumn_m­
[
cŞ
]]

607 if(
	$ty³
(
v
è
is
 
¡r
):

608 (
v
)

609 if(
	$ty³
(
v
è
is
 
Å
.
æßt64
):

610 
v®
 = '%.3f' % 
v


611 (
v®
)

612 if(
	$ty³
(
v
è
is
 ):

613 
v®
 = '%.3f' % 
v


614 (
v®
)

615 if(
	$ty³
(
v
è
is
 ):

616 
v®
 = '%d' % 
v


617 (
v®
)

618 if(
	$ty³
(
v
è
is
 ):

619 
v®
 = '%d' % 
v


620 (
v®
)

621 if(
	$ty³
(
v
è
is
 
boŞ
):

622 if(
v
):

627 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
BackgroundRŞe
:

628 if(
cŞ
 == 0):

629 
bg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
g¿y
)

630 
	`–if
(
cŞ
 < 5):

631 
bg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
lightG¿y
)

634 if(
’abËd
):

635 
bg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
wh™e
)

637 
bg
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(220, 220, 220))

638  
bg


639 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
FÜegroundRŞe
:

640 if(
’abËd
):

641 
fg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
bÏck
)

643 
fg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
blue
)

644  
fg


645 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
FÚtRŞe
:

646 
ât
 = 
QtGui
.
	`QFÚt
()

647 
ât
.
	`£tPoštSize
(
TABLE_FONT_SIZE
)

648 if(
cŞ
 == 0):

649 
ât
.
	`£tBŞd
(
True
)

650  
ât


651 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
TextAlignm’tRŞe
:

652 ià(
cŞ
 == 0):

653 (
QtCÜe
.
Qt
.
AlignLeá
)

655 #»tuº(
QtCÜe
.
Qt
.
AlignRight
)

656 (
QtCÜe
.
Qt
.
AlignC’‹r
)

659 #´šˆ'»tuºšg NÚ[%d,%d]„Şğ%d' % (
row
,
cŞ
, 
rŞe
)

660  
NÚe


662 
def
 
	$modify_d©a
(
£lf
, 
sÿn_id
, 
sÿn
):

664 
	$modify_d©a
(): 
desütiÚ


666 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


667 :
ty³
 
sÿn_id
: scan_idype

669 :
·¿m
 
sÿn
: sÿÀ
desütiÚ


670 :
ty³
 
sÿn
: scanype

672 :
»tuºs
: 
NÚe


675 
·ss


677 
def
 
	$£tD©a
(
£lf
, 
šdex
, 
v®ue
, 
rŞe
, 
»ÿlc
=
True
):

679 
	$£tD©a
(): 
desütiÚ


681 :
·¿m
 
šdex
: index 
desütiÚ


682 :
ty³
 
šdex
: indexype

684 :
·¿m
 
v®ue
: v®u
desütiÚ


685 :
ty³
 
v®ue
: valueype

687 :
·¿m
 
rŞe
:„Ş
desütiÚ


688 :
ty³
 
rŞe
:„oleype

690 :
·¿m
 
»ÿlc
=
True
:„eÿlc=Tru
desütiÚ


691 :
ty³
 
»ÿlc
=
True
:„ecalc=Trueype

693 :
»tuºs
: 
NÚe


696 
·ss


698 
def
 
	$æags
(
£lf
, 
šdex
):

700 
	$æags
(): 
desütiÚ


702 :
·¿m
 
šdex
: index 
desütiÚ


703 :
ty³
 
šdex
: indexype

705 :
»tuºs
: 
NÚe


708 #´šˆ'%d, %d' % (
šdex
.
	`row
(), index.
	`cŞumn
())

709 
row
 = 
šdex
.
	`row
()

710 
cŞ
 = 
šdex
.
	`cŞumn
()

711 
rowRdOÆy
 = 
row
 
š
 
£lf
.
rd_Úly_rows
.
	`keys
()

712 
cŞRdOÆy
 = 
cŞ
 
š
 
£lf
.
rd_Úly_cŞs
.
	`keys
()

713 if(
rowRdOÆy
):

714  
QtCÜe
.
Qt
.
I‹mIsEd™abË
 | QtCÜe.Qt.
I‹mIsS–eùabË


715 
	$–if
(
cŞRdOÆy
):

716  
QtCÜe
.
Qt
.
I‹mIsEÇbËd
 | QtCÜe.Qt.
I‹mIsS–eùabË


718  
QtCÜe
.
Qt
.
I‹mIsEd™abË
 | QtCÜe.Qt.
I‹mIsEÇbËd
 | QtCÜe.Qt.
I‹mIsS–eùabË


721 
def
 
	$g’_¥©Ÿl_mod–_obj
(
hdr_Çme
, 
func
, 
æoÜ_v®
, 
ûšg_v®
):

722 
dù
 = {
	}
}

723 
dù
['hdr'] = 
hdr_Çme


724 
dù
['func'] = 
func


725 
dù
['æoÜ_v®'] = 
æoÜ_v®


726 
dù
['ûšg_v®'] = 
ûšg_v®


727 (
dù
)

729 #th
C_
 
is
 
C’‹r


730 
C_SPATIAL_DCT
 = []

731 
C_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('ID',
NÚe
,None,None))

732 
C_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('CENTERX', 
Ú_ûÁ”_chªged
, 
NÚe
, None))

733 
C_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('RANGEX', 
Ú_¿nge_chªged
, 
NÚe
, None))

734 
C_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('CENTERY', 
Ú_ûÁ”_chªged
, 
NÚe
, None))

735 
C_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('RANGEY', 
Ú_¿nge_chªged
, 
NÚe
, None))

736 
C_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('STEPX', 
Ú_¡•_size_chªged
, 
NÚe
, None))

737 
C_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('STEPY', 
Ú_¡•_size_chªged
, 
NÚe
, None))

738 
C_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('NPOINTSX', 
Ú_Åošts_chªged
, 0, 20000))

739 
C_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('NPOINTSY', 
Ú_Åošts_chªged
, 0, 20000))

742 #th
S_
 
is
 
S¹


743 
S_SPATIAL_DCT
 = []

744 
S_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('ID',
NÚe
,None,None))

745 
S_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('STARTX',
Ú_¡¬t_chªged
, 
NÚe
, None))

746 
S_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('STOPX',
Ú_¡İ_chªged
, 
NÚe
, None))

747 
S_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('STARTY',
Ú_¡¬t_chªged
, 
NÚe
, None))

748 
S_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('STOPY',
Ú_¡İ_chªged
, 
NÚe
, None))

749 
S_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('STEPX', 
Ú_¡•_size_chªged
, 
NÚe
, None))

750 
S_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('STEPY', 
Ú_¡•_size_chªged
, 
NÚe
, None))

751 
S_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('NPOINTSX', 
Ú_Åošts_chªged
, 0, 20000))

752 
S_SPATIAL_DCT
.
­³nd
(
g’_¥©Ÿl_mod–_obj
('NPOINTSY', 
Ú_Åošts_chªged
, 0, 20000))

755 
def
 
	$g‘_v®_äom_roi
(
¥_db
, 
f›ld
, 
roi_key
):

756 if(
roi_key
 
š
 
¥_db
.
	$keys
()):

757 
roi
 = 
¥_db
[
roi_key
]

759 (
NÚe
)

761 if(
f›ld
 
š
 
roi
.
	$keys
()):

762 (
roi
[
f›ld
])

764 (
NÚe
)

766 
def
 
	$g‘_v®_äom_¥_db
(
f›ld
, 
¥_db
):

767 
axis_key
 = 
f›ld
[-1]

768 
subæd
 = 
f›ld
[0:-1]

770 (
	`g‘_v®_äom_roi
(
¥_db
, 
subæd
, 
axis_key
))

773 
def
 
	$£t_v®_š_roi
(
¥_db
, 
f›ld
, 
roi_key
, 
v®
):

774 if(
roi_key
 
š
 
¥_db
.
	$keys
()):

775 
roi
 = 
¥_db
[
roi_key
]

777 (
NÚe
)

779 if(
f›ld
 
š
 
roi
.
	$keys
()):

780 
roi
[
f›ld
] = 
v®


782 
_logg”
.
	`”rÜ
('f›ld [%s] dÛ¢ˆexi¡ iÀ¥_db' % 
f›ld
)

784 
def
 
	$£t_f›ld_v®_š_¥_db
(
f›ld
, 
v®
, 
¥_db
):

785 
axis_key
 = 
f›ld
[-1]

786 
subæd
 = 
f›ld
[0:-1]

787 
	`£t_v®_š_roi
(
¥_db
, 
subæd
, 
axis_key
, 
v®
)

790 
def
 
	$g‘_roi_äom_¥_db
(
f›ld
, 
¥_db
):

791 
axis_key
 = 
f›ld
[-1]

792 if(
axis_key
 
š
 
¥_db
.
	$keys
()):

793 (
¥_db
[
axis_key
])

795 
_logg”
.
	`”rÜ
('axis_key [%s] dÛ¢ˆexi¡ iÀ¥_db' % 
axis_key
)

798 
şass
 
	$Ba£SÿnTabËV›w
(
QtWidg‘s
.
QTabËV›w
):

800 
This
 
is
 
a
 
widg‘
 
to
 
di¥Ïy
 
the
 
·¿m‘”s
 
of
 
šdividu®
 
sÿns
,hwidg‘ 
»¥Úds
Ø
ûÎ
 
ed™s


801 
ªd
 
fÜûs
 
a
 
»ÿlc
 
of
 
row
 
–em’ts
 
Ãed
 
be
.

803 
row_£Ëùed
 = 
QtCÜe
.
	$pyqtSigÇl
(
objeù
è#row 
d©a


804 
add_»giÚ
 = 
QtCÜe
.
	`pyqtSigÇl
()

805 
d–_»giÚ
 = 
QtCÜe
.
	`pyqtSigÇl
()

806 
sÿn_chªged
 = 
QtCÜe
.
	`pyqtSigÇl
(, 
objeù
)

808 
def
 
	$__š™__
(
£lf
, 
hdrLi¡
, 
sÿnLi¡
, 
bËmod–_şass
, 
·»Á
=
NÚe
):

810 
	$__š™__
(): 
desütiÚ


812 :
·¿m
 
hdrLi¡
: hdrLi¡ 
desütiÚ


813 :
ty³
 
hdrLi¡
: hdrListype

815 :
·¿m
 
sÿnLi¡
: sÿnLi¡ 
desütiÚ


816 :
ty³
 
sÿnLi¡
: scanListype

818 :
·¿m
 
bËmod–_şass
:abËmod–_şas 
desütiÚ


819 :
ty³
 
bËmod–_şass
:ablemodel_classype

821 :
·¿m
 
·»Á
=
NÚe
:…¬’t=NÚ
desütiÚ


822 :
ty³
 
·»Á
=
NÚe
:…arent=Noneype

824 :
»tuºs
: 
NÚe


826 
	`su³r
(
Ba£SÿnTabËV›w
, 
£lf
).
	`__š™__
(
·»Á
)

827 
£lf
.
hdrLi¡
 = hdrList

828 
£lf
.
sÿns
 = 
sÿnLi¡


829 
£lf
.
bËmod–
 = 
NÚe


830 
£lf
.
mod–s
 = {
	}
}

831 
£lf
.
mod–_id_¡¬t_v®
 = 
NÚe


832 
£lf
.
mod–_id
 = 0

833 
£lf
.
mod–_id_l¡
 = []

834 
£lf
.
sigÇls_cÚÃùed
 = 
F®£


836 
£lf
.
v”tiÿlH—d”
().
£tSeùiÚResizeMode
(
QtWidg‘s
.
QH—d”V›w
.
Fixed
)

837 
£lf
.
v”tiÿlH—d”
().
£tDeçuÉSeùiÚSize
(20)

839 
£lf
.
£tS–eùiÚBehaviÜ
(
QtWidg‘s
.
QAb¡¿ùI‹mV›w
.
S–eùRows
)

840 
£lf
.
£tAÉ”ÇtšgRowCŞÜs
(
True
)

842 
ât
 = 
QtGui
.
QFÚt
()

843 
ât
.
£tPoštSize
(
TABLE_FONT_SIZE
)

844 
£lf
.
£tFÚt
(
ât
)

846 
£lf
.
v”tiÿlH—d”
().
£tDeçuÉSeùiÚSize
(15)

848 
£lf
.
_cur_£Ëùed_sÿn
 = 
NÚe


849 
£lf
.
bËmod–_şass
 =ablemodel_class

851 #£lf.
£tS–eùiÚBehaviÜ
(
QtWidg‘s
.
QAb¡¿ùI‹mV›w
.
S–eùI‹ms
)

852 #£lf.
£tHÜizÚlSüŞlMode
(
QtWidg‘s
.
QAb¡¿ùI‹mV›w
.
SüŞlP”Pix–
)

853 #£lf.
hÜizÚlH—d”
().
£tSeùiÚResizeMode
(
QtWidg‘s
.
QH—d”V›w
.
SŒ‘ch
)

854 #£lf.
hÜizÚlH—d”
().
£tSeùiÚResizeMode
(
QtWidg‘s
.
QH—d”V›w
.
IÁ”aùive
)

855 #£lf.
hÜizÚlH—d”
().
£tSeùiÚResizeMode
(
QtWidg‘s
.
QH—d”V›w
.
¡»tchLa¡SeùiÚ
)

856 
£lf
.
sÿnFÏgs
 = {}

857 
£lf
.
_block_upd©es
 = 
F®£


858 #£lf.
şicked
.
cÚÃù
(
£lf
.
Ú_şicked
)

859 #£lf.
£tS–eùiÚBehaviÜ
(
QtWidg‘s
.
QAb¡¿ùI‹mV›w
.
S–eùRows
)

860 #£lf.
£ËùiÚMod–
().
£ËùiÚChªged
.
cÚÃù
(
£lf
.
£lChªged
)

861 
£lf
.
şicked
.
cÚÃù
(£lf.
Ú_şicked
)

863 
def
 
	$cÚ‹xtM’uEv’t
(
£lf
, 
ev’t
):

865 
	$cÚ‹xtM’uEv’t
(): 
desütiÚ


867 :
·¿m
 
ev’t
:ƒv’ˆ
desütiÚ


868 :
ty³
 
ev’t
:ƒventype

870 :
»tuºs
: 
NÚe


872 
m’u
 = 
QtWidg‘s
.
	`QM’u
(
£lf
)

873 
addAùiÚ
 = 
m’u
.
	`addAùiÚ
("Add„egion")

874 
d–AùiÚ
 = 
m’u
.
	`addAùiÚ
("Delete„egion")

875 
dmpMod–AùiÚ
 = 
m’u
.
	`addAùiÚ
("Dump Selected Model")

876 
aùiÚ
 = 
m’u
.
	`exec_
(
£lf
.
	`m­ToGlob®
(
ev’t
.
	`pos
()))

877 
aùiÚ
 =ğ
addAùiÚ
:

878 
£lf
.
add_»giÚ
.
	`em™
()

879 
–if
 
aùiÚ
 =ğ
d–AùiÚ
:

880 
£lf
.
d–_»giÚ
.
	`em™
()

881 
–if
 
aùiÚ
 =ğ
dmpMod–AùiÚ
:

882 
£lf
.
	`dump_mod–_keys
()

884 
def
 
	$cÚÃù_sigÇls
(
£lf
):

886 
	$cÚÃù_sigÇls
(): 
desütiÚ


888 :
»tuºs
: 
NÚe


890 
£lf
.
	`£tMod–
(£lf.
bËmod–
)

891 
£lf
.
	`£ËùiÚMod–
().
£ËùiÚChªged
.
	`cÚÃù
(£lf.
£lChªged
)

892 
£lf
.
bËmod–
.
d©aChªged
.
	`cÚÃù
(£lf.
Ú_ûÎ_chªged
)

893 
£lf
.
bËmod–
.
sÿn_chªged
.
	`cÚÃù
(£lf.
Ú_mod–_chªged
)

894 #£lf.
_numHdrCŞs
 = 
£lf
.
bËmod–
.
	`cŞumnCouÁ
(self)

895 #£lf.
şicked
.
	`cÚÃù
(
£lf
.
Ú_şicked
)

896 
£lf
.
sigÇls_cÚÃùed
 = 
True


898 
def
 
	$discÚÃù_sigÇls
(
£lf
):

900 
	$discÚÃù_sigÇls
(): 
desütiÚ


902 :
»tuºs
: 
NÚe


904 
Œy
:

905 
£lf
.
	`£ËùiÚMod–
().
£ËùiÚChªged
.
	`discÚÃù
(£lf.
£lChªged
)

906 
£lf
.
bËmod–
.
d©aChªged
.
	`discÚÃù
(£lf.
Ú_ûÎ_chªged
)

907 
£lf
.
bËmod–
.
sÿn_chªged
.
	`discÚÃù
(£lf.
Ú_mod–_chªged
)

908 #£lf.
şicked
.
	`discÚÃù
(
£lf
.
Ú_şicked
)

909 
£lf
.
sigÇls_cÚÃùed
 = 
F®£


910 
exû±
:

911 
·ss


913 
def
 
	$š™_mod–
(
£lf
):

915 
	$š™_mod–
(): 
desütiÚ


917 :
»tuºs
: 
NÚe


920 
·ss


922 
def
 
	$£t_mod–_ed™abË
(
£lf
, 
ed
):

924 
	$£t_mod–_ed™abË
(): 
desütiÚ


926 :
·¿m
 
ed
:ƒd 
desütiÚ


927 :
ty³
 
ed
:ƒdype

929 :
»tuºs
: 
NÚe


931 if(
£lf
.
bËmod–
 
is
 
nÙ
 
NÚe
):

932 
£lf
.
bËmod–
.
	`£t_ed™abË
(
ed
)

934 
def
 
	$Ú_şicked
(
£lf
, 
šdex
):

936 
	$Ú_şicked
(): 
desütiÚ


938 :
·¿m
 
šdex
: index 
desütiÚ


939 :
ty³
 
šdex
: indexype

941 :
»tuºs
: 
NÚe


943 
row
 = 
šdex
.
	`row
()

944 
sÿn
 = 
£lf
.
	`g‘_row_d©a
(
row
)

945 #£lf.
row_£Ëùed
.
	`em™
(
sÿn
)

946 
£lf
.
_cur_£Ëùed_sÿn
 = 
sÿn


948 
def
 
	$g‘_Ãxt_mod–_id
(
£lf
):

949 #m_key ğ
	`sÜ‹d
(
£lf
.
mod–s
.
	`keys
())

950 #»tuº(
m_keys
[-1] + 1)

951 
id_l¡
 = []

952 
sÿn
 
š
 
£lf
.
bËmod–
.
sÿnLi¡D©a
:

953 
id_l¡
.
	`­³nd
(
sÿn
[
SPDB_ID_VAL
])

954 if(
	`Ën
(
id_l¡
) == 0):

957 
ids
 = 
	`sÜ‹d
(
id_l¡
)

958 (
ids
[-1] + 1)

963 
def
 
	$£t_mod–_id_¡¬t_v®
(
£lf
, 
v®
):

965 
	$£t_mod–_id_¡¬t_v®
(): 
desütiÚ


967 :
·¿m
 
v®
: v® 
desütiÚ


968 :
ty³
 
v®
: valype

970 :
»tuºs
: 
NÚe


973 
This
 
is
 
the
 
v®ue
 
th©
 
this
 
mod–
 
wl
 
START
 
coutšg
 
äom


974 
the
 
roi
 
id
's

976 
£lf
.
mod–_id_¡¬t_v®
 = 
v®


977 
£lf
.
mod–_id
 = 
v®


979 
def
 
	$g‘_mod–_id_¡¬t_v®
(
£lf
):

981 
	$g‘_mod–_id_¡¬t_v®
(): 
desütiÚ


983 :
»tuºs
: 
NÚe


986 
This
 
is
 
the
 
v®ue
 
th©
 
this
 
mod–
 
wl
 
START
 
coutšg
 
äom


987 
the
 
roi
 
id
's

989 (
£lf
.
mod–_id_¡¬t_v®
)

991 
def
 
	$dump_mod–_keys
(
£lf
):

993 
	$dump_mod–_keys
(): 
desütiÚ


995 :
»tuºs
: 
NÚe


997 
mod–
 = 
£lf
.
bËmod–
.
	`g‘_sÿn_li¡
()

998 #´šˆ
£lf
.
bËmod–_şass


999 
m
 
š
 
mod–
:

1000 
´št
 'Mod– ID = %d' % 
£lf
.
mod–_id


1001 
´št
 '\ˆ[%d]' % 
m
[
SPDB_ID_VAL
]

1003 
def
 
	$£t_sÿn_li¡
(
£lf
, 
sÿnLi¡
):

1005 
	$£t_sÿn_li¡
(): 
desütiÚ


1007 :
·¿m
 
sÿnLi¡
: sÿnLi¡ 
desütiÚ


1008 :
ty³
 
sÿnLi¡
: scanListype

1010 :
»tuºs
: 
NÚe


1012 
£lf
.
bËmod–
.
	`£t_sÿn_li¡
(
sÿnLi¡
)

1014 
def
 
	$g‘_sÿn_li¡
(
£lf
, 
mod–_id
=
NÚe
):

1016 
	$g‘_sÿn_li¡
(): 
desütiÚ


1018 :
·¿m
 
mod–_id
=
NÚe
: mod–_id=NÚ
desütiÚ


1019 :
ty³
 
mod–_id
=
NÚe
: model_id=Noneype

1021 :
»tuºs
: 
NÚe


1023 if(
mod–_id
 
is
 
nÙ
 
NÚe
):

1024 if(
mod–_id
 
š
 
£lf
.
mod–s
.
	$keys
()):

1025 (
£lf
.
mod–s
[
mod–_id
].
	`g‘_sÿn_li¡
())

1027 
´št
 'Mod–[%d] dÛ nÙƒxi¡' % 
mod–_id


1030 (
£lf
.
bËmod–
.
	`g‘_sÿn_li¡
())

1032 
def
 
	$g‘_num_sÿns
(
£lf
):

1034 
	$g‘_num_sÿns
(): 
desütiÚ


1036 :
»tuºs
: 
NÚe


1038 
sÿns
 = 
£lf
.
	`g‘_sÿn_li¡
()

1039 (
	`Ën
(
sÿns
))

1041 
def
 
	$g‘_sÿn
(
£lf
, 
sÿn_id
):

1043 
	$g‘_sÿn
(): 
desütiÚ


1045 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


1046 :
ty³
 
sÿn_id
: scan_idype

1048 :
»tuºs
: 
NÚe


1050 (
£lf
.
bËmod–
.
	`g‘_sÿn
(
sÿn_id
))

1052 
def
 
	$g‘_mod–
(
£lf
, 
mod–_id
):

1054 
	$g‘_mod–
(): 
desütiÚ


1056 :
·¿m
 
mod–_id
: mod–_id 
desütiÚ


1057 :
ty³
 
mod–_id
: model_idype

1059 :
»tuºs
: 
NÚe


1061 if(
mod–_id
 
š
 
£lf
.
mod–s
.
	$keys
()):

1062 (
£lf
.
mod–s
[
mod–_id
])

1064 
def
 
	$»move_mod–
(
£lf
, 
mod–_id
):

1066 
	$»move_mod–
(): 
desütiÚ


1068 :
·¿m
 
mod–_id
: mod–_id 
desütiÚ


1069 :
ty³
 
mod–_id
: model_idype

1071 :
»tuºs
: 
NÚe


1073 if(
mod–_id
 
š
 
£lf
.
mod–s
.
	$keys
()):

1074 
£lf
.
mod–s
[
mod–_id
].
	`»moveAÎ
()

1075 
d–
 
£lf
.
mod–s
[
mod–_id
]

1077 
def
 
	$»move_®l_mod–s
(
£lf
):

1079 
	$»move_®l_mod–s
(): 
desütiÚ


1081 :
»tuºs
: 
NÚe


1083 
mod–_id
 
š
 
£lf
.
mod–s
.
	$keys
():

1084 
£lf
.
	`»move_mod–
(
mod–_id
)

1087 
def
 
	$g‘_cur_£Ëùed_sÿn
(
£lf
):

1089 
	$g‘_cur_£Ëùed_sÿn
(): 
desütiÚ


1091 :
»tuºs
: 
NÚe


1093 (
£lf
.
_cur_£Ëùed_sÿn
)

1095 
def
 
	$£t_g‘£t_funcs
(
£lf
, 
funşi¡
):

1097 
	$£t_g‘£t_funcs
(): 
desütiÚ


1099 :
·¿m
 
funşi¡
: funşi¡ 
desütiÚ


1100 :
ty³
 
funşi¡
: funclistype

1102 :
»tuºs
: 
NÚe


1104 
£lf
.
bËmod–
.
	`£t_g‘£t_funcs
(
funşi¡
)

1106 
def
 
	$£lChªged
(
£lf
, 
£Ëùed
, 
de£Ëùed
):

1108 
	$£lChªged
(): 
desütiÚ


1110 :
·¿m
 
£Ëùed
: s–eùed 
desütiÚ


1111 :
ty³
 
£Ëùed
: selectedype

1113 :
·¿m
 
de£Ëùed
: de£Ëùed 
desütiÚ


1114 :
ty³
 
de£Ëùed
: deselectedype

1116 :
»tuºs
: 
NÚe


1118 
idxs
 = 
£Ëùed
.
	`šdexes
()

1119 if(
	`Ën
(
idxs
) > 0):

1120 
idx
 = 
idxs
.
	`pİ
()

1121 
row
 = 
idx
.
	`row
()

1122 
sÿn
 = 
£lf
.
	`g‘_row_d©a
(
row
)

1123 
£lf
.
row_£Ëùed
.
	`em™
(
sÿn
)

1124 
£lf
.
_cur_£Ëùed_sÿn
 = 
sÿn


1126 
£lf
.
_cur_£Ëùed_sÿn
 = 
NÚe


1128 
def
 
	$modify_sÿn
(
£lf
, 
sÿn_id
, 
Ãwsÿn
):

1130 
	$modify_sÿn
(): 
desütiÚ


1132 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


1133 :
ty³
 
sÿn_id
: scan_idype

1135 :
·¿m
 
Ãwsÿn
:‚ewsÿÀ
desütiÚ


1136 :
ty³
 
Ãwsÿn
:‚ewscanype

1138 :
»tuºs
: 
NÚe


1141 
·ss


1143 
def
 
	$»move_sÿn
(
£lf
, 
sÿn_id
):

1145 
	$»move_sÿn
(): 
desütiÚ


1147 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


1148 :
ty³
 
sÿn_id
: scan_idype

1150 :
»tuºs
: 
NÚe


1152 
row
 = 
£lf
.
bËmod–
.
	`g‘_sÿn_rowidx
(
sÿn_id
)

1153 if(
row
 
is
 
nÙ
 
NÚe
):

1154 
£lf
.
bËmod–
.
	`»moveRow
(
row
)

1156 
def
 
	$»move_®l
(
£lf
):

1158 
	$»move_®l
(): 
desütiÚ


1160 :
»tuºs
: 
NÚe


1162 
£lf
.
bËmod–
.
	`»moveAÎ
()

1164 
def
 
	$cÚÃù_´og»ss_¦Ù
(
£lf
, 
_sigÇl
):

1166 
	$cÚÃù_´og»ss_¦Ù
(): 
desütiÚ


1168 :
·¿m
 
_sigÇl
: _sigÇÈ
desütiÚ


1169 :
ty³
 
_sigÇl
: _signalype

1171 :
»tuºs
: 
NÚe


1173 
_sigÇl
.
	`cÚÃù
(
£lf
.
£Ëù_row
)

1175 #deà
	`£Ëù_row
(
£lf
, 
sÿn_id
=
NÚe
, 
´og»ss
=0.0):

1176 
def
 
	`£Ëù_row
(
£lf
, 
row_idx
=
NÚe
, 
´og»ss
=0.0):

1178 
	$£Ëù_row
(): 
desütiÚ


1180 :
·¿m
 
sÿn_id
=
NÚe
: sÿn_id=NÚ
desütiÚ


1181 :
ty³
 
sÿn_id
=
NÚe
: scan_id=Noneype

1183 :
·¿m
 
´og»ss
=0.0:…rog»ss=0.0 
desütiÚ


1184 :
ty³
 
´og»ss
=0.0:…rogress=0.0ype

1186 :
»tuºs
: 
NÚe


1188 if(
row_idx
 
is
 
NÚe
):

1189 
row_idx
 = 0

1190 
£lf
.
	`£ËùRow
(
row_idx
)

1192 
def
 
	$di§bË_upd©es
(
£lf
):

1194 
	$di§bË_upd©es
(): 
desütiÚ


1196 :
»tuºs
: 
NÚe


1198 
£lf
.
_block_upd©es
 = 
True


1200 
def
 
	$’abË_upd©es
(
£lf
):

1202 
	$’abË_upd©es
(): 
desütiÚ


1204 :
»tuºs
: 
NÚe


1206 
£lf
.
_block_upd©es
 = 
F®£


1208 
def
 
	$g‘_num_rows
(
£lf
):

1210 
	$g‘_num_rows
(): 
desütiÚ


1212 :
»tuºs
: 
NÚe


1214 (
£lf
.
bËmod–
.
	`rowCouÁ
(
NÚe
))

1216 
def
 
	$g‘_row_d©a
(
£lf
, 
row
):

1218 
	$g‘_row_d©a
(): 
desütiÚ


1220 :
·¿m
 
row
:„ow 
desütiÚ


1221 :
ty³
 
row
:„owype

1223 :
»tuºs
: 
NÚe


1225 
sÿn
 = 
£lf
.
bËmod–
.
	`g‘_sÿn_by_row
(
row
)

1226 (
sÿn
)

1228 
def
 
	$Ú_ûÎ_chªged
(
£lf
, 
idx
, 
idx2
):

1230 
	$Ú_ûÎ_chªged
(): 
desütiÚ


1232 :
·¿m
 
idx
: idx 
desütiÚ


1233 :
ty³
 
idx
: idxype

1235 :
·¿m
 
idx2
: idx2 
desütiÚ


1236 :
ty³
 
idx2
: idx2ype

1238 :
»tuºs
: 
NÚe


1240 
d
 = 
idx
.
	`d©a
()

1241 if(
d
 
is
 
nÙ
 
NÚe
):

1242 
v®
 = (
d
)

1244 (
NÚe
, 
F®£
)

1246 
def
 
	$ü—‹_Ãw_mod–
(
£lf
, 
sÿns
=
NÚe
, 
mod–_id
=NÚe, 
u£_ûÁ”
=
True
):

1248 
	$ü—‹_Ãw_mod–
(): 
desütiÚ


1250 :
·¿m
 
sÿns
=
NÚe
: sÿns=NÚ
desütiÚ


1251 :
ty³
 
sÿns
=
NÚe
: scans=Noneype

1253 :
»tuºs
: 
NÚe


1256 
bË
 
mod–s
 
th©
 
is
 
šdexed
 
by
 
the
 
mod–_id
 
·s£d
 
š
 
äom
h
·»Á
 
bËV›w
 
	`Ú_Ãw_»giÚ
()

1257 
¦Ù


1259 
impÜt
 
time
, 
d©‘ime


1260 #cÚÃù 
the
 
mod–s
 
sigÇl
 
to
 
em™
h
v›ws
 
sÿn_chªged
 signal

1261 
£lf
.
	`discÚÃù_sigÇls
()

1262 if(
sÿns
 
is
 
NÚe
):

1263 
sÿÆi¡
 = []

1265 
sÿÆi¡
 = 
sÿns


1267 if(
mod–_id
 
is
 
NÚe
):

1268 #šüem’ˆ
mod–
 
id


1269 
£lf
.
mod–_id
 
š
 s–f.
mod–s
.
	$keys
():

1270 #£lf.
mod–_id
 += 1

1271 
£lf
.
mod–_id
 = 
	`g‘_unique_roi_id
()

1273 
£lf
.
mod–_id
 = model_id

1275 
bËmod–
 = 
£lf
.
	`bËmod–_şass
(£lf.
hdrLi¡
, [], self)

1276 
£lf
.
mod–s
[£lf.
mod–_id
] = 
bËmod–


1277 
sÿn
 
š
 
sÿÆi¡
:

1278 
£lf
.
	`add_sÿn
(
sÿn
)

1280 #£ˆ
the
 
Ãw
 
mod–
 
to
 
be
h
cu¼’t
 model

1281 
£lf
.
	`sw™ch_mod–s
(£lf.
mod–_id
)

1282 
£lf
.
	`£t_mod–_cŞumn_deçuÉs
()

1283 
£lf
.
	`cÚÃù_sigÇls
()

1284 (
£lf
.
mod–_id
)

1286 
def
 
	$sw™ch_mod–s
(
£lf
, 
mod–_id
):

1288 
	$sw™ch_mod–s
(): 
desütiÚ


1290 :
·¿m
 
mod–_id
: mod–_id 
desütiÚ


1291 :
ty³
 
mod–_id
: model_idype

1293 :
»tuºs
: 
NÚe


1296 #´šˆ'sw™ch_mod–s: mod–_id [%d]' % 
mod–_id


1297 if(
mod–_id
 
š
 
£lf
.
mod–s
.
	$keys
()):

1298 
£lf
.
bËmod–
ğ£lf.
mod–s
[
mod–_id
]

1299 
£lf
.
mod–_id
 = model_id

1300 
£lf
.
	`£tMod–
(£lf.
bËmod–
)

1301 
£lf
.
	`discÚÃù_sigÇls
()

1302 
£lf
.
	`cÚÃù_sigÇls
()

1303 (
True
)

1304 (
F®£
)

1306 
def
 
	$Ú_mod–_chªged
(
£lf
, 
row
, 
sÿn
):

1308 
	$Ú_mod–_chªged
(): 
desütiÚ


1310 :
·¿m
 
row
:„ow 
desütiÚ


1311 :
ty³
 
row
:„owype

1313 :
·¿m
 
sÿn
: sÿÀ
desütiÚ


1314 :
ty³
 
sÿn
: scanype

1316 :
»tuºs
: 
NÚe


1319 
£lf
.
sÿn_chªged
.
	`em™
(
row
, 
sÿn
)

1321 
def
 
	$add_sÿn
(
£lf
, 
sÿn
, 
sÿn_id
):

1323 
	$add_sÿn
(): 
desütiÚ


1325 :
·¿m
 
sÿn
: sÿÀ
desütiÚ


1326 :
ty³
 
sÿn
: scanype

1328 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


1329 :
ty³
 
sÿn_id
: scan_idype

1331 :
»tuºs
: 
NÚe


1334 
sucûss
 = 
F®£


1335 #mak
su»
 
th©
 
the
 
sÿn_id
 
is
 
ª
 
š‹g”
 
™
 i 
¡l
 
a
 
¡ršg


1336 
sÿn
[
SPDB_ID_VAL
] = (
sÿn_id
)

1337 
sucûss
 = 
£lf
.
bËmod–
.
	`add_sÿn
(
sÿn
)

1338 
£lf
.
_cur_£Ëùed_sÿn
 = 
sÿn


1339 
£lf
.
	`£t_mod–_cŞumn_deçuÉs
()

1340 
sucûss
 = 
True


1341 (
sucûss
)

1344 
şass
 
	$Ba£S–eùiÚWidg‘
(
QtWidg‘s
.
QWidg‘
):

1345 
mod–_chªge
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
)

1346 
chªged
 = 
QtCÜe
.
	`pyqtSigÇl
()

1348 
def
 
	$__š™__
(
£lf
):

1350 
	$__š™__
(): 
desütiÚ


1352 :
·¿m
 
ev_£l_widg‘
=
NÚe
:ƒv_£l_widg‘=NÚ
desütiÚ


1353 :
ty³
 
ev_£l_widg‘
=
NÚe
:ƒv_sel_widget=Noneype

1355 :
»tuºs
: 
NÚe


1357 
QtWidg‘s
.
QWidg‘
.
	`__š™__
(
£lf
)

1358 
£lf
.
add_»giÚ_’abËd
 = 
True


	@widgets/scan_table_view/evScanTableModel.py

2 
C»©ed
 
Ú
 
	gNov
 16, 2016

4 @
	gauthÜ
: 
b”gr


7 
äom
 
şs
.
­¶iÿtiÚs
.
pyStxm
.
widg‘s
.
sÿn_bË_v›w
.
ba£SÿnTabË
 
impÜt
 *

8 
äom
 
şs
.
uts
.
roi_diù_defs
 
impÜt
 *

10 #Ãed 
a
 
m­pšg
 
of
 
bË
 
cŞumns
 
to
 
roi
 
diù
 
key


11 
EV_COLUMN_MAP
 = [
ID
, 
START
, 
STOP
, 
RANGE
, 
NPOINTS
, 
STEP
, 
DWELL
]

12 #šşud
cŞumns
 
of
 
EV_COLUMN_MAP
 
th©
 
»quœe
 
a
 
¡¬t
 
»ÿlcuÏtiÚ


13 
	gEV_START_CHANGED
 = [1]

14 
EV_STOP_CHANGED
 = [2]

15 #šşud
cŞumns
 
of
 
EV_COLUMN_MAP
 
th©
 
»quœe
 
a
 
¿nge
 
»ÿlcuÏtiÚ


16 
EV_RANGE_CHANGED
 = [3]

17 #šşud
cŞumns
 
of
 
EV_COLUMN_MAP
 
th©
 
»quœe
 
a
 
Åošts
 
»ÿlcuÏtiÚ


18 
EV_NPOINTS_CHANGED
 = [4]

19 #šşud
cŞumns
 
of
 
EV_COLUMN_MAP
 
th©
 
»quœe
 
a
 
¡•
 
size
 
»ÿlcuÏtiÚ


20 
EV_STEP_CHANGED
 = [5]

22 
şass
 
	$EÃrgySÿnTabËMod–
(
Ba£SÿnTabËMod–
):

24 
def
 
	$__š™__
(
£lf
, 
hdrLi¡
, 
d©aš
, 
·»Á
 = 
NÚe
, *
¬gs
):

26 
	$__š™__
(): 
desütiÚ


28 :
·¿m
 
hdrLi¡
: hdrLi¡ 
desütiÚ


29 :
ty³
 
hdrLi¡
: hdrListype

31 :
·¿m
 
d©aš
: d©aš 
desütiÚ


32 :
ty³
 
d©aš
: datainype

34 :
·¿m
 
·»Á
=
NÚe
:…¬’t=NÚ
desütiÚ


35 :
ty³
 
·»Á
=
NÚe
:…arent=Noneype

37 :
·¿m
 *
¬gs
: *¬g 
desütiÚ


38 :
ty³
 *
¬gs
: *argsype

40 :
»tuºs
: 
NÚe


42 #QtCÜe.
QAb¡¿ùTabËMod–
.
	`__š™__
(
£lf
, 
·»Á
, *
¬gs
)

43 
	`su³r
(
EÃrgySÿnTabËMod–
, 
£lf
).
	`__š™__
Ğ
hdrLi¡
, 
d©aš
, 
·»Á
, *
¬gs
)

44 #¨
diù
 
th©
 
wl
 
u£
 
¥©Ÿl
 
»giÚ
 
sÿn_id
' a keyØEÃrgyRegiÚSÿnDef'
s


45 
£lf
.
cur_sÿn_row
 = 
NÚe


46 
£lf
.
sÿnLi¡D©a
 = 
d©aš


47 
£lf
.
ed™abË
 = 
F®£


48 
£lf
.
cŞumn_m­
 = 
EV_COLUMN_MAP


49 
£lf
.
	`£t_mš_rows
(1)

50 
£lf
.
	`£t_max_rows
(20)

52 
def
 
	$£tD©a
(
£lf
, 
šdex
, 
v®ue
, 
rŞe
, 
»ÿlc
=
True
, 
do_sigÇl
=True):

54 
	$£tD©a
(): 
desütiÚ


56 :
·¿m
 
šdex
: index 
desütiÚ


57 :
ty³
 
šdex
: indexype

59 :
·¿m
 
v®ue
: v®u
desütiÚ


60 :
ty³
 
v®ue
: valueype

62 :
·¿m
 
rŞe
:„Ş
desütiÚ


63 :
ty³
 
rŞe
:„oleype

65 :
·¿m
 
»ÿlc
=
True
:„eÿlc=Tru
desütiÚ


66 :
ty³
 
»ÿlc
=
True
:„ecalc=Trueype

68 :
·¿m
 
do_sigÇl
=
True
: do_sigÇl=Tru
desütiÚ


69 :
ty³
 
do_sigÇl
=
True
: do_signal=Trueype

71 :
»tuºs
: 
NÚe


73 
row
 = 
šdex
.
	`row
()

74 
cŞ
 = 
šdex
.
	`cŞumn
()

75 
ok
 = 
True


76 if(
rŞe
 =ğ
QtCÜe
.
Qt
.
Ed™RŞe
):

78 if(
cŞ
 == 0):

79  
True


80 #v®, 
ok
 = 
v®ue
.
	`toLÚgLÚg
()

81 
	`–if
(
cŞ
 == 10):

82 
v®
 = 
	`¡r
(
v®ue
.
	`toSŒšg
())

83 if(
	`Ën
(
v®
) < 1):

84 
ok
 = 
F®£


86 
v®
 = (
v®ue
)

87 #ÿÎ 
the
 
assocŸ‹d
 
£‰”
 
funùiÚ
 
this
 
	`cŞumn
 (thi 
is
 
£tup
 
š
h
sÿn
 
defš™iÚ
 
şass


88 if(
ok
):

89 #Úly 
chªge
 
the
 
v®ue
 th
u£r
 
’‹»d
 
a
 value

90 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

91 
sÿn_id
 = 
sÿn
[
SPDB_ID_VAL
]

92 #´šˆ'£tD©a[sÿn_id=%d] cŞ=%d v®ğ%f' % (
sÿn_id
, 
cŞ
, 
v®
)

93 
sÿn
[
EV_COLUMN_MAP
[
cŞ
]] = 
v®


95 #fÜû 
the
 
row
 
to
 
»ÿlc


96 if(
»ÿlc
):

97 #now 
ÿÎ
 
the
 
»£pùive
 
funùiÚ
 
to
 
»ÿlc
h
sÿn
 
·¿ms


98 if(
cŞ
 
š
 
EV_START_CHANGED
):

99 
	`Ú_¡¬t_chªged
(
sÿn
)

101 if(
cŞ
 
š
 
EV_STOP_CHANGED
):

102 
	`Ú_¡İ_chªged
(
sÿn
)

104 if(
cŞ
 
š
 
EV_RANGE_CHANGED
):

105 
	`Ú_¿nge_chªged
(
sÿn
)

107 if(
cŞ
 
š
 
EV_NPOINTS_CHANGED
):

108 
	`Ú_Åošts_chªged
(
sÿn
)

110 if(
cŞ
 
š
 
EV_STEP_CHANGED
):

111 
	`Ú_¡•_size_chªged
(
sÿn
)

113 #fš®ly 
make
 
su»
 
®l
 
sÿns
 
obey
 
asûndšg
 
eV
 
ruË


114 
£lf
.
	`»ÿlc_·¿ms
(
row
+1)

116 if((
rŞe
 =ğ
QtCÜe
.
Qt
.
Ed™RŞe
è
	$Ü
 (
rŞe
 =ğ
QtCÜe
.
Qt
.
Di¥ÏyRŞe
)):

117 #mu¡ 
em™
 
this
 
as
 
·¹
 
of
 
the
 
äamewÜk
 
suµÜt
 
ª
 
ed™abË
 
Ab¡¿ùTabËMod–


118 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

119 
£lf
.
d©aChªged
.
	`em™
(
šdex
, index)

121 if(
do_sigÇl
):

123 
£lf
.
sÿn_chªged
.
	`em™
(
row
, 
sÿn
)

125  
True


128 
def
 
	$»ÿlc_·¿ms
(
£lf
, 
row
=
NÚe
):

130 
	$»ÿlc_·¿ms
(): 
desütiÚ


132 :
·¿m
 
row
=
NÚe
:„ow=NÚ
desütiÚ


133 :
ty³
 
row
=
NÚe
:„ow=Noneype

135 :
»tuºs
: 
NÚe


137 if(
row
 
is
 
NÚe
):

138 
row
 = 
£lf
.
	`mod–
().
	`rowCouÁ
(
QtCÜe
.
	`QMod–Index
())

140 
idx
 = 
row


141 
sÿn
 
š
 
£lf
.
sÿnLi¡D©a
[
idx
:]:

142 if(
idx
 == 0):

143 
·ss


145 #mak
su»
 
th©
 
the
 
¡¬t
 
of
 
this
 
sÿn
 
is
 
equ®
 
to
h
¡İ
 oàth
´evious


146 
sÿn
['START'] = 
£lf
.
sÿnLi¡D©a
[
idx
-1]['STOP'] + 
EV_SCAN_EDGE_RANGE


147 
	`Ú_¡¬t_chªged
(
sÿn
)

148 
idx
 += 1

151 
def
 
	$modify_d©a
(
£lf
, 
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
=
F®£
):

153 
	$modify_d©a
(): 
desütiÚ


155 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


156 :
ty³
 
sÿn_id
: scan_idype

158 :
·¿m
 
Ãwsÿn
:‚ewsÿÀ
desütiÚ


159 :
ty³
 
Ãwsÿn
:‚ewscanype

161 :
·¿m
 
do_¡•_Åts
=
F®£
: do_¡•_Åts=F®£ 
desütiÚ


162 :
ty³
 
do_¡•_Åts
=
F®£
: do_step_npts=Falseype

164 :
»tuºs
: 
NÚe


167 
£lf
.
	`»¶aû_sÿn
(
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
)

168 
£lf
.
d©aChªged
.
	`em™
(
QtCÜe
.
	`QMod–Index
(), QtCore.QModelIndex())

170 
def
 
	$»¶aû_sÿn
(
£lf
, 
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
=
True
):

172 
	$»¶aû_sÿn
(): 
desütiÚ


174 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


175 :
ty³
 
sÿn_id
: scan_idype

177 :
·¿m
 
Ãwsÿn
:‚ewsÿÀ
desütiÚ


178 :
ty³
 
Ãwsÿn
:‚ewscanype

180 :
·¿m
 
do_¡•_Åts
=
True
: do_¡•_Åts=Tru
desütiÚ


181 :
ty³
 
do_¡•_Åts
=
True
: do_step_npts=Trueype

183 :
»tuºs
: 
NÚe


186 
row
 = 0

187 
sÿn
 
š
 
£lf
.
sÿnLi¡D©a
:

188 #´šˆ'g‘_sÿn_rowidx: [%d] = %d' % (
row
, 
sÿn
['ID'])

189 if(
sÿn
[
SPDB_ID_VAL
] =ğ
sÿn_id
):

190 
£lf
.
sÿnLi¡D©a
[
row
][
START
] = 
Ãwsÿn
[START]

191 
£lf
.
sÿnLi¡D©a
[
row
][
STOP
] = 
Ãwsÿn
[STOP]

192 
£lf
.
sÿnLi¡D©a
[
row
][
CENTER
] = 
Ãwsÿn
[CENTER]

193 
£lf
.
sÿnLi¡D©a
[
row
][
RANGE
] = 
Ãwsÿn
[RANGE]

194 
£lf
.
sÿnLi¡D©a
[
row
][
STEP
] = 
Ãwsÿn
[STEP]

195 
£lf
.
sÿnLi¡D©a
[
row
][
NPOINTS
] = 
Ãwsÿn
[NPOINTS]

196 
row
 += 1

	@widgets/scan_table_view/evScanTableModel.py

2 
C»©ed
 
Ú
 
	gNov
 16, 2016

4 @
	gauthÜ
: 
b”gr


7 
äom
 
şs
.
­¶iÿtiÚs
.
pyStxm
.
widg‘s
.
sÿn_bË_v›w
.
ba£SÿnTabË
 
impÜt
 *

8 
äom
 
şs
.
uts
.
roi_diù_defs
 
impÜt
 *

10 #Ãed 
a
 
m­pšg
 
of
 
bË
 
cŞumns
 
to
 
roi
 
diù
 
key


11 
EV_COLUMN_MAP
 = [
ID
, 
START
, 
STOP
, 
RANGE
, 
NPOINTS
, 
STEP
, 
DWELL
]

12 #šşud
cŞumns
 
of
 
EV_COLUMN_MAP
 
th©
 
»quœe
 
a
 
¡¬t
 
»ÿlcuÏtiÚ


13 
	gEV_START_CHANGED
 = [1]

14 
EV_STOP_CHANGED
 = [2]

15 #šşud
cŞumns
 
of
 
EV_COLUMN_MAP
 
th©
 
»quœe
 
a
 
¿nge
 
»ÿlcuÏtiÚ


16 
EV_RANGE_CHANGED
 = [3]

17 #šşud
cŞumns
 
of
 
EV_COLUMN_MAP
 
th©
 
»quœe
 
a
 
Åošts
 
»ÿlcuÏtiÚ


18 
EV_NPOINTS_CHANGED
 = [4]

19 #šşud
cŞumns
 
of
 
EV_COLUMN_MAP
 
th©
 
»quœe
 
a
 
¡•
 
size
 
»ÿlcuÏtiÚ


20 
EV_STEP_CHANGED
 = [5]

22 
şass
 
	$EÃrgySÿnTabËMod–
(
Ba£SÿnTabËMod–
):

24 
def
 
	$__š™__
(
£lf
, 
hdrLi¡
, 
d©aš
, 
·»Á
 = 
NÚe
, *
¬gs
):

26 
	$__š™__
(): 
desütiÚ


28 :
·¿m
 
hdrLi¡
: hdrLi¡ 
desütiÚ


29 :
ty³
 
hdrLi¡
: hdrListype

31 :
·¿m
 
d©aš
: d©aš 
desütiÚ


32 :
ty³
 
d©aš
: datainype

34 :
·¿m
 
·»Á
=
NÚe
:…¬’t=NÚ
desütiÚ


35 :
ty³
 
·»Á
=
NÚe
:…arent=Noneype

37 :
·¿m
 *
¬gs
: *¬g 
desütiÚ


38 :
ty³
 *
¬gs
: *argsype

40 :
»tuºs
: 
NÚe


42 #QtCÜe.
QAb¡¿ùTabËMod–
.
	`__š™__
(
£lf
, 
·»Á
, *
¬gs
)

43 
	`su³r
(
EÃrgySÿnTabËMod–
, 
£lf
).
	`__š™__
Ğ
hdrLi¡
, 
d©aš
, 
·»Á
, *
¬gs
)

44 #¨
diù
 
th©
 
wl
 
u£
 
¥©Ÿl
 
»giÚ
 
sÿn_id
' a keyØEÃrgyRegiÚSÿnDef'
s


45 
£lf
.
cur_sÿn_row
 = 
NÚe


46 
£lf
.
sÿnLi¡D©a
 = 
d©aš


47 
£lf
.
ed™abË
 = 
F®£


48 
£lf
.
cŞumn_m­
 = 
EV_COLUMN_MAP


49 
£lf
.
	`£t_mš_rows
(1)

50 
£lf
.
	`£t_max_rows
(20)

52 
def
 
	$£tD©a
(
£lf
, 
šdex
, 
v®ue
, 
rŞe
, 
»ÿlc
=
True
, 
do_sigÇl
=True):

54 
	$£tD©a
(): 
desütiÚ


56 :
·¿m
 
šdex
: index 
desütiÚ


57 :
ty³
 
šdex
: indexype

59 :
·¿m
 
v®ue
: v®u
desütiÚ


60 :
ty³
 
v®ue
: valueype

62 :
·¿m
 
rŞe
:„Ş
desütiÚ


63 :
ty³
 
rŞe
:„oleype

65 :
·¿m
 
»ÿlc
=
True
:„eÿlc=Tru
desütiÚ


66 :
ty³
 
»ÿlc
=
True
:„ecalc=Trueype

68 :
·¿m
 
do_sigÇl
=
True
: do_sigÇl=Tru
desütiÚ


69 :
ty³
 
do_sigÇl
=
True
: do_signal=Trueype

71 :
»tuºs
: 
NÚe


73 
row
 = 
šdex
.
	`row
()

74 
cŞ
 = 
šdex
.
	`cŞumn
()

75 
ok
 = 
True


76 if(
rŞe
 =ğ
QtCÜe
.
Qt
.
Ed™RŞe
):

78 if(
cŞ
 == 0):

79  
True


80 #v®, 
ok
 = 
v®ue
.
	`toLÚgLÚg
()

81 
	`–if
(
cŞ
 == 10):

82 
v®
 = 
	`¡r
(
v®ue
.
	`toSŒšg
())

83 if(
	`Ën
(
v®
) < 1):

84 
ok
 = 
F®£


86 
v®
 = (
v®ue
)

87 #ÿÎ 
the
 
assocŸ‹d
 
£‰”
 
funùiÚ
 
this
 
	`cŞumn
 (thi 
is
 
£tup
 
š
h
sÿn
 
defš™iÚ
 
şass


88 if(
ok
):

89 #Úly 
chªge
 
the
 
v®ue
 th
u£r
 
’‹»d
 
a
 value

90 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

91 
sÿn_id
 = 
sÿn
[
SPDB_ID_VAL
]

92 #´šˆ'£tD©a[sÿn_id=%d] cŞ=%d v®ğ%f' % (
sÿn_id
, 
cŞ
, 
v®
)

93 
sÿn
[
EV_COLUMN_MAP
[
cŞ
]] = 
v®


95 #fÜû 
the
 
row
 
to
 
»ÿlc


96 if(
»ÿlc
):

97 #now 
ÿÎ
 
the
 
»£pùive
 
funùiÚ
 
to
 
»ÿlc
h
sÿn
 
·¿ms


98 if(
cŞ
 
š
 
EV_START_CHANGED
):

99 
	`Ú_¡¬t_chªged
(
sÿn
)

101 if(
cŞ
 
š
 
EV_STOP_CHANGED
):

102 
	`Ú_¡İ_chªged
(
sÿn
)

104 if(
cŞ
 
š
 
EV_RANGE_CHANGED
):

105 
	`Ú_¿nge_chªged
(
sÿn
)

107 if(
cŞ
 
š
 
EV_NPOINTS_CHANGED
):

108 
	`Ú_Åošts_chªged
(
sÿn
)

110 if(
cŞ
 
š
 
EV_STEP_CHANGED
):

111 
	`Ú_¡•_size_chªged
(
sÿn
)

113 #fš®ly 
make
 
su»
 
®l
 
sÿns
 
obey
 
asûndšg
 
eV
 
ruË


114 
£lf
.
	`»ÿlc_·¿ms
(
row
+1)

116 if((
rŞe
 =ğ
QtCÜe
.
Qt
.
Ed™RŞe
è
	$Ü
 (
rŞe
 =ğ
QtCÜe
.
Qt
.
Di¥ÏyRŞe
)):

117 #mu¡ 
em™
 
this
 
as
 
·¹
 
of
 
the
 
äamewÜk
 
suµÜt
 
ª
 
ed™abË
 
Ab¡¿ùTabËMod–


118 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

119 
£lf
.
d©aChªged
.
	`em™
(
šdex
, index)

121 if(
do_sigÇl
):

123 
£lf
.
sÿn_chªged
.
	`em™
(
row
, 
sÿn
)

125  
True


128 
def
 
	$»ÿlc_·¿ms
(
£lf
, 
row
=
NÚe
):

130 
	$»ÿlc_·¿ms
(): 
desütiÚ


132 :
·¿m
 
row
=
NÚe
:„ow=NÚ
desütiÚ


133 :
ty³
 
row
=
NÚe
:„ow=Noneype

135 :
»tuºs
: 
NÚe


137 if(
row
 
is
 
NÚe
):

138 
row
 = 
£lf
.
	`mod–
().
	`rowCouÁ
(
QtCÜe
.
	`QMod–Index
())

140 
idx
 = 
row


141 
sÿn
 
š
 
£lf
.
sÿnLi¡D©a
[
idx
:]:

142 if(
idx
 == 0):

143 
·ss


145 #mak
su»
 
th©
 
the
 
¡¬t
 
of
 
this
 
sÿn
 
is
 
equ®
 
to
h
¡İ
 oàth
´evious


146 
sÿn
['START'] = 
£lf
.
sÿnLi¡D©a
[
idx
-1]['STOP'] + 
EV_SCAN_EDGE_RANGE


147 
	`Ú_¡¬t_chªged
(
sÿn
)

148 
idx
 += 1

151 
def
 
	$modify_d©a
(
£lf
, 
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
=
F®£
):

153 
	$modify_d©a
(): 
desütiÚ


155 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


156 :
ty³
 
sÿn_id
: scan_idype

158 :
·¿m
 
Ãwsÿn
:‚ewsÿÀ
desütiÚ


159 :
ty³
 
Ãwsÿn
:‚ewscanype

161 :
·¿m
 
do_¡•_Åts
=
F®£
: do_¡•_Åts=F®£ 
desütiÚ


162 :
ty³
 
do_¡•_Åts
=
F®£
: do_step_npts=Falseype

164 :
»tuºs
: 
NÚe


167 
£lf
.
	`»¶aû_sÿn
(
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
)

168 
£lf
.
d©aChªged
.
	`em™
(
QtCÜe
.
	`QMod–Index
(), QtCore.QModelIndex())

170 
def
 
	$»¶aû_sÿn
(
£lf
, 
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
=
True
):

172 
	$»¶aû_sÿn
(): 
desütiÚ


174 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


175 :
ty³
 
sÿn_id
: scan_idype

177 :
·¿m
 
Ãwsÿn
:‚ewsÿÀ
desütiÚ


178 :
ty³
 
Ãwsÿn
:‚ewscanype

180 :
·¿m
 
do_¡•_Åts
=
True
: do_¡•_Åts=Tru
desütiÚ


181 :
ty³
 
do_¡•_Åts
=
True
: do_step_npts=Trueype

183 :
»tuºs
: 
NÚe


186 
row
 = 0

187 
sÿn
 
š
 
£lf
.
sÿnLi¡D©a
:

188 #´šˆ'g‘_sÿn_rowidx: [%d] = %d' % (
row
, 
sÿn
['ID'])

189 if(
sÿn
[
SPDB_ID_VAL
] =ğ
sÿn_id
):

190 
£lf
.
sÿnLi¡D©a
[
row
][
START
] = 
Ãwsÿn
[START]

191 
£lf
.
sÿnLi¡D©a
[
row
][
STOP
] = 
Ãwsÿn
[STOP]

192 
£lf
.
sÿnLi¡D©a
[
row
][
CENTER
] = 
Ãwsÿn
[CENTER]

193 
£lf
.
sÿnLi¡D©a
[
row
][
RANGE
] = 
Ãwsÿn
[RANGE]

194 
£lf
.
sÿnLi¡D©a
[
row
][
STEP
] = 
Ãwsÿn
[STEP]

195 
£lf
.
sÿnLi¡D©a
[
row
][
NPOINTS
] = 
Ãwsÿn
[NPOINTS]

196 
row
 += 1

	@widgets/scan_table_view/evScanTableView.py

2 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
ba£SÿnTabË
 
	gimpÜt
 *

4 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
evSÿnTabËMod–
 
impÜt
 
	gEÃrgySÿnTabËMod–


7 
şass
 
	$EÃrgySÿnTabËV›w
(
Ba£SÿnTabËV›w
):

9 
def
 
	$__š™__
(
£lf
, 
sÿnLi¡
=[], 
·»Á
=
NÚe
):

11 
	$__š™__
(): 
desütiÚ


13 :
·¿m
 
sÿnLi¡
=[]: sÿnLi¡=[] 
desütiÚ


14 :
ty³
 
sÿnLi¡
=[]: scanList=[]ype

16 :
·¿m
 
·»Á
=
NÚe
:…¬’t=NÚ
desütiÚ


17 :
ty³
 
·»Á
=
NÚe
:…arent=Noneype

19 :
»tuºs
: 
NÚe


21 #£tu°
the
 
h—d”
 th
tİ
 
of
h
bË


22 
hdrLi¡
 = ['ID','Start', 'End', 'Range\n(eV)', '#Points', 'Step\n(eV)', 'Dwell\n(ms)']

23 #£lf.
func_li¡
 = ['ev_id', 'center', 'range', 'step','Npoints', 'dwell', 'pol1', 'pol2', 'off1', 'off2', 'xmcd']

24 
	`su³r
(
EÃrgySÿnTabËV›w
, 
£lf
).
	`__š™__
(
hdrLi¡
, 
sÿnLi¡
, 
EÃrgySÿnTabËMod–
, 
·»Á
)

25 
£lf
.
	`£tStyËSh“t
(
EV_SS
)

26 
£lf
.
evNum
 = 0

28 #£lf.
	`š™_mod–
()

29 #£lf.
	`£t_mod–_id_¡¬t_v®
(
EV_CNTR
)

32 
def
 
	$š™_mod–
(
£lf
):

34 
	$š™_mod–
(): 
desütiÚ


36 :
»tuºs
: 
NÚe


38 
£lf
.
bËmod–
 = 
	`EÃrgySÿnTabËMod–
(£lf.
hdrLi¡
, s–f.
sÿns
, self)

39 
£lf
.
	`£t_mod–_cŞumn_deçuÉs
()

41 
def
 
	$£t_mod–_cŞumn_deçuÉs
(
£lf
):

43 
	$£t_mod–_cŞumn_deçuÉs
(): 
desütiÚ


45 :
»tuºs
: 
NÚe


47 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(0)

48 #fÜ 
i
 
š
 
	`¿nge
(1,
	`Ën
(
£lf
.
hdrLi¡
)):

49 #£lf.
	`hÜizÚlH—d”
().
	`£tSeùiÚResizeMode
(
i
, 
QtWidg‘s
.
QH—d”V›w
.
SŒ‘ch
)

51 
def
 
	$sizeHštFÜCŞumn
(
£lf
, 
cŞumn
):

53 
	$sizeHštFÜCŞumn
(): 
desütiÚ


55 :
·¿m
 
cŞumn
: cŞumÀ
desütiÚ


56 :
ty³
 
cŞumn
: columnype

58 :
»tuºs
: 
NÚe


60 
fm
 = 
£lf
.
	`fÚtM‘rics
()

61 
max_width
 = 0

62 
i
 
š
 
	`¿nge
(
£lf
.
	`mod–
().
	$rowCouÁ
()):

63 
width
 = 
fm
.
	`width
(
£lf
.
	`mod–
().
	`g‘_ûÎ
(
i
,
cŞumn
)) + 10

64 
width
 > 
max_width
:

65 
max_width
 = 
width


66  
max_width


69 
def
 
	$modify_sÿn
(
£lf
, 
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
=
F®£
):

71 
	$modify_sÿn
(): 
desütiÚ


73 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


74 :
ty³
 
sÿn_id
: scan_idype

76 :
·¿m
 
Ãwsÿn
:‚ewsÿÀ
desütiÚ


77 :
ty³
 
Ãwsÿn
:‚ewscanype

79 :
·¿m
 
do_¡•_Åts
=
F®£
: do_¡•_Åts=F®£ 
desütiÚ


80 :
ty³
 
do_¡•_Åts
=
F®£
: do_step_npts=Falseype

82 :
»tuºs
: 
NÚe


85 
sÿn
 = 
£lf
.
bËmod–
.
	`g‘_sÿn
(
sÿn_id
)

86 if(
sÿn
 
is
 
nÙ
 
NÚe
):

87 
£lf
.
bËmod–
.
	`modify_d©a
(
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
)

	@widgets/scan_table_view/evScanTableView.py

2 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
ba£SÿnTabË
 
	gimpÜt
 *

4 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
evSÿnTabËMod–
 
impÜt
 
	gEÃrgySÿnTabËMod–


7 
şass
 
	$EÃrgySÿnTabËV›w
(
Ba£SÿnTabËV›w
):

9 
def
 
	$__š™__
(
£lf
, 
sÿnLi¡
=[], 
·»Á
=
NÚe
):

11 
	$__š™__
(): 
desütiÚ


13 :
·¿m
 
sÿnLi¡
=[]: sÿnLi¡=[] 
desütiÚ


14 :
ty³
 
sÿnLi¡
=[]: scanList=[]ype

16 :
·¿m
 
·»Á
=
NÚe
:…¬’t=NÚ
desütiÚ


17 :
ty³
 
·»Á
=
NÚe
:…arent=Noneype

19 :
»tuºs
: 
NÚe


21 #£tu°
the
 
h—d”
 th
tİ
 
of
h
bË


22 
hdrLi¡
 = ['ID','Start', 'End', 'Range\n(eV)', '#Points', 'Step\n(eV)', 'Dwell\n(ms)']

23 #£lf.
func_li¡
 = ['ev_id', 'center', 'range', 'step','Npoints', 'dwell', 'pol1', 'pol2', 'off1', 'off2', 'xmcd']

24 
	`su³r
(
EÃrgySÿnTabËV›w
, 
£lf
).
	`__š™__
(
hdrLi¡
, 
sÿnLi¡
, 
EÃrgySÿnTabËMod–
, 
·»Á
)

25 
£lf
.
	`£tStyËSh“t
(
EV_SS
)

26 
£lf
.
evNum
 = 0

28 #£lf.
	`š™_mod–
()

29 #£lf.
	`£t_mod–_id_¡¬t_v®
(
EV_CNTR
)

32 
def
 
	$š™_mod–
(
£lf
):

34 
	$š™_mod–
(): 
desütiÚ


36 :
»tuºs
: 
NÚe


38 
£lf
.
bËmod–
 = 
	`EÃrgySÿnTabËMod–
(£lf.
hdrLi¡
, s–f.
sÿns
, self)

39 
£lf
.
	`£t_mod–_cŞumn_deçuÉs
()

41 
def
 
	$£t_mod–_cŞumn_deçuÉs
(
£lf
):

43 
	$£t_mod–_cŞumn_deçuÉs
(): 
desütiÚ


45 :
»tuºs
: 
NÚe


47 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(0)

48 #fÜ 
i
 
š
 
	`¿nge
(1,
	`Ën
(
£lf
.
hdrLi¡
)):

49 #£lf.
	`hÜizÚlH—d”
().
	`£tSeùiÚResizeMode
(
i
, 
QtWidg‘s
.
QH—d”V›w
.
SŒ‘ch
)

51 
def
 
	$sizeHštFÜCŞumn
(
£lf
, 
cŞumn
):

53 
	$sizeHštFÜCŞumn
(): 
desütiÚ


55 :
·¿m
 
cŞumn
: cŞumÀ
desütiÚ


56 :
ty³
 
cŞumn
: columnype

58 :
»tuºs
: 
NÚe


60 
fm
 = 
£lf
.
	`fÚtM‘rics
()

61 
max_width
 = 0

62 
i
 
š
 
	`¿nge
(
£lf
.
	`mod–
().
	$rowCouÁ
()):

63 
width
 = 
fm
.
	`width
(
£lf
.
	`mod–
().
	`g‘_ûÎ
(
i
,
cŞumn
)) + 10

64 
width
 > 
max_width
:

65 
max_width
 = 
width


66  
max_width


69 
def
 
	$modify_sÿn
(
£lf
, 
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
=
F®£
):

71 
	$modify_sÿn
(): 
desütiÚ


73 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


74 :
ty³
 
sÿn_id
: scan_idype

76 :
·¿m
 
Ãwsÿn
:‚ewsÿÀ
desütiÚ


77 :
ty³
 
Ãwsÿn
:‚ewscanype

79 :
·¿m
 
do_¡•_Åts
=
F®£
: do_¡•_Åts=F®£ 
desütiÚ


80 :
ty³
 
do_¡•_Åts
=
F®£
: do_step_npts=Falseype

82 :
»tuºs
: 
NÚe


85 
sÿn
 = 
£lf
.
bËmod–
.
	`g‘_sÿn
(
sÿn_id
)

86 if(
sÿn
 
is
 
nÙ
 
NÚe
):

87 
£lf
.
bËmod–
.
	`modify_d©a
(
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
)

	@widgets/scan_table_view/evSelWidget.py

2 
äom
 
PyQt5
 
impÜt
 
	gQtWidg‘s


4 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
ba£SÿnTabË
 
	gimpÜt
 *

6 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
evSÿnTabËV›w
 
impÜt
 
	gEÃrgySÿnTabËV›w


7 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
pŞ¬™yS–Widg‘
 
impÜt
 
	gPŞ¬™yS–Widg‘


9 
şass
 
	$EÃrgyS–Widg‘
(
Ba£S–eùiÚWidg‘
):

11 
A
 
QWidg‘
 
th©
 
cÚšs
 
ª
 
EÃrgySÿnTabËV›w


14 
def
 
	$__š™__
(
£lf
, 
pŞ_£l_widg‘
=
NÚe
, 
’abË_pŞ¬™y_Üd”
=
True
):

16 
	$__š™__
(): 
desütiÚ


18 :
·¿m
 
pŞ_£l_widg‘
=
NÚe
:…Ş_£l_widg‘=NÚ
desütiÚ


19 :
ty³
 
pŞ_£l_widg‘
=
NÚe
:…ol_sel_widget=Noneype

21 :
»tuºs
: 
NÚe


23 
	`su³r
(
EÃrgyS–Widg‘
, 
£lf
).
	`__š™__
()

24 #Ba£S–eùiÚWidg‘.
	`__š™__
(
£lf
)

25 #£tGeom‘ry(
x_pos
, 
y_pos
, 
width
, 
height
)

26 
£lf
.
	`£tGeom‘ry
(300, 200, 870, 450)

27 
£lf
.
	`£tWšdowT™Ë
("Click on columnitleo sort")

28 
£lf
.
ed™abË
 = 
F®£


29 
£lf
.
pŞ_£l_widg‘
 =…ol_sel_widget

30 
£lf
.
sšgË_ev_mod–
 = 
F®£


31 #£lf.
pŞ_£l_widg‘
.
chªged
.
	`cÚÃù
(
£lf
.
Ú_pŞ_bË_chªged
)

35 
£lf
.
bË_v›w
 = 
	`EÃrgySÿnTabËV›w
()

36 
£lf
.
bË_v›w
.
sÿn_chªged
.
	`cÚÃù
(£lf.
chªged
)

37 
£lf
.
sÿn_id
 = 0 #£lf.
bË_v›w
.
	`g‘_mod–_id_¡¬t_v®
()

39 
£lf
.
bË_v›w
.
	`ü—‹_Ãw_mod–
()

40 
£lf
.
bË_v›w
.
	`£t_mod–_cŞumn_deçuÉs
()

41 #£ˆ
fÚt


42 #£ˆ
cŞumn
 
width
 
to
 
f™
 
	`cÚ‹Ás
 (
£t
 
fÚt
 
fœ¡
!)

43 
£lf
.
bË_v›w
.
	`»sizeCŞumnsToCÚ‹Ás
()

44 #’abË 
sÜtšg


45 
£lf
.
bË_v›w
.
	`£tSÜtšgEÇbËd
(
F®£
)

47 if(
’abË_pŞ¬™y_Üd”
):

48 
£lf
.
sÿnÜd”ComboBox
 = 
QtWidg‘s
.
	`QComboBox
()

49 
£lf
.
sÿnÜd”ComboBox
.
	`addI‹m
('1. Forƒach Energy step scan‡ll Polarities')

50 
£lf
.
sÿnÜd”ComboBox
.
	`addI‹m
('2. Forƒach Polarity step scan‡ll Energies')

51 
lbl
 = 
QtWidg‘s
.
	`QLab–
('Ev/Polarity Sequencing for scan')

52 
f
 = 
lbl
.
	`fÚt
()

53 
f
.
	`£tBŞd
(
True
)

54 
lbl
.
	`£tFÚt
(
f
)

55 
h_Ïyout
 = 
QtWidg‘s
.
	`QHBoxLayout
()

56 
h_Ïyout
.
	`addWidg‘
(
lbl
)

57 
h_Ïyout
.
	`addWidg‘
(
£lf
.
sÿnÜd”ComboBox
)

58 
h¥aûr
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(40,20,QtWidg‘s.
QSizePŞicy
.
Ex·ndšg
,QtWidg‘s.QSizePŞicy.
Mšimum
)

59 
h_Ïyout
.
	`addI‹m
(
h¥aûr
)

61 #discÚÃù 
now


62 #£lf.
sÿnÜd”ComboBox
.
cu¼’tIndexChªged
.
	`cÚÃù
(
£lf
.
sÿn_Üd”_chªged
)

63 
£lf
.
ev_pŞ¬™y_sÿn_Üd”
 = 
’”gy_sÿn_Üd”_ty³s
.
EV_THEN_POL


65 
Ïyout
 = 
QtWidg‘s
.
	`QVBoxLayout
(
£lf
)

66 
Ïyout
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

67 if(
’abË_pŞ¬™y_Üd”
):

68 
Ïyout
.
	`addLayout
(
h_Ïyout
)

70 
Ïyout
.
	`addWidg‘
(
£lf
.
bË_v›w
)

71 
£lf
.
	`£tLayout
(
Ïyout
)

72 
£lf
.
	`ş—rFocus
()

74 
£lf
.
bË_v›w
.
	`»move_®l_mod–s
()

76 
£lf
.
bË_v›w
.
add_»giÚ
.
	`cÚÃù
(£lf.
Ú_Ãw_»giÚ
)

77 
£lf
.
bË_v›w
.
d–_»giÚ
.
	`cÚÃù
(£lf.
d–‘e_row
)

78 
£lf
.
bË_v›w
.
row_£Ëùed
.
	`cÚÃù
(£lf.
Ú_row_£Ëùed
)

80 
def
 
	$£t_sšgË_ev_mod–
(
£lf
, 
v®
):

81 
£lf
.
sšgË_ev_mod–
 = 
v®


83 
def
 
	$’abË_add_»giÚ
(
£lf
, do=
True
):

84 
£lf
.
	`’abË_add_»giÚ_m’u
(do)

85 #nØ
gu¬ª‹e
 
th©
 
th”e
 
is
 
a
 
pŞ¬™y
 
£l
 
widg‘
 
so
 
check
 
fœ¡


86 if(
£lf
.
pŞ_£l_widg‘
):

87 
£lf
.
pŞ_£l_widg‘
.
	`’abË_add_»giÚ_m’u
(do)

89 
def
 
	$’abË_add_»giÚ_m’u
(
£lf
, do=
True
):

90 
£lf
.
add_»giÚ_’abËd
 = do

92 
def
 
	$Ú_pŞ_bË_chªged
(
£lf
):

94 #sÿÀğ
£lf
.
	`g‘_row_d©a_by_™em_id
(£lf.
sÿn_id
)

95 #_logg”.
	`debug
('EnergySelWidget: on_pol_table_changed,ƒmitting changed sig')

96 
£lf
.
chªged
.
	`em™
()

98 
def
 
	$modify_row_d©a
(
£lf
, 
™em_id
, 
sÿn
):

99 
£lf
.
bË_v›w
.
	`modify_sÿn
(
™em_id
, 
sÿn
)

101 
def
 
	$g‘_row_idx
(
£lf
, 
™em_id
):

102 (
£lf
.
bË_v›w
.
bËmod–
.
	`g‘_sÿn_rowidx
(
™em_id
))

104 
def
 
	$g‘_row_d©a_by_™em_id
(
£lf
, 
™em_id
):

105 (
£lf
.
bË_v›w
.
	`g‘_sÿn
(
™em_id
))

107 
def
 
	$sÿn_Üd”_chªged
(
£lf
, 
idx
):

108 if(
idx
 == 0):

109 #1. 
FÜ
 
—ch
 
EÃrgy
 
¡•
 
sÿn
 
®l
 
PŞ¬™›s
'

110 
£lf
.
ev_pŞ¬™y_sÿn_Üd”
 = 
’”gy_sÿn_Üd”_ty³s
.
EV_THEN_POL


112 #2. 
FÜ
 
—ch
 
PŞ¬™y
 
¡•
 
sÿn
 
®l
 
EÃrg›s


113 
£lf
.
ev_pŞ¬™y_sÿn_Üd”
 = 
’”gy_sÿn_Üd”_ty³s
.
POL_THEN_EV


115 
def
 
	$g‘_ev_pŞ¬™y_sÿn_Üd”
(
£lf
):

116 (
£lf
.
ev_pŞ¬™y_sÿn_Üd”
)

118 
def
 
	$£Ëù_row
(
£lf
, 
row_idx
):

119 
£lf
.
bË_v›w
.
	`£Ëù_row
(
row_idx
)

121 
def
 
	$g‘_row_d©a
(
£lf
, 
™em_id
):

122 (
£lf
.
bË_v›w
.
	`g‘_sÿn
(
™em_id
))

124 
def
 
	$d–‘e_row
(
£lf
, 
sÿn_id
=
NÚe
):

126 
	$d–‘e_row
(): 
desütiÚ


128 :
·¿m
 
sÿn_id
=
NÚe
: sÿn_id=NÚ
desütiÚ


129 :
ty³
 
sÿn_id
=
NÚe
: scan_id=Noneype

131 :
»tuºs
: 
NÚe


134 
This
 
funùiÚ
 
os
 
ÿÎed
 
by
 
the
 
right
 
şick
 
m’u
 
aùiÚ
 
d–‘šg
 
a
 
row
.

136 if(
sÿn_id
 
is
 
NÚe
):

137 
sÿn
 = 
£lf
.
bË_v›w
.
	`g‘_cur_£Ëùed_sÿn
()

138 
sÿn_id
 = 
sÿn
[
SPDB_ID_VAL
]

139 
£lf
.
	`Ú_d–‘e_»giÚ
(
sÿn_id
)

141 
def
 
	$d–‘e_mod–
(
£lf
, 
ev_mod–_id
=
NÚe
):

143 
	$d–‘e_mod–
(): 
desütiÚ


145 :
·¿m
 
ev_mod–_id
=
NÚe
:ƒv_mod–_id=NÚ
desütiÚ


146 :
ty³
 
ev_mod–_id
=
NÚe
:ƒv_model_id=Noneype

148 :
»tuºs
: 
NÚe


151 
This
 
funùiÚ
 
is
 
ÿÎed
 
by
 
the
 
S·tŸl
 
widg‘
 
	`d–‘e_mod–
().

153 
this
 
funùiÚ
 
kes
 
the
 
mod–_id
 
of
h
desœed
 
ev
 model_id

154 
th©
 
Ãeds
 
to
 
be
 
d–‘ed
. 
FÜ
 
ev
 
mod–s
 
the
 
£qu’û
 
d–‘iÚ
 
is
 
as
 
fŞows
:

155 - 
g‘
 
the
 
POL
 
mod–_id
 
u£d
 
by
h
·»Á
 
EV
 
sÿn
, (['POL_ID']

156 - 
g‘
 
the
 
li¡
 
of
 
POL
 
sÿns
 
š
h
mod–


157 - 
ev”y
 
sÿn
 
š
 
the
 
mod–
 
»tuºed
 
äom


158 - 
ÿÎ
 
the
 
£lf
.
ev_£l_widg‘
 'd–‘e_mod–' 
w™h
h
POL
 
mod–_id
, (['POL_ID'])

159 - 
ÿÎ
 'remove_model(model_id)'

161 if(
ev_mod–_id
 
is
 
NÚe
):

162 
sÿn
 = 
£lf
.
bË_v›w
.
	`g‘_cur_£Ëùed_sÿn
()

163 
ev_mod–_id
 = 
sÿn
[
SPDB_ID_VAL
]

165 
ev_sÿns
 = 
£lf
.
bË_v›w
.
	`g‘_sÿn_li¡
(
ev_mod–_id
)

166 #fÜ 
sÿn
 
š
 
ev_sÿns
:

167 #£lf.
pŞ_£l_widg‘
.
	`d–‘e_mod–
(
sÿn
['POL_ID'])

168 
sÿn
 
š
 
ev_sÿns
:

169 
£lf
.
	`Ú_d–‘e_»giÚ
(
sÿn
[
SPDB_ID_VAL
])

170 
£lf
.
bË_v›w
.
	`»move_mod–
(
ev_mod–_id
)

172 
def
 
	$g‘_d©a
(
£lf
, 
mod–_id
=
NÚe
):

174 
	$g‘_d©a
(): 
desütiÚ


176 :
·¿m
 
mod–_id
=
NÚe
: mod–_id=NÚ
desütiÚ


177 :
ty³
 
mod–_id
=
NÚe
: model_id=Noneype

179 :
»tuºs
: 
NÚe


181 
ev_rois
 = 
£lf
.
bË_v›w
.
	`g‘_sÿn_li¡
(
mod–_id
)

182 
£lf
.
	`upd©e_ev_pŞ_sÿn_Üd”
(
ev_rois
)

183 (
ev_rois
)

185 
def
 
	$g‘_cur_mod–_id
(
£lf
):

187 
	$g‘_cur_mod–_id
(): 
desütiÚ


189 :
»tuºs
: 
NÚe


191 (
£lf
.
bË_v›w
.
mod–_id
)

193 
def
 
	$Ú_row_£Ëùed
(
£lf
, 
sÿn
):

195 
	$Ú_row_£Ëùed
(): 
desütiÚ


197 :
·¿m
 
sÿn
: sÿÀ
desütiÚ


198 :
ty³
 
sÿn
: scanype

200 :
»tuºs
: 
NÚe


202 #´šˆ'\t\tEV mod–_ID %d s–eùed: POL_ID =ğ[%d]' % (
sÿn
[
SPDB_ID_VAL
], scan['POL_ID'])

203 #_logg”.
	`debug
('EnergySelWidget: on_row_selected,ƒmitting model_change')

204 
£lf
.
mod–_chªge
.
	`em™
(
sÿn
[
SPDB_ID_VAL
])

205 #nØ
gu¬ª‹e
 
th©
 
th”e
 
is
 
a
 
pŞ¬™y
 
widg‘
 
so
 
check
 
fœ¡


206 if(
£lf
.
pŞ_£l_widg‘
):

207 
£lf
.
pŞ_£l_widg‘
.
	`sw™ch_v›w_mod–
(
sÿn
['POL_ID'])

208 
£lf
.
pŞ_£l_widg‘
.
bË_v›w
.
	`£Ëù_row
()

209 
£lf
.
pŞ_£l_widg‘
.
	`upd©e_bË
()

211 
def
 
	$sw™ch_v›w_mod–
(
£lf
, 
mod–_id
):

213 
	$sw™ch_v›w_mod–
(): 
desütiÚ


215 :
·¿m
 
mod–_id
: mod–_id 
desütiÚ


216 :
ty³
 
mod–_id
: model_idype

218 :
»tuºs
: 
NÚe


220 
£lf
.
bË_v›w
.
	`sw™ch_mod–s
(
mod–_id
)

222 
def
 
	$ş—r_bË
(
£lf
):

224 
	$ş—r_bË
(): 
desütiÚ


226 :
»tuºs
: 
NÚe


228 
£lf
.
bË_v›w
.
	`»move_®l
(£lf.
sÿn_id
)

230 
def
 
	$£t_ed™abË
(
£lf
, 
ed
):

232 
	$£t_ed™abË
(): 
desütiÚ


234 :
·¿m
 
ed
:ƒd 
desütiÚ


235 :
ty³
 
ed
:ƒdype

237 :
»tuºs
: 
NÚe


239 
£lf
.
bË_v›w
.
	`£t_mod–_ed™abË
(
ed
)

241 
def
 
	$g‘_ev_»giÚs
(
£lf
):

243 
	$g‘_ev_»giÚs
(): 
desütiÚ


245 :
»tuºs
: 
NÚe


247 
ev_rois
 = 
£lf
.
bË_v›w
.
	`mod–
().
	`g‘_sÿns
()

248 
£lf
.
	`upd©e_ev_pŞ_sÿn_Üd”
(
ev_rois
)

249 (
ev_rois
)

251 
def
 
	$upd©e_ev_pŞ_sÿn_Üd”
(
£lf
, 
ev_rois
):

252 
ev_Üd”
 = 
£lf
.
	`g‘_ev_pŞ¬™y_sÿn_Üd”
()

253 
e_roi
 
š
 
ev_rois
:

254 
e_roi
['EV_POL_ORDER'] = 
ev_Üd”


256 
def
 
	$Ú_Ãw_»giÚ
(
£lf
, 
sÿn
=
NÚe
, 
add_•u_roi
=
True
):

258 
	$Ú_Ãw_»giÚ
(): 
EÃrgyS–Widg‘


260 :
·¿m
 
sÿn
=
NÚe
: sÿn=NÚ
desütiÚ


261 :
ty³
 
sÿn
=
NÚe
: scan=Noneype

263 :
»tuºs
: 
NÚe


265 #num_ev_roi ğ
	`Ën
(
£lf
.
	`g‘_ev_»giÚs
())

266 if(
nÙ
 
£lf
.
add_»giÚ_’abËd
):

269 #Ëˆ
the
 
pŞ¬™y
 
widg‘
 
know
 
th©
 
™s
 
iok
 
to
 
add
 
Ãw
 
»giÚs


270 if(
£lf
.
pŞ_£l_widg‘
):

271 
£lf
.
pŞ_£l_widg‘
.
	`’abË_add_»giÚ_m’u
(
True
)

273 #š™_ev = 
MAIN_OBJ
.
	`deviû
(
DNM_ENERGY
).
	`g‘_pos™iÚ
()

274 
š™_ev
 = 350.0

275 #sÿÀğ
	`g‘_ba£_’”gy_roi
('EV', 'ENERGY', 370, 395, 25.0, 10, 2.5, 
£lf
.
pŞ_roi
, s–f.
off_roi
, 
¡•Size
=
NÚe
, 
’abË
=
True
)

276 if(
sÿn
 
is
 
NÚe
):

277 #u£ 
´evious
 
sÿns
 
v®s
 
Ãw
 
¿nge


278 
ev_Üd”
 = 
£lf
.
	`g‘_ev_pŞ¬™y_sÿn_Üd”
()

279 
cur_sÿn
 = 
cİy
.
	`d“pcİy
(
£lf
.
bË_v›w
.
	`g‘_cur_£Ëùed_sÿn
())

280 
¦i¡
 = 
£lf
.
bË_v›w
.
	`g‘_sÿn_li¡
()

281 if((
cur_sÿn
 
is
 
NÚe
è
	`ªd
 (
	`Ën
(
¦i¡
) == 0)):

282 #ü—‹ 
a
 

283 
sÿn
 = 
	`g‘_ba£_’”gy_roi
('EV', 'ENERGY', 
š™_ev
, in™_ev, 0.0, 1, 2.5, 
NÚe
, 
¡•Size
=NÚe, 
’abË
=
True
, 
’”gy_sÿn_Üd”
=
ev_Üd”
)

285 #g‘ 
the
 
Ï¡
 
Úe


286 if(
	`Ën
(
¦i¡
) > 0):

287 
cur_sÿn
 = 
¦i¡
[-1]

289 
sÿn
 = 
	`g‘_ba£_’”gy_roi
('EV', 'ENERGY', 
cur_sÿn
['START'], cur_sÿn['STOP'], cur_sÿn['RANGE'] + 
EV_SCAN_EDGE_RANGE
, cur_sÿn['NPOINTS'], cur_sÿn['DWELL'], 
NÚe
, 
¡•Size
=NÚe, 
’abË
=
True
, 
’”gy_sÿn_Üd”
=
ev_Üd”
)

291 #if(
£lf
.
pŞ_£l_widg‘
 
is
 
nÙ
 
NÚe
):

292 if((
add_•u_roi
è
	$ªd
 (
£lf
.
pŞ_£l_widg‘
 
is
 
nÙ
 
NÚe
)):

293 
sÿn
['POL_ID'] = 
£lf
.
pŞ_£l_widg‘
.
bË_v›w
.
	`ü—‹_Ãw_mod–
()

294 #´šˆ'\t\tEV[%d] c»©šg POL_MODEL[%d]' % (
sÿn
[
SPDB_ID_VAL
], scan['POL_ID'])

295 if(
£lf
.
pŞ_£l_widg‘
):

296 
£lf
.
pŞ_£l_widg‘
.
	`Ú_Ãw_»giÚ
()

297 
£lf
.
pŞ_£l_widg‘
.
	`upd©e_bË
()

299 #£lf.
bË_v›w
.
	`add_sÿn
(
sÿn
, scan['POL_ID'])

300 
£lf
.
sÿn_id
 += 1

301 
£lf
.
bË_v›w
.
	`add_sÿn
(
sÿn
, s–f.
sÿn_id
)

302 
Ãw_row
 = 
£lf
.
bË_v›w
.
	`g‘_num_rows
()

303 
£lf
.
bË_v›w
.
	`mod–
().
	`»ÿlc_·¿ms
(
Ãw_row
-1)

305 #sØ
th©
 
ªy
 
chªges
 
wl
 
be
 
picked
 
up
 
by
‡ny 
li¡’šg
 
widg‘s


306 if(
£lf
.
pŞ_£l_widg‘
):

307 
£lf
.
	`Ú_pŞ_bË_chªged
()

310 
def
 
	$lßd_sÿn
(
£lf
, 
ev_rois
=[]):

311 
cur_sÿn
 
š
 
ev_rois
:

313 
sÿn
 = 
	`g‘_ba£_’”gy_roi
('EV', 'ENERGY', 
cur_sÿn
['START'], cur_sÿn['STOP'], cur_sÿn['RANGE'] + 
EV_SCAN_EDGE_RANGE
, cur_sÿn['NPOINTS'], cur_sÿn['DWELL'], 
NÚe
, 
¡•Size
=NÚe, 
’abË
=
True
)

314 
sÿn
[
SPDB_ID_VAL
] = 
cur_sÿn
[SPDB_ID_VAL]

315 
sÿn
['POL_ID'] = 
cur_sÿn
['POL_ID']

316 
sÿn
['POL_ROIS'] = 
cur_sÿn
['POL_ROIS']

318 if(
£lf
.
pŞ_£l_widg‘
):

319 
£lf
.
pŞ_£l_widg‘
.
bË_v›w
.
	`ü—‹_Ãw_mod–
(
mod–_id
 = 
sÿn
['POL_ID'])

320 #´šˆ'\t\tEV[%d] c»©šg POL_MODEL[%d]' % (
sÿn
[
SPDB_ID_VAL
], scan['POL_ID'])

321 
£lf
.
pŞ_£l_widg‘
.
	`lßd_sÿn
(
sÿn
['POL_ROIS'])

322 
£lf
.
pŞ_£l_widg‘
.
	`upd©e_bË
()

324 
£lf
.
bË_v›w
.
	`add_sÿn
(
sÿn
, sÿn[
SPDB_ID_VAL
])

328 
def
 
	$Ú_d–‘e_»giÚ
(
£lf
, 
sÿn_id
=
NÚe
):

330 
	$Ú_d–‘e_»giÚ
(): 
desütiÚ


332 :
·¿m
 
sÿn_id
=
NÚe
: sÿn_id=NÚ
desütiÚ


333 :
ty³
 
sÿn_id
=
NÚe
: scan_id=Noneype

335 :
»tuºs
: 
NÚe


337 if(
sÿn_id
 
is
 
NÚe
):

338 
sÿn
 = 
£lf
.
bË_v›w
.
	`g‘_cur_£Ëùed_sÿn
()

339 
sÿn_id
 = 
sÿn
[
SPDB_ID_VAL
]

340 
sÿn
 = 
£lf
.
bË_v›w
.
	`g‘_sÿn
(
sÿn_id
)

341 if(
sÿn
):

342 if(
£lf
.
pŞ_£l_widg‘
):

343 
£lf
.
pŞ_£l_widg‘
.
	`d–‘e_mod–
(
sÿn
['POL_ID'])

344 
´št
 '\‹v d–‘šg[%d]' % 
sÿn_id


345 
£lf
.
bË_v›w
.
	`»move_sÿn
(
sÿn_id
)

347 
def
 
	$Ú_sšgË_ev
(
£lf
):

349 
	$Ú_sšgË_ev
(): 
desütiÚ


351 :
»tuºs
: 
NÚe


353 
£lf
.
bË_v›w
.
	`mod–
().
	`»move_®l_exû±_fœ¡
(£lf.
sÿn_id
)

	@widgets/scan_table_view/evSelWidget.py

2 
äom
 
PyQt5
 
impÜt
 
	gQtWidg‘s


4 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
ba£SÿnTabË
 
	gimpÜt
 *

6 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
evSÿnTabËV›w
 
impÜt
 
	gEÃrgySÿnTabËV›w


7 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
pŞ¬™yS–Widg‘
 
impÜt
 
	gPŞ¬™yS–Widg‘


9 
şass
 
	$EÃrgyS–Widg‘
(
Ba£S–eùiÚWidg‘
):

11 
A
 
QWidg‘
 
th©
 
cÚšs
 
ª
 
EÃrgySÿnTabËV›w


14 
def
 
	$__š™__
(
£lf
, 
pŞ_£l_widg‘
=
NÚe
, 
’abË_pŞ¬™y_Üd”
=
True
):

16 
	$__š™__
(): 
desütiÚ


18 :
·¿m
 
pŞ_£l_widg‘
=
NÚe
:…Ş_£l_widg‘=NÚ
desütiÚ


19 :
ty³
 
pŞ_£l_widg‘
=
NÚe
:…ol_sel_widget=Noneype

21 :
»tuºs
: 
NÚe


23 
	`su³r
(
EÃrgyS–Widg‘
, 
£lf
).
	`__š™__
()

24 #Ba£S–eùiÚWidg‘.
	`__š™__
(
£lf
)

25 #£tGeom‘ry(
x_pos
, 
y_pos
, 
width
, 
height
)

26 
£lf
.
	`£tGeom‘ry
(300, 200, 870, 450)

27 
£lf
.
	`£tWšdowT™Ë
("Click on columnitleo sort")

28 
£lf
.
ed™abË
 = 
F®£


29 
£lf
.
pŞ_£l_widg‘
 =…ol_sel_widget

30 
£lf
.
sšgË_ev_mod–
 = 
F®£


31 #£lf.
pŞ_£l_widg‘
.
chªged
.
	`cÚÃù
(
£lf
.
Ú_pŞ_bË_chªged
)

35 
£lf
.
bË_v›w
 = 
	`EÃrgySÿnTabËV›w
()

36 
£lf
.
bË_v›w
.
sÿn_chªged
.
	`cÚÃù
(£lf.
chªged
)

37 
£lf
.
sÿn_id
 = 0 #£lf.
bË_v›w
.
	`g‘_mod–_id_¡¬t_v®
()

39 
£lf
.
bË_v›w
.
	`ü—‹_Ãw_mod–
()

40 
£lf
.
bË_v›w
.
	`£t_mod–_cŞumn_deçuÉs
()

41 #£ˆ
fÚt


42 #£ˆ
cŞumn
 
width
 
to
 
f™
 
	`cÚ‹Ás
 (
£t
 
fÚt
 
fœ¡
!)

43 
£lf
.
bË_v›w
.
	`»sizeCŞumnsToCÚ‹Ás
()

44 #’abË 
sÜtšg


45 
£lf
.
bË_v›w
.
	`£tSÜtšgEÇbËd
(
F®£
)

47 if(
’abË_pŞ¬™y_Üd”
):

48 
£lf
.
sÿnÜd”ComboBox
 = 
QtWidg‘s
.
	`QComboBox
()

49 
£lf
.
sÿnÜd”ComboBox
.
	`addI‹m
('1. Forƒach Energy step scan‡ll Polarities')

50 
£lf
.
sÿnÜd”ComboBox
.
	`addI‹m
('2. Forƒach Polarity step scan‡ll Energies')

51 
lbl
 = 
QtWidg‘s
.
	`QLab–
('Ev/Polarity Sequencing for scan')

52 
f
 = 
lbl
.
	`fÚt
()

53 
f
.
	`£tBŞd
(
True
)

54 
lbl
.
	`£tFÚt
(
f
)

55 
h_Ïyout
 = 
QtWidg‘s
.
	`QHBoxLayout
()

56 
h_Ïyout
.
	`addWidg‘
(
lbl
)

57 
h_Ïyout
.
	`addWidg‘
(
£lf
.
sÿnÜd”ComboBox
)

58 
h¥aûr
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(40,20,QtWidg‘s.
QSizePŞicy
.
Ex·ndšg
,QtWidg‘s.QSizePŞicy.
Mšimum
)

59 
h_Ïyout
.
	`addI‹m
(
h¥aûr
)

61 #discÚÃù 
now


62 #£lf.
sÿnÜd”ComboBox
.
cu¼’tIndexChªged
.
	`cÚÃù
(
£lf
.
sÿn_Üd”_chªged
)

63 
£lf
.
ev_pŞ¬™y_sÿn_Üd”
 = 
’”gy_sÿn_Üd”_ty³s
.
EV_THEN_POL


65 
Ïyout
 = 
QtWidg‘s
.
	`QVBoxLayout
(
£lf
)

66 
Ïyout
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

67 if(
’abË_pŞ¬™y_Üd”
):

68 
Ïyout
.
	`addLayout
(
h_Ïyout
)

70 
Ïyout
.
	`addWidg‘
(
£lf
.
bË_v›w
)

71 
£lf
.
	`£tLayout
(
Ïyout
)

72 
£lf
.
	`ş—rFocus
()

74 
£lf
.
bË_v›w
.
	`»move_®l_mod–s
()

76 
£lf
.
bË_v›w
.
add_»giÚ
.
	`cÚÃù
(£lf.
Ú_Ãw_»giÚ
)

77 
£lf
.
bË_v›w
.
d–_»giÚ
.
	`cÚÃù
(£lf.
d–‘e_row
)

78 
£lf
.
bË_v›w
.
row_£Ëùed
.
	`cÚÃù
(£lf.
Ú_row_£Ëùed
)

80 
def
 
	$£t_sšgË_ev_mod–
(
£lf
, 
v®
):

81 
£lf
.
sšgË_ev_mod–
 = 
v®


83 
def
 
	$’abË_add_»giÚ
(
£lf
, do=
True
):

84 
£lf
.
	`’abË_add_»giÚ_m’u
(do)

85 #nØ
gu¬ª‹e
 
th©
 
th”e
 
is
 
a
 
pŞ¬™y
 
£l
 
widg‘
 
so
 
check
 
fœ¡


86 if(
£lf
.
pŞ_£l_widg‘
):

87 
£lf
.
pŞ_£l_widg‘
.
	`’abË_add_»giÚ_m’u
(do)

89 
def
 
	$’abË_add_»giÚ_m’u
(
£lf
, do=
True
):

90 
£lf
.
add_»giÚ_’abËd
 = do

92 
def
 
	$Ú_pŞ_bË_chªged
(
£lf
):

94 #sÿÀğ
£lf
.
	`g‘_row_d©a_by_™em_id
(£lf.
sÿn_id
)

95 #_logg”.
	`debug
('EnergySelWidget: on_pol_table_changed,ƒmitting changed sig')

96 
£lf
.
chªged
.
	`em™
()

98 
def
 
	$modify_row_d©a
(
£lf
, 
™em_id
, 
sÿn
):

99 
£lf
.
bË_v›w
.
	`modify_sÿn
(
™em_id
, 
sÿn
)

101 
def
 
	$g‘_row_idx
(
£lf
, 
™em_id
):

102 (
£lf
.
bË_v›w
.
bËmod–
.
	`g‘_sÿn_rowidx
(
™em_id
))

104 
def
 
	$g‘_row_d©a_by_™em_id
(
£lf
, 
™em_id
):

105 (
£lf
.
bË_v›w
.
	`g‘_sÿn
(
™em_id
))

107 
def
 
	$sÿn_Üd”_chªged
(
£lf
, 
idx
):

108 if(
idx
 == 0):

109 #1. 
FÜ
 
—ch
 
EÃrgy
 
¡•
 
sÿn
 
®l
 
PŞ¬™›s
'

110 
£lf
.
ev_pŞ¬™y_sÿn_Üd”
 = 
’”gy_sÿn_Üd”_ty³s
.
EV_THEN_POL


112 #2. 
FÜ
 
—ch
 
PŞ¬™y
 
¡•
 
sÿn
 
®l
 
EÃrg›s


113 
£lf
.
ev_pŞ¬™y_sÿn_Üd”
 = 
’”gy_sÿn_Üd”_ty³s
.
POL_THEN_EV


115 
def
 
	$g‘_ev_pŞ¬™y_sÿn_Üd”
(
£lf
):

116 (
£lf
.
ev_pŞ¬™y_sÿn_Üd”
)

118 
def
 
	$£Ëù_row
(
£lf
, 
row_idx
):

119 
£lf
.
bË_v›w
.
	`£Ëù_row
(
row_idx
)

121 
def
 
	$g‘_row_d©a
(
£lf
, 
™em_id
):

122 (
£lf
.
bË_v›w
.
	`g‘_sÿn
(
™em_id
))

124 
def
 
	$d–‘e_row
(
£lf
, 
sÿn_id
=
NÚe
):

126 
	$d–‘e_row
(): 
desütiÚ


128 :
·¿m
 
sÿn_id
=
NÚe
: sÿn_id=NÚ
desütiÚ


129 :
ty³
 
sÿn_id
=
NÚe
: scan_id=Noneype

131 :
»tuºs
: 
NÚe


134 
This
 
funùiÚ
 
os
 
ÿÎed
 
by
 
the
 
right
 
şick
 
m’u
 
aùiÚ
 
d–‘šg
 
a
 
row
.

136 if(
sÿn_id
 
is
 
NÚe
):

137 
sÿn
 = 
£lf
.
bË_v›w
.
	`g‘_cur_£Ëùed_sÿn
()

138 
sÿn_id
 = 
sÿn
[
SPDB_ID_VAL
]

139 
£lf
.
	`Ú_d–‘e_»giÚ
(
sÿn_id
)

141 
def
 
	$d–‘e_mod–
(
£lf
, 
ev_mod–_id
=
NÚe
):

143 
	$d–‘e_mod–
(): 
desütiÚ


145 :
·¿m
 
ev_mod–_id
=
NÚe
:ƒv_mod–_id=NÚ
desütiÚ


146 :
ty³
 
ev_mod–_id
=
NÚe
:ƒv_model_id=Noneype

148 :
»tuºs
: 
NÚe


151 
This
 
funùiÚ
 
is
 
ÿÎed
 
by
 
the
 
S·tŸl
 
widg‘
 
	`d–‘e_mod–
().

153 
this
 
funùiÚ
 
kes
 
the
 
mod–_id
 
of
h
desœed
 
ev
 model_id

154 
th©
 
Ãeds
 
to
 
be
 
d–‘ed
. 
FÜ
 
ev
 
mod–s
 
the
 
£qu’û
 
d–‘iÚ
 
is
 
as
 
fŞows
:

155 - 
g‘
 
the
 
POL
 
mod–_id
 
u£d
 
by
h
·»Á
 
EV
 
sÿn
, (['POL_ID']

156 - 
g‘
 
the
 
li¡
 
of
 
POL
 
sÿns
 
š
h
mod–


157 - 
ev”y
 
sÿn
 
š
 
the
 
mod–
 
»tuºed
 
äom


158 - 
ÿÎ
 
the
 
£lf
.
ev_£l_widg‘
 'd–‘e_mod–' 
w™h
h
POL
 
mod–_id
, (['POL_ID'])

159 - 
ÿÎ
 'remove_model(model_id)'

161 if(
ev_mod–_id
 
is
 
NÚe
):

162 
sÿn
 = 
£lf
.
bË_v›w
.
	`g‘_cur_£Ëùed_sÿn
()

163 
ev_mod–_id
 = 
sÿn
[
SPDB_ID_VAL
]

165 
ev_sÿns
 = 
£lf
.
bË_v›w
.
	`g‘_sÿn_li¡
(
ev_mod–_id
)

166 #fÜ 
sÿn
 
š
 
ev_sÿns
:

167 #£lf.
pŞ_£l_widg‘
.
	`d–‘e_mod–
(
sÿn
['POL_ID'])

168 
sÿn
 
š
 
ev_sÿns
:

169 
£lf
.
	`Ú_d–‘e_»giÚ
(
sÿn
[
SPDB_ID_VAL
])

170 
£lf
.
bË_v›w
.
	`»move_mod–
(
ev_mod–_id
)

172 
def
 
	$g‘_d©a
(
£lf
, 
mod–_id
=
NÚe
):

174 
	$g‘_d©a
(): 
desütiÚ


176 :
·¿m
 
mod–_id
=
NÚe
: mod–_id=NÚ
desütiÚ


177 :
ty³
 
mod–_id
=
NÚe
: model_id=Noneype

179 :
»tuºs
: 
NÚe


181 
ev_rois
 = 
£lf
.
bË_v›w
.
	`g‘_sÿn_li¡
(
mod–_id
)

182 
£lf
.
	`upd©e_ev_pŞ_sÿn_Üd”
(
ev_rois
)

183 (
ev_rois
)

185 
def
 
	$g‘_cur_mod–_id
(
£lf
):

187 
	$g‘_cur_mod–_id
(): 
desütiÚ


189 :
»tuºs
: 
NÚe


191 (
£lf
.
bË_v›w
.
mod–_id
)

193 
def
 
	$Ú_row_£Ëùed
(
£lf
, 
sÿn
):

195 
	$Ú_row_£Ëùed
(): 
desütiÚ


197 :
·¿m
 
sÿn
: sÿÀ
desütiÚ


198 :
ty³
 
sÿn
: scanype

200 :
»tuºs
: 
NÚe


202 #´šˆ'\t\tEV mod–_ID %d s–eùed: POL_ID =ğ[%d]' % (
sÿn
[
SPDB_ID_VAL
], scan['POL_ID'])

203 #_logg”.
	`debug
('EnergySelWidget: on_row_selected,ƒmitting model_change')

204 
£lf
.
mod–_chªge
.
	`em™
(
sÿn
[
SPDB_ID_VAL
])

205 #nØ
gu¬ª‹e
 
th©
 
th”e
 
is
 
a
 
pŞ¬™y
 
widg‘
 
so
 
check
 
fœ¡


206 if(
£lf
.
pŞ_£l_widg‘
):

207 
£lf
.
pŞ_£l_widg‘
.
	`sw™ch_v›w_mod–
(
sÿn
['POL_ID'])

208 
£lf
.
pŞ_£l_widg‘
.
bË_v›w
.
	`£Ëù_row
()

209 
£lf
.
pŞ_£l_widg‘
.
	`upd©e_bË
()

211 
def
 
	$sw™ch_v›w_mod–
(
£lf
, 
mod–_id
):

213 
	$sw™ch_v›w_mod–
(): 
desütiÚ


215 :
·¿m
 
mod–_id
: mod–_id 
desütiÚ


216 :
ty³
 
mod–_id
: model_idype

218 :
»tuºs
: 
NÚe


220 
£lf
.
bË_v›w
.
	`sw™ch_mod–s
(
mod–_id
)

222 
def
 
	$ş—r_bË
(
£lf
):

224 
	$ş—r_bË
(): 
desütiÚ


226 :
»tuºs
: 
NÚe


228 
£lf
.
bË_v›w
.
	`»move_®l
(£lf.
sÿn_id
)

230 
def
 
	$£t_ed™abË
(
£lf
, 
ed
):

232 
	$£t_ed™abË
(): 
desütiÚ


234 :
·¿m
 
ed
:ƒd 
desütiÚ


235 :
ty³
 
ed
:ƒdype

237 :
»tuºs
: 
NÚe


239 
£lf
.
bË_v›w
.
	`£t_mod–_ed™abË
(
ed
)

241 
def
 
	$g‘_ev_»giÚs
(
£lf
):

243 
	$g‘_ev_»giÚs
(): 
desütiÚ


245 :
»tuºs
: 
NÚe


247 
ev_rois
 = 
£lf
.
bË_v›w
.
	`mod–
().
	`g‘_sÿns
()

248 
£lf
.
	`upd©e_ev_pŞ_sÿn_Üd”
(
ev_rois
)

249 (
ev_rois
)

251 
def
 
	$upd©e_ev_pŞ_sÿn_Üd”
(
£lf
, 
ev_rois
):

252 
ev_Üd”
 = 
£lf
.
	`g‘_ev_pŞ¬™y_sÿn_Üd”
()

253 
e_roi
 
š
 
ev_rois
:

254 
e_roi
['EV_POL_ORDER'] = 
ev_Üd”


256 
def
 
	$Ú_Ãw_»giÚ
(
£lf
, 
sÿn
=
NÚe
, 
add_•u_roi
=
True
):

258 
	$Ú_Ãw_»giÚ
(): 
EÃrgyS–Widg‘


260 :
·¿m
 
sÿn
=
NÚe
: sÿn=NÚ
desütiÚ


261 :
ty³
 
sÿn
=
NÚe
: scan=Noneype

263 :
»tuºs
: 
NÚe


265 #num_ev_roi ğ
	`Ën
(
£lf
.
	`g‘_ev_»giÚs
())

266 if(
nÙ
 
£lf
.
add_»giÚ_’abËd
):

269 #Ëˆ
the
 
pŞ¬™y
 
widg‘
 
know
 
th©
 
™s
 
iok
 
to
 
add
 
Ãw
 
»giÚs


270 if(
£lf
.
pŞ_£l_widg‘
):

271 
£lf
.
pŞ_£l_widg‘
.
	`’abË_add_»giÚ_m’u
(
True
)

273 #š™_ev = 
MAIN_OBJ
.
	`deviû
(
DNM_ENERGY
).
	`g‘_pos™iÚ
()

274 
š™_ev
 = 350.0

275 #sÿÀğ
	`g‘_ba£_’”gy_roi
('EV', 'ENERGY', 370, 395, 25.0, 10, 2.5, 
£lf
.
pŞ_roi
, s–f.
off_roi
, 
¡•Size
=
NÚe
, 
’abË
=
True
)

276 if(
sÿn
 
is
 
NÚe
):

277 #u£ 
´evious
 
sÿns
 
v®s
 
Ãw
 
¿nge


278 
ev_Üd”
 = 
£lf
.
	`g‘_ev_pŞ¬™y_sÿn_Üd”
()

279 
cur_sÿn
 = 
cİy
.
	`d“pcİy
(
£lf
.
bË_v›w
.
	`g‘_cur_£Ëùed_sÿn
())

280 
¦i¡
 = 
£lf
.
bË_v›w
.
	`g‘_sÿn_li¡
()

281 if((
cur_sÿn
 
is
 
NÚe
è
	`ªd
 (
	`Ën
(
¦i¡
) == 0)):

282 #ü—‹ 
a
 

283 
sÿn
 = 
	`g‘_ba£_’”gy_roi
('EV', 'ENERGY', 
š™_ev
, in™_ev, 0.0, 1, 2.5, 
NÚe
, 
¡•Size
=NÚe, 
’abË
=
True
, 
’”gy_sÿn_Üd”
=
ev_Üd”
)

285 #g‘ 
the
 
Ï¡
 
Úe


286 if(
	`Ën
(
¦i¡
) > 0):

287 
cur_sÿn
 = 
¦i¡
[-1]

289 
sÿn
 = 
	`g‘_ba£_’”gy_roi
('EV', 'ENERGY', 
cur_sÿn
['START'], cur_sÿn['STOP'], cur_sÿn['RANGE'] + 
EV_SCAN_EDGE_RANGE
, cur_sÿn['NPOINTS'], cur_sÿn['DWELL'], 
NÚe
, 
¡•Size
=NÚe, 
’abË
=
True
, 
’”gy_sÿn_Üd”
=
ev_Üd”
)

291 #if(
£lf
.
pŞ_£l_widg‘
 
is
 
nÙ
 
NÚe
):

292 if((
add_•u_roi
è
	$ªd
 (
£lf
.
pŞ_£l_widg‘
 
is
 
nÙ
 
NÚe
)):

293 
sÿn
['POL_ID'] = 
£lf
.
pŞ_£l_widg‘
.
bË_v›w
.
	`ü—‹_Ãw_mod–
()

294 #´šˆ'\t\tEV[%d] c»©šg POL_MODEL[%d]' % (
sÿn
[
SPDB_ID_VAL
], scan['POL_ID'])

295 if(
£lf
.
pŞ_£l_widg‘
):

296 
£lf
.
pŞ_£l_widg‘
.
	`Ú_Ãw_»giÚ
()

297 
£lf
.
pŞ_£l_widg‘
.
	`upd©e_bË
()

299 #£lf.
bË_v›w
.
	`add_sÿn
(
sÿn
, scan['POL_ID'])

300 
£lf
.
sÿn_id
 += 1

301 
£lf
.
bË_v›w
.
	`add_sÿn
(
sÿn
, s–f.
sÿn_id
)

302 
Ãw_row
 = 
£lf
.
bË_v›w
.
	`g‘_num_rows
()

303 
£lf
.
bË_v›w
.
	`mod–
().
	`»ÿlc_·¿ms
(
Ãw_row
-1)

305 #sØ
th©
 
ªy
 
chªges
 
wl
 
be
 
picked
 
up
 
by
‡ny 
li¡’šg
 
widg‘s


306 if(
£lf
.
pŞ_£l_widg‘
):

307 
£lf
.
	`Ú_pŞ_bË_chªged
()

310 
def
 
	$lßd_sÿn
(
£lf
, 
ev_rois
=[]):

311 
cur_sÿn
 
š
 
ev_rois
:

313 
sÿn
 = 
	`g‘_ba£_’”gy_roi
('EV', 'ENERGY', 
cur_sÿn
['START'], cur_sÿn['STOP'], cur_sÿn['RANGE'] + 
EV_SCAN_EDGE_RANGE
, cur_sÿn['NPOINTS'], cur_sÿn['DWELL'], 
NÚe
, 
¡•Size
=NÚe, 
’abË
=
True
)

314 
sÿn
[
SPDB_ID_VAL
] = 
cur_sÿn
[SPDB_ID_VAL]

315 
sÿn
['POL_ID'] = 
cur_sÿn
['POL_ID']

316 
sÿn
['POL_ROIS'] = 
cur_sÿn
['POL_ROIS']

318 if(
£lf
.
pŞ_£l_widg‘
):

319 
£lf
.
pŞ_£l_widg‘
.
bË_v›w
.
	`ü—‹_Ãw_mod–
(
mod–_id
 = 
sÿn
['POL_ID'])

320 #´šˆ'\t\tEV[%d] c»©šg POL_MODEL[%d]' % (
sÿn
[
SPDB_ID_VAL
], scan['POL_ID'])

321 
£lf
.
pŞ_£l_widg‘
.
	`lßd_sÿn
(
sÿn
['POL_ROIS'])

322 
£lf
.
pŞ_£l_widg‘
.
	`upd©e_bË
()

324 
£lf
.
bË_v›w
.
	`add_sÿn
(
sÿn
, sÿn[
SPDB_ID_VAL
])

328 
def
 
	$Ú_d–‘e_»giÚ
(
£lf
, 
sÿn_id
=
NÚe
):

330 
	$Ú_d–‘e_»giÚ
(): 
desütiÚ


332 :
·¿m
 
sÿn_id
=
NÚe
: sÿn_id=NÚ
desütiÚ


333 :
ty³
 
sÿn_id
=
NÚe
: scan_id=Noneype

335 :
»tuºs
: 
NÚe


337 if(
sÿn_id
 
is
 
NÚe
):

338 
sÿn
 = 
£lf
.
bË_v›w
.
	`g‘_cur_£Ëùed_sÿn
()

339 
sÿn_id
 = 
sÿn
[
SPDB_ID_VAL
]

340 
sÿn
 = 
£lf
.
bË_v›w
.
	`g‘_sÿn
(
sÿn_id
)

341 if(
sÿn
):

342 if(
£lf
.
pŞ_£l_widg‘
):

343 
£lf
.
pŞ_£l_widg‘
.
	`d–‘e_mod–
(
sÿn
['POL_ID'])

344 
´št
 '\‹v d–‘šg[%d]' % 
sÿn_id


345 
£lf
.
bË_v›w
.
	`»move_sÿn
(
sÿn_id
)

347 
def
 
	$Ú_sšgË_ev
(
£lf
):

349 
	$Ú_sšgË_ev
(): 
desütiÚ


351 :
»tuºs
: 
NÚe


353 
£lf
.
bË_v›w
.
	`mod–
().
	`»move_®l_exû±_fœ¡
(£lf.
sÿn_id
)

	@widgets/scan_table_view/multiRegionWidget.py

2 
äom
 
PyQt5
 
impÜt
 
	gQtCÜe
, 
	gQtGui
, 
	gQtWidg‘s


4 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
ba£SÿnTabË
 
	gimpÜt
 *

5 
äom
 
	gşs
.
	gsÿÂšg
.
d©aRecÜd”
 
impÜt
 
	gSTXMD©aIo


6 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
¥©ŸlS–Widg‘
 
impÜt
 
	gS·tŸlS–Widg‘


7 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
evS–Widg‘
 
impÜt
 
	gEÃrgyS–Widg‘


8 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
pŞ¬™yS–Widg‘
 
impÜt
 
	gPŞ¬™yS–Widg‘


9 
äom
 
	gşs
.
	guts
.
roi_uts
 
impÜt
 
	gg‘_fœ¡_¥_db_äom_wdg_com


10 
äom
 
	gşs
.
	guts
.
feUts
 
impÜt
 
	gg‘_fe_·th_as_·¹s


11 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


13 
	g_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

15 
şass
 
	$MuÉiRegiÚWidg‘
(
Ba£S–eùiÚWidg‘
):

17 
A
 
QWidg‘
 
th©
 
cÚšs
 
S·tŸl
, 
EV
, 
ªd
 
pŞ¬™y
 
£ËùiÚ
 
bË
 
v›ws


19 
Each
 
of
 
the
 3 
widg‘s
 
Ãed
 
to
 
suµÜt
h
addšg
 
ªd
 
d–‘šg
 oà
»giÚs
 
bÙh


20 
äom
 
‹h
 
	`GUI
 (
right
 
şick
 
ªd
 
£Ëù
 
add
/
d–‘e
 fromeh 
m’u
è
as
 
w–l
‡s

21 
´og¿m©tiÿÎy
 
beÿu£
 
we
 
Ãed
 
to
 
be
 
abË
Ø
add
/
d–‘e
 
ba£d
 
Ú
 
wh©
 
a
 
¶Ù‹r
 
widg‘


22 
may
 
have
 
dÚe
.

26 
¥©Ÿl_row_£Ëùed
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
)

27 
¥©Ÿl_row_chªged
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
)

28 
¥©Ÿl_row_d–‘ed
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
)

30 
def
 
	$__š™__
(
£lf
,
u£_ûÁ”
=
True
, 
is_pošt
=
F®£
, 
is_¬b_lše
=F®£, 
’abË_muÉi_¥©Ÿl
=F®£, 
sšgË_ev_mod–
=F®£, *
¬gs
):

32 
	$__š™__
(): 
desütiÚ


34 :
·¿m
 *
¬gs
: *¬g 
desütiÚ


35 :
ty³
 *
¬gs
: *argsype

37 :
»tuºs
: 
NÚe


39 
Ba£S–eùiÚWidg‘
.
	`__š™__
(
£lf
, *
¬gs
)

40 
£lf
.
	`£tGeom‘ry
(300, 200, 870, 850)

42 
£lf
.
u£_ûÁ”
 = use_center

43 
£lf
.
’abË_muÉi_¥©Ÿl
 =ƒnable_multi_spatial

44 
£lf
.
ev_pŞ¬™y_sÿn_Üd”
 = 
’”gy_sÿn_Üd”_ty³s
.
EV_THEN_POL


46 
£lf
.
lßdSÿnBŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
('Load Scan')

47 
£lf
.
g‘D©aBŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
('Get Data')

48 
£lf
.
com·»D©aBŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
('Compare Data')

49 #£lf.
muÉiS·tŸlCheckBox
 = 
QtWidg‘s
.
	`QCheckBox
('Multi Spatials')

52 
£lf
.
g‘D©aBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_g‘_d©a_bŠ
)

53 
£lf
.
lßdSÿnBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_lßd_sÿn
)

54 
£lf
.
com·»D©aBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_com·»_d©a
)

55 #£lf.
muÉiS·tŸlCheckBox
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_muÉi_¥©Ÿl_chk
)

57 
£lf
.
pŞ_widg
 = 
	`PŞ¬™yS–Widg‘
()

58 
£lf
.
ev_widg
 = 
	`EÃrgyS–Widg‘
(£lf.
pŞ_widg
)

59 
£lf
.
¥_widg
 = 
	`S·tŸlS–Widg‘
(£lf.
ev_widg
, 
u£_ûÁ”
=u£_ûÁ”, 
is_pošt
=is_pošt, 
is_¬b_lše
=is_¬b_lše, 
sšgË_ev_mod–
=single_ev_model)

61 
£lf
.
¥_widg
.
bË_v›w
.
row_£Ëùed
.
	`cÚÃù
(£lf.
row_was_£Ëùed
)

62 
£lf
.
¥_widg
.
mod–_chªge
.
	`cÚÃù
(£lf.
Ú_¥©Ÿl_mod–_chªged
)

63 
£lf
.
¥_widg
.
¥©Ÿl_row_chªged
.
	`cÚÃù
(£lf.
Ú_¥©Ÿl_row_chªged
)

64 
£lf
.
¥_widg
.
roi_d–‘ed
.
	`cÚÃù
(£lf.
Ú_¥©Ÿl_roi_d–‘ed
)

66 
v_Ïyout
 = 
QtWidg‘s
.
	`QVBoxLayout
()

67 
v_Ïyout
.
	`£tCÚ‹ÁsM¬gšs
(2,2,2,2)

69 #if(
’abË_muÉi_¥©Ÿl
):

70 #v_Ïyout.
	`addWidg‘
(
£lf
.
muÉiS·tŸlCheckBox
)

72 
v_Ïyout
.
	`addWidg‘
(
£lf
.
¥_widg
)

73 
v_Ïyout
.
	`addWidg‘
(
£lf
.
ev_widg
)

74 
v_Ïyout
.
	`addWidg‘
(
£lf
.
pŞ_widg
)

75 #v_Ïyout.
	`addWidg‘
(
£lf
.
g‘D©aBŠ
)

76 #v_Ïyout.
	`addWidg‘
(
£lf
.
lßdSÿnBŠ
)

78 #£lf.
muÉiS·tŸlCheckBox
.
	`£tChecked
(
F®£
)

79 #£lf.
	`Ú_muÉi_¥©Ÿl_chk
(
F®£
)

80 if(
’abË_muÉi_¥©Ÿl
):

81 #£lf.
muÉiS·tŸlCheckBox
.
	`£tEÇbËd
(
True
)

82 #£lf.
muÉiS·tŸlCheckBox
.
	`£tChecked
(
True
)

83 
£lf
.
	`Ú_muÉi_¥©Ÿl_chk
(
True
)

85 #£lf.
muÉiS·tŸlCheckBox
.
	`£tEÇbËd
(
F®£
)

86 #£lf.
muÉiS·tŸlCheckBox
.
	`£tChecked
(
F®£
)

87 
£lf
.
	`Ú_muÉi_¥©Ÿl_chk
(
F®£
)

89 
£lf
.
	`£tLayout
(
v_Ïyout
)

92 
def
 
	$show_lßd_bŠ
(
£lf
):

93 
£lf
.
	`Ïyout
().
	`addWidg‘
(£lf.
lßdSÿnBŠ
)

95 
def
 
	$show_g‘d©a_bŠ
(
£lf
):

96 
£lf
.
	`Ïyout
().
	`addWidg‘
(£lf.
g‘D©aBŠ
)

98 
def
 
	$Ú_g‘_d©a_bŠ
(
£lf
):

99 #¥_»giÚ ğ
£lf
.
	`g‘_¥_»giÚs
()

100 #´šˆ
¥_»giÚs


101 
£lf
.
	`g‘_¥_»giÚs
(
do_´št
=
True
)

103 
def
 
	$g‘_¥©Ÿl_mod–
(
£lf
):

104 (
£lf
.
¥_widg
.
bË_v›w
.
	`mod–
())

106 
def
 
	$g‘_’”gy_mod–
(
£lf
):

107 (
£lf
.
ev_widg
.
bË_v›w
.
	`mod–
())

110 
def
 
	$d–‘e_¥©Ÿl_row
(
£lf
, 
¥_mod–_id
=
NÚe
):

111 
£lf
.
¥_widg
.
	`d–‘e_row
(
¥_mod–_id
)

113 
def
 
	$modify_¥©Ÿl_row_d©a
(
£lf
, 
™em_id
, 
sÿn
):

114 
£lf
.
¥_widg
.
	`modify_row_d©a
(
™em_id
, 
sÿn
)

116 
def
 
	$g‘_¥©Ÿl_row_d©a
(
£lf
, 
sÿn_id
):

117 (
£lf
.
¥_widg
.
	`g‘_row_d©a_by_™em_id
(
sÿn_id
))

119 
def
 
	$ü—t_Ãw_¥©Ÿl_»giÚ
(
£lf
, 
sÿn
=
NÚe
, 
add_’”gy_roi
=
True
):

120 if(
£lf
.
’abË_muÉi_¥©Ÿl
 
	`Ü
 (£lf.
¥_widg
.
bË_v›w
.
	`g‘_num_sÿns
() == 0)):

121 
£lf
.
¥_widg
.
	`Ú_Ãw_»giÚ
(
sÿn
=sÿn, 
add_’”gy_roi
=add_energy_roi)

123 
def
 
	$£t_¥©Ÿl_pos™iÚ”s
(
£lf
, 
xpos_Çme
, 
ypos_Çme
):

124 
£lf
.
¥_widg
.
	`£t_pos™iÚ”s
(
xpos_Çme
, 
ypos_Çme
)

126 
def
 
	$ş—r_¥©Ÿl_bË
(
£lf
):

127 
£lf
.
¥_widg
.
	`ş—r_bË
()

129 
def
 
	$£t_roi_lim™s
(
£lf
, 
lim™_def
):

130 
q»ù
 = 
lim™_def
.
	`g‘_®¬m_def
(
as_q»ù
=
True
)

131 
£lf
.
	`_£t_¥©Ÿl_¿nge
(
q»ù
)

133 
def
 
	$_£t_¥©Ÿl_¿nge
(
£lf
, 
q»ù
):

135 
£lf
.
¥_widg
.
	`£t_¥©Ÿl_¿nge
(
q»ù
)

137 if(
nÙ
 
£lf
.
u£_ûÁ”
):

138 
£lf
.
¥_widg
.
	`£t_¥©Ÿl_¡¬t¡İ
(
q»ù
)

140 
def
 
	$Ú_com·»_d©a
(
£lf
):

141 
£lf
.
	`com·»_roi
(
roi_def
, 
axis
=
SPDB_X
)

143 
def
 
	$Ú_lßd_sÿn
(
£lf
 ):

144 
äom
 
şs
.
­¶iÿtiÚs
.
pyStxm
.
bl10ID01
 
impÜt
 
MAIN_OBJ


145 
äom
 
şs
.
sÿÂšg
.
d©aRecÜd”
 
impÜt
 
STXMD©aIo


146 
äom
 
şs
.
uts
.
feUts
 
impÜt
 
g‘_fe_·th_as_·¹s


147 
äom
 
şs
.
­pWidg‘s
.
dŸlogs
 
impÜt
 
g‘O³nFeName


149 
d©adœ
=
r
'S:\STXM-data\Cryo-STXM\2017\guest\0201'

150 
d©a_fe_pfx
 = 'C'

151 
âame
 = 
	`g‘O³nFeName
("Lßd Sÿn", 
f‹r_¡r
="SÿÀFe (%s*.hdf5)" % 
d©a_fe_pfx
, 
£¬ch_·th
=
d©adœ
)

152 
£lf
.
	`İ’fe
(
âame
)

153 #d©a_dœ, 
å»fix
, 
fsuffix
 = 
	`g‘_fe_·th_as_·¹s
(
âame
)

154 #if(
âame
 
is
 
NÚe
):

156 #d©a_iØğ
	`STXMD©aIo
(
d©a_dœ
, 
å»fix
, 
fsuffix
)

157 #d©a_dù = 
d©a_io
.
	`lßd
()

158 #if(
d©a_dù
 
is
 
nÙ
 
NÚe
):

159 #dù_put(
d©a_dù
,
ADO_CFG_WDG_COM_CMND
, 
widg‘_com_cmnd_ty³s
.
LOAD_SCAN
)

160 #£lf.
	`lßd_sÿn
(
	`dù_g‘
(
d©a_dù
, 
ADO_CFG_WDG_COM
))

162 
def
 
	$İ’fe
(
£lf
, 
âame
):

164 
check_fÜ_cur_sÿn_b
: 
this
 
ÿÎ
 
was
 
Üigš®ly
 
u£d
 
by
 
the
 
lßd_sÿn
 
bu‰Ús
 
Ú
 
—ch
 
sÿn
 
¶uggš


165 
b
 
which
 
would
 
Úly
 
lßd
 
a
 
sÿn
 
th©
 
m©ched
 
the
 sÿÀ
¶uggš
 
you
 
w”e
 
lßdšg
 
äom
, 
but
 
to


166 
suµÜt
 
d¿g
 
ªd
 
drİ
 
İ”©iÚs
 
we
 
wl
 
®low
 
the
 
skpšg
 
of
 
this
 
check
 
so
 
th©
h
maš
 
­p


167 
ÿn
 
autom©iÿÎy
 
make
 
the
 
drİ³d
 
sÿn
h
cu»Á
 sÿÀ
¶uggš
 
b


169 if(
âame
 
is
 
NÚe
):

171 
d©a_dœ
, 
å»fix
, 
fsuffix
 = 
	`g‘_fe_·th_as_·¹s
(
âame
)

172 
d©a_io
 = 
	`STXMD©aIo
(
d©a_dœ
, 
å»fix
)

173 
’Œy_dù
 = 
d©a_io
.
	`lßd
()

174 if(
’Œy_dù
 
is
 
NÚe
):

176 
­³nd
 = 
F®£


177 
ekey
 
š
 
’Œy_dù
.
	$keys
():

178 #ekey = 
’Œy_dù
.
	`keys
()[0]

179 
nx_d©as
 = 
d©a_io
.
	`g‘_NXd©as_äom_’Œy
(
’Œy_dù
, 
ekey
)

180 #cu¼’y 
Úly
 
suµÜt
 1 
couÁ”


181 
couÁ”_Çme
 = 
nx_d©as
.
	`keys
()[0]

182 
d©a
 = 
d©a_io
.
	`g‘_sigÇl_d©a_äom_NXd©a
(
nx_d©as
, 
couÁ”_Çme
)

183 
wdg_com
 = 
d©a_io
.
	`g‘_wdg_com_äom_’Œy
(
’Œy_dù
, 
ekey
)

185 if(
nÙ
 
­³nd
):

186 
£lf
.
	`lßd_sÿn
(
wdg_com
, 
­³nd
=append)

187 
­³nd
 = 
True


189 
£lf
.
	`lßd_sÿn
(
wdg_com
, 
­³nd
=append)

193 #_logg”.
	`”rÜ
('unableo†oad scan, wrong scanype')

196 
def
 
	$lßd_sÿn
(
£lf
, 
wdg_com
, 
­³nd
=
F®£
):

198 
giv’
 
the
 
sÿn
 
ty³
 
suµÜts
 
muÉi
 
¥©Ÿl
, 
»ad
 
š
 
ªd
 
lßd
h
»¥eùive


199 
bËs


200 
sÿn_ty³s
 = 
	`Enum
('Detector_Image','OSA_Image','OSA_Focus','Sample_Focus','Sample_Point_Spectrum', 'Sample_Line_Spectrum', 'Sample_Image', 'Sample_Image_Stack', 'Generic_Scan')

202 
muÉi_sÿn_ty³s
 = [
sÿn_ty³s
.
SAMPLE_POINT_SPECTRUM
, sÿn_ty³s.
SAMPLE_LINE_SPECTRUM
, sÿn_ty³s.
SAMPLE_IMAGE
, sÿn_ty³s.
SAMPLE_IMAGE_STACK
, sÿn_ty³s.SAMPLE_IMAGE + 
IMAGE_LXL
, sÿn_ty³s.SAMPLE_IMAGE + 
IMAGE_PXP
]

204 
¥_roi_dù
 = 
	`dù_g‘
(
wdg_com
, 
WDGCOM_SPATIAL_ROIS
)

205 
¥_ids
 = 
¥_roi_dù
.
	`keys
()

206 
¥_id
 = 
¥_ids
[0]

207 
¥_db
 = 
¥_roi_dù
[
¥_id
]

208 
sÿn_ty³
 = 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
)

210 if(
sÿn_ty³
 
nÙ
 
š
 
muÉi_sÿn_ty³s
):

211 
_logg”
.
	`”rÜ
('IncÜ»ù sÿÀty³ [%d],‚Ù‡ muÉ˜¥©ŸÈ»giÚ sÿn' % 
sÿn_ty³
)

214 
_logg”
.
	`šfo
('[%d] sÿÀlßded' % 
sÿn_ty³
)

216 #if(
	`Ën
(
¥_ids
) > 1):

217 #£lf.
muÉiS·tŸlCheckBox
.
	`£tChecked
(
True
)

218 #£lf.
	`Ú_muÉi_¥©Ÿl_chk
(
True
)

220 #£lf.
muÉiS·tŸlCheckBox
.
	`£tChecked
(
F®£
)

221 #£lf.
	`Ú_muÉi_¥©Ÿl_chk
(
F®£
)

222 if(
nÙ
 
­³nd
):

223 
£lf
.
¥_widg
.
	`lßd_sÿn
(
¥_db
)

225 
£lf
.
¥_widg
.
	`add_sÿn
(
¥_db
)

227 if(
	`Ën
(
¥_ids
) > 1):

228 
¥_id
 
š
 
¥_ids
[1:]:

229 
¥_roi
 = 
¥_roi_dù
[
¥_id
]

230 #£lf.
¥_widg
.
	`lßd_sÿn
(
¥_roi
)

231 #£lf.
¥_widg
.
bË_v›w
.
	`add_sÿn
(
¥_roi
, 
¥_id
)

232 
£lf
.
¥_widg
.
	`add_sÿn
(
¥_roi
)

233 #£lf.
	`´št_¥_roi
(
¥_roi
)

237 
def
 
	$row_was_£Ëùed
(
£lf
, 
sÿn
):

238 
¥_db
 = 
	`make_¥©Ÿl_db_diù
()

239 
¥_db
[
WDGCOM_CMND
] = 
widg‘_com_cmnd_ty³s
.
SELECT_ROI


240 #dù_put(
¥_db
, 
SPDB_SCAN_PLUGIN_ITEM_ID
, 
sÿn
[
SPDB_ID_VAL
])

241 
¥_db
[
SPDB_ID_VAL
] = 
sÿn
[SPDB_ID_VAL]

243 
£lf
.
¥©Ÿl_row_£Ëùed
.
	`em™
(
¥_db
)

245 
def
 
	$’abË_add_¥©Ÿl_»giÚ_m’u
(
£lf
, do=
True
):

246 
£lf
.
¥_widg
.
	`’abË_add_»giÚ_m’u
(do)

248 
def
 
	$de£Ëù_®l
(
£lf
):

249 #_logg”.
	`debug
('deselect_all: called')

250 
£lf
.
¥_widg
.
bË_v›w
.
	`ş—rS–eùiÚ
()

252 
def
 
	$£Ëù_¥©Ÿl_row
(
£lf
, 
sÿn_id
):

253 
£lf
.
¥_widg
.
	`blockSigÇls
(
True
)

254 
£lf
.
¥_widg
.
	`£Ëù_row
(
™em_id
=
sÿn_id
)

255 
£lf
.
¥_widg
.
	`blockSigÇls
(
F®£
)

257 
def
 
	$Ú_muÉi_¥©Ÿl_chk
(
£lf
, 
checked
):

258 if(
checked
):

259 
£lf
.
’abË_muÉi_¥©Ÿl
 = 
True


261 
£lf
.
’abË_muÉi_¥©Ÿl
 = 
F®£


263 
£lf
.
¥_widg
.
	`’abË_muÉi_¥©Ÿl
(£lf.
’abË_muÉi_¥©Ÿl
)

265 
def
 
	$is_muÉi_»giÚ_’abËd
(
£lf
):

266 (
£lf
.
’abË_muÉi_¥©Ÿl
)

268 
def
 
	$Ú_¥©Ÿl_mod–_chªged
(
£lf
, 
sÿn_id
):

269 
cur_row_li¡
 = 
£lf
.
¥_widg
.
bË_v›w
.
	`£ËùiÚMod–
().
	`£ËùedRows
()

270 
cur_row
 = 
cur_row_li¡
[0].
	`row
()

271 #g‘ 
row
 
ID
 
of
 
this
 
sÿn


272 
Ãw_row
 = 
£lf
.
¥_widg
.
	`g‘_row_idx
(
sÿn_id
)

273 if(
cur_row
 =ğ
Ãw_row
):

274 #w
have
 
b“n
 
ÿÎed
 
´og¿m©iÿÎy
 
so
  
sigÇl
 
cyşe


277 
sÿn
 = 
£lf
.
¥_widg
.
	`g‘_row_d©a
(
sÿn_id
)

278 if(
sÿn
 
is
 
nÙ
 
NÚe
):

279 
x_roi
 = 
sÿn
[
SPDB_X
]

280 
y_roi
 = 
sÿn
[
SPDB_Y
]

282 
¥_db
 = 
	`make_¥©Ÿl_db_diù
(
x_roi
=x_roi, 
y_roi
=y_roi)

283 
¥_db
[
WDGCOM_CMND
] = 
widg‘_com_cmnd_ty³s
.
ROI_CHANGED


284 #dù_put(
¥_db
, 
SPDB_SCAN_PLUGIN_ITEM_ID
, 
sÿn
[
SPDB_ID_VAL
])

286 if(
x_roi
['NPOINTS'] == 1):

287 
	`dù_put
(
¥_db
, 
SPDB_PLOT_SHAPE_TYPE
, 
¥©Ÿl_ty³_´efix
.
PNT
)

289 
	`dù_put
(
¥_db
, 
SPDB_PLOT_SHAPE_TYPE
, 
¥©Ÿl_ty³_´efix
.
ROI
)

291 
£lf
.
¥©Ÿl_row_£Ëùed
.
	`em™
(
¥_db
)

294 #deà
	`Ú_¥©Ÿl_row_chªged
(
£lf
, 
sÿn
):

295 #if(
sÿn
 
is
 
nÙ
 
NÚe
):

296 ##
´št
 'Ú_¥©Ÿl_row_chªged: sÿn_id(%d)' % 
sÿn
[
SPDB_ID_VAL
]

297 #¥_db = 
	`make_¥©Ÿl_db_diù
()

298 #¥_db[
WDGCOM_CMND
] = 
widg‘_com_cmnd_ty³s
.
ROI_CHANGED


299 #
##
£t
 
the
 
SINGLE_SPATIAL
 
f›lds
 
so
 
th©
h
¶Ù‹r
 
ÿn
 
upd©e


300 #¥_db[
SPDB_X
]['START'] = 
sÿn
[SPDB_X]['START']

301 #¥_db[
SPDB_X
]['STOP'] = 
sÿn
[SPDB_X]['STOP']

302 #¥_db[
SPDB_Y
]['START'] = 
sÿn
[SPDB_Y]['START']

303 #¥_db[
SPDB_Y
]['STOP'] = 
sÿn
[SPDB_Y]['STOP']

304 #¥_db[
SPDB_X
]['CENTER'] = 
sÿn
[SPDB_X]['CENTER']

305 #¥_db[
SPDB_Y
]['CENTER'] = 
sÿn
[SPDB_Y]['CENTER']

306 #¥_db[
SPDB_X
]['RANGE'] = 
sÿn
[SPDB_X]['RANGE']

307 #¥_db[
SPDB_Y
]['RANGE'] = 
sÿn
[SPDB_Y]['RANGE']

308 #¥_db[
SPDB_X
]['NPOINTS'] = 
sÿn
[SPDB_X]['NPOINTS']

309 #¥_db[
SPDB_Y
]['NPOINTS'] = 
sÿn
[SPDB_Y]['NPOINTS']

310 #
#¥_db[
SPDB_EV_ROIS
] = 
sÿn
[SPDB_EV_ROIS]

311 #
##
»ù
 = (
sÿn
['STARTX'], scan['STARTY'], scan['STOPX'], scan['STOPY'])

312 #»ù = 
sÿn
[
SPDB_RECT
]

313 ##
´št
 'Ú_¥©Ÿl_row_chªged:„eù =' , 
»ù


314 ##
	`dù_put
(
¥_db
, 
SPDB_SCAN_PLUGIN_ITEM_ID
, 
sÿn
[
SPDB_ID_VAL
])

315 #if(
sÿn
[
SPDB_X
]['NPOINTS'] == 1):

316 ##
¥_db
['SCAN_PLUGGIN']['ITEM']['TYPE'] = 
¥©Ÿl_ty³_´efix
.
PNT


317 #dù_put(
¥_db
, 
SPDB_PLOT_SHAPE_TYPE
, 
¥©Ÿl_ty³_´efix
.
PNT
)

319 ##
¥_db
['SCAN_PLUGGIN']['ITEM']['TYPE'] = 
¥©Ÿl_ty³_´efix
.
ROI


320 #dù_put(
¥_db
, 
SPDB_PLOT_SHAPE_TYPE
, 
¥©Ÿl_ty³_´efix
.
ROI
)

321 #
#¥_db[
SPDB_ID_VAL
] = 
sÿn
[SPDB_ID_VAL]

322 #£lf.
¥©Ÿl_row_chªged
.
	`em™
(
¥_db
)

323 #
##
¥_roi
 = 
£lf
.
	`g‘_¥_»giÚs
()

324 ##
£lf
.
bËs_chªged
.
	`em™
()

327 #deà
	`upd©e_muÉi_¥©Ÿl_wdg_com
(
£lf
):

328 
def
 
	$Ú_¥©Ÿl_row_chªged
(
£lf
, 
sÿn
):

330 
This
 
is
 
a
 
¡ªd¬d
 
funùiÚ
 
th©
 
®l
 
sÿn
 
¶uggšs
 
have
h© i 
ÿÎed
 
to


331 
g‘
 
the
 
d©a
 
äom
h
¶uggšs
 
UI
 
widg‘s
 
ªd
 
wr™e
 
them
 
što
 
a
 
diù
 
»tuºed
 
by


332 
	`g‘_ba£_sÿÅ¬am_roi
(), 
this
 
diù
 
is
 
em™‹d
 
by
 
®l
 
sÿn
 
¶uggšs
 
to
 
be
 
u£d
 by

333 
the
 
sÿn
 
şas£s
 
	$cÚfigu»
(è
funùiÚs


335 :
»tuºs
: 
NÚe


338 #_logg”.
	`debug
('on_spatial_row_changed:')

339 
¥_rois_dù
 = 
£lf
.
	`g‘_¥_»giÚs
()

340 
£lf
.
¥©Ÿl_row_chªged
.
	`em™
(
¥_rois_dù
)

343 
def
 
	$Ú_¥©Ÿl_roi_d–‘ed
(
£lf
, 
sÿn
):

344 
£lf
.
¥©Ÿl_row_d–‘ed
.
	`em™
(
sÿn
)

347 
def
 
	$g‘_¥_»giÚs
(
£lf
, 
do_´št
=
F®£
):

349 
	$g‘_¥_»giÚs
(): 
desütiÚ


351 :
»tuºs
: 
NÚe


357 
¥_»giÚs
 = {
	}
}

358 
¥_roi
 
š
 
£lf
.
¥_widg
.
	$g‘_d©a
():

359 if(
do_´št
):

360 
£lf
.
	`´št_¥_roi
(
¥_roi
)

361 #£lf.
	`com·»_roi
(
¥_roi
, 
axis
=
SPDB_X
)

362 #£lf.
	`com·»_roi
(
¥_roi
, 
axis
=
SPDB_Y
)

364 
x¡¬t
 = 
	`dù_g‘
(
¥_roi
, 
SPDB_XSTART
)

365 
x¡İ
 = 
	`dù_g‘
(
¥_roi
, 
SPDB_XSTOP
)

366 
y¡¬t
 = 
	`dù_g‘
(
¥_roi
, 
SPDB_YSTART
)

367 
y¡İ
 = 
	`dù_g‘
(
¥_roi
, 
SPDB_YSTOP
)

368 
¥_roi
[
SPDB_RECT
] = (
x¡¬t
, 
y¡¬t
, 
x¡İ
, 
y¡İ
)

369 
_evs
 = []

370 
e_Åts
 = 0

371 
pŞ_Åts
 = 0

372 
ev_£ošts
 = []

373 
dw–l_£ošts
 = []

375 #´šˆ'¥_id=%d EV_ID=%d' % (
¥_roi
[
SPDB_ID_VAL
], sp_roi[
SPDB_EV_ID
])

376 
ev_roi
 
š
 
£lf
.
ev_widg
.
	$g‘_d©a
(
¥_roi
[
SPDB_EV_ID
]):

377 if(
do_´št
):

378 
£lf
.
	`´št_ev_roi
(
ev_roi
)

380 
dw–l
 = 
ev_roi
[
DWELL
]

381 
e_Åts
 +ğ
ev_roi
[
NPOINTS
]

382 
dw–l_£ošts
.
	`­³nd
(
dw–l
)

383 
_pŞs
 = []

384 
pŞ_£ošts
 = []

385 
off_£ošts
 = []

386 
ªgË_£ošts
 = []

387 #fÜ 
ev_¥
 
š
 
ev_roi
['SETPOINTS']:

388 
pŞ_roi
 
š
 
£lf
.
pŞ_widg
.
	`g‘_d©a
(
ev_roi
['POL_ID']):

389 if(
do_´št
):

390 
£lf
.
	`´št_pŞ_roi
(
ev_roi
['START'], 
pŞ_roi
)

391 #ev_£ošts.
	`­³nd
(
ev_¥
)

392 #dw–l_£ošts.
	`­³nd
(
dw–l
)

393 
pŞ_£ošts
.
	`­³nd
(
pŞ_roi
['POL'])

394 
off_£ošts
.
	`­³nd
(
pŞ_roi
['OFF'])

395 
ªgË_£ošts
.
	`­³nd
(
pŞ_roi
['ANGLE'])

396 
_pŞs
.
	`­³nd
(
pŞ_roi
)

397 
pŞ_Åts
 += 1

398 
ev_roi
['POL_ROIS'] = 
_pŞs


400 
ev_roi
['EPU_POL_PNTS'] = 
pŞ_£ošts


401 
ev_roi
['EPU_OFF_PNTS'] = 
off_£ošts


402 
ev_roi
['EPU_ANG_PNTS'] = 
ªgË_£ošts


404 
_evs
.
	`­³nd
(
ev_roi
)

406 
¥_roi
[
SPDB_EV_ROIS
] = 
_evs


407 
¥_roi
[
SPDB_EV_NPOINTS
] = 
e_Åts


408 
¥_roi
[
SPDB_POL_NPOINTS
] = 
pŞ_Åts


410 
¥_»giÚs
[
¥_roi
[
SPDB_ID_VAL
]] = sp_roi

412 (
¥_»giÚs
)

414 
def
 
	$com·»_roi
(
£lf
, 
roi_def
, 
axis
=
SPDB_X
):

416 
	$com·»_roi
(): 
desütiÚ


418 :
·¿m
 
roi
:„o˜
desütiÚ


419 :
ty³
 
roi
:„oiype

421 :
»tuºs
: 
NÚe


423 
´št


424 
f›lds
 = ['CENTER', 'RANGE', 'NPOINTS', 'STEP', 'START', 'STOP']

425 if(
axis
 =ğ
SPDB_X
):

426 
ax
 = 
roi_def
['SPATIAL_ROIS'][0]

428 
ax
 = 
roi_def
['SPATIAL_ROIS'][1]

430 
k
 
š
 
f›lds
:

431 
´št
 '[%s] = %.2à[%s] = %.2f' % (
k
+
axis
, 
roi_def
[k+axis], k, 
ax
[k])

432 
k
 = 'SETPOINTS'

433 
´št
 '[%s%s' % (
k
, 
axis
è+ '] =', 
roi_def
[k+axis]

434 
´št
 '[%s'% (
k
è+ ']=', 
ax
[k]

436 
def
 
	$g‘_¥_»giÚs_Üig
(
£lf
):

438 
	$g‘_¥_»giÚs
(): 
desütiÚ


440 :
»tuºs
: 
NÚe


443 
This
 
funùiÚ
 
g¿bs
 
®l
 
the
 
»giÚs
 
group
 
like
 
this
:

444 
¥_»giÚs
 = []

445 
¥_»giÚs
[0] = ['SPATIAL_REGION',.....[
SPDB_EV_ROIS
]]

446 
EV_ROIS
 = ['EV_ROI', ........['POL_ROIS']]

447 
POL_ROIS
 = [{'POL_ROI', ....
	}
}]

448 
¥_»giÚs
[1] = ['SPATIAL_REGION',.....[
SPDB_EV_ROIS
]]

449 
	gEV_ROIS
 = ['EV_ROI', ........['POL_ROIS']]

450 
	gPOL_ROIS
 = [{'POL_ROI', ....}]

453 
I
 
®so
 
wªt
 
to
  
®l
 
of
 
the
 
EV
 
»giÚs
 
a
 
·¹icuÏr
 
¥©Ÿl
 
ROI
 
such
 
th©


454 
the
 
»suÉšg
 
¬¿ys
 
¬e
 
®»ady
 
to
 
be
 
£Á
Øth
ssÿn
 
»cÜd
 
š
 
TABLE
 
mode
, 
	gm—nšg


455 
I
 
wªt
 
ª
 
¬¿y
 
th©
 
cÚšs
 
®l
 
of
 
the
 
EV
 
£ošts
 
such
h© 
™
 
is
 
cÜ»ù
 
	gthe


456 
numb”
 
of
 
pŞ¬™y
 
£‰šgs
 
—ch
 
’”gy
 
	gpošt
.

457 
fÜe
 
	gSPATIAL_ROI
 1:

458 
EV_ROI
 1 = 395e
v
 
to
 405ev 2 
±s
, 
	gPOL_ROI
's = [{pol1e1}, {pol2e1}, {pol3e1}]

459 
	gEV_ROI
 2 = 395e
v
 
to
 405ev 3 
±s
, 
	gPOL_ROI
's = [{pol1e2}, {pol2e2}]

460 
I
 
wªt
 
to
 
g’”©e
 
the
 
	gfŞlowšg
 2 
	g¬¿ys


462 
EV
 
¬¿y
 
£Á
 
to
 
’”gy
 
ssÿn
 
POL
‡¼ay s’ˆtØ
pŞ¬™y
 
	gssÿn


463 [ 
e1
.1, [ 
pŞ1e1
,

464 
e1
.1, 
pŞ2e1
,

465 
e1
.1, 
pŞ3e1
,

466 
e1
.2, 
pŞ1e1
,

467 
e1
.2, 
pŞ2e1
,

468 
e1
.2, 
pŞ3e1
,

469 
e2
.1, 
pŞ2e1
,

470 
e2
.1, 
pŞ2e2
,

471 
e2
.2, 
pŞ2e1
,

472 
e2
.2, 
pŞ2e2
,

473 
e2
.3, 
pŞ2e1
,

474 
e2
.3 
pŞ2e2


476 
BÙh
 
ssÿn
 
NPTS
 
wl
 
	gbe
 12

477 
NPTS
 
	gEV_ROI
 1 = 2 
ev
 
±s
 
x
 3 
pŞ
 
pošts
 = 6

478 
NPTS
 
EV_ROI
 2 = 3 
ev
 
±s
 
x
 2 
pŞ
 
pošts
 = 6

481 
¥_db
 = 
make_¥©Ÿl_db_diù
()

483 
¥_»giÚs
 = {}

484 
¥_roi
 
š
 
£lf
.
¥_widg
.
	$g‘_d©a
():

485 #£lf.
	`´št_¥_roi
(
¥_roi
)

486 #£lf.
	`com·»_roi
(
¥_roi
, 
axis
=
SPDB_X
)

487 #£lf.
	`com·»_roi
(
¥_roi
, 
axis
=
SPDB_Y
)

488 
_evs
 = []

489 
e_Åts
 = 0

490 
ev_£ošts
 = []

491 
dw–l_£ošts
 = []

493 
ev_roi
 
š
 
£lf
.
ev_widg
.
	`g‘_d©a
(
¥_roi
['EV_ID']):

494 #£lf.
	`´št_ev_roi
(
ev_roi
)

495 
dw–l
 = 
ev_roi
['DWELL']

496 
e_Åts
 +ğ
ev_roi
['NPOINTS']

497 
dw–l_£ošts
.
	`­³nd
(
dw–l
)

498 
_pŞs
 = []

499 
pŞ_£ošts
 = []

500 
off_£ošts
 = []

501 
ªgË_£ošts
 = []

502 #fÜ 
ev_¥
 
š
 
ev_roi
['SETPOINTS']:

503 
pŞ_roi
 
š
 
£lf
.
pŞ_widg
.
	`g‘_d©a
(
ev_roi
['POL_ID']):

504 #£lf.
	`´št_pŞ_roi
(
ev_roi
['START'], 
pŞ_roi
)

505 #ev_£ošts.
	`­³nd
(
ev_¥
)

506 #dw–l_£ošts.
	`­³nd
(
dw–l
)

507 
pŞ_£ošts
.
	`­³nd
(
pŞ_roi
['POL'])

508 
off_£ošts
.
	`­³nd
(
pŞ_roi
['OFF'])

509 
ªgË_£ošts
.
	`­³nd
(
pŞ_roi
['ANGLE'])

510 
_pŞs
.
	`­³nd
(
pŞ_roi
)

511 
ev_roi
['POL_ROIS'] = 
_pŞs


513 
ev_roi
['EPU_POL_PNTS'] = 
pŞ_£ošts


514 
ev_roi
['EPU_OFF_PNTS'] = 
off_£ošts


515 
ev_roi
['EPU_ANG_PNTS'] = 
ªgË_£ošts


517 
_evs
.
	`­³nd
(
ev_roi
)

519 
¥_roi
[
SPDB_EV_ROIS
] = 
_evs


520 
¥_roi
[
SPDB_EV_NPOINTS
] = 
e_Åts


522 
x_£ošts
 = 
¥_roi
[
SPDB_X
]['SETPOINTS']

523 
y_£ošts
 = 
¥_roi
[
SPDB_Y
]['SETPOINTS']

525 
numE
 = 
	`Ën
(
ev_roi
['SETPOINTS'])

526 
numX
 = 
	`Ën
(
x_£ošts
)

527 
numY
 = 
	`Ën
(
y_£ošts
)

528 
numP
 = 
numE
 * 
numY
 * 
numX


530 
x_£ošts2
 = 
Å
.
	`te
(
x_£ošts
, 
numY
)

531 
x²ts
 = 
Å
.
	`te
(
x_£ošts2
, 
numE
)

532 
y_£ošts2
 = 
Å
.
	`»³©
(
y_£ošts
, 
numX
)

533 
y²ts
 = 
Å
.
	`te
(
y_£ošts2
, 
numE
)

535 
•Ás
 = 
Å
.
	`»³©
(
ev_£ošts
, (
numY
 * 
numX
))

536 
dw–l_²ts
 = 
Å
.
	`»³©
(
dw–l_£ošts
, (
numY
 * 
numX
))

537 
pŞ_²ts
 = 
Å
.
	`»³©
(
pŞ_£ošts
, (
numY
 * 
numX
))

538 
off_²ts
 = 
Å
.
	`»³©
(
off_£ošts
, (
numY
 * 
numX
))

539 
ªgË_²ts
 = 
Å
.
	`»³©
(
ªgË_£ošts
, (
numY
 * 
numX
))

541 
¥_roi
['1D_SETPOINTS'][
SPDB_X
] = 
x²ts


542 
¥_roi
['1D_SETPOINTS'][
SPDB_Y
] = 
y²ts


543 
¥_roi
['1D_SETPOINTS']['EV'] = 
ev_roi
['SETPOINTS']

544 
¥_roi
['1D_SETPOINTS']['DWELL'] = 
dw–l_£ošts


545 
¥_roi
['1D_SETPOINTS']['EPU_POL'] = 
pŞ_£ošts


546 
¥_roi
['1D_SETPOINTS']['EPU_OFF'] = 
off_£ošts


547 
¥_roi
['1D_SETPOINTS']['EPU_ANGLE'] = 
ªgË_£ošts


548 #¥_»giÚs.
	`­³nd
(
¥_roi
)

549 
¥_»giÚs
[
¥_roi
[
SPDB_ID_VAL
]] = sp_roi

551 
¥_db
['SPATIAL_IDS'] = 
¥_»giÚs
.
	`keys
()

552 
¥_db
['MULTI_SPATIAL'] = 
¥_»giÚs


553 (
¥_db
)

555 #deà
	`com·»_roi
(
£lf
, 
roi_def
, 
axis
=
SPDB_X
):

557 #com·»_roi(): 
desütiÚ


558 #
#:
·¿m
 
roi
:„o˜
desütiÚ


559 #:
ty³
 
roi
:„oiype

560 #
#:
»tuºs
: 
NÚe


564 #if(
axis
 =ğ
SPDB_X
):

565 #ax = 
roi_def
['SPATIAL_ROIS'][0]

567 #ax = 
roi_def
['SPATIAL_ROIS'][1]

568 #
#fÜ 
k
 
š
 
f›lds
:

569 #´šˆ'[%s] = %.2à[%s] = %.2f' % (
k
+
axis
, 
roi_def
[k+axis], k, 
ax
[k])

571 #´šˆ'[%s%s' % (
k
, 
axis
è+ '] =', 
roi_def
[k+axis]

572 #´šˆ'[%s'% (
k
è+ ']=', 
ax
[k]

574 
def
 
	$´št_¥_roi
(
£lf
, 
roi
):

576 
	$´št_¥_roi
(): 
desütiÚ


578 :
·¿m
 
roi
:„o˜
desütiÚ


579 :
ty³
 
roi
:„oiype

581 :
»tuºs
: 
NÚe


583 
´št
 'S·tŸÈROI [%d] C’‹rX[%.2f] RªgeX[%.2f] C’‹rY[%.2f] RªgeY[%.2f] EV_MODEL=%d' % (
roi
[
SPDB_ID_VAL
],„oi['X']['CENTER'],roi['X']['RANGE'],roi['Y']['CENTER'],„oi['Y']['RANGE'],„oi['EV_ID'])

584 
´št
 'S·tŸÈROI [%d] S¹X[%.2f] StİX[%.2f] S¹Y[%.2f] StİY[%.2f]' % (
roi
[
SPDB_ID_VAL
],„oi['X']['START'],roi['X']['STOP'],roi['Y']['START'],„oi['Y']['STOP'])

586 
def
 
	$´št_ev_roi
(
£lf
, 
roi
):

588 
	$´št_ev_roi
(): 
desütiÚ


590 :
·¿m
 
roi
:„o˜
desütiÚ


591 :
ty³
 
roi
:„oiype

593 :
»tuºs
: 
NÚe


595 
´št
 '\tEV ROI [%d] S¹[%.2f] End[%.2f] Rªge[%.2f] Pošts[%.2f] Dw–l[%.2f] POL_MODEL=%d' % (
roi
[
SPDB_ID_VAL
],roi['START'],roi['STOP'],roi['RANGE'],„oi['NPOINTS'],„oi['DWELL'],„oi['POL_ID'])

597 
def
 
	$´št_pŞ_roi
(
£lf
, 
ev_£ošt
, 
roi
):

599 
	$´št_pŞ_roi
(): 
desütiÚ


601 :
·¿m
 
ev_£ošt
:ƒv_£ošˆ
desütiÚ


602 :
ty³
 
ev_£ošt
:ƒv_setpointype

604 :
·¿m
 
roi
:„o˜
desütiÚ


605 :
ty³
 
roi
:„oiype

607 :
»tuºs
: 
NÚe


609 
´št
 '\t\tPOL ROI [%d] [%.3àev] POL[%d] Off£t[%.2f] AngË[%.2f]' % (
roi
[
SPDB_ID_VAL
], 
ev_£ošt
,„oi['POL'],roi['OFF'],roi['ANGLE'])

612 
__Çme__
 == '__main__':

613 
impÜt
 
sys


614 
äom
 
şs
.
­pWidg‘s
.
¥yd”_cÚsŞe
 
impÜt
 
Sh–lWidg‘
#, 
Sh–lDock


616 
	`log_to_qt
()

617 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

618 #wš = 
	`EÃrgyS–Widg‘
()

619 #wš.
	`show
()

620 #¥©ŸÈğ
	`S·tŸlS–Widg‘
()

621 #¥©Ÿl.
	`show
()

623 #muÉ˜ğ
	`MuÉiRegiÚWidg‘
(
u£_ûÁ”
=
True
, 
’abË_muÉi_¥©Ÿl
=True)

624 
muÉi
 = 
	`MuÉiRegiÚWidg‘
(
u£_ûÁ”
=
True
, 
’abË_muÉi_¥©Ÿl
=True, 
is_pošt
=
F®£
, 
sšgË_ev_mod–
=False)

625 #muÉi.
	`’abË_add_¥©Ÿl_»giÚ_m’u
(
True
)

626 
muÉi
.
	`show_lßd_bŠ
()

627 
muÉi
.
	`show_g‘d©a_bŠ
()

629 #n ğ{'maš': 
muÉi
, 'g':
	`glob®s
(è
	}
}

630 ##
msg
 = "Try forƒxample: widget.set_text('foobar') or win.close()"

631 #pythÚsh–Èğ
Sh–lWidg‘
(
·»Á
=
NÚe
, 
Çme¥aû
=
ns
,
commªds
=[], 
muÉ™h»aded
=
True
)

632 #muÉi.
Ïyout
().
addWidg‘
(
pythÚsh–l
)

634 
	gmuÉi
.
show
()

636 
	gsys
.
ex™
(
­p
.
exec_
())

	@widgets/scan_table_view/multiRegionWidget.py

2 
äom
 
PyQt5
 
impÜt
 
	gQtCÜe
, 
	gQtGui
, 
	gQtWidg‘s


4 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
ba£SÿnTabË
 
	gimpÜt
 *

5 
äom
 
	gşs
.
	gsÿÂšg
.
d©aRecÜd”
 
impÜt
 
	gSTXMD©aIo


6 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
¥©ŸlS–Widg‘
 
impÜt
 
	gS·tŸlS–Widg‘


7 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
evS–Widg‘
 
impÜt
 
	gEÃrgyS–Widg‘


8 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
pŞ¬™yS–Widg‘
 
impÜt
 
	gPŞ¬™yS–Widg‘


9 
äom
 
	gşs
.
	guts
.
roi_uts
 
impÜt
 
	gg‘_fœ¡_¥_db_äom_wdg_com


10 
äom
 
	gşs
.
	guts
.
feUts
 
impÜt
 
	gg‘_fe_·th_as_·¹s


11 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


13 
	g_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

15 
şass
 
	$MuÉiRegiÚWidg‘
(
Ba£S–eùiÚWidg‘
):

17 
A
 
QWidg‘
 
th©
 
cÚšs
 
S·tŸl
, 
EV
, 
ªd
 
pŞ¬™y
 
£ËùiÚ
 
bË
 
v›ws


19 
Each
 
of
 
the
 3 
widg‘s
 
Ãed
 
to
 
suµÜt
h
addšg
 
ªd
 
d–‘šg
 oà
»giÚs
 
bÙh


20 
äom
 
‹h
 
	`GUI
 (
right
 
şick
 
ªd
 
£Ëù
 
add
/
d–‘e
 fromeh 
m’u
è
as
 
w–l
‡s

21 
´og¿m©tiÿÎy
 
beÿu£
 
we
 
Ãed
 
to
 
be
 
abË
Ø
add
/
d–‘e
 
ba£d
 
Ú
 
wh©
 
a
 
¶Ù‹r
 
widg‘


22 
may
 
have
 
dÚe
.

26 
¥©Ÿl_row_£Ëùed
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
)

27 
¥©Ÿl_row_chªged
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
)

28 
¥©Ÿl_row_d–‘ed
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
)

30 
def
 
	$__š™__
(
£lf
,
u£_ûÁ”
=
True
, 
is_pošt
=
F®£
, 
is_¬b_lše
=F®£, 
’abË_muÉi_¥©Ÿl
=F®£, 
sšgË_ev_mod–
=F®£, *
¬gs
):

32 
	$__š™__
(): 
desütiÚ


34 :
·¿m
 *
¬gs
: *¬g 
desütiÚ


35 :
ty³
 *
¬gs
: *argsype

37 :
»tuºs
: 
NÚe


39 
Ba£S–eùiÚWidg‘
.
	`__š™__
(
£lf
, *
¬gs
)

40 
£lf
.
	`£tGeom‘ry
(300, 200, 870, 850)

42 
£lf
.
u£_ûÁ”
 = use_center

43 
£lf
.
’abË_muÉi_¥©Ÿl
 =ƒnable_multi_spatial

44 
£lf
.
ev_pŞ¬™y_sÿn_Üd”
 = 
’”gy_sÿn_Üd”_ty³s
.
EV_THEN_POL


46 
£lf
.
lßdSÿnBŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
('Load Scan')

47 
£lf
.
g‘D©aBŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
('Get Data')

48 
£lf
.
com·»D©aBŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
('Compare Data')

49 #£lf.
muÉiS·tŸlCheckBox
 = 
QtWidg‘s
.
	`QCheckBox
('Multi Spatials')

52 
£lf
.
g‘D©aBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_g‘_d©a_bŠ
)

53 
£lf
.
lßdSÿnBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_lßd_sÿn
)

54 
£lf
.
com·»D©aBŠ
.
şicked
.
	`cÚÃù
(£lf.
Ú_com·»_d©a
)

55 #£lf.
muÉiS·tŸlCheckBox
.
şicked
.
	`cÚÃù
(
£lf
.
Ú_muÉi_¥©Ÿl_chk
)

57 
£lf
.
pŞ_widg
 = 
	`PŞ¬™yS–Widg‘
()

58 
£lf
.
ev_widg
 = 
	`EÃrgyS–Widg‘
(£lf.
pŞ_widg
)

59 
£lf
.
¥_widg
 = 
	`S·tŸlS–Widg‘
(£lf.
ev_widg
, 
u£_ûÁ”
=u£_ûÁ”, 
is_pošt
=is_pošt, 
is_¬b_lše
=is_¬b_lše, 
sšgË_ev_mod–
=single_ev_model)

61 
£lf
.
¥_widg
.
bË_v›w
.
row_£Ëùed
.
	`cÚÃù
(£lf.
row_was_£Ëùed
)

62 
£lf
.
¥_widg
.
mod–_chªge
.
	`cÚÃù
(£lf.
Ú_¥©Ÿl_mod–_chªged
)

63 
£lf
.
¥_widg
.
¥©Ÿl_row_chªged
.
	`cÚÃù
(£lf.
Ú_¥©Ÿl_row_chªged
)

64 
£lf
.
¥_widg
.
roi_d–‘ed
.
	`cÚÃù
(£lf.
Ú_¥©Ÿl_roi_d–‘ed
)

66 
v_Ïyout
 = 
QtWidg‘s
.
	`QVBoxLayout
()

67 
v_Ïyout
.
	`£tCÚ‹ÁsM¬gšs
(2,2,2,2)

69 #if(
’abË_muÉi_¥©Ÿl
):

70 #v_Ïyout.
	`addWidg‘
(
£lf
.
muÉiS·tŸlCheckBox
)

72 
v_Ïyout
.
	`addWidg‘
(
£lf
.
¥_widg
)

73 
v_Ïyout
.
	`addWidg‘
(
£lf
.
ev_widg
)

74 
v_Ïyout
.
	`addWidg‘
(
£lf
.
pŞ_widg
)

75 #v_Ïyout.
	`addWidg‘
(
£lf
.
g‘D©aBŠ
)

76 #v_Ïyout.
	`addWidg‘
(
£lf
.
lßdSÿnBŠ
)

78 #£lf.
muÉiS·tŸlCheckBox
.
	`£tChecked
(
F®£
)

79 #£lf.
	`Ú_muÉi_¥©Ÿl_chk
(
F®£
)

80 if(
’abË_muÉi_¥©Ÿl
):

81 #£lf.
muÉiS·tŸlCheckBox
.
	`£tEÇbËd
(
True
)

82 #£lf.
muÉiS·tŸlCheckBox
.
	`£tChecked
(
True
)

83 
£lf
.
	`Ú_muÉi_¥©Ÿl_chk
(
True
)

85 #£lf.
muÉiS·tŸlCheckBox
.
	`£tEÇbËd
(
F®£
)

86 #£lf.
muÉiS·tŸlCheckBox
.
	`£tChecked
(
F®£
)

87 
£lf
.
	`Ú_muÉi_¥©Ÿl_chk
(
F®£
)

89 
£lf
.
	`£tLayout
(
v_Ïyout
)

92 
def
 
	$show_lßd_bŠ
(
£lf
):

93 
£lf
.
	`Ïyout
().
	`addWidg‘
(£lf.
lßdSÿnBŠ
)

95 
def
 
	$show_g‘d©a_bŠ
(
£lf
):

96 
£lf
.
	`Ïyout
().
	`addWidg‘
(£lf.
g‘D©aBŠ
)

98 
def
 
	$Ú_g‘_d©a_bŠ
(
£lf
):

99 #¥_»giÚ ğ
£lf
.
	`g‘_¥_»giÚs
()

100 #´šˆ
¥_»giÚs


101 
£lf
.
	`g‘_¥_»giÚs
(
do_´št
=
True
)

103 
def
 
	$g‘_¥©Ÿl_mod–
(
£lf
):

104 (
£lf
.
¥_widg
.
bË_v›w
.
	`mod–
())

106 
def
 
	$g‘_’”gy_mod–
(
£lf
):

107 (
£lf
.
ev_widg
.
bË_v›w
.
	`mod–
())

110 
def
 
	$d–‘e_¥©Ÿl_row
(
£lf
, 
¥_mod–_id
=
NÚe
):

111 
£lf
.
¥_widg
.
	`d–‘e_row
(
¥_mod–_id
)

113 
def
 
	$modify_¥©Ÿl_row_d©a
(
£lf
, 
™em_id
, 
sÿn
):

114 
£lf
.
¥_widg
.
	`modify_row_d©a
(
™em_id
, 
sÿn
)

116 
def
 
	$g‘_¥©Ÿl_row_d©a
(
£lf
, 
sÿn_id
):

117 (
£lf
.
¥_widg
.
	`g‘_row_d©a_by_™em_id
(
sÿn_id
))

119 
def
 
	$ü—t_Ãw_¥©Ÿl_»giÚ
(
£lf
, 
sÿn
=
NÚe
, 
add_’”gy_roi
=
True
):

120 if(
£lf
.
’abË_muÉi_¥©Ÿl
 
	`Ü
 (£lf.
¥_widg
.
bË_v›w
.
	`g‘_num_sÿns
() == 0)):

121 
£lf
.
¥_widg
.
	`Ú_Ãw_»giÚ
(
sÿn
=sÿn, 
add_’”gy_roi
=add_energy_roi)

123 
def
 
	$£t_¥©Ÿl_pos™iÚ”s
(
£lf
, 
xpos_Çme
, 
ypos_Çme
):

124 
£lf
.
¥_widg
.
	`£t_pos™iÚ”s
(
xpos_Çme
, 
ypos_Çme
)

126 
def
 
	$ş—r_¥©Ÿl_bË
(
£lf
):

127 
£lf
.
¥_widg
.
	`ş—r_bË
()

129 
def
 
	$£t_roi_lim™s
(
£lf
, 
lim™_def
):

130 
q»ù
 = 
lim™_def
.
	`g‘_®¬m_def
(
as_q»ù
=
True
)

131 
£lf
.
	`_£t_¥©Ÿl_¿nge
(
q»ù
)

133 
def
 
	$_£t_¥©Ÿl_¿nge
(
£lf
, 
q»ù
):

135 
£lf
.
¥_widg
.
	`£t_¥©Ÿl_¿nge
(
q»ù
)

137 if(
nÙ
 
£lf
.
u£_ûÁ”
):

138 
£lf
.
¥_widg
.
	`£t_¥©Ÿl_¡¬t¡İ
(
q»ù
)

140 
def
 
	$Ú_com·»_d©a
(
£lf
):

141 
£lf
.
	`com·»_roi
(
roi_def
, 
axis
=
SPDB_X
)

143 
def
 
	$Ú_lßd_sÿn
(
£lf
 ):

144 
äom
 
şs
.
­¶iÿtiÚs
.
pyStxm
.
bl10ID01
 
impÜt
 
MAIN_OBJ


145 
äom
 
şs
.
sÿÂšg
.
d©aRecÜd”
 
impÜt
 
STXMD©aIo


146 
äom
 
şs
.
uts
.
feUts
 
impÜt
 
g‘_fe_·th_as_·¹s


147 
äom
 
şs
.
­pWidg‘s
.
dŸlogs
 
impÜt
 
g‘O³nFeName


149 
d©adœ
=
r
'S:\STXM-data\Cryo-STXM\2017\guest\0201'

150 
d©a_fe_pfx
 = 'C'

151 
âame
 = 
	`g‘O³nFeName
("Lßd Sÿn", 
f‹r_¡r
="SÿÀFe (%s*.hdf5)" % 
d©a_fe_pfx
, 
£¬ch_·th
=
d©adœ
)

152 
£lf
.
	`İ’fe
(
âame
)

153 #d©a_dœ, 
å»fix
, 
fsuffix
 = 
	`g‘_fe_·th_as_·¹s
(
âame
)

154 #if(
âame
 
is
 
NÚe
):

156 #d©a_iØğ
	`STXMD©aIo
(
d©a_dœ
, 
å»fix
, 
fsuffix
)

157 #d©a_dù = 
d©a_io
.
	`lßd
()

158 #if(
d©a_dù
 
is
 
nÙ
 
NÚe
):

159 #dù_put(
d©a_dù
,
ADO_CFG_WDG_COM_CMND
, 
widg‘_com_cmnd_ty³s
.
LOAD_SCAN
)

160 #£lf.
	`lßd_sÿn
(
	`dù_g‘
(
d©a_dù
, 
ADO_CFG_WDG_COM
))

162 
def
 
	$İ’fe
(
£lf
, 
âame
):

164 
check_fÜ_cur_sÿn_b
: 
this
 
ÿÎ
 
was
 
Üigš®ly
 
u£d
 
by
 
the
 
lßd_sÿn
 
bu‰Ús
 
Ú
 
—ch
 
sÿn
 
¶uggš


165 
b
 
which
 
would
 
Úly
 
lßd
 
a
 
sÿn
 
th©
 
m©ched
 
the
 sÿÀ
¶uggš
 
you
 
w”e
 
lßdšg
 
äom
, 
but
 
to


166 
suµÜt
 
d¿g
 
ªd
 
drİ
 
İ”©iÚs
 
we
 
wl
 
®low
 
the
 
skpšg
 
of
 
this
 
check
 
so
 
th©
h
maš
 
­p


167 
ÿn
 
autom©iÿÎy
 
make
 
the
 
drİ³d
 
sÿn
h
cu»Á
 sÿÀ
¶uggš
 
b


169 if(
âame
 
is
 
NÚe
):

171 
d©a_dœ
, 
å»fix
, 
fsuffix
 = 
	`g‘_fe_·th_as_·¹s
(
âame
)

172 
d©a_io
 = 
	`STXMD©aIo
(
d©a_dœ
, 
å»fix
)

173 
’Œy_dù
 = 
d©a_io
.
	`lßd
()

174 if(
’Œy_dù
 
is
 
NÚe
):

176 
­³nd
 = 
F®£


177 
ekey
 
š
 
’Œy_dù
.
	$keys
():

178 #ekey = 
’Œy_dù
.
	`keys
()[0]

179 
nx_d©as
 = 
d©a_io
.
	`g‘_NXd©as_äom_’Œy
(
’Œy_dù
, 
ekey
)

180 #cu¼’y 
Úly
 
suµÜt
 1 
couÁ”


181 
couÁ”_Çme
 = 
nx_d©as
.
	`keys
()[0]

182 
d©a
 = 
d©a_io
.
	`g‘_sigÇl_d©a_äom_NXd©a
(
nx_d©as
, 
couÁ”_Çme
)

183 
wdg_com
 = 
d©a_io
.
	`g‘_wdg_com_äom_’Œy
(
’Œy_dù
, 
ekey
)

185 if(
nÙ
 
­³nd
):

186 
£lf
.
	`lßd_sÿn
(
wdg_com
, 
­³nd
=append)

187 
­³nd
 = 
True


189 
£lf
.
	`lßd_sÿn
(
wdg_com
, 
­³nd
=append)

193 #_logg”.
	`”rÜ
('unableo†oad scan, wrong scanype')

196 
def
 
	$lßd_sÿn
(
£lf
, 
wdg_com
, 
­³nd
=
F®£
):

198 
giv’
 
the
 
sÿn
 
ty³
 
suµÜts
 
muÉi
 
¥©Ÿl
, 
»ad
 
š
 
ªd
 
lßd
h
»¥eùive


199 
bËs


200 
sÿn_ty³s
 = 
	`Enum
('Detector_Image','OSA_Image','OSA_Focus','Sample_Focus','Sample_Point_Spectrum', 'Sample_Line_Spectrum', 'Sample_Image', 'Sample_Image_Stack', 'Generic_Scan')

202 
muÉi_sÿn_ty³s
 = [
sÿn_ty³s
.
SAMPLE_POINT_SPECTRUM
, sÿn_ty³s.
SAMPLE_LINE_SPECTRUM
, sÿn_ty³s.
SAMPLE_IMAGE
, sÿn_ty³s.
SAMPLE_IMAGE_STACK
, sÿn_ty³s.SAMPLE_IMAGE + 
IMAGE_LXL
, sÿn_ty³s.SAMPLE_IMAGE + 
IMAGE_PXP
]

204 
¥_roi_dù
 = 
	`dù_g‘
(
wdg_com
, 
WDGCOM_SPATIAL_ROIS
)

205 
¥_ids
 = 
¥_roi_dù
.
	`keys
()

206 
¥_id
 = 
¥_ids
[0]

207 
¥_db
 = 
¥_roi_dù
[
¥_id
]

208 
sÿn_ty³
 = 
	`dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
)

210 if(
sÿn_ty³
 
nÙ
 
š
 
muÉi_sÿn_ty³s
):

211 
_logg”
.
	`”rÜ
('IncÜ»ù sÿÀty³ [%d],‚Ù‡ muÉ˜¥©ŸÈ»giÚ sÿn' % 
sÿn_ty³
)

214 
_logg”
.
	`šfo
('[%d] sÿÀlßded' % 
sÿn_ty³
)

216 #if(
	`Ën
(
¥_ids
) > 1):

217 #£lf.
muÉiS·tŸlCheckBox
.
	`£tChecked
(
True
)

218 #£lf.
	`Ú_muÉi_¥©Ÿl_chk
(
True
)

220 #£lf.
muÉiS·tŸlCheckBox
.
	`£tChecked
(
F®£
)

221 #£lf.
	`Ú_muÉi_¥©Ÿl_chk
(
F®£
)

222 if(
nÙ
 
­³nd
):

223 
£lf
.
¥_widg
.
	`lßd_sÿn
(
¥_db
)

225 
£lf
.
¥_widg
.
	`add_sÿn
(
¥_db
)

227 if(
	`Ën
(
¥_ids
) > 1):

228 
¥_id
 
š
 
¥_ids
[1:]:

229 
¥_roi
 = 
¥_roi_dù
[
¥_id
]

230 #£lf.
¥_widg
.
	`lßd_sÿn
(
¥_roi
)

231 #£lf.
¥_widg
.
bË_v›w
.
	`add_sÿn
(
¥_roi
, 
¥_id
)

232 
£lf
.
¥_widg
.
	`add_sÿn
(
¥_roi
)

233 #£lf.
	`´št_¥_roi
(
¥_roi
)

237 
def
 
	$row_was_£Ëùed
(
£lf
, 
sÿn
):

238 
¥_db
 = 
	`make_¥©Ÿl_db_diù
()

239 
¥_db
[
WDGCOM_CMND
] = 
widg‘_com_cmnd_ty³s
.
SELECT_ROI


240 #dù_put(
¥_db
, 
SPDB_SCAN_PLUGIN_ITEM_ID
, 
sÿn
[
SPDB_ID_VAL
])

241 
¥_db
[
SPDB_ID_VAL
] = 
sÿn
[SPDB_ID_VAL]

243 
£lf
.
¥©Ÿl_row_£Ëùed
.
	`em™
(
¥_db
)

245 
def
 
	$’abË_add_¥©Ÿl_»giÚ_m’u
(
£lf
, do=
True
):

246 
£lf
.
¥_widg
.
	`’abË_add_»giÚ_m’u
(do)

248 
def
 
	$de£Ëù_®l
(
£lf
):

249 #_logg”.
	`debug
('deselect_all: called')

250 
£lf
.
¥_widg
.
bË_v›w
.
	`ş—rS–eùiÚ
()

252 
def
 
	$£Ëù_¥©Ÿl_row
(
£lf
, 
sÿn_id
):

253 
£lf
.
¥_widg
.
	`blockSigÇls
(
True
)

254 
£lf
.
¥_widg
.
	`£Ëù_row
(
™em_id
=
sÿn_id
)

255 
£lf
.
¥_widg
.
	`blockSigÇls
(
F®£
)

257 
def
 
	$Ú_muÉi_¥©Ÿl_chk
(
£lf
, 
checked
):

258 if(
checked
):

259 
£lf
.
’abË_muÉi_¥©Ÿl
 = 
True


261 
£lf
.
’abË_muÉi_¥©Ÿl
 = 
F®£


263 
£lf
.
¥_widg
.
	`’abË_muÉi_¥©Ÿl
(£lf.
’abË_muÉi_¥©Ÿl
)

265 
def
 
	$is_muÉi_»giÚ_’abËd
(
£lf
):

266 (
£lf
.
’abË_muÉi_¥©Ÿl
)

268 
def
 
	$Ú_¥©Ÿl_mod–_chªged
(
£lf
, 
sÿn_id
):

269 
cur_row_li¡
 = 
£lf
.
¥_widg
.
bË_v›w
.
	`£ËùiÚMod–
().
	`£ËùedRows
()

270 
cur_row
 = 
cur_row_li¡
[0].
	`row
()

271 #g‘ 
row
 
ID
 
of
 
this
 
sÿn


272 
Ãw_row
 = 
£lf
.
¥_widg
.
	`g‘_row_idx
(
sÿn_id
)

273 if(
cur_row
 =ğ
Ãw_row
):

274 #w
have
 
b“n
 
ÿÎed
 
´og¿m©iÿÎy
 
so
  
sigÇl
 
cyşe


277 
sÿn
 = 
£lf
.
¥_widg
.
	`g‘_row_d©a
(
sÿn_id
)

278 if(
sÿn
 
is
 
nÙ
 
NÚe
):

279 
x_roi
 = 
sÿn
[
SPDB_X
]

280 
y_roi
 = 
sÿn
[
SPDB_Y
]

282 
¥_db
 = 
	`make_¥©Ÿl_db_diù
(
x_roi
=x_roi, 
y_roi
=y_roi)

283 
¥_db
[
WDGCOM_CMND
] = 
widg‘_com_cmnd_ty³s
.
ROI_CHANGED


284 #dù_put(
¥_db
, 
SPDB_SCAN_PLUGIN_ITEM_ID
, 
sÿn
[
SPDB_ID_VAL
])

286 if(
x_roi
['NPOINTS'] == 1):

287 
	`dù_put
(
¥_db
, 
SPDB_PLOT_SHAPE_TYPE
, 
¥©Ÿl_ty³_´efix
.
PNT
)

289 
	`dù_put
(
¥_db
, 
SPDB_PLOT_SHAPE_TYPE
, 
¥©Ÿl_ty³_´efix
.
ROI
)

291 
£lf
.
¥©Ÿl_row_£Ëùed
.
	`em™
(
¥_db
)

294 #deà
	`Ú_¥©Ÿl_row_chªged
(
£lf
, 
sÿn
):

295 #if(
sÿn
 
is
 
nÙ
 
NÚe
):

296 ##
´št
 'Ú_¥©Ÿl_row_chªged: sÿn_id(%d)' % 
sÿn
[
SPDB_ID_VAL
]

297 #¥_db = 
	`make_¥©Ÿl_db_diù
()

298 #¥_db[
WDGCOM_CMND
] = 
widg‘_com_cmnd_ty³s
.
ROI_CHANGED


299 #
##
£t
 
the
 
SINGLE_SPATIAL
 
f›lds
 
so
 
th©
h
¶Ù‹r
 
ÿn
 
upd©e


300 #¥_db[
SPDB_X
]['START'] = 
sÿn
[SPDB_X]['START']

301 #¥_db[
SPDB_X
]['STOP'] = 
sÿn
[SPDB_X]['STOP']

302 #¥_db[
SPDB_Y
]['START'] = 
sÿn
[SPDB_Y]['START']

303 #¥_db[
SPDB_Y
]['STOP'] = 
sÿn
[SPDB_Y]['STOP']

304 #¥_db[
SPDB_X
]['CENTER'] = 
sÿn
[SPDB_X]['CENTER']

305 #¥_db[
SPDB_Y
]['CENTER'] = 
sÿn
[SPDB_Y]['CENTER']

306 #¥_db[
SPDB_X
]['RANGE'] = 
sÿn
[SPDB_X]['RANGE']

307 #¥_db[
SPDB_Y
]['RANGE'] = 
sÿn
[SPDB_Y]['RANGE']

308 #¥_db[
SPDB_X
]['NPOINTS'] = 
sÿn
[SPDB_X]['NPOINTS']

309 #¥_db[
SPDB_Y
]['NPOINTS'] = 
sÿn
[SPDB_Y]['NPOINTS']

310 #
#¥_db[
SPDB_EV_ROIS
] = 
sÿn
[SPDB_EV_ROIS]

311 #
##
»ù
 = (
sÿn
['STARTX'], scan['STARTY'], scan['STOPX'], scan['STOPY'])

312 #»ù = 
sÿn
[
SPDB_RECT
]

313 ##
´št
 'Ú_¥©Ÿl_row_chªged:„eù =' , 
»ù


314 ##
	`dù_put
(
¥_db
, 
SPDB_SCAN_PLUGIN_ITEM_ID
, 
sÿn
[
SPDB_ID_VAL
])

315 #if(
sÿn
[
SPDB_X
]['NPOINTS'] == 1):

316 ##
¥_db
['SCAN_PLUGGIN']['ITEM']['TYPE'] = 
¥©Ÿl_ty³_´efix
.
PNT


317 #dù_put(
¥_db
, 
SPDB_PLOT_SHAPE_TYPE
, 
¥©Ÿl_ty³_´efix
.
PNT
)

319 ##
¥_db
['SCAN_PLUGGIN']['ITEM']['TYPE'] = 
¥©Ÿl_ty³_´efix
.
ROI


320 #dù_put(
¥_db
, 
SPDB_PLOT_SHAPE_TYPE
, 
¥©Ÿl_ty³_´efix
.
ROI
)

321 #
#¥_db[
SPDB_ID_VAL
] = 
sÿn
[SPDB_ID_VAL]

322 #£lf.
¥©Ÿl_row_chªged
.
	`em™
(
¥_db
)

323 #
##
¥_roi
 = 
£lf
.
	`g‘_¥_»giÚs
()

324 ##
£lf
.
bËs_chªged
.
	`em™
()

327 #deà
	`upd©e_muÉi_¥©Ÿl_wdg_com
(
£lf
):

328 
def
 
	$Ú_¥©Ÿl_row_chªged
(
£lf
, 
sÿn
):

330 
This
 
is
 
a
 
¡ªd¬d
 
funùiÚ
 
th©
 
®l
 
sÿn
 
¶uggšs
 
have
h© i 
ÿÎed
 
to


331 
g‘
 
the
 
d©a
 
äom
h
¶uggšs
 
UI
 
widg‘s
 
ªd
 
wr™e
 
them
 
što
 
a
 
diù
 
»tuºed
 
by


332 
	`g‘_ba£_sÿÅ¬am_roi
(), 
this
 
diù
 
is
 
em™‹d
 
by
 
®l
 
sÿn
 
¶uggšs
 
to
 
be
 
u£d
 by

333 
the
 
sÿn
 
şas£s
 
	$cÚfigu»
(è
funùiÚs


335 :
»tuºs
: 
NÚe


338 #_logg”.
	`debug
('on_spatial_row_changed:')

339 
¥_rois_dù
 = 
£lf
.
	`g‘_¥_»giÚs
()

340 
£lf
.
¥©Ÿl_row_chªged
.
	`em™
(
¥_rois_dù
)

343 
def
 
	$Ú_¥©Ÿl_roi_d–‘ed
(
£lf
, 
sÿn
):

344 
£lf
.
¥©Ÿl_row_d–‘ed
.
	`em™
(
sÿn
)

347 
def
 
	$g‘_¥_»giÚs
(
£lf
, 
do_´št
=
F®£
):

349 
	$g‘_¥_»giÚs
(): 
desütiÚ


351 :
»tuºs
: 
NÚe


357 
¥_»giÚs
 = {
	}
}

358 
¥_roi
 
š
 
£lf
.
¥_widg
.
	$g‘_d©a
():

359 if(
do_´št
):

360 
£lf
.
	`´št_¥_roi
(
¥_roi
)

361 #£lf.
	`com·»_roi
(
¥_roi
, 
axis
=
SPDB_X
)

362 #£lf.
	`com·»_roi
(
¥_roi
, 
axis
=
SPDB_Y
)

364 
x¡¬t
 = 
	`dù_g‘
(
¥_roi
, 
SPDB_XSTART
)

365 
x¡İ
 = 
	`dù_g‘
(
¥_roi
, 
SPDB_XSTOP
)

366 
y¡¬t
 = 
	`dù_g‘
(
¥_roi
, 
SPDB_YSTART
)

367 
y¡İ
 = 
	`dù_g‘
(
¥_roi
, 
SPDB_YSTOP
)

368 
¥_roi
[
SPDB_RECT
] = (
x¡¬t
, 
y¡¬t
, 
x¡İ
, 
y¡İ
)

369 
_evs
 = []

370 
e_Åts
 = 0

371 
pŞ_Åts
 = 0

372 
ev_£ošts
 = []

373 
dw–l_£ošts
 = []

375 #´šˆ'¥_id=%d EV_ID=%d' % (
¥_roi
[
SPDB_ID_VAL
], sp_roi[
SPDB_EV_ID
])

376 
ev_roi
 
š
 
£lf
.
ev_widg
.
	$g‘_d©a
(
¥_roi
[
SPDB_EV_ID
]):

377 if(
do_´št
):

378 
£lf
.
	`´št_ev_roi
(
ev_roi
)

380 
dw–l
 = 
ev_roi
[
DWELL
]

381 
e_Åts
 +ğ
ev_roi
[
NPOINTS
]

382 
dw–l_£ošts
.
	`­³nd
(
dw–l
)

383 
_pŞs
 = []

384 
pŞ_£ošts
 = []

385 
off_£ošts
 = []

386 
ªgË_£ošts
 = []

387 #fÜ 
ev_¥
 
š
 
ev_roi
['SETPOINTS']:

388 
pŞ_roi
 
š
 
£lf
.
pŞ_widg
.
	`g‘_d©a
(
ev_roi
['POL_ID']):

389 if(
do_´št
):

390 
£lf
.
	`´št_pŞ_roi
(
ev_roi
['START'], 
pŞ_roi
)

391 #ev_£ošts.
	`­³nd
(
ev_¥
)

392 #dw–l_£ošts.
	`­³nd
(
dw–l
)

393 
pŞ_£ošts
.
	`­³nd
(
pŞ_roi
['POL'])

394 
off_£ošts
.
	`­³nd
(
pŞ_roi
['OFF'])

395 
ªgË_£ošts
.
	`­³nd
(
pŞ_roi
['ANGLE'])

396 
_pŞs
.
	`­³nd
(
pŞ_roi
)

397 
pŞ_Åts
 += 1

398 
ev_roi
['POL_ROIS'] = 
_pŞs


400 
ev_roi
['EPU_POL_PNTS'] = 
pŞ_£ošts


401 
ev_roi
['EPU_OFF_PNTS'] = 
off_£ošts


402 
ev_roi
['EPU_ANG_PNTS'] = 
ªgË_£ošts


404 
_evs
.
	`­³nd
(
ev_roi
)

406 
¥_roi
[
SPDB_EV_ROIS
] = 
_evs


407 
¥_roi
[
SPDB_EV_NPOINTS
] = 
e_Åts


408 
¥_roi
[
SPDB_POL_NPOINTS
] = 
pŞ_Åts


410 
¥_»giÚs
[
¥_roi
[
SPDB_ID_VAL
]] = sp_roi

412 (
¥_»giÚs
)

414 
def
 
	$com·»_roi
(
£lf
, 
roi_def
, 
axis
=
SPDB_X
):

416 
	$com·»_roi
(): 
desütiÚ


418 :
·¿m
 
roi
:„o˜
desütiÚ


419 :
ty³
 
roi
:„oiype

421 :
»tuºs
: 
NÚe


423 
´št


424 
f›lds
 = ['CENTER', 'RANGE', 'NPOINTS', 'STEP', 'START', 'STOP']

425 if(
axis
 =ğ
SPDB_X
):

426 
ax
 = 
roi_def
['SPATIAL_ROIS'][0]

428 
ax
 = 
roi_def
['SPATIAL_ROIS'][1]

430 
k
 
š
 
f›lds
:

431 
´št
 '[%s] = %.2à[%s] = %.2f' % (
k
+
axis
, 
roi_def
[k+axis], k, 
ax
[k])

432 
k
 = 'SETPOINTS'

433 
´št
 '[%s%s' % (
k
, 
axis
è+ '] =', 
roi_def
[k+axis]

434 
´št
 '[%s'% (
k
è+ ']=', 
ax
[k]

436 
def
 
	$g‘_¥_»giÚs_Üig
(
£lf
):

438 
	$g‘_¥_»giÚs
(): 
desütiÚ


440 :
»tuºs
: 
NÚe


443 
This
 
funùiÚ
 
g¿bs
 
®l
 
the
 
»giÚs
 
group
 
like
 
this
:

444 
¥_»giÚs
 = []

445 
¥_»giÚs
[0] = ['SPATIAL_REGION',.....[
SPDB_EV_ROIS
]]

446 
EV_ROIS
 = ['EV_ROI', ........['POL_ROIS']]

447 
POL_ROIS
 = [{'POL_ROI', ....
	}
}]

448 
¥_»giÚs
[1] = ['SPATIAL_REGION',.....[
SPDB_EV_ROIS
]]

449 
	gEV_ROIS
 = ['EV_ROI', ........['POL_ROIS']]

450 
	gPOL_ROIS
 = [{'POL_ROI', ....}]

453 
I
 
®so
 
wªt
 
to
  
®l
 
of
 
the
 
EV
 
»giÚs
 
a
 
·¹icuÏr
 
¥©Ÿl
 
ROI
 
such
 
th©


454 
the
 
»suÉšg
 
¬¿ys
 
¬e
 
®»ady
 
to
 
be
 
£Á
Øth
ssÿn
 
»cÜd
 
š
 
TABLE
 
mode
, 
	gm—nšg


455 
I
 
wªt
 
ª
 
¬¿y
 
th©
 
cÚšs
 
®l
 
of
 
the
 
EV
 
£ošts
 
such
h© 
™
 
is
 
cÜ»ù
 
	gthe


456 
numb”
 
of
 
pŞ¬™y
 
£‰šgs
 
—ch
 
’”gy
 
	gpošt
.

457 
fÜe
 
	gSPATIAL_ROI
 1:

458 
EV_ROI
 1 = 395e
v
 
to
 405ev 2 
±s
, 
	gPOL_ROI
's = [{pol1e1}, {pol2e1}, {pol3e1}]

459 
	gEV_ROI
 2 = 395e
v
 
to
 405ev 3 
±s
, 
	gPOL_ROI
's = [{pol1e2}, {pol2e2}]

460 
I
 
wªt
 
to
 
g’”©e
 
the
 
	gfŞlowšg
 2 
	g¬¿ys


462 
EV
 
¬¿y
 
£Á
 
to
 
’”gy
 
ssÿn
 
POL
‡¼ay s’ˆtØ
pŞ¬™y
 
	gssÿn


463 [ 
e1
.1, [ 
pŞ1e1
,

464 
e1
.1, 
pŞ2e1
,

465 
e1
.1, 
pŞ3e1
,

466 
e1
.2, 
pŞ1e1
,

467 
e1
.2, 
pŞ2e1
,

468 
e1
.2, 
pŞ3e1
,

469 
e2
.1, 
pŞ2e1
,

470 
e2
.1, 
pŞ2e2
,

471 
e2
.2, 
pŞ2e1
,

472 
e2
.2, 
pŞ2e2
,

473 
e2
.3, 
pŞ2e1
,

474 
e2
.3 
pŞ2e2


476 
BÙh
 
ssÿn
 
NPTS
 
wl
 
	gbe
 12

477 
NPTS
 
	gEV_ROI
 1 = 2 
ev
 
±s
 
x
 3 
pŞ
 
pošts
 = 6

478 
NPTS
 
EV_ROI
 2 = 3 
ev
 
±s
 
x
 2 
pŞ
 
pošts
 = 6

481 
¥_db
 = 
make_¥©Ÿl_db_diù
()

483 
¥_»giÚs
 = {}

484 
¥_roi
 
š
 
£lf
.
¥_widg
.
	$g‘_d©a
():

485 #£lf.
	`´št_¥_roi
(
¥_roi
)

486 #£lf.
	`com·»_roi
(
¥_roi
, 
axis
=
SPDB_X
)

487 #£lf.
	`com·»_roi
(
¥_roi
, 
axis
=
SPDB_Y
)

488 
_evs
 = []

489 
e_Åts
 = 0

490 
ev_£ošts
 = []

491 
dw–l_£ošts
 = []

493 
ev_roi
 
š
 
£lf
.
ev_widg
.
	`g‘_d©a
(
¥_roi
['EV_ID']):

494 #£lf.
	`´št_ev_roi
(
ev_roi
)

495 
dw–l
 = 
ev_roi
['DWELL']

496 
e_Åts
 +ğ
ev_roi
['NPOINTS']

497 
dw–l_£ošts
.
	`­³nd
(
dw–l
)

498 
_pŞs
 = []

499 
pŞ_£ošts
 = []

500 
off_£ošts
 = []

501 
ªgË_£ošts
 = []

502 #fÜ 
ev_¥
 
š
 
ev_roi
['SETPOINTS']:

503 
pŞ_roi
 
š
 
£lf
.
pŞ_widg
.
	`g‘_d©a
(
ev_roi
['POL_ID']):

504 #£lf.
	`´št_pŞ_roi
(
ev_roi
['START'], 
pŞ_roi
)

505 #ev_£ošts.
	`­³nd
(
ev_¥
)

506 #dw–l_£ošts.
	`­³nd
(
dw–l
)

507 
pŞ_£ošts
.
	`­³nd
(
pŞ_roi
['POL'])

508 
off_£ošts
.
	`­³nd
(
pŞ_roi
['OFF'])

509 
ªgË_£ošts
.
	`­³nd
(
pŞ_roi
['ANGLE'])

510 
_pŞs
.
	`­³nd
(
pŞ_roi
)

511 
ev_roi
['POL_ROIS'] = 
_pŞs


513 
ev_roi
['EPU_POL_PNTS'] = 
pŞ_£ošts


514 
ev_roi
['EPU_OFF_PNTS'] = 
off_£ošts


515 
ev_roi
['EPU_ANG_PNTS'] = 
ªgË_£ošts


517 
_evs
.
	`­³nd
(
ev_roi
)

519 
¥_roi
[
SPDB_EV_ROIS
] = 
_evs


520 
¥_roi
[
SPDB_EV_NPOINTS
] = 
e_Åts


522 
x_£ošts
 = 
¥_roi
[
SPDB_X
]['SETPOINTS']

523 
y_£ošts
 = 
¥_roi
[
SPDB_Y
]['SETPOINTS']

525 
numE
 = 
	`Ën
(
ev_roi
['SETPOINTS'])

526 
numX
 = 
	`Ën
(
x_£ošts
)

527 
numY
 = 
	`Ën
(
y_£ošts
)

528 
numP
 = 
numE
 * 
numY
 * 
numX


530 
x_£ošts2
 = 
Å
.
	`te
(
x_£ošts
, 
numY
)

531 
x²ts
 = 
Å
.
	`te
(
x_£ošts2
, 
numE
)

532 
y_£ošts2
 = 
Å
.
	`»³©
(
y_£ošts
, 
numX
)

533 
y²ts
 = 
Å
.
	`te
(
y_£ošts2
, 
numE
)

535 
•Ás
 = 
Å
.
	`»³©
(
ev_£ošts
, (
numY
 * 
numX
))

536 
dw–l_²ts
 = 
Å
.
	`»³©
(
dw–l_£ošts
, (
numY
 * 
numX
))

537 
pŞ_²ts
 = 
Å
.
	`»³©
(
pŞ_£ošts
, (
numY
 * 
numX
))

538 
off_²ts
 = 
Å
.
	`»³©
(
off_£ošts
, (
numY
 * 
numX
))

539 
ªgË_²ts
 = 
Å
.
	`»³©
(
ªgË_£ošts
, (
numY
 * 
numX
))

541 
¥_roi
['1D_SETPOINTS'][
SPDB_X
] = 
x²ts


542 
¥_roi
['1D_SETPOINTS'][
SPDB_Y
] = 
y²ts


543 
¥_roi
['1D_SETPOINTS']['EV'] = 
ev_roi
['SETPOINTS']

544 
¥_roi
['1D_SETPOINTS']['DWELL'] = 
dw–l_£ošts


545 
¥_roi
['1D_SETPOINTS']['EPU_POL'] = 
pŞ_£ošts


546 
¥_roi
['1D_SETPOINTS']['EPU_OFF'] = 
off_£ošts


547 
¥_roi
['1D_SETPOINTS']['EPU_ANGLE'] = 
ªgË_£ošts


548 #¥_»giÚs.
	`­³nd
(
¥_roi
)

549 
¥_»giÚs
[
¥_roi
[
SPDB_ID_VAL
]] = sp_roi

551 
¥_db
['SPATIAL_IDS'] = 
¥_»giÚs
.
	`keys
()

552 
¥_db
['MULTI_SPATIAL'] = 
¥_»giÚs


553 (
¥_db
)

555 #deà
	`com·»_roi
(
£lf
, 
roi_def
, 
axis
=
SPDB_X
):

557 #com·»_roi(): 
desütiÚ


558 #
#:
·¿m
 
roi
:„o˜
desütiÚ


559 #:
ty³
 
roi
:„oiype

560 #
#:
»tuºs
: 
NÚe


564 #if(
axis
 =ğ
SPDB_X
):

565 #ax = 
roi_def
['SPATIAL_ROIS'][0]

567 #ax = 
roi_def
['SPATIAL_ROIS'][1]

568 #
#fÜ 
k
 
š
 
f›lds
:

569 #´šˆ'[%s] = %.2à[%s] = %.2f' % (
k
+
axis
, 
roi_def
[k+axis], k, 
ax
[k])

571 #´šˆ'[%s%s' % (
k
, 
axis
è+ '] =', 
roi_def
[k+axis]

572 #´šˆ'[%s'% (
k
è+ ']=', 
ax
[k]

574 
def
 
	$´št_¥_roi
(
£lf
, 
roi
):

576 
	$´št_¥_roi
(): 
desütiÚ


578 :
·¿m
 
roi
:„o˜
desütiÚ


579 :
ty³
 
roi
:„oiype

581 :
»tuºs
: 
NÚe


583 
´št
 'S·tŸÈROI [%d] C’‹rX[%.2f] RªgeX[%.2f] C’‹rY[%.2f] RªgeY[%.2f] EV_MODEL=%d' % (
roi
[
SPDB_ID_VAL
],„oi['X']['CENTER'],roi['X']['RANGE'],roi['Y']['CENTER'],„oi['Y']['RANGE'],„oi['EV_ID'])

584 
´št
 'S·tŸÈROI [%d] S¹X[%.2f] StİX[%.2f] S¹Y[%.2f] StİY[%.2f]' % (
roi
[
SPDB_ID_VAL
],„oi['X']['START'],roi['X']['STOP'],roi['Y']['START'],„oi['Y']['STOP'])

586 
def
 
	$´št_ev_roi
(
£lf
, 
roi
):

588 
	$´št_ev_roi
(): 
desütiÚ


590 :
·¿m
 
roi
:„o˜
desütiÚ


591 :
ty³
 
roi
:„oiype

593 :
»tuºs
: 
NÚe


595 
´št
 '\tEV ROI [%d] S¹[%.2f] End[%.2f] Rªge[%.2f] Pošts[%.2f] Dw–l[%.2f] POL_MODEL=%d' % (
roi
[
SPDB_ID_VAL
],roi['START'],roi['STOP'],roi['RANGE'],„oi['NPOINTS'],„oi['DWELL'],„oi['POL_ID'])

597 
def
 
	$´št_pŞ_roi
(
£lf
, 
ev_£ošt
, 
roi
):

599 
	$´št_pŞ_roi
(): 
desütiÚ


601 :
·¿m
 
ev_£ošt
:ƒv_£ošˆ
desütiÚ


602 :
ty³
 
ev_£ošt
:ƒv_setpointype

604 :
·¿m
 
roi
:„o˜
desütiÚ


605 :
ty³
 
roi
:„oiype

607 :
»tuºs
: 
NÚe


609 
´št
 '\t\tPOL ROI [%d] [%.3àev] POL[%d] Off£t[%.2f] AngË[%.2f]' % (
roi
[
SPDB_ID_VAL
], 
ev_£ošt
,„oi['POL'],roi['OFF'],roi['ANGLE'])

612 
__Çme__
 == '__main__':

613 
impÜt
 
sys


614 
äom
 
şs
.
­pWidg‘s
.
¥yd”_cÚsŞe
 
impÜt
 
Sh–lWidg‘
#, 
Sh–lDock


616 
	`log_to_qt
()

617 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

618 #wš = 
	`EÃrgyS–Widg‘
()

619 #wš.
	`show
()

620 #¥©ŸÈğ
	`S·tŸlS–Widg‘
()

621 #¥©Ÿl.
	`show
()

623 #muÉ˜ğ
	`MuÉiRegiÚWidg‘
(
u£_ûÁ”
=
True
, 
’abË_muÉi_¥©Ÿl
=True)

624 
muÉi
 = 
	`MuÉiRegiÚWidg‘
(
u£_ûÁ”
=
True
, 
’abË_muÉi_¥©Ÿl
=True, 
is_pošt
=
F®£
, 
sšgË_ev_mod–
=False)

625 #muÉi.
	`’abË_add_¥©Ÿl_»giÚ_m’u
(
True
)

626 
muÉi
.
	`show_lßd_bŠ
()

627 
muÉi
.
	`show_g‘d©a_bŠ
()

629 #n ğ{'maš': 
muÉi
, 'g':
	`glob®s
(è
	}
}

630 ##
msg
 = "Try forƒxample: widget.set_text('foobar') or win.close()"

631 #pythÚsh–Èğ
Sh–lWidg‘
(
·»Á
=
NÚe
, 
Çme¥aû
=
ns
,
commªds
=[], 
muÉ™h»aded
=
True
)

632 #muÉi.
Ïyout
().
addWidg‘
(
pythÚsh–l
)

634 
	gmuÉi
.
show
()

636 
	gsys
.
ex™
(
­p
.
exec_
())

	@widgets/scan_table_view/polarityCmboBoxDelegate.py

2 
C»©ed
 
Ú
 
	gNov
 16, 2016

4 @
	gauthÜ
: 
b”gr


7 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
	gQtWidg‘s


9 
	gPOLARITY_COLUMN
 = 1

11 
şass
 
	$PŞComboBoxD–eg©e
(
QtWidg‘s
.
QI‹mD–eg©e
):

13 
A
 
d–eg©e
 
th©
 
¶aûs
 
a
 
fuÎy
 
funùiÚšg
 
QComboBox
 
š
 
ev”y


14 
ûÎ
 
of
 
the
 
cŞumn
 
to
 
which
 
™
's‡pplied

16 
def
 
	$__š™__
(
£lf
, 
·»Á
):

18 
	$__š™__
(): 
desütiÚ


20 :
·¿m
 
·»Á
:…¬’ˆ
desütiÚ


21 :
ty³
 
·»Á
:…arentype

23 :
»tuºs
: 
NÚe


26 
QtWidg‘s
.
QI‹mD–eg©e
.
	`__š™__
(
£lf
, 
·»Á
)

28 
def
 
	$ü—‹Ed™Ü
(
£lf
, 
·»Á
, 
İtiÚ
, 
šdex
):

30 
	$ü—‹Ed™Ü
(): 
desütiÚ


32 :
·¿m
 
·»Á
:…¬’ˆ
desütiÚ


33 :
ty³
 
·»Á
:…arentype

35 :
·¿m
 
İtiÚ
: o±iÚ 
desütiÚ


36 :
ty³
 
İtiÚ
: optionype

38 :
·¿m
 
šdex
: index 
desütiÚ


39 :
ty³
 
šdex
: indexype

41 :
»tuºs
: 
NÚe


43 
cbox
 = 
QtWidg‘s
.
	`QComboBox
(
·»Á
)

44 
cbox
.
	`addI‹ms
(['CircLeft','CircRight','LinHor', 'IncVert-', 'IncVert+','LinInc'])

47 #fÜ 
™em
 
š
 
™ems
:

48 #cbox.
	`addI‹m
(
™em
, 
idx
)

49 #idx = 
idx
 -1

50 #chkd = 
šdex
.
	`mod–
().
	`g‘_sÿns
()[šdex.
	`row
()][
POLARITY_COLUMN
]

51 #chkbx.
	`£tChecked
(
chkd
)

52 #£lf.
	`cÚÃù
(
cbox
, 
QtCÜe
.
	`SIGNAL
("cu¼’tIndexChªged(IÁ)"), 
£lf
, QtCÜe.
	`SLOT
("on_pol_changed()"))

53 
cbox
.
cu¼’tIndexChªged
.
	`cÚÃù
(
£lf
.
Ú_pŞ_chªged
)

54  
cbox


56 
def
 
	$£tEd™ÜD©a
(
£lf
, 
ed™Ü
, 
šdex
):

58 
	$£tEd™ÜD©a
(): 
desütiÚ


60 :
·¿m
 
ed™Ü
:ƒd™Ü 
desütiÚ


61 :
ty³
 
ed™Ü
:ƒditorype

63 :
·¿m
 
šdex
: index 
desütiÚ


64 :
ty³
 
šdex
: indexype

66 :
»tuºs
: 
NÚe


69 
ed™Ü
.
	`blockSigÇls
(
True
)

70 #ed™Ü.
	`£tCu¼’tIndex
((
šdex
.
	`mod–
().
	`d©a
(index)))

71 if(
šdex
.
	`cŞumn
(è=ğ
POLARITY_COLUMN
):

72 #ed™Ü.
	`£tChecked
(
šdex
.
	`mod–
().
	`d©a
(index))

73 
idx
 = (
šdex
.
	`d©a
())

74 
ed™Ü
.
	`£tCu¼’tIndex
(
idx
)

75 
ed™Ü
.
	`blockSigÇls
(
F®£
)

77 
def
 
	$£tMod–D©a
(
£lf
, 
ed™Ü
, 
mod–
, 
šdex
):

79 
	$£tMod–D©a
(): 
desütiÚ


81 :
·¿m
 
ed™Ü
:ƒd™Ü 
desütiÚ


82 :
ty³
 
ed™Ü
:ƒditorype

84 :
·¿m
 
mod–
: mod– 
desütiÚ


85 :
ty³
 
mod–
: modelype

87 :
·¿m
 
šdex
: index 
desütiÚ


88 :
ty³
 
šdex
: indexype

90 :
»tuºs
: 
NÚe


92 #u£r_d©a_v®, 
ok
 = 
ed™Ü
.
	`™emD©a
Ód™Ü.
	`cu¼’tIndex
()).
	`toIÁ
()

93 #mod–.
	`£tD©a
(
šdex
, 
u£r_d©a_v®
, 
QtCÜe
.
Qt
.
Ed™RŞe
)

94 
mod–
.
	`£tD©a
(
šdex
, 
ed™Ü
.
	`cu¼’tIndex
(), 
QtCÜe
.
Qt
.
Ed™RŞe
)

97 @
QtCÜe
.
	`pyqtSlÙ
()

98 
def
 
	$Ú_pŞ_chªged
(
£lf
):

100 
	$Ú_pŞ_chªged
(): 
desütiÚ


102 :
»tuºs
: 
NÚe


104 
´št
 'Ú_pŞ_chªged [%d]' % (
£lf
.
	`£nd”
().
	`cu¼’tIndex
())

105 
£lf
.
comm™D©a
.
	`em™
(£lf.
	`£nd”
())

	@widgets/scan_table_view/polarityCmboBoxDelegate.py

2 
C»©ed
 
Ú
 
	gNov
 16, 2016

4 @
	gauthÜ
: 
b”gr


7 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
	gQtWidg‘s


9 
	gPOLARITY_COLUMN
 = 1

11 
şass
 
	$PŞComboBoxD–eg©e
(
QtWidg‘s
.
QI‹mD–eg©e
):

13 
A
 
d–eg©e
 
th©
 
¶aûs
 
a
 
fuÎy
 
funùiÚšg
 
QComboBox
 
š
 
ev”y


14 
ûÎ
 
of
 
the
 
cŞumn
 
to
 
which
 
™
's‡pplied

16 
def
 
	$__š™__
(
£lf
, 
·»Á
):

18 
	$__š™__
(): 
desütiÚ


20 :
·¿m
 
·»Á
:…¬’ˆ
desütiÚ


21 :
ty³
 
·»Á
:…arentype

23 :
»tuºs
: 
NÚe


26 
QtWidg‘s
.
QI‹mD–eg©e
.
	`__š™__
(
£lf
, 
·»Á
)

28 
def
 
	$ü—‹Ed™Ü
(
£lf
, 
·»Á
, 
İtiÚ
, 
šdex
):

30 
	$ü—‹Ed™Ü
(): 
desütiÚ


32 :
·¿m
 
·»Á
:…¬’ˆ
desütiÚ


33 :
ty³
 
·»Á
:…arentype

35 :
·¿m
 
İtiÚ
: o±iÚ 
desütiÚ


36 :
ty³
 
İtiÚ
: optionype

38 :
·¿m
 
šdex
: index 
desütiÚ


39 :
ty³
 
šdex
: indexype

41 :
»tuºs
: 
NÚe


43 
cbox
 = 
QtWidg‘s
.
	`QComboBox
(
·»Á
)

44 
cbox
.
	`addI‹ms
(['CircLeft','CircRight','LinHor', 'IncVert-', 'IncVert+','LinInc'])

47 #fÜ 
™em
 
š
 
™ems
:

48 #cbox.
	`addI‹m
(
™em
, 
idx
)

49 #idx = 
idx
 -1

50 #chkd = 
šdex
.
	`mod–
().
	`g‘_sÿns
()[šdex.
	`row
()][
POLARITY_COLUMN
]

51 #chkbx.
	`£tChecked
(
chkd
)

52 #£lf.
	`cÚÃù
(
cbox
, 
QtCÜe
.
	`SIGNAL
("cu¼’tIndexChªged(IÁ)"), 
£lf
, QtCÜe.
	`SLOT
("on_pol_changed()"))

53 
cbox
.
cu¼’tIndexChªged
.
	`cÚÃù
(
£lf
.
Ú_pŞ_chªged
)

54  
cbox


56 
def
 
	$£tEd™ÜD©a
(
£lf
, 
ed™Ü
, 
šdex
):

58 
	$£tEd™ÜD©a
(): 
desütiÚ


60 :
·¿m
 
ed™Ü
:ƒd™Ü 
desütiÚ


61 :
ty³
 
ed™Ü
:ƒditorype

63 :
·¿m
 
šdex
: index 
desütiÚ


64 :
ty³
 
šdex
: indexype

66 :
»tuºs
: 
NÚe


69 
ed™Ü
.
	`blockSigÇls
(
True
)

70 #ed™Ü.
	`£tCu¼’tIndex
((
šdex
.
	`mod–
().
	`d©a
(index)))

71 if(
šdex
.
	`cŞumn
(è=ğ
POLARITY_COLUMN
):

72 #ed™Ü.
	`£tChecked
(
šdex
.
	`mod–
().
	`d©a
(index))

73 
idx
 = (
šdex
.
	`d©a
())

74 
ed™Ü
.
	`£tCu¼’tIndex
(
idx
)

75 
ed™Ü
.
	`blockSigÇls
(
F®£
)

77 
def
 
	$£tMod–D©a
(
£lf
, 
ed™Ü
, 
mod–
, 
šdex
):

79 
	$£tMod–D©a
(): 
desütiÚ


81 :
·¿m
 
ed™Ü
:ƒd™Ü 
desütiÚ


82 :
ty³
 
ed™Ü
:ƒditorype

84 :
·¿m
 
mod–
: mod– 
desütiÚ


85 :
ty³
 
mod–
: modelype

87 :
·¿m
 
šdex
: index 
desütiÚ


88 :
ty³
 
šdex
: indexype

90 :
»tuºs
: 
NÚe


92 #u£r_d©a_v®, 
ok
 = 
ed™Ü
.
	`™emD©a
Ód™Ü.
	`cu¼’tIndex
()).
	`toIÁ
()

93 #mod–.
	`£tD©a
(
šdex
, 
u£r_d©a_v®
, 
QtCÜe
.
Qt
.
Ed™RŞe
)

94 
mod–
.
	`£tD©a
(
šdex
, 
ed™Ü
.
	`cu¼’tIndex
(), 
QtCÜe
.
Qt
.
Ed™RŞe
)

97 @
QtCÜe
.
	`pyqtSlÙ
()

98 
def
 
	$Ú_pŞ_chªged
(
£lf
):

100 
	$Ú_pŞ_chªged
(): 
desütiÚ


102 :
»tuºs
: 
NÚe


104 
´št
 'Ú_pŞ_chªged [%d]' % (
£lf
.
	`£nd”
().
	`cu¼’tIndex
())

105 
£lf
.
comm™D©a
.
	`em™
(£lf.
	`£nd”
())

	@widgets/scan_table_view/polaritySelWidget.py

2 
C»©ed
 
Ú
 
	gNov
 16, 2016

4 @
	gauthÜ
: 
b”gr


6 
äom
 
şs
.
­¶iÿtiÚs
.
pyStxm
.
widg‘s
.
sÿn_bË_v›w
.
ba£SÿnTabË
 
impÜt
 *

8 
äom
 
şs
.
­¶iÿtiÚs
.
pyStxm
.
widg‘s
.
sÿn_bË_v›w
.
pŞ¬™yTabËV›w
 
impÜt
 
PŞ¬™yTabËV›w


10 
şass
 
	$PŞ¬™yS–Widg‘
(
Ba£S–eùiÚWidg‘
):

12 
A
 
QWidg‘
 
th©
 
cÚšs
 
ª
 
PŞ¬™yTabËV›w


14 
def
 
	$__š™__
(
£lf
,*
¬gs
):

16 
	$__š™__
(): 
desütiÚ


18 :
·¿m
 *
¬gs
: *¬g 
desütiÚ


19 :
ty³
 *
¬gs
: *argsype

21 :
»tuºs
: 
NÚe


23 
Ba£S–eùiÚWidg‘
.
	`__š™__
(
£lf
, *
¬gs
)

24 #£tGeom‘ry(
x_pos
, 
y_pos
, 
width
, 
height
)

25 
£lf
.
	`£tGeom‘ry
(300, 200, 870, 450)

26 
£lf
.
	`£tWšdowT™Ë
("Click on columnitleo sort")

27 
£lf
.
ed™abË
 = 
F®£


28 
rois
 = [
	`g‘_•u_pŞ_dù
(0, 0.0, 
ªgË
=0.0)]

31 
£lf
.
sÿn_id
 = 0

32 
£lf
.
bË_v›w
 = 
	`PŞ¬™yTabËV›w
()

33 #£lf.
sÿn_id
 = 
£lf
.
bË_v›w
.
	`g‘_mod–_id_¡¬t_v®
()

34 
£lf
.
bË_v›w
.
	`»sizeCŞumnsToCÚ‹Ás
()

35 
£lf
.
bË_v›w
.
	`£tSÜtšgEÇbËd
(
F®£
)

36 
£lf
.
bË_v›w
.
	`ü—‹_Ãw_mod–
()

37 
£lf
.
bË_v›w
.
	`£t_mod–_cŞumn_deçuÉs
()

39 
Ïyout
 = 
QtWidg‘s
.
	`QVBoxLayout
(
£lf
)

40 
Ïyout
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

41 
Ïyout
.
	`addWidg‘
(
£lf
.
bË_v›w
)

42 
£lf
.
	`£tLayout
(
Ïyout
)

43 
£lf
.
	`ş—rFocus
()

45 
£lf
.
bË_v›w
.
add_»giÚ
.
	`cÚÃù
(£lf.
Ú_Ãw_»giÚ
)

46 
£lf
.
bË_v›w
.
d–_»giÚ
.
	`cÚÃù
(£lf.
Ú_d–‘e_»giÚ
)

47 
£lf
.
bË_v›w
.
row_£Ëùed
.
	`cÚÃù
(£lf.
Ú_row_£Ëùed
)

49 
£lf
.
bË_v›w
.
sÿn_chªged
.
	`cÚÃù
(£lf.
chªged
)

51 #£lf.
bË_v›w
.
	`mod–
().
sÿn_chªged
.
	`cÚÃù
(
£lf
.
Ú_pŞ_sÿn_chªged
)

52 
def
 
	$’abË_add_»giÚ_m’u
(
£lf
, do=
True
):

53 
£lf
.
add_»giÚ_’abËd
 = do

55 
def
 
	$£Ëù_row
(
£lf
, 
row_idx
):

56 
£lf
.
bË_v›w
.
	`£Ëù_row
(
row_idx
)

58 
def
 
	$g‘_row_d©a
(
£lf
, 
™em_id
):

59 (
£lf
.
bË_v›w
.
	`g‘_sÿn
(
™em_id
))

61 
def
 
	$d–‘e_mod–
(
£lf
, 
pŞ_mod–_id
=
NÚe
):

63 
	$d–‘e_mod–
(): 
desütiÚ


65 :
·¿m
 
pŞ_mod–_id
=
NÚe
:…Ş_mod–_id=NÚ
desütiÚ


66 :
ty³
 
pŞ_mod–_id
=
NÚe
:…ol_model_id=Noneype

68 :
»tuºs
: 
NÚe


71 
This
 
funùiÚ
 
is
 
ÿÎed
 
by
 
the
 
EV
 
widg‘
 
	$d–‘e_mod–
(è
as
 
w–l
‡ 
	`d–‘e_row
(), 
d•’ds
 
Ú


72 
why
 
ªd
 
how
 
the
 
row
 
waws
 
to
 
be
 
d–‘ed
.

74 
this
 
funùiÚ
 
kes
 
the
 
mod–_id
 
of
h
desœed
 
POL
 model_id

75 
th©
 
Ãeds
 
to
 
be
 
d–‘ed
. 
FÜ
 
POL
 
mod–s
 
the
 
£qu’û
 
d–‘iÚ
 
is
 
as
 
fŞows
:

76 - 
g‘
 
the
 
li¡
 
of
 
sÿns
 
š
h
mod–
 
w™h
h
§me
 
id
 
as
 
pŞ_mod–_id


77 - 
d–‘e
 
ev”y
 
sÿn
 
š
 
the
 
li¡


78 - 
ÿÎ
 'remove_model(model_id)'

80 if(
pŞ_mod–_id
 
is
 
NÚe
):

81 
sÿn
 = 
£lf
.
bË_v›w
.
	`g‘_cur_£Ëùed_sÿn
()

82 
pŞ_mod–_id
 = 
sÿn
[
SPDB_ID_VAL
]

84 
pŞ_sÿns
 = 
£lf
.
bË_v›w
.
	`g‘_sÿn_li¡
(
pŞ_mod–_id
)

85 
pŞ
 
š
 
pŞ_sÿns
:

86 
£lf
.
	`Ú_d–‘e_»giÚ
(
pŞ
[
SPDB_ID_VAL
])

87 
£lf
.
bË_v›w
.
	`»move_mod–
(
pŞ_mod–_id
)

89 
def
 
	$g‘_d©a
(
£lf
, 
mod–_id
=
NÚe
):

91 
	$g‘_d©a
(): 
desütiÚ


93 :
·¿m
 
mod–_id
=
NÚe
: mod–_id=NÚ
desütiÚ


94 :
ty³
 
mod–_id
=
NÚe
: model_id=Noneype

96 :
»tuºs
: 
NÚe


98 (
£lf
.
bË_v›w
.
	`g‘_sÿn_li¡
(
mod–_id
))

100 
def
 
	$upd©e_bË
(
£lf
):

102 
	$upd©e_bË
(): 
desütiÚ


104 :
»tuºs
: 
NÚe


106 
£lf
.
bË_v›w
.
	`upd©e_bË
()

108 
def
 
	$g‘_cur_mod–_id
(
£lf
):

110 
	$g‘_cur_mod–_id
(): 
desütiÚ


112 :
»tuºs
: 
NÚe


114 (
£lf
.
bË_v›w
.
mod–_id
)

116 
def
 
	$Ú_row_£Ëùed
(
£lf
, 
sÿn
):

118 
	$Ú_row_£Ëùed
(): 
desütiÚ


120 :
·¿m
 
sÿn
: sÿÀ
desütiÚ


121 :
ty³
 
sÿn
: scanype

123 :
»tuºs
: 
NÚe


125 #´šˆ'\t\t\t\tPOLARITY mod–_ID %d s–eùed' % (
sÿn
[
SPDB_ID_VAL
])

126 #£lf.
bË_v›w
.
	`dump_mod–_keys
()

127 #_logg”.
	`debug
('PolaritySelWidget: on_row_selected,ƒmitting model_change')

128 
£lf
.
mod–_chªge
.
	`em™
(
sÿn
[
SPDB_ID_VAL
])

132 
def
 
	$sw™ch_v›w_mod–
(
£lf
, 
mod–_id
):

134 
	$sw™ch_v›w_mod–
(): 
desütiÚ


136 :
·¿m
 
mod–_id
: mod–_id 
desütiÚ


137 :
ty³
 
mod–_id
: model_idype

139 :
»tuºs
: 
NÚe


141 
£lf
.
bË_v›w
.
	`sw™ch_mod–s
(
mod–_id
)

143 
def
 
	$ş—r_bË
(
£lf
):

145 
	$ş—r_bË
(): 
desütiÚ


147 :
»tuºs
: 
NÚe


149 
£lf
.
bË_v›w
.
	`»move_®l
(£lf.
sÿn_id
)

151 
def
 
	$£t_ed™abË
(
£lf
, 
ed
):

153 
	$£t_ed™abË
(): 
desütiÚ


155 :
·¿m
 
ed
:ƒd 
desütiÚ


156 :
ty³
 
ed
:ƒdype

158 :
»tuºs
: 
NÚe


160 
£lf
.
bË_v›w
.
	`£t_mod–_ed™abË
(
ed
)

162 
def
 
	$g‘_»giÚs
(
£lf
):

164 
	$g‘_»giÚs
(): 
desütiÚ


166 :
»tuºs
: 
NÚe


168 
rois
 = 
£lf
.
bË_v›w
.
	`mod–
().
	`g‘_sÿns
()

169 (
rois
)

171 
def
 
	$Ú_Ãw_»giÚ
(
£lf
, 
sÿn
=
NÚe
):

173 
	$Ú_Ãw_»giÚ
(): 
Ú
 
Ãw
 
PŞ¬™y
 
»giÚ


175 :
·¿m
 
sÿn
=
NÚe
: sÿn=NÚ
desütiÚ


176 :
ty³
 
sÿn
=
NÚe
: scan=Noneype

178 :
»tuºs
: 
NÚe


180 if(
nÙ
 
£lf
.
add_»giÚ_’abËd
):

183 if(
sÿn
 
is
 
NÚe
):

184 #u£ 
´evious
 
sÿns
 
v®s
 
Ãw
 
¿nge


185 
cur_sÿn
 = 
cİy
.
	`d“pcİy
(
£lf
.
bË_v›w
.
	`g‘_cur_£Ëùed_sÿn
())

186 
¦i¡
 = 
£lf
.
bË_v›w
.
	`g‘_sÿn_li¡
()

187 if((
cur_sÿn
 
is
 
NÚe
è
	`ªd
 (
	`Ën
(
¦i¡
) == 0)):

188 #ü—‹ 
a
 

189 
sÿn
 = 
	`g‘_•u_pŞ_dù
(0, 0.0, 
ªgË
=0.0)

191 #g‘ 
the
 
Ï¡
 
Úe


192 if(
	`Ën
(
¦i¡
) > 0):

193 
cur_sÿn
 = 
¦i¡
[-1]

195 
sÿn
 = 
	`g‘_•u_pŞ_dù
(
cur_sÿn
['POL'], cur_sÿn['OFF'], 
ªgË
=cur_scan['ANGLE'])

197 
£lf
.
sÿn_id
 += 1

198 
£lf
.
bË_v›w
.
	`add_sÿn
(
sÿn
, s–f.
sÿn_id
)

200 #sØ
th©
 
ªy
 
chªges
 
wl
 
be
 
picked
 
up
 
by
‡ny 
li¡’šg
 
widg‘s


201 
£lf
.
chªged
.
	`em™
()

203 
def
 
	$lßd_sÿn
(
£lf
, 
pŞ_rois
=[]):

204 
cur_sÿn
 
š
 
pŞ_rois
:

205 
sÿn
 = 
	`g‘_•u_pŞ_dù
(
cur_sÿn
['POL'], cur_sÿn['OFF'], 
ªgË
=cur_scan['ANGLE'])

207 
£lf
.
	`Ú_Ãw_»giÚ
(
sÿn
)

209 
def
 
	$Ú_d–‘e_»giÚ
(
£lf
, 
sÿn_id
=
NÚe
):

211 
	$Ú_d–‘e_»giÚ
(): 
desütiÚ


213 :
·¿m
 
sÿn_id
=
NÚe
: sÿn_id=NÚ
desütiÚ


214 :
ty³
 
sÿn_id
=
NÚe
: scan_id=Noneype

216 :
»tuºs
: 
NÚe


218 if(
sÿn_id
 
is
 
NÚe
):

219 
sÿn
 = 
£lf
.
bË_v›w
.
	`g‘_cur_£Ëùed_sÿn
()

220 
sÿn_id
 = 
sÿn
[
SPDB_ID_VAL
]

222 
´št
 '\t\Ş d–‘šg[%d]' % 
sÿn_id


223 
£lf
.
bË_v›w
.
	`»move_sÿn
(
sÿn_id
)

225 
def
 
	$Ú_sšgË_»giÚ
(
£lf
):

227 
	$Ú_sšgË_»giÚ
(): 
desütiÚ


229 :
»tuºs
: 
NÚe


231 
£lf
.
bË_v›w
.
	`mod–
().
	`»move_®l_exû±_fœ¡
(£lf.
sÿn_id
)

	@widgets/scan_table_view/polaritySelWidget.py

2 
C»©ed
 
Ú
 
	gNov
 16, 2016

4 @
	gauthÜ
: 
b”gr


6 
äom
 
şs
.
­¶iÿtiÚs
.
pyStxm
.
widg‘s
.
sÿn_bË_v›w
.
ba£SÿnTabË
 
impÜt
 *

8 
äom
 
şs
.
­¶iÿtiÚs
.
pyStxm
.
widg‘s
.
sÿn_bË_v›w
.
pŞ¬™yTabËV›w
 
impÜt
 
PŞ¬™yTabËV›w


10 
şass
 
	$PŞ¬™yS–Widg‘
(
Ba£S–eùiÚWidg‘
):

12 
A
 
QWidg‘
 
th©
 
cÚšs
 
ª
 
PŞ¬™yTabËV›w


14 
def
 
	$__š™__
(
£lf
,*
¬gs
):

16 
	$__š™__
(): 
desütiÚ


18 :
·¿m
 *
¬gs
: *¬g 
desütiÚ


19 :
ty³
 *
¬gs
: *argsype

21 :
»tuºs
: 
NÚe


23 
Ba£S–eùiÚWidg‘
.
	`__š™__
(
£lf
, *
¬gs
)

24 #£tGeom‘ry(
x_pos
, 
y_pos
, 
width
, 
height
)

25 
£lf
.
	`£tGeom‘ry
(300, 200, 870, 450)

26 
£lf
.
	`£tWšdowT™Ë
("Click on columnitleo sort")

27 
£lf
.
ed™abË
 = 
F®£


28 
rois
 = [
	`g‘_•u_pŞ_dù
(0, 0.0, 
ªgË
=0.0)]

31 
£lf
.
sÿn_id
 = 0

32 
£lf
.
bË_v›w
 = 
	`PŞ¬™yTabËV›w
()

33 #£lf.
sÿn_id
 = 
£lf
.
bË_v›w
.
	`g‘_mod–_id_¡¬t_v®
()

34 
£lf
.
bË_v›w
.
	`»sizeCŞumnsToCÚ‹Ás
()

35 
£lf
.
bË_v›w
.
	`£tSÜtšgEÇbËd
(
F®£
)

36 
£lf
.
bË_v›w
.
	`ü—‹_Ãw_mod–
()

37 
£lf
.
bË_v›w
.
	`£t_mod–_cŞumn_deçuÉs
()

39 
Ïyout
 = 
QtWidg‘s
.
	`QVBoxLayout
(
£lf
)

40 
Ïyout
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

41 
Ïyout
.
	`addWidg‘
(
£lf
.
bË_v›w
)

42 
£lf
.
	`£tLayout
(
Ïyout
)

43 
£lf
.
	`ş—rFocus
()

45 
£lf
.
bË_v›w
.
add_»giÚ
.
	`cÚÃù
(£lf.
Ú_Ãw_»giÚ
)

46 
£lf
.
bË_v›w
.
d–_»giÚ
.
	`cÚÃù
(£lf.
Ú_d–‘e_»giÚ
)

47 
£lf
.
bË_v›w
.
row_£Ëùed
.
	`cÚÃù
(£lf.
Ú_row_£Ëùed
)

49 
£lf
.
bË_v›w
.
sÿn_chªged
.
	`cÚÃù
(£lf.
chªged
)

51 #£lf.
bË_v›w
.
	`mod–
().
sÿn_chªged
.
	`cÚÃù
(
£lf
.
Ú_pŞ_sÿn_chªged
)

52 
def
 
	$’abË_add_»giÚ_m’u
(
£lf
, do=
True
):

53 
£lf
.
add_»giÚ_’abËd
 = do

55 
def
 
	$£Ëù_row
(
£lf
, 
row_idx
):

56 
£lf
.
bË_v›w
.
	`£Ëù_row
(
row_idx
)

58 
def
 
	$g‘_row_d©a
(
£lf
, 
™em_id
):

59 (
£lf
.
bË_v›w
.
	`g‘_sÿn
(
™em_id
))

61 
def
 
	$d–‘e_mod–
(
£lf
, 
pŞ_mod–_id
=
NÚe
):

63 
	$d–‘e_mod–
(): 
desütiÚ


65 :
·¿m
 
pŞ_mod–_id
=
NÚe
:…Ş_mod–_id=NÚ
desütiÚ


66 :
ty³
 
pŞ_mod–_id
=
NÚe
:…ol_model_id=Noneype

68 :
»tuºs
: 
NÚe


71 
This
 
funùiÚ
 
is
 
ÿÎed
 
by
 
the
 
EV
 
widg‘
 
	$d–‘e_mod–
(è
as
 
w–l
‡ 
	`d–‘e_row
(), 
d•’ds
 
Ú


72 
why
 
ªd
 
how
 
the
 
row
 
waws
 
to
 
be
 
d–‘ed
.

74 
this
 
funùiÚ
 
kes
 
the
 
mod–_id
 
of
h
desœed
 
POL
 model_id

75 
th©
 
Ãeds
 
to
 
be
 
d–‘ed
. 
FÜ
 
POL
 
mod–s
 
the
 
£qu’û
 
d–‘iÚ
 
is
 
as
 
fŞows
:

76 - 
g‘
 
the
 
li¡
 
of
 
sÿns
 
š
h
mod–
 
w™h
h
§me
 
id
 
as
 
pŞ_mod–_id


77 - 
d–‘e
 
ev”y
 
sÿn
 
š
 
the
 
li¡


78 - 
ÿÎ
 'remove_model(model_id)'

80 if(
pŞ_mod–_id
 
is
 
NÚe
):

81 
sÿn
 = 
£lf
.
bË_v›w
.
	`g‘_cur_£Ëùed_sÿn
()

82 
pŞ_mod–_id
 = 
sÿn
[
SPDB_ID_VAL
]

84 
pŞ_sÿns
 = 
£lf
.
bË_v›w
.
	`g‘_sÿn_li¡
(
pŞ_mod–_id
)

85 
pŞ
 
š
 
pŞ_sÿns
:

86 
£lf
.
	`Ú_d–‘e_»giÚ
(
pŞ
[
SPDB_ID_VAL
])

87 
£lf
.
bË_v›w
.
	`»move_mod–
(
pŞ_mod–_id
)

89 
def
 
	$g‘_d©a
(
£lf
, 
mod–_id
=
NÚe
):

91 
	$g‘_d©a
(): 
desütiÚ


93 :
·¿m
 
mod–_id
=
NÚe
: mod–_id=NÚ
desütiÚ


94 :
ty³
 
mod–_id
=
NÚe
: model_id=Noneype

96 :
»tuºs
: 
NÚe


98 (
£lf
.
bË_v›w
.
	`g‘_sÿn_li¡
(
mod–_id
))

100 
def
 
	$upd©e_bË
(
£lf
):

102 
	$upd©e_bË
(): 
desütiÚ


104 :
»tuºs
: 
NÚe


106 
£lf
.
bË_v›w
.
	`upd©e_bË
()

108 
def
 
	$g‘_cur_mod–_id
(
£lf
):

110 
	$g‘_cur_mod–_id
(): 
desütiÚ


112 :
»tuºs
: 
NÚe


114 (
£lf
.
bË_v›w
.
mod–_id
)

116 
def
 
	$Ú_row_£Ëùed
(
£lf
, 
sÿn
):

118 
	$Ú_row_£Ëùed
(): 
desütiÚ


120 :
·¿m
 
sÿn
: sÿÀ
desütiÚ


121 :
ty³
 
sÿn
: scanype

123 :
»tuºs
: 
NÚe


125 #´šˆ'\t\t\t\tPOLARITY mod–_ID %d s–eùed' % (
sÿn
[
SPDB_ID_VAL
])

126 #£lf.
bË_v›w
.
	`dump_mod–_keys
()

127 #_logg”.
	`debug
('PolaritySelWidget: on_row_selected,ƒmitting model_change')

128 
£lf
.
mod–_chªge
.
	`em™
(
sÿn
[
SPDB_ID_VAL
])

132 
def
 
	$sw™ch_v›w_mod–
(
£lf
, 
mod–_id
):

134 
	$sw™ch_v›w_mod–
(): 
desütiÚ


136 :
·¿m
 
mod–_id
: mod–_id 
desütiÚ


137 :
ty³
 
mod–_id
: model_idype

139 :
»tuºs
: 
NÚe


141 
£lf
.
bË_v›w
.
	`sw™ch_mod–s
(
mod–_id
)

143 
def
 
	$ş—r_bË
(
£lf
):

145 
	$ş—r_bË
(): 
desütiÚ


147 :
»tuºs
: 
NÚe


149 
£lf
.
bË_v›w
.
	`»move_®l
(£lf.
sÿn_id
)

151 
def
 
	$£t_ed™abË
(
£lf
, 
ed
):

153 
	$£t_ed™abË
(): 
desütiÚ


155 :
·¿m
 
ed
:ƒd 
desütiÚ


156 :
ty³
 
ed
:ƒdype

158 :
»tuºs
: 
NÚe


160 
£lf
.
bË_v›w
.
	`£t_mod–_ed™abË
(
ed
)

162 
def
 
	$g‘_»giÚs
(
£lf
):

164 
	$g‘_»giÚs
(): 
desütiÚ


166 :
»tuºs
: 
NÚe


168 
rois
 = 
£lf
.
bË_v›w
.
	`mod–
().
	`g‘_sÿns
()

169 (
rois
)

171 
def
 
	$Ú_Ãw_»giÚ
(
£lf
, 
sÿn
=
NÚe
):

173 
	$Ú_Ãw_»giÚ
(): 
Ú
 
Ãw
 
PŞ¬™y
 
»giÚ


175 :
·¿m
 
sÿn
=
NÚe
: sÿn=NÚ
desütiÚ


176 :
ty³
 
sÿn
=
NÚe
: scan=Noneype

178 :
»tuºs
: 
NÚe


180 if(
nÙ
 
£lf
.
add_»giÚ_’abËd
):

183 if(
sÿn
 
is
 
NÚe
):

184 #u£ 
´evious
 
sÿns
 
v®s
 
Ãw
 
¿nge


185 
cur_sÿn
 = 
cİy
.
	`d“pcİy
(
£lf
.
bË_v›w
.
	`g‘_cur_£Ëùed_sÿn
())

186 
¦i¡
 = 
£lf
.
bË_v›w
.
	`g‘_sÿn_li¡
()

187 if((
cur_sÿn
 
is
 
NÚe
è
	`ªd
 (
	`Ën
(
¦i¡
) == 0)):

188 #ü—‹ 
a
 

189 
sÿn
 = 
	`g‘_•u_pŞ_dù
(0, 0.0, 
ªgË
=0.0)

191 #g‘ 
the
 
Ï¡
 
Úe


192 if(
	`Ën
(
¦i¡
) > 0):

193 
cur_sÿn
 = 
¦i¡
[-1]

195 
sÿn
 = 
	`g‘_•u_pŞ_dù
(
cur_sÿn
['POL'], cur_sÿn['OFF'], 
ªgË
=cur_scan['ANGLE'])

197 
£lf
.
sÿn_id
 += 1

198 
£lf
.
bË_v›w
.
	`add_sÿn
(
sÿn
, s–f.
sÿn_id
)

200 #sØ
th©
 
ªy
 
chªges
 
wl
 
be
 
picked
 
up
 
by
‡ny 
li¡’šg
 
widg‘s


201 
£lf
.
chªged
.
	`em™
()

203 
def
 
	$lßd_sÿn
(
£lf
, 
pŞ_rois
=[]):

204 
cur_sÿn
 
š
 
pŞ_rois
:

205 
sÿn
 = 
	`g‘_•u_pŞ_dù
(
cur_sÿn
['POL'], cur_sÿn['OFF'], 
ªgË
=cur_scan['ANGLE'])

207 
£lf
.
	`Ú_Ãw_»giÚ
(
sÿn
)

209 
def
 
	$Ú_d–‘e_»giÚ
(
£lf
, 
sÿn_id
=
NÚe
):

211 
	$Ú_d–‘e_»giÚ
(): 
desütiÚ


213 :
·¿m
 
sÿn_id
=
NÚe
: sÿn_id=NÚ
desütiÚ


214 :
ty³
 
sÿn_id
=
NÚe
: scan_id=Noneype

216 :
»tuºs
: 
NÚe


218 if(
sÿn_id
 
is
 
NÚe
):

219 
sÿn
 = 
£lf
.
bË_v›w
.
	`g‘_cur_£Ëùed_sÿn
()

220 
sÿn_id
 = 
sÿn
[
SPDB_ID_VAL
]

222 
´št
 '\t\Ş d–‘šg[%d]' % 
sÿn_id


223 
£lf
.
bË_v›w
.
	`»move_sÿn
(
sÿn_id
)

225 
def
 
	$Ú_sšgË_»giÚ
(
£lf
):

227 
	$Ú_sšgË_»giÚ
(): 
desütiÚ


229 :
»tuºs
: 
NÚe


231 
£lf
.
bË_v›w
.
	`mod–
().
	`»move_®l_exû±_fœ¡
(£lf.
sÿn_id
)

	@widgets/scan_table_view/polarityTableModel.py

2 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
ba£SÿnTabË
 
	gimpÜt
 *

4 
	gPOLARITY_COLUMN_MAP
 = ['ID','POL', 'OFF', 'ANGLE']

5 
	gPOLARITY_POLARITY_CHANGED
 = [1]

6 
POLARITY_OFFSET_CHANGED
 = [2]

7 
POLARITY_LINEAR_ANGLE_CHANGED
 = [3]

9 
şass
 
	$PŞ¬™yTabËMod–
(
Ba£SÿnTabËMod–
):

11 
def
 
	$__š™__
(
£lf
, 
hdrLi¡
, 
d©aš
, 
·»Á
 = 
NÚe
, *
¬gs
):

13 
	$__š™__
(): 
desütiÚ


15 :
·¿m
 
hdrLi¡
: hdrLi¡ 
desütiÚ


16 :
ty³
 
hdrLi¡
: hdrListype

18 :
·¿m
 
d©aš
: d©aš 
desütiÚ


19 :
ty³
 
d©aš
: datainype

21 :
·¿m
 
·»Á
=
NÚe
:…¬’t=NÚ
desütiÚ


22 :
ty³
 
·»Á
=
NÚe
:…arent=Noneype

24 :
·¿m
 *
¬gs
: *¬g 
desütiÚ


25 :
ty³
 *
¬gs
: *argsype

27 :
»tuºs
: 
NÚe


29 #QtCÜe.
QAb¡¿ùTabËMod–
.
	`__š™__
(
£lf
, 
·»Á
, *
¬gs
)

30 
	`su³r
(
PŞ¬™yTabËMod–
, 
£lf
).
	`__š™__
Ğ
hdrLi¡
, 
d©aš
, 
·»Á
, *
¬gs
)

31 #¨
diù
 
th©
 
wl
 
u£
 
¥©Ÿl
 
»giÚ
 
sÿn_id
' a keyØEÃrgyRegiÚSÿnDef'
s


32 
£lf
.
cur_sÿn_row
 = 
NÚe


33 
£lf
.
sÿnLi¡D©a
 = 
d©aš


34 
£lf
.
ed™abË
 = 
F®£


35 
£lf
.
cŞumn_m­
 = 
POLARITY_COLUMN_MAP


36 
£lf
.
	`£t_mš_rows
(0)

37 
£lf
.
	`£t_max_rows
(20)

40 
def
 
	$£tD©a
(
£lf
, 
šdex
, 
v®ue
, 
rŞe
, 
do_sigÇl
=
True
):

42 
	$£tD©a
(): 
desütiÚ


44 :
·¿m
 
šdex
: index 
desütiÚ


45 :
ty³
 
šdex
: indexype

47 :
·¿m
 
v®ue
: v®u
desütiÚ


48 :
ty³
 
v®ue
: valueype

50 :
·¿m
 
rŞe
:„Ş
desütiÚ


51 :
ty³
 
rŞe
:„oleype

53 :
·¿m
 
do_sigÇl
=
True
: do_sigÇl=Tru
desütiÚ


54 :
ty³
 
do_sigÇl
=
True
: do_signal=Trueype

56 :
»tuºs
: 
NÚe


58 
row
 = 
šdex
.
	`row
()

59 
cŞ
 = 
šdex
.
	`cŞumn
()

60 
ok
 = 
True


61 
´št
 'PŞ¬™y mod–:„Şğ%d' % 
rŞe


62 if(
rŞe
 =ğ
QtCÜe
.
Qt
.
Ed™RŞe
):

64 if(
cŞ
 == 0):

65  
True


66 #v®, 
ok
 = 
v®ue
.
	`toLÚgLÚg
()

67 
	`–if
(
cŞ
 == 1):

68 #v® = 
	`¡r
(
v®ue
.
	`toSŒšg
())

69 #if(
	`Ën
(
v®
) < 1):

70 #ok = 
F®£


71 
v®
 = 
v®ue


73 
v®
 = (
v®ue
)

76 #ÿÎ 
the
 
assocŸ‹d
 
£‰”
 
funùiÚ
 
this
 
	`cŞumn
 (thi 
is
 
£tup
 
š
h
sÿn
 
defš™iÚ
 
şass


77 if(
ok
):

78 #Úly 
chªge
 
the
 
v®ue
 th
u£r
 
’‹»d
 
a
 value

79 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

80 
sÿn_id
 = 
sÿn
[
SPDB_ID_VAL
]

81 #´šˆ'£tD©a[sÿn_id=%d] cŞ=%d v®ğ%f' % (
sÿn_id
, 
cŞ
, 
v®
)

82 #if(
POLARITY_COLUMN_MAP
[
cŞ
] == 'POL'):

83 ##
cÚv”t
 
pŞ¬™y
 
combobox
 
v®
 
to
 
¡xm
 
w¿µ”
 
v®ues


84 #v® = 
v®
 - 1

86 
sÿn
[
POLARITY_COLUMN_MAP
[
cŞ
]] = 
v®


88 if((
rŞe
 =ğ
QtCÜe
.
Qt
.
Ed™RŞe
è
	$Ü
 (
rŞe
 =ğ
QtCÜe
.
Qt
.
Di¥ÏyRŞe
)):

89 #mu¡ 
em™
 
this
 
as
 
·¹
 
of
 
the
 
äamewÜk
 
suµÜt
 
ª
 
ed™abË
 
Ab¡¿ùTabËMod–


90 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

91 
£lf
.
d©aChªged
.
	`em™
(
šdex
, index)

93 if(
do_sigÇl
):

95 
£lf
.
sÿn_chªged
.
	`em™
(
row
, 
sÿn
)

97  
True


	@widgets/scan_table_view/polarityTableModel.py

2 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
ba£SÿnTabË
 
	gimpÜt
 *

4 
	gPOLARITY_COLUMN_MAP
 = ['ID','POL', 'OFF', 'ANGLE']

5 
	gPOLARITY_POLARITY_CHANGED
 = [1]

6 
POLARITY_OFFSET_CHANGED
 = [2]

7 
POLARITY_LINEAR_ANGLE_CHANGED
 = [3]

9 
şass
 
	$PŞ¬™yTabËMod–
(
Ba£SÿnTabËMod–
):

11 
def
 
	$__š™__
(
£lf
, 
hdrLi¡
, 
d©aš
, 
·»Á
 = 
NÚe
, *
¬gs
):

13 
	$__š™__
(): 
desütiÚ


15 :
·¿m
 
hdrLi¡
: hdrLi¡ 
desütiÚ


16 :
ty³
 
hdrLi¡
: hdrListype

18 :
·¿m
 
d©aš
: d©aš 
desütiÚ


19 :
ty³
 
d©aš
: datainype

21 :
·¿m
 
·»Á
=
NÚe
:…¬’t=NÚ
desütiÚ


22 :
ty³
 
·»Á
=
NÚe
:…arent=Noneype

24 :
·¿m
 *
¬gs
: *¬g 
desütiÚ


25 :
ty³
 *
¬gs
: *argsype

27 :
»tuºs
: 
NÚe


29 #QtCÜe.
QAb¡¿ùTabËMod–
.
	`__š™__
(
£lf
, 
·»Á
, *
¬gs
)

30 
	`su³r
(
PŞ¬™yTabËMod–
, 
£lf
).
	`__š™__
Ğ
hdrLi¡
, 
d©aš
, 
·»Á
, *
¬gs
)

31 #¨
diù
 
th©
 
wl
 
u£
 
¥©Ÿl
 
»giÚ
 
sÿn_id
' a keyØEÃrgyRegiÚSÿnDef'
s


32 
£lf
.
cur_sÿn_row
 = 
NÚe


33 
£lf
.
sÿnLi¡D©a
 = 
d©aš


34 
£lf
.
ed™abË
 = 
F®£


35 
£lf
.
cŞumn_m­
 = 
POLARITY_COLUMN_MAP


36 
£lf
.
	`£t_mš_rows
(0)

37 
£lf
.
	`£t_max_rows
(20)

40 
def
 
	$£tD©a
(
£lf
, 
šdex
, 
v®ue
, 
rŞe
, 
do_sigÇl
=
True
):

42 
	$£tD©a
(): 
desütiÚ


44 :
·¿m
 
šdex
: index 
desütiÚ


45 :
ty³
 
šdex
: indexype

47 :
·¿m
 
v®ue
: v®u
desütiÚ


48 :
ty³
 
v®ue
: valueype

50 :
·¿m
 
rŞe
:„Ş
desütiÚ


51 :
ty³
 
rŞe
:„oleype

53 :
·¿m
 
do_sigÇl
=
True
: do_sigÇl=Tru
desütiÚ


54 :
ty³
 
do_sigÇl
=
True
: do_signal=Trueype

56 :
»tuºs
: 
NÚe


58 
row
 = 
šdex
.
	`row
()

59 
cŞ
 = 
šdex
.
	`cŞumn
()

60 
ok
 = 
True


61 
´št
 'PŞ¬™y mod–:„Şğ%d' % 
rŞe


62 if(
rŞe
 =ğ
QtCÜe
.
Qt
.
Ed™RŞe
):

64 if(
cŞ
 == 0):

65  
True


66 #v®, 
ok
 = 
v®ue
.
	`toLÚgLÚg
()

67 
	`–if
(
cŞ
 == 1):

68 #v® = 
	`¡r
(
v®ue
.
	`toSŒšg
())

69 #if(
	`Ën
(
v®
) < 1):

70 #ok = 
F®£


71 
v®
 = 
v®ue


73 
v®
 = (
v®ue
)

76 #ÿÎ 
the
 
assocŸ‹d
 
£‰”
 
funùiÚ
 
this
 
	`cŞumn
 (thi 
is
 
£tup
 
š
h
sÿn
 
defš™iÚ
 
şass


77 if(
ok
):

78 #Úly 
chªge
 
the
 
v®ue
 th
u£r
 
’‹»d
 
a
 value

79 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

80 
sÿn_id
 = 
sÿn
[
SPDB_ID_VAL
]

81 #´šˆ'£tD©a[sÿn_id=%d] cŞ=%d v®ğ%f' % (
sÿn_id
, 
cŞ
, 
v®
)

82 #if(
POLARITY_COLUMN_MAP
[
cŞ
] == 'POL'):

83 ##
cÚv”t
 
pŞ¬™y
 
combobox
 
v®
 
to
 
¡xm
 
w¿µ”
 
v®ues


84 #v® = 
v®
 - 1

86 
sÿn
[
POLARITY_COLUMN_MAP
[
cŞ
]] = 
v®


88 if((
rŞe
 =ğ
QtCÜe
.
Qt
.
Ed™RŞe
è
	$Ü
 (
rŞe
 =ğ
QtCÜe
.
Qt
.
Di¥ÏyRŞe
)):

89 #mu¡ 
em™
 
this
 
as
 
·¹
 
of
 
the
 
äamewÜk
 
suµÜt
 
ª
 
ed™abË
 
Ab¡¿ùTabËMod–


90 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

91 
£lf
.
d©aChªged
.
	`em™
(
šdex
, index)

93 if(
do_sigÇl
):

95 
£lf
.
sÿn_chªged
.
	`em™
(
row
, 
sÿn
)

97  
True


	@widgets/scan_table_view/polarityTableView.py

2 
C»©ed
 
Ú
 
	gNov
 16, 2016

4 @
	gauthÜ
: 
b”gr


6 
äom
 
şs
.
­¶iÿtiÚs
.
pyStxm
.
widg‘s
.
sÿn_bË_v›w
.
ba£SÿnTabË
 
impÜt
 *

8 
äom
 
şs
.
­¶iÿtiÚs
.
pyStxm
.
widg‘s
.
sÿn_bË_v›w
.
pŞ¬™yTabËMod–
 
impÜt
 
PŞ¬™yTabËMod–


9 
äom
 
şs
.
­¶iÿtiÚs
.
pyStxm
.
widg‘s
.
sÿn_bË_v›w
.
pŞ¬™yCmboBoxD–eg©e
 
impÜt
 
PŞComboBoxD–eg©e
, 
	gPOLARITY_COLUMN


11 
şass
 
	$PŞ¬™yTabËV›w
(
Ba£SÿnTabËV›w
):

13 #chªged = 
QtCÜe
.
	`pyqtSigÇl
()

15 
def
 
	$__š™__
(
£lf
, 
sÿnLi¡
=[], 
·»Á
=
NÚe
):

17 
	$__š™__
(): 
desütiÚ


19 :
·¿m
 
sÿnLi¡
=[]: sÿnLi¡=[] 
desütiÚ


20 :
ty³
 
sÿnLi¡
=[]: scanList=[]ype

22 :
·¿m
 
·»Á
=
NÚe
:…¬’t=NÚ
desütiÚ


23 :
ty³
 
·»Á
=
NÚe
:…arent=Noneype

25 :
»tuºs
: 
NÚe


27 #£tu°
the
 
h—d”
 th
tİ
 
of
h
bË


28 
hdrLi¡
 = ['ID','Polarity', 'Offset', 'Linear Angle']

29 #£lf.
func_li¡
 = ['pol_id', 'polarity', 'offset','linearAngle']

31 
	`su³r
(
PŞ¬™yTabËV›w
, 
£lf
).
	`__š™__
(
hdrLi¡
, 
sÿnLi¡
, 
PŞ¬™yTabËMod–
, 
·»Á
)

32 
£lf
.
	`£tStyËSh“t
(
POL_SS
)

33 
£lf
.
xyNum
 = 0

34 #£lf.
	`£t_mod–_id_¡¬t_v®
(
POL_CNTR
)

35 
£lf
.
	`£tI‹mD–eg©eFÜCŞumn
(
POLARITY_COLUMN
, 
	`PŞComboBoxD–eg©e
(self))

37 #tuº 
bŞd
 
off


38 
fÚt
 = 
£lf
.
	`hÜizÚlH—d”
().
	`fÚt
()

39 
fÚt
.
	`£tBŞd
(
F®£
)

40 
fÚt
.
	`£tPoštSize
(8)

41 
£lf
.
	`hÜizÚlH—d”
().
	`£tFÚt
(
fÚt
)

42 #£lf.
	`š™_mod–
()

44 
def
 
	$š™_mod–
(
£lf
):

46 
	$š™_mod–
(): 
desütiÚ


48 :
»tuºs
: 
NÚe


50 
£lf
.
bËmod–
 = 
	`PŞ¬™yTabËMod–
(£lf.
hdrLi¡
, s–f.
sÿns
, self)

51 
£lf
.
	`£t_mod–_cŞumn_deçuÉs
()

54 
def
 
	$g‘_pŞ¬™y_combobox
(
£lf
):

56 
	$g‘_pŞ¬™y_combobox
(): 
desütiÚ


58 :
»tuºs
: 
NÚe


60 
cbox
 = 
QtWidg‘s
.
	`QComboBox
()

61 #th
v®ues
 
th©
 
Ãed
 
to
 
be
 
pushed
 
out
 
the£
 
	`¬e
 (
š
 
Üd”
)

63 
cbox
.
	`addI‹ms
(['Circ Left','Circ Right','Linear'])

64 (
cbox
)

67 
def
 
	$£t_mod–_cŞumn_deçuÉs
(
£lf
):

69 
	$£t_mod–_cŞumn_deçuÉs
(): 
desütiÚ


71 :
»tuºs
: 
NÚe


73 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(0)

74 #fÜ 
i
 
š
 
	`¿nge
(1,
	`Ën
(
£lf
.
hdrLi¡
)):

75 #£lf.
	`hÜizÚlH—d”
().
	`£tSeùiÚResizeMode
(
i
, 
QtWidg‘s
.
QH—d”V›w
.
SŒ‘ch
)

77 
def
 
	$sizeHštFÜCŞumn
(
£lf
, 
cŞumn
):

79 
	$sizeHštFÜCŞumn
(): 
desütiÚ


81 :
·¿m
 
cŞumn
: cŞumÀ
desütiÚ


82 :
ty³
 
cŞumn
: columnype

84 :
»tuºs
: 
NÚe


86 
fm
 = 
£lf
.
	`fÚtM‘rics
()

87 
max_width
 = 0

88 
i
 
š
 
	`¿nge
(
£lf
.
	`mod–
().
	$rowCouÁ
()):

89 
width
 = 
fm
.
	`width
(
£lf
.
	`mod–
().
	`g‘_ûÎ
(
i
,
cŞumn
)) + 10

90 
width
 > 
max_width
:

91 
max_width
 = 
width


92  
max_width


94 
def
 
	$upd©e_bË
(
£lf
):

96 
	$upd©e_bË
(): 
desütiÚ


98 :
»tuºs
: 
NÚe


100 if(
£lf
.
bËmod–
 
is
 
nÙ
 
NÚe
):

101 
row
 
š
 
	`¿nge
(0, 
£lf
.
bËmod–
.
	$rowCouÁ
()):

102 #bË_v›w.
	`İ’P”si¡’tEd™Ü
(
bË_mod–
.
	`šdex
(
row
, 0))

103 
£lf
.
	`İ’P”si¡’tEd™Ü
(£lf.
bËmod–
.
	`šdex
(
row
, 
POLARITY_COLUMN
))

105 
def
 
	$add_sÿn
(
£lf
, 
sÿn
, 
sÿn_id
):

107 
	$add_sÿn
(): 
desütiÚ


109 :
·¿m
 
sÿn
: sÿÀ
desütiÚ


110 :
ty³
 
sÿn
: scanype

112 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


113 :
ty³
 
sÿn_id
: scan_idype

115 :
»tuºs
: 
NÚe


118 
sucûss
 = 
F®£


119 if(
£lf
.
	$sw™ch_mod–s
(
£lf
.
mod–_id
)):

120 #sÿn[
SPDB_ID_VAL
] = 
£lf
.
mod–_id_¡¬t_v®
 + s–f.
	`g‘_num_sÿns
()

121 
sÿn
[
SPDB_ID_VAL
] = 
sÿn_id


122 
sucûss
 = 
£lf
.
bËmod–
.
	`add_sÿn
(
sÿn
)

123 
£lf
.
_cur_£Ëùed_sÿn
 = 
sÿn


124 
£lf
.
	`£Ëù_row
(
sÿn
[
SPDB_ID_VAL
])

125 
£lf
.
	`£t_mod–_cŞumn_deçuÉs
()

126 
sucûss
 = 
True


128 
£lf
.
	`upd©e_bË
()

130 (
sucûss
)

	@widgets/scan_table_view/polarityTableView.py

2 
C»©ed
 
Ú
 
	gNov
 16, 2016

4 @
	gauthÜ
: 
b”gr


6 
äom
 
şs
.
­¶iÿtiÚs
.
pyStxm
.
widg‘s
.
sÿn_bË_v›w
.
ba£SÿnTabË
 
impÜt
 *

8 
äom
 
şs
.
­¶iÿtiÚs
.
pyStxm
.
widg‘s
.
sÿn_bË_v›w
.
pŞ¬™yTabËMod–
 
impÜt
 
PŞ¬™yTabËMod–


9 
äom
 
şs
.
­¶iÿtiÚs
.
pyStxm
.
widg‘s
.
sÿn_bË_v›w
.
pŞ¬™yCmboBoxD–eg©e
 
impÜt
 
PŞComboBoxD–eg©e
, 
	gPOLARITY_COLUMN


11 
şass
 
	$PŞ¬™yTabËV›w
(
Ba£SÿnTabËV›w
):

13 #chªged = 
QtCÜe
.
	`pyqtSigÇl
()

15 
def
 
	$__š™__
(
£lf
, 
sÿnLi¡
=[], 
·»Á
=
NÚe
):

17 
	$__š™__
(): 
desütiÚ


19 :
·¿m
 
sÿnLi¡
=[]: sÿnLi¡=[] 
desütiÚ


20 :
ty³
 
sÿnLi¡
=[]: scanList=[]ype

22 :
·¿m
 
·»Á
=
NÚe
:…¬’t=NÚ
desütiÚ


23 :
ty³
 
·»Á
=
NÚe
:…arent=Noneype

25 :
»tuºs
: 
NÚe


27 #£tu°
the
 
h—d”
 th
tİ
 
of
h
bË


28 
hdrLi¡
 = ['ID','Polarity', 'Offset', 'Linear Angle']

29 #£lf.
func_li¡
 = ['pol_id', 'polarity', 'offset','linearAngle']

31 
	`su³r
(
PŞ¬™yTabËV›w
, 
£lf
).
	`__š™__
(
hdrLi¡
, 
sÿnLi¡
, 
PŞ¬™yTabËMod–
, 
·»Á
)

32 
£lf
.
	`£tStyËSh“t
(
POL_SS
)

33 
£lf
.
xyNum
 = 0

34 #£lf.
	`£t_mod–_id_¡¬t_v®
(
POL_CNTR
)

35 
£lf
.
	`£tI‹mD–eg©eFÜCŞumn
(
POLARITY_COLUMN
, 
	`PŞComboBoxD–eg©e
(self))

37 #tuº 
bŞd
 
off


38 
fÚt
 = 
£lf
.
	`hÜizÚlH—d”
().
	`fÚt
()

39 
fÚt
.
	`£tBŞd
(
F®£
)

40 
fÚt
.
	`£tPoštSize
(8)

41 
£lf
.
	`hÜizÚlH—d”
().
	`£tFÚt
(
fÚt
)

42 #£lf.
	`š™_mod–
()

44 
def
 
	$š™_mod–
(
£lf
):

46 
	$š™_mod–
(): 
desütiÚ


48 :
»tuºs
: 
NÚe


50 
£lf
.
bËmod–
 = 
	`PŞ¬™yTabËMod–
(£lf.
hdrLi¡
, s–f.
sÿns
, self)

51 
£lf
.
	`£t_mod–_cŞumn_deçuÉs
()

54 
def
 
	$g‘_pŞ¬™y_combobox
(
£lf
):

56 
	$g‘_pŞ¬™y_combobox
(): 
desütiÚ


58 :
»tuºs
: 
NÚe


60 
cbox
 = 
QtWidg‘s
.
	`QComboBox
()

61 #th
v®ues
 
th©
 
Ãed
 
to
 
be
 
pushed
 
out
 
the£
 
	`¬e
 (
š
 
Üd”
)

63 
cbox
.
	`addI‹ms
(['Circ Left','Circ Right','Linear'])

64 (
cbox
)

67 
def
 
	$£t_mod–_cŞumn_deçuÉs
(
£lf
):

69 
	$£t_mod–_cŞumn_deçuÉs
(): 
desütiÚ


71 :
»tuºs
: 
NÚe


73 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(0)

74 #fÜ 
i
 
š
 
	`¿nge
(1,
	`Ën
(
£lf
.
hdrLi¡
)):

75 #£lf.
	`hÜizÚlH—d”
().
	`£tSeùiÚResizeMode
(
i
, 
QtWidg‘s
.
QH—d”V›w
.
SŒ‘ch
)

77 
def
 
	$sizeHštFÜCŞumn
(
£lf
, 
cŞumn
):

79 
	$sizeHštFÜCŞumn
(): 
desütiÚ


81 :
·¿m
 
cŞumn
: cŞumÀ
desütiÚ


82 :
ty³
 
cŞumn
: columnype

84 :
»tuºs
: 
NÚe


86 
fm
 = 
£lf
.
	`fÚtM‘rics
()

87 
max_width
 = 0

88 
i
 
š
 
	`¿nge
(
£lf
.
	`mod–
().
	$rowCouÁ
()):

89 
width
 = 
fm
.
	`width
(
£lf
.
	`mod–
().
	`g‘_ûÎ
(
i
,
cŞumn
)) + 10

90 
width
 > 
max_width
:

91 
max_width
 = 
width


92  
max_width


94 
def
 
	$upd©e_bË
(
£lf
):

96 
	$upd©e_bË
(): 
desütiÚ


98 :
»tuºs
: 
NÚe


100 if(
£lf
.
bËmod–
 
is
 
nÙ
 
NÚe
):

101 
row
 
š
 
	`¿nge
(0, 
£lf
.
bËmod–
.
	$rowCouÁ
()):

102 #bË_v›w.
	`İ’P”si¡’tEd™Ü
(
bË_mod–
.
	`šdex
(
row
, 0))

103 
£lf
.
	`İ’P”si¡’tEd™Ü
(£lf.
bËmod–
.
	`šdex
(
row
, 
POLARITY_COLUMN
))

105 
def
 
	$add_sÿn
(
£lf
, 
sÿn
, 
sÿn_id
):

107 
	$add_sÿn
(): 
desütiÚ


109 :
·¿m
 
sÿn
: sÿÀ
desütiÚ


110 :
ty³
 
sÿn
: scanype

112 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


113 :
ty³
 
sÿn_id
: scan_idype

115 :
»tuºs
: 
NÚe


118 
sucûss
 = 
F®£


119 if(
£lf
.
	$sw™ch_mod–s
(
£lf
.
mod–_id
)):

120 #sÿn[
SPDB_ID_VAL
] = 
£lf
.
mod–_id_¡¬t_v®
 + s–f.
	`g‘_num_sÿns
()

121 
sÿn
[
SPDB_ID_VAL
] = 
sÿn_id


122 
sucûss
 = 
£lf
.
bËmod–
.
	`add_sÿn
(
sÿn
)

123 
£lf
.
_cur_£Ëùed_sÿn
 = 
sÿn


124 
£lf
.
	`£Ëù_row
(
sÿn
[
SPDB_ID_VAL
])

125 
£lf
.
	`£t_mod–_cŞumn_deçuÉs
()

126 
sucûss
 = 
True


128 
£lf
.
	`upd©e_bË
()

130 (
sucûss
)

	@widgets/scan_table_view/spatialSelWidget.py

1 
äom
 
PyQt5
 
impÜt
 
	guic


3 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
ba£SÿnTabË
 
	gimpÜt
 *

4 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
¥©ŸlTabËV›w
 
impÜt
 
	gS·tŸlSÿnTabËV›w


5 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


7 
	g_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

9 
şass
 
	$S·tŸlS–Widg‘
(
Ba£S–eùiÚWidg‘
):

11 
A
 
QWidg‘
 
th©
 
cÚšs
 
ª
 
S·tŸlSÿnTabËV›w
, 
ÿn
 
be
 
cÚfigu»d
 
to
 
cÚÃù
Ø
ev_£l_widg‘


13 
roi_d–‘ed
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
)

14 
¥©Ÿl_row_chªged
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
)

16 
def
 
	$__š™__
(
£lf
, 
ev_£l_widg‘
=
NÚe
, 
u£_ûÁ”
=
True
, 
is_pošt
=
F®£
, 
is_¬b_lše
=F®£, 
sšgË_ev_mod–
=False):

18 
	$__š™__
(): 
desütiÚ


20 :
·¿m
 
ev_£l_widg‘
=
NÚe
:ƒv_£l_widg‘=NÚ
desütiÚ


21 :
ty³
 
ev_£l_widg‘
=
NÚe
:ƒv_sel_widget=Noneype

23 :
·¿m
 
u£_ûÁ”
: 
True
 
the
 
h—d”
 
th©
 
is
 
u£d
 
wl
 
u£
 
C’‹rX
 
C’‹rY
, 
Ùh”wi£
 
™
 wÈu£ 
S¹X
, 
S¹Y


24 :
ty³
 
u£_ûÁ”
: 
boŞ


26 :
·¿m
 
is_pošt
: 
dÛs
 
the
 
¥©Ÿl
 
roi
 
»´e£Á
 
a
 
pošt
 
sÿn
?

27 :
ty³
 
is_pošt
: 
boŞ


29 :
·¿m
 
is_¬b_lše
: 
dÛs
 
the
 
¥©Ÿl
 
roi
 
»´e£Á
 
a
 
¬b™¿ry
 
lše
 
sÿn
?

30 :
ty³
 
is_¬b_lše
: 
boŞ


33 :
·¿m
 
sšgË_mod–
: 
this
 
æag
 
decides
 
mutË
 
ev_roi
 
mod–s
 
¬e
 
®lowed
,hi 
is
 
u£ful
 
to
 
£t
 
™
Ø
True


34 
š
 
the
 
wh”e
 
I
 
wªt
 
to
 
»u£
 
a
 
sšgË
 
ev_roi
 
mutË
 
¥©Ÿl
 
roi
's

35 :
ty³
 
sšgË_mod–
: 
boŞ—n


39 :
»tuºs
: 
NÚe


41 
Ba£S–eùiÚWidg‘
.
	`__š™__
(
£lf
)

42 #£tGeom‘ry(
x_pos
, 
y_pos
, 
width
, 
height
)

43 
£lf
.
	`£tGeom‘ry
(300, 200, 870, 450)

44 
£lf
.
	`£tWšdowT™Ë
("Click on columnitleo sort")

45 
£lf
.
ed™abË
 = 
F®£


46 
£lf
.
add_»giÚ_’abËd
 = 
True


47 
£lf
.
ev_£l_widg‘
 =ƒv_sel_widget

49 
£lf
.
u£_ûÁ”
 = use_center

50 
£lf
.
sšgË_ev_mod–
 = single_ev_model

51 
£lf
.
sšgË_ev_mod–_id
 = 
NÚe


52 if(
sšgË_ev_mod–
):

53 
£lf
.
ev_£l_widg‘
.
	`£t_sšgË_ev_mod–
(
True
)

55 
£lf
.
ev_£l_widg‘
.
	`£t_sšgË_ev_mod–
(
F®£
)

57 
£lf
.
bË_v›w
 = 
	`S·tŸlSÿnTabËV›w
(
u£_ûÁ”
=u£_ûÁ”, 
is_pošt
=is_pošt, 
is_¬b_lše
=is_arb_line)

58 
£lf
.
sÿn_id
 = 0 #£lf.
bË_v›w
.
	`g‘_mod–_id_¡¬t_v®
()

59 
£lf
.
bË_v›w
.
	`ü—‹_Ãw_mod–
(
u£_ûÁ”
=use_center)

60 
£lf
.
bË_v›w
.
	`£t_mod–_id_¡¬t_v®
(0)

61 
£lf
.
bË_v›w
.
	`£t_mod–_cŞumn_deçuÉs
()

62 #£lf.
	`Ú_Ãw_»giÚ
()

63 
£lf
.
xpos_Çme
 = 
DNM_SAMPLE_X


64 
£lf
.
ypos_Çme
 = 
DNM_SAMPLE_Y


65 #£ˆ
fÚt


66 #£ˆ
cŞumn
 
width
 
to
 
f™
 
	`cÚ‹Ás
 (
£t
 
fÚt
 
fœ¡
!)

67 
£lf
.
bË_v›w
.
	`»sizeCŞumnsToCÚ‹Ás
()

68 
£lf
.
bË_v›w
.
	`£tSÜtšgEÇbËd
(
F®£
)

70 
Ïyout
 = 
QtWidg‘s
.
	`QVBoxLayout
(
£lf
)

71 
Ïyout
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

72 
Ïyout
.
	`addWidg‘
(
£lf
.
bË_v›w
)

73 
£lf
.
	`£tLayout
(
Ïyout
)

74 
£lf
.
	`ş—rFocus
()

76 
£lf
.
ev_£l_widg‘
.
chªged
.
	`cÚÃù
(£lf.
Ú_ev_bË_chªged
)

78 
£lf
.
bË_v›w
.
sÿn_chªged
.
	`cÚÃù
(£lf.
Ú_sÿn_chªged
)

79 
£lf
.
bË_v›w
.
d–_»giÚ
.
	`cÚÃù
(£lf.
d–‘e_row
)

80 
£lf
.
bË_v›w
.
row_£Ëùed
.
	`cÚÃù
(£lf.
Ú_row_£Ëùed
)

82 
£lf
.
bË_v›w
.
add_»giÚ
.
	`cÚÃù
(£lf.
Ú_Ãw_»giÚ
)

85 
def
 
	$£t_pos™iÚ”s
(
£lf
, 
xpos_Çme
, 
ypos_Çme
):

86 
£lf
.
xpos_Çme
 = xpos_name

87 
£lf
.
ypos_Çme
 = ypos_name

90 
def
 
	$£t_¥©Ÿl_¿nge
(
£lf
, 
q»ù
):

93 
£lf
.
bË_v›w
.
	`£t_x_¥©Ÿl_¿nge
(
q»ù
.
	$width
()è#(
xËá
, 
ytİ
, 
width
, 
height
)

94 
£lf
.
bË_v›w
.
	`£t_y_¥©Ÿl_¿nge
(
q»ù
.
	$height
()è#(
xËá
, 
ytİ
, 
width
, 
height
)

96 
def
 
	$£t_¥©Ÿl_¡¬t¡İ
(
£lf
, 
q»ù
):

98 (
x1
, 
y1
, 
x2
, 
y2
èğ
q»ù
.
	`g‘CoÜds
()

99 
£lf
.
bË_v›w
.
	`£t_x_¥©Ÿl_¡¬t¡İ
((
x1
, 
x2
)è#(
xËá
, 
ytİ
, 
width
, 
height
)

100 
£lf
.
bË_v›w
.
	`£t_x_¥©Ÿl_¿nge
((
y1
, 
y2
)è#(
xËá
, 
ytİ
, 
width
, 
height
)

103 
def
 
	$’abË_add_»giÚ_m’u
(
£lf
, do=
True
):

105 
£lf
.
add_»giÚ_’abËd
 = do

107 
def
 
	$Ú_ev_bË_chªged
(
£lf
):

109 
sÿn
 = 
£lf
.
	`g‘_row_d©a_by_™em_id
(£lf.
sÿn_id
)

110 
£lf
.
¥©Ÿl_row_chªged
.
	`em™
(
sÿn
)

113 
def
 
	$Ú_sÿn_chªged
(
£lf
, 
row
, 
sÿn
):

115 #´šˆ'S·tŸlS–Widg‘: on_sÿn_chªged„ow(%dèsÿn_id(%d)' % (
row
, 
sÿn
[
SPDB_ID_VAL
])

116 #_logg”.
	`debug
('SpatialSelWidget: on_scan_changed,ƒmitting spatial_row_changed sig')

117 
£lf
.
¥©Ÿl_row_chªged
.
	`em™
(
sÿn
)

118 
£lf
.
	`check_if_bË_em±y
()

120 
def
 
	$de£Ëù_®l
(
£lf
):

121 
£lf
.
bË_v›w
.
	`ş—rS–eùiÚ
()

123 
def
 
	$£Ëù_row
(
£lf
, 
row_idx
=
NÚe
, 
™em_id
=None):

124 if(
row_idx
 
is
 
nÙ
 
NÚe
):

125 
£lf
.
bË_v›w
.
	`£Ëù_row
(
row_idx
)

126 
	$–if
(
™em_id
 
is
 
nÙ
 
NÚe
):

127 
row_idx
 = 
£lf
.
bË_v›w
.
bËmod–
.
	`g‘_sÿn_rowidx
(
™em_id
)

128 
£lf
.
bË_v›w
.
	`£Ëù_row
(
row_idx
)

130 
def
 
	$g‘_row_idx
(
£lf
, 
™em_id
):

131 (
£lf
.
bË_v›w
.
bËmod–
.
	`g‘_sÿn_rowidx
(
™em_id
))

133 
def
 
	$g‘_row_d©a_by_™em_id
(
£lf
, 
™em_id
):

134 (
£lf
.
bË_v›w
.
	`g‘_sÿn
(
™em_id
))

136 
def
 
	$modify_row_d©a
(
£lf
, 
™em_id
, 
sÿn
):

137 
£lf
.
bË_v›w
.
	`modify_sÿn
(
™em_id
, 
sÿn
)

139 
def
 
	$»move_mod–
(
£lf
, 
mod–_id
):

141 
	$»move_mod–
(): 
desütiÚ


143 :
·¿m
 
mod–_id
: mod–_id 
desütiÚ


144 :
ty³
 
mod–_id
: model_idype

146 :
»tuºs
: 
NÚe


148 
£lf
.
bË_v›w
.
	`»move_mod–
(
mod–_id
)

149 
£lf
.
	`check_if_bË_em±y
()

150 
£lf
.
	`de£Ëù_®l
()

152 
def
 
	$d–‘e_row
(
£lf
, 
¥_mod–_id
=
NÚe
):

154 
	$d–‘e_mod–
(): 
desütiÚ


156 :
·¿m
 
¥_mod–_id
=
NÚe
: sp_mod–_id=NÚ
desütiÚ


157 :
ty³
 
¥_mod–_id
=
NÚe
: sp_model_id=Noneype

159 :
»tuºs
: 
NÚe


162 
This
 
funùiÚ
 
is
 
ÿÎed
 
by
 
the
 
right
 
şick
 
m’u
 
aùiÚ
 
d–‘šg
 
a
 
row
.

164 
this
 
funùiÚ
 
kes
 
the
 
mod–_id
 
of
h
desœed
 
¥©Ÿl
 
»giÚ


165 
th©
 
Ãeds
 
to
 
be
 
d–‘ed
. 
FÜ
 
¥©Ÿl
 
mod–s
 
the
 
£qu’û
 
d–‘iÚ
 
is
 
as
 
fŞows
:

166 - 
fšd
 
the
 
mod–_id
 
of
h
EV
 
mod–
 
th©
hmod– 
we
 
¬e
 
d–‘šg
 
is
 
cÚÃùed
 
	`to
 ([
SPDB_EV_ID
])

167 - 
ÿÎ
 
the
 
£lf
.
ev_£l_widg‘
 'd–‘e_mod–' 
w™h
h
EV
 
mod–_id
, ([
SPDB_EV_ID
])

168 - 
ÿÎ
 'remove_model(sp_model_id)'

169 - 
ü—‹
 
a
 
Ãw
 
widg‘_com
 
diù
 
ªd
 
£t
 
the
 
»Ëvªt
 
f›lds
 
so
 
th©
 
ªy
 
Ùh”
 
widg‘
 
li¡’šg


170 
wl
 
be
 
giv’
 
®l
 
of
 
the
 
šfÜm©iÚ
 
»quœed
 
to
 
d–‘e
 
this
 
ROI
 
äom
 
™s
 
cÚ‹Ás
,

171 - 
em™
 
the
 
¥_db
 
diù
 
w™h
h
commªd
 
DEL_ROI


172 - 
fÜû
 
ª
 
upd©e
 
of
 
the
 
bË
 
v›w
 
by
 
£Ëùšg
h
fœ¡
 
row
 oàth
¥©Ÿl
able

174 if(
¥_mod–_id
 
is
 
NÚe
):

175 
sÿn
 = 
£lf
.
bË_v›w
.
	`g‘_cur_£Ëùed_sÿn
()

176 if(
sÿn
 
is
 
NÚe
):

177 #nØ
mÜe
 
sÿns
 
Ëá


179 
¥_mod–_id
 = 
sÿn
[
SPDB_ID_VAL
]

181 
sÿn
 = 
£lf
.
bË_v›w
.
	`g‘_sÿn
(
¥_mod–_id
)

182 if(
sÿn
 
is
 
NÚe
):

183 
_logg”
.
	`”rÜ
('d–‘e_mod–: mod– %d dÛ nÙƒxi¡' % 
¥_mod–_id
)

187 if(
£lf
.
sšgË_ev_mod–
):

188 #Úly 
d–‘e
 
ev
 
»giÚ
 
we
 
¬e
 
d–‘šg
 
the
 
Ï¡
 
of
h
¥©Ÿl
 
»giÚs


189 if(
	`Ën
(
£lf
.
	`g‘_»giÚs
()) == 1):

190 
£lf
.
ev_£l_widg‘
.
	`d–‘e_mod–
(
sÿn
[
SPDB_EV_ID
])

192 
£lf
.
ev_£l_widg‘
.
	`d–‘e_mod–
(
sÿn
[
SPDB_EV_ID
])

193 
£lf
.
	`Ú_d–‘e_»giÚ
(
¥_mod–_id
)

194 #£lf.
bË_v›w
.
	`»move_mod–
(
¥_mod–_id
)

196 
¥_db
 = 
	`make_¥©Ÿl_db_diù
()

197 
¥_db
[
WDGCOM_CMND
] = 
widg‘_com_cmnd_ty³s
.
DEL_ROI


198 
	`dù_put
(
¥_db
, 
SPDB_ID_VAL
, 
¥_mod–_id
)

200 if(
sÿn
[
SPDB_X
]['NPOINTS'] == 1):

201 
sÿn_ty³
 = 
sÿn_ty³s
.
SAMPLE_POINT_SPECTRUM


202 #¥_db['SCAN_PLUGGIN']['ITEM']['TYPE'] = 
¥©Ÿl_ty³_´efix
.
PNT


203 
	`dù_put
(
¥_db
, 
SPDB_PLOT_SHAPE_TYPE
, 
¥©Ÿl_ty³_´efix
.
PNT
)

205 
sÿn_ty³
 = 
sÿn_ty³s
.
SAMPLE_IMAGE


206 #¥_db['SCAN_PLUGGIN']['ITEM']['TYPE'] = 
¥©Ÿl_ty³_´efix
.
ROI


207 
	`dù_put
(
¥_db
, 
SPDB_PLOT_SHAPE_TYPE
, 
¥©Ÿl_ty³_´efix
.
ROI
)

209 
	`dù_put
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
, 
sÿn_ty³
)

211 
£lf
.
roi_d–‘ed
.
	`em™
(
¥_db
)

212 #fÜû 
ª
 
upd©e
 
of
 
the
 
v›w
 
by
 
£Ëùšg
h
fœ¡
 
row
 
aá”
 
a
 
d–‘iÚ


213 #£lf.
bË_v›w
.
	`£Ëù_row
(
row_idx
=0)

214 
£lf
.
	`de£Ëù_®l
()

216 
£lf
.
	`check_if_bË_em±y
()

218 
def
 
	$check_if_bË_em±y
(
£lf
):

219 if(
£lf
.
bË_v›w
.
	`g‘_num_rows
() <= 0):

220 
£lf
.
ev_£l_widg‘
.
	`’abË_add_»giÚ
(
F®£
)

221 
£lf
.
	`»£t_sšgË_ev_mode_id
()

223 #if(
nÙ
 
£lf
.
sšgË_ev_mod–
):

224 
£lf
.
ev_£l_widg‘
.
	`’abË_add_»giÚ
(
True
)

225 #£lf.
sšgË_ev_mod–_id
 = 
£lf
.
	`g‘_cur_mod–_id
()

226 
£lf
.
sšgË_ev_mod–_id
 = s–f.
ev_£l_widg‘
.
	`g‘_cur_mod–_id
()

228 
def
 
	$»£t_sšgË_ev_mode_id
(
£lf
):

229 
£lf
.
sšgË_ev_mod–_id
 = 
NÚe


231 
def
 
	$g‘_d©a
(
£lf
, 
mod–_id
=
NÚe
):

233 
	$g‘_d©a
(): 
desütiÚ


235 :
·¿m
 
mod–_id
=
NÚe
: mod–_id=NÚ
desütiÚ


236 :
ty³
 
mod–_id
=
NÚe
: model_id=Noneype

238 :
»tuºs
: 
NÚe


240 (
£lf
.
bË_v›w
.
	`g‘_sÿn_li¡
(
mod–_id
))

242 
def
 
	$g‘_cur_mod–_id
(
£lf
):

244 
	$g‘_cur_mod–_id
(): 
desütiÚ


246 :
»tuºs
: 
NÚe


248 (
£lf
.
bË_v›w
.
mod–_id
)

250 
def
 
	$Ú_row_£Ëùed
(
£lf
, 
sÿn
):

252 
	$Ú_row_£Ëùed
(): 
desütiÚ


254 :
·¿m
 
sÿn
: sÿÀ
desütiÚ


255 :
ty³
 
sÿn
: scanype

257 :
»tuºs
: 
NÚe


259 #´šˆ'SPATIAL mod–_ID %d s–eùed EV_ID=%d' % (
sÿn
[
SPDB_ID_VAL
], sÿn[
SPDB_EV_ID
])

260 
£lf
.
ev_£l_widg‘
.
	`sw™ch_v›w_mod–
(
sÿn
[
SPDB_EV_ID
])

261 
£lf
.
ev_£l_widg‘
.
bË_v›w
.
	`£Ëù_row
()

262 
£lf
.
mod–_chªge
.
	`em™
(
sÿn
[
SPDB_ID_VAL
])

264 
def
 
	$sw™ch_v›w_mod–
(
£lf
, 
mod–_id
):

266 
	$sw™ch_v›w_mod–
(): 
desütiÚ


268 :
·¿m
 
mod–_id
: mod–_id 
desütiÚ


269 :
ty³
 
mod–_id
: model_idype

271 :
»tuºs
: 
NÚe


273 
£lf
.
bË_v›w
.
	`sw™ch_mod–s
(
mod–_id
)

275 
def
 
	$ş—r_bË
(
£lf
):

277 
	$ş—r_bË
(): 
desütiÚ


279 :
»tuºs
: 
NÚe


281 
£lf
.
	`»£t_sšgË_ev_mode_id
()

282 
£lf
.
bË_v›w
.
	`»move_®l
()

284 
def
 
	$£t_ed™abË
(
£lf
, 
ed
):

286 
	$£t_ed™abË
(): 
desütiÚ


288 :
·¿m
 
ed
:ƒd 
desütiÚ


289 :
ty³
 
ed
:ƒdype

291 :
»tuºs
: 
NÚe


293 
£lf
.
bË_v›w
.
	`£t_mod–_ed™abË
(
ed
)

295 
def
 
	$g‘_»giÚs
(
£lf
):

297 
	$g‘_»giÚs
(): 
desütiÚ


299 :
»tuºs
: 
NÚe


301 
rois
 = 
£lf
.
bË_v›w
.
	`mod–
().
	`g‘_sÿns
()

302 (
rois
)

304 
def
 
	$Ú_Ãw_»giÚ
(
£lf
, 
sÿn
=
NÚe
, 
add_’”gy_roi
=
True
):

306 
	$Ú_Ãw_»giÚ
(): 
Ú
 
Ãw
 
¥©Ÿl
 
»giÚ


308 :
·¿m
 
sÿn
=
NÚe
: sÿn=NÚ
desütiÚ


309 :
ty³
 
sÿn
=
NÚe
: scan=Noneype

311 :
»tuºs
: 
NÚe


313 if(
nÙ
 
£lf
.
add_»giÚ_’abËd
):

316 #sÿÀğ
	`g‘_ba£_’”gy_roi
('EV', 'ENERGY', 370, 395, 25.0, 10, 2.5, 
£lf
.
pŞ_roi
, s–f.
off_roi
, 
¡•Size
=
NÚe
, 
’abË
=
True
)

317 if(
sÿn
 
is
 
NÚe
):

319 #u£ 
´evious
 
sÿns
 
v®s
 
Ãw
 
¿nge


320 
cur_sÿn
 = 
cİy
.
	`d“pcİy
(
£lf
.
bË_v›w
.
	`g‘_cur_£Ëùed_sÿn
())

321 
¦i¡
 = 
£lf
.
bË_v›w
.
	`g‘_sÿn_li¡
()

322 if((
cur_sÿn
 
is
 
NÚe
è
	`ªd
 (
	`Ën
(
¦i¡
) == 0)):

323 #ü—‹ 
a
 

324 
x_roi
 = 
	`g‘_ba£_roi
(
SPDB_X
, 
£lf
.
xpos_Çme
, 0, 100, 20, 
¡•Size
=
NÚe
, 
max_sÿn_¿nge
=NÚe, 
’abË
=
True
)

325 
y_roi
 = 
	`g‘_ba£_roi
(
SPDB_Y
, 
£lf
.
ypos_Çme
, 0, 100, 20, 
¡•Size
=
NÚe
, 
max_sÿn_¿nge
=NÚe, 
’abË
=
True
)

326 
sÿn
 = 
	`make_¥©Ÿl_db_diù
(
x_roi
=x_roi, 
y_roi
=y_roi)

328 #g‘ 
the
 
Ï¡
 
Úe


329 if(
	`Ën
(
¦i¡
) > 0):

330 
cur_sÿn
 = 
¦i¡
[-1]

332 
x_roi
 = 
	`g‘_ba£_roi
(
SPDB_X
, 
£lf
.
xpos_Çme
, 
cur_sÿn
[SPDB_X]['CENTER'], cur_sÿn[SPDB_X]['RANGE'], cur_sÿn[SPDB_X]['NPOINTS'], 
¡•Size
=
NÚe
, 
max_sÿn_¿nge
=NÚe, 
’abË
=
True
)

333 
y_roi
 = 
	`g‘_ba£_roi
(
SPDB_Y
, 
£lf
.
ypos_Çme
, 
cur_sÿn
[SPDB_Y]['CENTER'], cur_sÿn[SPDB_Y]['RANGE'], cur_sÿn[SPDB_Y]['NPOINTS'], 
¡•Size
=
NÚe
, 
max_sÿn_¿nge
=NÚe, 
’abË
=
True
)

334 
sÿn
 = 
	`make_¥©Ÿl_db_diù
(
x_roi
=x_roi, 
y_roi
=y_roi)

335 #£lf.
sÿn_id
 += 1

336 
£lf
.
sÿn_id
 = s–f.
bË_v›w
.
	`g‘_Ãxt_mod–_id
()

338 
£lf
.
sÿn_id
 = 
sÿn
[
SPDB_ID_VAL
]

340 #dù_put(
sÿn
, 
SPDB_SCAN_PLUGIN_ITEM_ID
, 
£lf
.
sÿn_id
)

341 
£lf
.
bË_v›w
.
	`£t_mod–_id_¡¬t_v®
(£lf.
sÿn_id
)

342 if((
add_’”gy_roi
è
	$ªd
 (
£lf
.
ev_£l_widg‘
 
is
 
nÙ
 
NÚe
)):

343 #ü—‹ 
a
 
Ãw
 
ev
 
roi
 
mod–
 
w™h
 
the
 
sÿn
[
SPDB_ID_VAL
] 
as
 
™s
 
key


344 if(
£lf
.
sšgË_ev_mod–
):

345 if(
£lf
.
sšgË_ev_mod–_id
 
is
 
NÚe
):

346 
sÿn
[
SPDB_EV_ID
] = 
£lf
.
ev_£l_widg‘
.
bË_v›w
.
	`ü—‹_Ãw_mod–
()

347 
£lf
.
sšgË_ev_mod–_id
 = 
sÿn
[
SPDB_EV_ID
]

348 
£lf
.
ev_£l_widg‘
.
	`’abË_add_»giÚ_m’u
(
True
)

349 
£lf
.
ev_£l_widg‘
.
	`Ú_Ãw_»giÚ
()

351 
sÿn
[
SPDB_EV_ID
] = 
£lf
.
sšgË_ev_mod–_id


353 
sÿn
[
SPDB_EV_ID
] = 
£lf
.
ev_£l_widg‘
.
bË_v›w
.
	`ü—‹_Ãw_mod–
()

354 
£lf
.
sšgË_ev_mod–_id
 = 
sÿn
[
SPDB_EV_ID
]

355 
£lf
.
ev_£l_widg‘
.
	`Ú_Ãw_»giÚ
()

356 #£lf.
ev_£l_widg‘
.
	`Ú_Ãw_»giÚ
()

357 
£lf
.
bË_v›w
.
	`add_sÿn
(
sÿn
, s–f.
sÿn_id
)

358 
£lf
.
	`check_if_bË_em±y
()

361 
def
 
	$lßd_sÿn
(
£lf
, 
lßded_sÿn
=
NÚe
):

363 
	$Ú_Ãw_»giÚ
(): 
desütiÚ


365 :
·¿m
 
sÿn
=
NÚe
: sÿn=NÚ
desütiÚ


366 :
ty³
 
sÿn
=
NÚe
: scan=Noneype

368 :
»tuºs
: 
NÚe


370 #sÿÀğ
	`g‘_ba£_’”gy_roi
('EV', 'ENERGY', 370, 395, 25.0, 10, 2.5, 
£lf
.
pŞ_roi
, s–f.
off_roi
, 
¡•Size
=
NÚe
, 
’abË
=
True
)

371 if(
lßded_sÿn
 
is
 
NÚe
):

372 
_logg”
.
	`”rÜ
('SpatialSelWidget:†oad_scan,‚o scan…rovided')

375 #x_ro˜ğ
	`g‘_ba£_roi
(
SPDB_X
, 
lßded_sÿn
[SPDB_X]['POSITIONER'],†ßded_sÿn[SPDB_X]['CENTER'],†ßded_sÿn[SPDB_X]['RANGE'],†ßded_sÿn[SPDB_X]['NPOINTS'], 
¡•Size
=
NÚe
, 
max_sÿn_¿nge
=NÚe, 
’abË
=
True
)

376 #y_ro˜ğ
	`g‘_ba£_roi
(
SPDB_Y
, 
lßded_sÿn
[SPDB_Y]['POSITIONER'],†ßded_sÿn[SPDB_Y]['CENTER'],†ßded_sÿn[SPDB_Y]['RANGE'],†ßded_sÿn[SPDB_Y]['NPOINTS'], 
¡•Size
=
NÚe
, 
max_sÿn_¿nge
=NÚe, 
’abË
=
True
)

377 #sÿÀğ
	`make_¥©Ÿl_db_diù
(
x_roi
=x_roi, 
y_roi
=y_roi)

378 #sÿn[
SPDB_ID_VAL
] = 
lßded_sÿn
[SPDB_ID_VAL]

379 #sÿn[
SPDB_EV_ID
] = 
lßded_sÿn
[SPDB_EV_ID]

380 #sÿn[
SPDB_EV_ROIS
] = 
lßded_sÿn
[SPDB_EV_ROIS]

382 
£lf
.
sÿn_id
 = 
lßded_sÿn
[
SPDB_ID_VAL
]

383 #ü—‹ 
a
 
Ãw
 
ev
 
roi
 
mod–
 
w™h
 
the
 
sÿn
[
SPDB_EV_ID
] 
as
 
™s
 
key


384 
£lf
.
ev_£l_widg‘
.
bË_v›w
.
	`ü—‹_Ãw_mod–
(
mod–_id
 = 
lßded_sÿn
[
SPDB_EV_ID
])

385 #mak
su»
 
th©
 
the
 
Ev
 
ªd
 
pŞ
 
widg‘s
 
know
 
they
 
¬e
 
®lowed
 
now
 
to
 
add
 
a
 
»giÚ


386 if(
nÙ
 
£lf
.
sšgË_ev_mod–
):

387 
£lf
.
ev_£l_widg‘
.
	`’abË_add_»giÚ
(
True
)

388 
£lf
.
ev_£l_widg‘
.
	`lßd_sÿn
(
lßded_sÿn
[
SPDB_EV_ROIS
])

390 
	`–if
(
£lf
.
sšgË_ev_mod–
 
	`ªd
 (
	`Ën
(£lf.
ev_£l_widg‘
.
	`g‘_ev_»giÚs
()) == 0)):

391 #w
¡l
 
Ãed
 
©
 
Ëa¡
 1 
ev
 
»giÚ


392 
£lf
.
ev_£l_widg‘
.
	`’abË_add_»giÚ
(
True
)

393 
£lf
.
ev_£l_widg‘
.
	`lßd_sÿn
(
lßded_sÿn
[
SPDB_EV_ROIS
])

394 #deø6 
£lf
.
ev_£l_widg‘
.
	`’abË_add_»giÚ
(
F®£
)

396 #£lf.
bË_v›w
.
	`»move_®l
()

397 
£lf
.
bË_v›w
.
	`add_sÿn
(
lßded_sÿn
, s–f.
sÿn_id
)

398 
£lf
.
	`check_if_bË_em±y
()

400 
def
 
	$add_sÿn
(
£lf
, 
lßded_sÿn
=
NÚe
):

402 
	$add_sÿn
(): 
desütiÚ


404 :
·¿m
 
sÿn
: sÿÀ
desütiÚ


405 :
ty³
 
sÿn
: scanype

407 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


408 :
ty³
 
sÿn_id
: scan_idype

410 :
»tuºs
: 
NÚe


413 
£lf
.
sÿn_id
 = 
lßded_sÿn
[
SPDB_ID_VAL
]

415 #ü—‹ 
a
 
Ãw
 
ev
 
roi
 
mod–
 
w™h
 
the
 
sÿn
[
SPDB_EV_ID
] 
as
 
™s
 
key


416 
£lf
.
ev_£l_widg‘
.
bË_v›w
.
	`ü—‹_Ãw_mod–
(
mod–_id
 = 
lßded_sÿn
[
SPDB_EV_ID
])

417 
£lf
.
ev_£l_widg‘
.
	`lßd_sÿn
(
lßded_sÿn
[
SPDB_EV_ROIS
])

418 
£lf
.
bË_v›w
.
	`add_sÿn
(
lßded_sÿn
, s–f.
sÿn_id
)

419 
£lf
.
	`check_if_bË_em±y
()

423 
def
 
	$Ú_d–‘e_»giÚ
(
£lf
, 
sÿn_id
=
NÚe
):

425 
	$Ú_d–‘e_»giÚ
(): 
desütiÚ


427 :
·¿m
 
sÿn_id
=
NÚe
: sÿn_id=NÚ
desütiÚ


428 :
ty³
 
sÿn_id
=
NÚe
: scan_id=Noneype

430 :
»tuºs
: 
NÚe


432 if(
sÿn_id
 
is
 
NÚe
):

433 
sÿn
 = 
£lf
.
bË_v›w
.
	`g‘_cur_£Ëùed_sÿn
()

434 
sÿn_id
 = 
sÿn
[
SPDB_ID_VAL
]

436 
´št
 '¥©ŸÈd–‘šg[%d]' % 
sÿn_id


437 
£lf
.
bË_v›w
.
	`»move_sÿn
(
sÿn_id
)

438 
£lf
.
	`check_if_bË_em±y
()

441 
def
 
	$Ú_sšgË_»giÚ
(
£lf
):

443 
	$Ú_sšgË_»giÚ
(): 
desütiÚ


445 :
»tuºs
: 
NÚe


447 
£lf
.
bË_v›w
.
	`mod–
().
	`»move_®l_exû±_fœ¡
(£lf.
sÿn_id
)

450 
def
 
	$’abË_muÉi_¥©Ÿl
(
£lf
, 
v®
):

451 if(
v®
):

452 
£lf
.
bË_v›w
.
	`mod–
().
	`£t_max_rows
(
MAX_SPATIAL_ROWS
)

454 #®low 
Úly
 
a
 
sšgË
 
row


455 
£lf
.
bË_v›w
.
	`mod–
().
	`£t_max_rows
(1)

	@widgets/scan_table_view/spatialSelWidget.py

1 
äom
 
PyQt5
 
impÜt
 
	guic


3 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
ba£SÿnTabË
 
	gimpÜt
 *

4 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
¥©ŸlTabËV›w
 
impÜt
 
	gS·tŸlSÿnTabËV›w


5 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


7 
	g_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

9 
şass
 
	$S·tŸlS–Widg‘
(
Ba£S–eùiÚWidg‘
):

11 
A
 
QWidg‘
 
th©
 
cÚšs
 
ª
 
S·tŸlSÿnTabËV›w
, 
ÿn
 
be
 
cÚfigu»d
 
to
 
cÚÃù
Ø
ev_£l_widg‘


13 
roi_d–‘ed
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
)

14 
¥©Ÿl_row_chªged
 = 
QtCÜe
.
	`pyqtSigÇl
(
objeù
)

16 
def
 
	$__š™__
(
£lf
, 
ev_£l_widg‘
=
NÚe
, 
u£_ûÁ”
=
True
, 
is_pošt
=
F®£
, 
is_¬b_lše
=F®£, 
sšgË_ev_mod–
=False):

18 
	$__š™__
(): 
desütiÚ


20 :
·¿m
 
ev_£l_widg‘
=
NÚe
:ƒv_£l_widg‘=NÚ
desütiÚ


21 :
ty³
 
ev_£l_widg‘
=
NÚe
:ƒv_sel_widget=Noneype

23 :
·¿m
 
u£_ûÁ”
: 
True
 
the
 
h—d”
 
th©
 
is
 
u£d
 
wl
 
u£
 
C’‹rX
 
C’‹rY
, 
Ùh”wi£
 
™
 wÈu£ 
S¹X
, 
S¹Y


24 :
ty³
 
u£_ûÁ”
: 
boŞ


26 :
·¿m
 
is_pošt
: 
dÛs
 
the
 
¥©Ÿl
 
roi
 
»´e£Á
 
a
 
pošt
 
sÿn
?

27 :
ty³
 
is_pošt
: 
boŞ


29 :
·¿m
 
is_¬b_lše
: 
dÛs
 
the
 
¥©Ÿl
 
roi
 
»´e£Á
 
a
 
¬b™¿ry
 
lše
 
sÿn
?

30 :
ty³
 
is_¬b_lše
: 
boŞ


33 :
·¿m
 
sšgË_mod–
: 
this
 
æag
 
decides
 
mutË
 
ev_roi
 
mod–s
 
¬e
 
®lowed
,hi 
is
 
u£ful
 
to
 
£t
 
™
Ø
True


34 
š
 
the
 
wh”e
 
I
 
wªt
 
to
 
»u£
 
a
 
sšgË
 
ev_roi
 
mutË
 
¥©Ÿl
 
roi
's

35 :
ty³
 
sšgË_mod–
: 
boŞ—n


39 :
»tuºs
: 
NÚe


41 
Ba£S–eùiÚWidg‘
.
	`__š™__
(
£lf
)

42 #£tGeom‘ry(
x_pos
, 
y_pos
, 
width
, 
height
)

43 
£lf
.
	`£tGeom‘ry
(300, 200, 870, 450)

44 
£lf
.
	`£tWšdowT™Ë
("Click on columnitleo sort")

45 
£lf
.
ed™abË
 = 
F®£


46 
£lf
.
add_»giÚ_’abËd
 = 
True


47 
£lf
.
ev_£l_widg‘
 =ƒv_sel_widget

49 
£lf
.
u£_ûÁ”
 = use_center

50 
£lf
.
sšgË_ev_mod–
 = single_ev_model

51 
£lf
.
sšgË_ev_mod–_id
 = 
NÚe


52 if(
sšgË_ev_mod–
):

53 
£lf
.
ev_£l_widg‘
.
	`£t_sšgË_ev_mod–
(
True
)

55 
£lf
.
ev_£l_widg‘
.
	`£t_sšgË_ev_mod–
(
F®£
)

57 
£lf
.
bË_v›w
 = 
	`S·tŸlSÿnTabËV›w
(
u£_ûÁ”
=u£_ûÁ”, 
is_pošt
=is_pošt, 
is_¬b_lše
=is_arb_line)

58 
£lf
.
sÿn_id
 = 0 #£lf.
bË_v›w
.
	`g‘_mod–_id_¡¬t_v®
()

59 
£lf
.
bË_v›w
.
	`ü—‹_Ãw_mod–
(
u£_ûÁ”
=use_center)

60 
£lf
.
bË_v›w
.
	`£t_mod–_id_¡¬t_v®
(0)

61 
£lf
.
bË_v›w
.
	`£t_mod–_cŞumn_deçuÉs
()

62 #£lf.
	`Ú_Ãw_»giÚ
()

63 
£lf
.
xpos_Çme
 = 
DNM_SAMPLE_X


64 
£lf
.
ypos_Çme
 = 
DNM_SAMPLE_Y


65 #£ˆ
fÚt


66 #£ˆ
cŞumn
 
width
 
to
 
f™
 
	`cÚ‹Ás
 (
£t
 
fÚt
 
fœ¡
!)

67 
£lf
.
bË_v›w
.
	`»sizeCŞumnsToCÚ‹Ás
()

68 
£lf
.
bË_v›w
.
	`£tSÜtšgEÇbËd
(
F®£
)

70 
Ïyout
 = 
QtWidg‘s
.
	`QVBoxLayout
(
£lf
)

71 
Ïyout
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

72 
Ïyout
.
	`addWidg‘
(
£lf
.
bË_v›w
)

73 
£lf
.
	`£tLayout
(
Ïyout
)

74 
£lf
.
	`ş—rFocus
()

76 
£lf
.
ev_£l_widg‘
.
chªged
.
	`cÚÃù
(£lf.
Ú_ev_bË_chªged
)

78 
£lf
.
bË_v›w
.
sÿn_chªged
.
	`cÚÃù
(£lf.
Ú_sÿn_chªged
)

79 
£lf
.
bË_v›w
.
d–_»giÚ
.
	`cÚÃù
(£lf.
d–‘e_row
)

80 
£lf
.
bË_v›w
.
row_£Ëùed
.
	`cÚÃù
(£lf.
Ú_row_£Ëùed
)

82 
£lf
.
bË_v›w
.
add_»giÚ
.
	`cÚÃù
(£lf.
Ú_Ãw_»giÚ
)

85 
def
 
	$£t_pos™iÚ”s
(
£lf
, 
xpos_Çme
, 
ypos_Çme
):

86 
£lf
.
xpos_Çme
 = xpos_name

87 
£lf
.
ypos_Çme
 = ypos_name

90 
def
 
	$£t_¥©Ÿl_¿nge
(
£lf
, 
q»ù
):

93 
£lf
.
bË_v›w
.
	`£t_x_¥©Ÿl_¿nge
(
q»ù
.
	$width
()è#(
xËá
, 
ytİ
, 
width
, 
height
)

94 
£lf
.
bË_v›w
.
	`£t_y_¥©Ÿl_¿nge
(
q»ù
.
	$height
()è#(
xËá
, 
ytİ
, 
width
, 
height
)

96 
def
 
	$£t_¥©Ÿl_¡¬t¡İ
(
£lf
, 
q»ù
):

98 (
x1
, 
y1
, 
x2
, 
y2
èğ
q»ù
.
	`g‘CoÜds
()

99 
£lf
.
bË_v›w
.
	`£t_x_¥©Ÿl_¡¬t¡İ
((
x1
, 
x2
)è#(
xËá
, 
ytİ
, 
width
, 
height
)

100 
£lf
.
bË_v›w
.
	`£t_x_¥©Ÿl_¿nge
((
y1
, 
y2
)è#(
xËá
, 
ytİ
, 
width
, 
height
)

103 
def
 
	$’abË_add_»giÚ_m’u
(
£lf
, do=
True
):

105 
£lf
.
add_»giÚ_’abËd
 = do

107 
def
 
	$Ú_ev_bË_chªged
(
£lf
):

109 
sÿn
 = 
£lf
.
	`g‘_row_d©a_by_™em_id
(£lf.
sÿn_id
)

110 
£lf
.
¥©Ÿl_row_chªged
.
	`em™
(
sÿn
)

113 
def
 
	$Ú_sÿn_chªged
(
£lf
, 
row
, 
sÿn
):

115 #´šˆ'S·tŸlS–Widg‘: on_sÿn_chªged„ow(%dèsÿn_id(%d)' % (
row
, 
sÿn
[
SPDB_ID_VAL
])

116 #_logg”.
	`debug
('SpatialSelWidget: on_scan_changed,ƒmitting spatial_row_changed sig')

117 
£lf
.
¥©Ÿl_row_chªged
.
	`em™
(
sÿn
)

118 
£lf
.
	`check_if_bË_em±y
()

120 
def
 
	$de£Ëù_®l
(
£lf
):

121 
£lf
.
bË_v›w
.
	`ş—rS–eùiÚ
()

123 
def
 
	$£Ëù_row
(
£lf
, 
row_idx
=
NÚe
, 
™em_id
=None):

124 if(
row_idx
 
is
 
nÙ
 
NÚe
):

125 
£lf
.
bË_v›w
.
	`£Ëù_row
(
row_idx
)

126 
	$–if
(
™em_id
 
is
 
nÙ
 
NÚe
):

127 
row_idx
 = 
£lf
.
bË_v›w
.
bËmod–
.
	`g‘_sÿn_rowidx
(
™em_id
)

128 
£lf
.
bË_v›w
.
	`£Ëù_row
(
row_idx
)

130 
def
 
	$g‘_row_idx
(
£lf
, 
™em_id
):

131 (
£lf
.
bË_v›w
.
bËmod–
.
	`g‘_sÿn_rowidx
(
™em_id
))

133 
def
 
	$g‘_row_d©a_by_™em_id
(
£lf
, 
™em_id
):

134 (
£lf
.
bË_v›w
.
	`g‘_sÿn
(
™em_id
))

136 
def
 
	$modify_row_d©a
(
£lf
, 
™em_id
, 
sÿn
):

137 
£lf
.
bË_v›w
.
	`modify_sÿn
(
™em_id
, 
sÿn
)

139 
def
 
	$»move_mod–
(
£lf
, 
mod–_id
):

141 
	$»move_mod–
(): 
desütiÚ


143 :
·¿m
 
mod–_id
: mod–_id 
desütiÚ


144 :
ty³
 
mod–_id
: model_idype

146 :
»tuºs
: 
NÚe


148 
£lf
.
bË_v›w
.
	`»move_mod–
(
mod–_id
)

149 
£lf
.
	`check_if_bË_em±y
()

150 
£lf
.
	`de£Ëù_®l
()

152 
def
 
	$d–‘e_row
(
£lf
, 
¥_mod–_id
=
NÚe
):

154 
	$d–‘e_mod–
(): 
desütiÚ


156 :
·¿m
 
¥_mod–_id
=
NÚe
: sp_mod–_id=NÚ
desütiÚ


157 :
ty³
 
¥_mod–_id
=
NÚe
: sp_model_id=Noneype

159 :
»tuºs
: 
NÚe


162 
This
 
funùiÚ
 
is
 
ÿÎed
 
by
 
the
 
right
 
şick
 
m’u
 
aùiÚ
 
d–‘šg
 
a
 
row
.

164 
this
 
funùiÚ
 
kes
 
the
 
mod–_id
 
of
h
desœed
 
¥©Ÿl
 
»giÚ


165 
th©
 
Ãeds
 
to
 
be
 
d–‘ed
. 
FÜ
 
¥©Ÿl
 
mod–s
 
the
 
£qu’û
 
d–‘iÚ
 
is
 
as
 
fŞows
:

166 - 
fšd
 
the
 
mod–_id
 
of
h
EV
 
mod–
 
th©
hmod– 
we
 
¬e
 
d–‘šg
 
is
 
cÚÃùed
 
	`to
 ([
SPDB_EV_ID
])

167 - 
ÿÎ
 
the
 
£lf
.
ev_£l_widg‘
 'd–‘e_mod–' 
w™h
h
EV
 
mod–_id
, ([
SPDB_EV_ID
])

168 - 
ÿÎ
 'remove_model(sp_model_id)'

169 - 
ü—‹
 
a
 
Ãw
 
widg‘_com
 
diù
 
ªd
 
£t
 
the
 
»Ëvªt
 
f›lds
 
so
 
th©
 
ªy
 
Ùh”
 
widg‘
 
li¡’šg


170 
wl
 
be
 
giv’
 
®l
 
of
 
the
 
šfÜm©iÚ
 
»quœed
 
to
 
d–‘e
 
this
 
ROI
 
äom
 
™s
 
cÚ‹Ás
,

171 - 
em™
 
the
 
¥_db
 
diù
 
w™h
h
commªd
 
DEL_ROI


172 - 
fÜû
 
ª
 
upd©e
 
of
 
the
 
bË
 
v›w
 
by
 
£Ëùšg
h
fœ¡
 
row
 oàth
¥©Ÿl
able

174 if(
¥_mod–_id
 
is
 
NÚe
):

175 
sÿn
 = 
£lf
.
bË_v›w
.
	`g‘_cur_£Ëùed_sÿn
()

176 if(
sÿn
 
is
 
NÚe
):

177 #nØ
mÜe
 
sÿns
 
Ëá


179 
¥_mod–_id
 = 
sÿn
[
SPDB_ID_VAL
]

181 
sÿn
 = 
£lf
.
bË_v›w
.
	`g‘_sÿn
(
¥_mod–_id
)

182 if(
sÿn
 
is
 
NÚe
):

183 
_logg”
.
	`”rÜ
('d–‘e_mod–: mod– %d dÛ nÙƒxi¡' % 
¥_mod–_id
)

187 if(
£lf
.
sšgË_ev_mod–
):

188 #Úly 
d–‘e
 
ev
 
»giÚ
 
we
 
¬e
 
d–‘šg
 
the
 
Ï¡
 
of
h
¥©Ÿl
 
»giÚs


189 if(
	`Ën
(
£lf
.
	`g‘_»giÚs
()) == 1):

190 
£lf
.
ev_£l_widg‘
.
	`d–‘e_mod–
(
sÿn
[
SPDB_EV_ID
])

192 
£lf
.
ev_£l_widg‘
.
	`d–‘e_mod–
(
sÿn
[
SPDB_EV_ID
])

193 
£lf
.
	`Ú_d–‘e_»giÚ
(
¥_mod–_id
)

194 #£lf.
bË_v›w
.
	`»move_mod–
(
¥_mod–_id
)

196 
¥_db
 = 
	`make_¥©Ÿl_db_diù
()

197 
¥_db
[
WDGCOM_CMND
] = 
widg‘_com_cmnd_ty³s
.
DEL_ROI


198 
	`dù_put
(
¥_db
, 
SPDB_ID_VAL
, 
¥_mod–_id
)

200 if(
sÿn
[
SPDB_X
]['NPOINTS'] == 1):

201 
sÿn_ty³
 = 
sÿn_ty³s
.
SAMPLE_POINT_SPECTRUM


202 #¥_db['SCAN_PLUGGIN']['ITEM']['TYPE'] = 
¥©Ÿl_ty³_´efix
.
PNT


203 
	`dù_put
(
¥_db
, 
SPDB_PLOT_SHAPE_TYPE
, 
¥©Ÿl_ty³_´efix
.
PNT
)

205 
sÿn_ty³
 = 
sÿn_ty³s
.
SAMPLE_IMAGE


206 #¥_db['SCAN_PLUGGIN']['ITEM']['TYPE'] = 
¥©Ÿl_ty³_´efix
.
ROI


207 
	`dù_put
(
¥_db
, 
SPDB_PLOT_SHAPE_TYPE
, 
¥©Ÿl_ty³_´efix
.
ROI
)

209 
	`dù_put
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
, 
sÿn_ty³
)

211 
£lf
.
roi_d–‘ed
.
	`em™
(
¥_db
)

212 #fÜû 
ª
 
upd©e
 
of
 
the
 
v›w
 
by
 
£Ëùšg
h
fœ¡
 
row
 
aá”
 
a
 
d–‘iÚ


213 #£lf.
bË_v›w
.
	`£Ëù_row
(
row_idx
=0)

214 
£lf
.
	`de£Ëù_®l
()

216 
£lf
.
	`check_if_bË_em±y
()

218 
def
 
	$check_if_bË_em±y
(
£lf
):

219 if(
£lf
.
bË_v›w
.
	`g‘_num_rows
() <= 0):

220 
£lf
.
ev_£l_widg‘
.
	`’abË_add_»giÚ
(
F®£
)

221 
£lf
.
	`»£t_sšgË_ev_mode_id
()

223 #if(
nÙ
 
£lf
.
sšgË_ev_mod–
):

224 
£lf
.
ev_£l_widg‘
.
	`’abË_add_»giÚ
(
True
)

225 #£lf.
sšgË_ev_mod–_id
 = 
£lf
.
	`g‘_cur_mod–_id
()

226 
£lf
.
sšgË_ev_mod–_id
 = s–f.
ev_£l_widg‘
.
	`g‘_cur_mod–_id
()

228 
def
 
	$»£t_sšgË_ev_mode_id
(
£lf
):

229 
£lf
.
sšgË_ev_mod–_id
 = 
NÚe


231 
def
 
	$g‘_d©a
(
£lf
, 
mod–_id
=
NÚe
):

233 
	$g‘_d©a
(): 
desütiÚ


235 :
·¿m
 
mod–_id
=
NÚe
: mod–_id=NÚ
desütiÚ


236 :
ty³
 
mod–_id
=
NÚe
: model_id=Noneype

238 :
»tuºs
: 
NÚe


240 (
£lf
.
bË_v›w
.
	`g‘_sÿn_li¡
(
mod–_id
))

242 
def
 
	$g‘_cur_mod–_id
(
£lf
):

244 
	$g‘_cur_mod–_id
(): 
desütiÚ


246 :
»tuºs
: 
NÚe


248 (
£lf
.
bË_v›w
.
mod–_id
)

250 
def
 
	$Ú_row_£Ëùed
(
£lf
, 
sÿn
):

252 
	$Ú_row_£Ëùed
(): 
desütiÚ


254 :
·¿m
 
sÿn
: sÿÀ
desütiÚ


255 :
ty³
 
sÿn
: scanype

257 :
»tuºs
: 
NÚe


259 #´šˆ'SPATIAL mod–_ID %d s–eùed EV_ID=%d' % (
sÿn
[
SPDB_ID_VAL
], sÿn[
SPDB_EV_ID
])

260 
£lf
.
ev_£l_widg‘
.
	`sw™ch_v›w_mod–
(
sÿn
[
SPDB_EV_ID
])

261 
£lf
.
ev_£l_widg‘
.
bË_v›w
.
	`£Ëù_row
()

262 
£lf
.
mod–_chªge
.
	`em™
(
sÿn
[
SPDB_ID_VAL
])

264 
def
 
	$sw™ch_v›w_mod–
(
£lf
, 
mod–_id
):

266 
	$sw™ch_v›w_mod–
(): 
desütiÚ


268 :
·¿m
 
mod–_id
: mod–_id 
desütiÚ


269 :
ty³
 
mod–_id
: model_idype

271 :
»tuºs
: 
NÚe


273 
£lf
.
bË_v›w
.
	`sw™ch_mod–s
(
mod–_id
)

275 
def
 
	$ş—r_bË
(
£lf
):

277 
	$ş—r_bË
(): 
desütiÚ


279 :
»tuºs
: 
NÚe


281 
£lf
.
	`»£t_sšgË_ev_mode_id
()

282 
£lf
.
bË_v›w
.
	`»move_®l
()

284 
def
 
	$£t_ed™abË
(
£lf
, 
ed
):

286 
	$£t_ed™abË
(): 
desütiÚ


288 :
·¿m
 
ed
:ƒd 
desütiÚ


289 :
ty³
 
ed
:ƒdype

291 :
»tuºs
: 
NÚe


293 
£lf
.
bË_v›w
.
	`£t_mod–_ed™abË
(
ed
)

295 
def
 
	$g‘_»giÚs
(
£lf
):

297 
	$g‘_»giÚs
(): 
desütiÚ


299 :
»tuºs
: 
NÚe


301 
rois
 = 
£lf
.
bË_v›w
.
	`mod–
().
	`g‘_sÿns
()

302 (
rois
)

304 
def
 
	$Ú_Ãw_»giÚ
(
£lf
, 
sÿn
=
NÚe
, 
add_’”gy_roi
=
True
):

306 
	$Ú_Ãw_»giÚ
(): 
Ú
 
Ãw
 
¥©Ÿl
 
»giÚ


308 :
·¿m
 
sÿn
=
NÚe
: sÿn=NÚ
desütiÚ


309 :
ty³
 
sÿn
=
NÚe
: scan=Noneype

311 :
»tuºs
: 
NÚe


313 if(
nÙ
 
£lf
.
add_»giÚ_’abËd
):

316 #sÿÀğ
	`g‘_ba£_’”gy_roi
('EV', 'ENERGY', 370, 395, 25.0, 10, 2.5, 
£lf
.
pŞ_roi
, s–f.
off_roi
, 
¡•Size
=
NÚe
, 
’abË
=
True
)

317 if(
sÿn
 
is
 
NÚe
):

319 #u£ 
´evious
 
sÿns
 
v®s
 
Ãw
 
¿nge


320 
cur_sÿn
 = 
cİy
.
	`d“pcİy
(
£lf
.
bË_v›w
.
	`g‘_cur_£Ëùed_sÿn
())

321 
¦i¡
 = 
£lf
.
bË_v›w
.
	`g‘_sÿn_li¡
()

322 if((
cur_sÿn
 
is
 
NÚe
è
	`ªd
 (
	`Ën
(
¦i¡
) == 0)):

323 #ü—‹ 
a
 

324 
x_roi
 = 
	`g‘_ba£_roi
(
SPDB_X
, 
£lf
.
xpos_Çme
, 0, 100, 20, 
¡•Size
=
NÚe
, 
max_sÿn_¿nge
=NÚe, 
’abË
=
True
)

325 
y_roi
 = 
	`g‘_ba£_roi
(
SPDB_Y
, 
£lf
.
ypos_Çme
, 0, 100, 20, 
¡•Size
=
NÚe
, 
max_sÿn_¿nge
=NÚe, 
’abË
=
True
)

326 
sÿn
 = 
	`make_¥©Ÿl_db_diù
(
x_roi
=x_roi, 
y_roi
=y_roi)

328 #g‘ 
the
 
Ï¡
 
Úe


329 if(
	`Ën
(
¦i¡
) > 0):

330 
cur_sÿn
 = 
¦i¡
[-1]

332 
x_roi
 = 
	`g‘_ba£_roi
(
SPDB_X
, 
£lf
.
xpos_Çme
, 
cur_sÿn
[SPDB_X]['CENTER'], cur_sÿn[SPDB_X]['RANGE'], cur_sÿn[SPDB_X]['NPOINTS'], 
¡•Size
=
NÚe
, 
max_sÿn_¿nge
=NÚe, 
’abË
=
True
)

333 
y_roi
 = 
	`g‘_ba£_roi
(
SPDB_Y
, 
£lf
.
ypos_Çme
, 
cur_sÿn
[SPDB_Y]['CENTER'], cur_sÿn[SPDB_Y]['RANGE'], cur_sÿn[SPDB_Y]['NPOINTS'], 
¡•Size
=
NÚe
, 
max_sÿn_¿nge
=NÚe, 
’abË
=
True
)

334 
sÿn
 = 
	`make_¥©Ÿl_db_diù
(
x_roi
=x_roi, 
y_roi
=y_roi)

335 #£lf.
sÿn_id
 += 1

336 
£lf
.
sÿn_id
 = s–f.
bË_v›w
.
	`g‘_Ãxt_mod–_id
()

338 
£lf
.
sÿn_id
 = 
sÿn
[
SPDB_ID_VAL
]

340 #dù_put(
sÿn
, 
SPDB_SCAN_PLUGIN_ITEM_ID
, 
£lf
.
sÿn_id
)

341 
£lf
.
bË_v›w
.
	`£t_mod–_id_¡¬t_v®
(£lf.
sÿn_id
)

342 if((
add_’”gy_roi
è
	$ªd
 (
£lf
.
ev_£l_widg‘
 
is
 
nÙ
 
NÚe
)):

343 #ü—‹ 
a
 
Ãw
 
ev
 
roi
 
mod–
 
w™h
 
the
 
sÿn
[
SPDB_ID_VAL
] 
as
 
™s
 
key


344 if(
£lf
.
sšgË_ev_mod–
):

345 if(
£lf
.
sšgË_ev_mod–_id
 
is
 
NÚe
):

346 
sÿn
[
SPDB_EV_ID
] = 
£lf
.
ev_£l_widg‘
.
bË_v›w
.
	`ü—‹_Ãw_mod–
()

347 
£lf
.
sšgË_ev_mod–_id
 = 
sÿn
[
SPDB_EV_ID
]

348 
£lf
.
ev_£l_widg‘
.
	`’abË_add_»giÚ_m’u
(
True
)

349 
£lf
.
ev_£l_widg‘
.
	`Ú_Ãw_»giÚ
()

351 
sÿn
[
SPDB_EV_ID
] = 
£lf
.
sšgË_ev_mod–_id


353 
sÿn
[
SPDB_EV_ID
] = 
£lf
.
ev_£l_widg‘
.
bË_v›w
.
	`ü—‹_Ãw_mod–
()

354 
£lf
.
sšgË_ev_mod–_id
 = 
sÿn
[
SPDB_EV_ID
]

355 
£lf
.
ev_£l_widg‘
.
	`Ú_Ãw_»giÚ
()

356 #£lf.
ev_£l_widg‘
.
	`Ú_Ãw_»giÚ
()

357 
£lf
.
bË_v›w
.
	`add_sÿn
(
sÿn
, s–f.
sÿn_id
)

358 
£lf
.
	`check_if_bË_em±y
()

361 
def
 
	$lßd_sÿn
(
£lf
, 
lßded_sÿn
=
NÚe
):

363 
	$Ú_Ãw_»giÚ
(): 
desütiÚ


365 :
·¿m
 
sÿn
=
NÚe
: sÿn=NÚ
desütiÚ


366 :
ty³
 
sÿn
=
NÚe
: scan=Noneype

368 :
»tuºs
: 
NÚe


370 #sÿÀğ
	`g‘_ba£_’”gy_roi
('EV', 'ENERGY', 370, 395, 25.0, 10, 2.5, 
£lf
.
pŞ_roi
, s–f.
off_roi
, 
¡•Size
=
NÚe
, 
’abË
=
True
)

371 if(
lßded_sÿn
 
is
 
NÚe
):

372 
_logg”
.
	`”rÜ
('SpatialSelWidget:†oad_scan,‚o scan…rovided')

375 #x_ro˜ğ
	`g‘_ba£_roi
(
SPDB_X
, 
lßded_sÿn
[SPDB_X]['POSITIONER'],†ßded_sÿn[SPDB_X]['CENTER'],†ßded_sÿn[SPDB_X]['RANGE'],†ßded_sÿn[SPDB_X]['NPOINTS'], 
¡•Size
=
NÚe
, 
max_sÿn_¿nge
=NÚe, 
’abË
=
True
)

376 #y_ro˜ğ
	`g‘_ba£_roi
(
SPDB_Y
, 
lßded_sÿn
[SPDB_Y]['POSITIONER'],†ßded_sÿn[SPDB_Y]['CENTER'],†ßded_sÿn[SPDB_Y]['RANGE'],†ßded_sÿn[SPDB_Y]['NPOINTS'], 
¡•Size
=
NÚe
, 
max_sÿn_¿nge
=NÚe, 
’abË
=
True
)

377 #sÿÀğ
	`make_¥©Ÿl_db_diù
(
x_roi
=x_roi, 
y_roi
=y_roi)

378 #sÿn[
SPDB_ID_VAL
] = 
lßded_sÿn
[SPDB_ID_VAL]

379 #sÿn[
SPDB_EV_ID
] = 
lßded_sÿn
[SPDB_EV_ID]

380 #sÿn[
SPDB_EV_ROIS
] = 
lßded_sÿn
[SPDB_EV_ROIS]

382 
£lf
.
sÿn_id
 = 
lßded_sÿn
[
SPDB_ID_VAL
]

383 #ü—‹ 
a
 
Ãw
 
ev
 
roi
 
mod–
 
w™h
 
the
 
sÿn
[
SPDB_EV_ID
] 
as
 
™s
 
key


384 
£lf
.
ev_£l_widg‘
.
bË_v›w
.
	`ü—‹_Ãw_mod–
(
mod–_id
 = 
lßded_sÿn
[
SPDB_EV_ID
])

385 #mak
su»
 
th©
 
the
 
Ev
 
ªd
 
pŞ
 
widg‘s
 
know
 
they
 
¬e
 
®lowed
 
now
 
to
 
add
 
a
 
»giÚ


386 if(
nÙ
 
£lf
.
sšgË_ev_mod–
):

387 
£lf
.
ev_£l_widg‘
.
	`’abË_add_»giÚ
(
True
)

388 
£lf
.
ev_£l_widg‘
.
	`lßd_sÿn
(
lßded_sÿn
[
SPDB_EV_ROIS
])

390 
	`–if
(
£lf
.
sšgË_ev_mod–
 
	`ªd
 (
	`Ën
(£lf.
ev_£l_widg‘
.
	`g‘_ev_»giÚs
()) == 0)):

391 #w
¡l
 
Ãed
 
©
 
Ëa¡
 1 
ev
 
»giÚ


392 
£lf
.
ev_£l_widg‘
.
	`’abË_add_»giÚ
(
True
)

393 
£lf
.
ev_£l_widg‘
.
	`lßd_sÿn
(
lßded_sÿn
[
SPDB_EV_ROIS
])

394 #deø6 
£lf
.
ev_£l_widg‘
.
	`’abË_add_»giÚ
(
F®£
)

396 #£lf.
bË_v›w
.
	`»move_®l
()

397 
£lf
.
bË_v›w
.
	`add_sÿn
(
lßded_sÿn
, s–f.
sÿn_id
)

398 
£lf
.
	`check_if_bË_em±y
()

400 
def
 
	$add_sÿn
(
£lf
, 
lßded_sÿn
=
NÚe
):

402 
	$add_sÿn
(): 
desütiÚ


404 :
·¿m
 
sÿn
: sÿÀ
desütiÚ


405 :
ty³
 
sÿn
: scanype

407 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


408 :
ty³
 
sÿn_id
: scan_idype

410 :
»tuºs
: 
NÚe


413 
£lf
.
sÿn_id
 = 
lßded_sÿn
[
SPDB_ID_VAL
]

415 #ü—‹ 
a
 
Ãw
 
ev
 
roi
 
mod–
 
w™h
 
the
 
sÿn
[
SPDB_EV_ID
] 
as
 
™s
 
key


416 
£lf
.
ev_£l_widg‘
.
bË_v›w
.
	`ü—‹_Ãw_mod–
(
mod–_id
 = 
lßded_sÿn
[
SPDB_EV_ID
])

417 
£lf
.
ev_£l_widg‘
.
	`lßd_sÿn
(
lßded_sÿn
[
SPDB_EV_ROIS
])

418 
£lf
.
bË_v›w
.
	`add_sÿn
(
lßded_sÿn
, s–f.
sÿn_id
)

419 
£lf
.
	`check_if_bË_em±y
()

423 
def
 
	$Ú_d–‘e_»giÚ
(
£lf
, 
sÿn_id
=
NÚe
):

425 
	$Ú_d–‘e_»giÚ
(): 
desütiÚ


427 :
·¿m
 
sÿn_id
=
NÚe
: sÿn_id=NÚ
desütiÚ


428 :
ty³
 
sÿn_id
=
NÚe
: scan_id=Noneype

430 :
»tuºs
: 
NÚe


432 if(
sÿn_id
 
is
 
NÚe
):

433 
sÿn
 = 
£lf
.
bË_v›w
.
	`g‘_cur_£Ëùed_sÿn
()

434 
sÿn_id
 = 
sÿn
[
SPDB_ID_VAL
]

436 
´št
 '¥©ŸÈd–‘šg[%d]' % 
sÿn_id


437 
£lf
.
bË_v›w
.
	`»move_sÿn
(
sÿn_id
)

438 
£lf
.
	`check_if_bË_em±y
()

441 
def
 
	$Ú_sšgË_»giÚ
(
£lf
):

443 
	$Ú_sšgË_»giÚ
(): 
desütiÚ


445 :
»tuºs
: 
NÚe


447 
£lf
.
bË_v›w
.
	`mod–
().
	`»move_®l_exû±_fœ¡
(£lf.
sÿn_id
)

450 
def
 
	$’abË_muÉi_¥©Ÿl
(
£lf
, 
v®
):

451 if(
v®
):

452 
£lf
.
bË_v›w
.
	`mod–
().
	`£t_max_rows
(
MAX_SPATIAL_ROWS
)

454 #®low 
Úly
 
a
 
sšgË
 
row


455 
£lf
.
bË_v›w
.
	`mod–
().
	`£t_max_rows
(1)

	@widgets/scan_table_view/spatialTableView.py

2 
C»©ed
 
Ú
 
	gNov
 16, 2016

4 @
	gauthÜ
: 
b”gr


6 
impÜt
 
numpy
 
as
 
Å


7 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui


8 
impÜt
 
	gcİy


9 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


11 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
bl10ID01
 
impÜt
 
	gMAIN_OBJ


12 
äom
 
	gşs
.
	guts
.
roi_uts
 
impÜt
 
	gg‘_ba£_roi
, 
	gg‘_ba£_’”gy_roi
, \

13 
	gg‘_•u_pŞ_dù
, 
	gmake_¥©Ÿl_db_diù
, 
	gwidg‘_com_cmnd_ty³s
, \

14 
	gÚ_¿nge_chªged
, 
	gÚ_Åošts_chªged
, 
	gÚ_¡•_size_chªged
, 
	gÚ_¡¬t_chªged
, 
	gÚ_¡İ_chªged
, \

15 
	gÚ_ûÁ”_chªged
, 
	g»ÿlc_£ošts
, 
	gg‘_unique_roi_id


17 
äom
 
	gşs
.
	gsÿÂšg
.
¡xmTy³s
 
impÜt
 
	gsÿn_ty³s
, 
	gsÿn_·Ãl_Üd”
, 
	gsÿn_image_ty³s
, 
	g¥©Ÿl_ty³_´efix
, 
	gIMAGE_LXL
, 
	gIMAGE_PXP
, 
	g’”gy_sÿn_Üd”_ty³s


19 
äom
 
	gşs
.
	guts
.
diù_uts
 
impÜt
 
	gdù_put
, 
	gdù_g‘


20 
äom
 
	gşs
.
	guts
.
roi_diù_defs
 
	gimpÜt
 *

21 
äom
 
	gbcm
.
	gdeviû
.
deviû_Çmes
 
	gimpÜt
 *

23 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
ba£SÿnTabË
 
	gimpÜt
 *

24 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
¬b™¿ryLšeTabËMod–
 
impÜt
 
	gArb™¿ryLšeSÿnTabËMod–


28 
şass
 
	$S·tŸlSÿnTabËMod–
(
Ba£SÿnTabËMod–
):

30 
sÿn_chªged
 = 
QtCÜe
.
	`pyqtSigÇl
(, 
objeù
)

32 
def
 
	$__š™__
(
£lf
, 
hdrLi¡
, 
d©aš
, 
·»Á
 = 
NÚe
, 
u£_ûÁ”
=
True
, 
is_¬b_lše
=
F®£
, *
¬gs
):

34 
	$__š™__
(): 
desütiÚ


36 :
·¿m
 
hdrLi¡
: hdrLi¡ 
desütiÚ


37 :
ty³
 
hdrLi¡
: hdrListype

39 :
·¿m
 
d©aš
: d©aš 
desütiÚ


40 :
ty³
 
d©aš
: datainype

42 :
·¿m
 
·»Á
=
NÚe
:…¬’t=NÚ
desütiÚ


43 :
ty³
 
·»Á
=
NÚe
:…arent=Noneype

45 :
·¿m
 *
¬gs
: *¬g 
desütiÚ


46 :
ty³
 *
¬gs
: *argsype

48 :
»tuºs
: 
NÚe


50 #QtCÜe.
QAb¡¿ùTabËMod–
.
	`__š™__
(
£lf
, 
·»Á
, *
¬gs
)

51 
	`su³r
(
S·tŸlSÿnTabËMod–
, 
£lf
).
	`__š™__
Ğ
hdrLi¡
, 
d©aš
, 
·»Á
, *
¬gs
)

52 #¨
diù
 
th©
 
wl
 
u£
 
¥©Ÿl
 
»giÚ
 
sÿn_id
' a keyØEÃrgyRegiÚSÿnDef'
s


53 
£lf
.
cur_sÿn_row
 = 
NÚe


54 
£lf
.
sÿnLi¡D©a
 = 
d©aš


55 
£lf
.
ed™abË
 = 
F®£


56 if('C’‹rX' 
š
 
hdrLi¡
):

57 
£lf
.
cŞumn_m­
 = 
C_SPATIAL_DCT


59 
£lf
.
cŞumn_m­
 = 
S_SPATIAL_DCT


61 
£lf
.
	`£t_mš_rows
(0)

62 
£lf
.
	`£t_max_rows
(20)

65 
def
 
	$d©a
(
£lf
, 
šdex
, 
rŞe
):

67 
ov”ride
 
ba£
 
bË
 
mod–
 
d©a
 
funùiÚ


68 
	$d©a
(): 
desütiÚ


70 :
·¿m
 
šdex
: index 
desütiÚ


71 :
ty³
 
šdex
: indexype

73 :
·¿m
 
rŞe
:„Ş
desütiÚ


74 :
ty³
 
rŞe
:„oleype

76 :
»tuºs
: 
NÚe


79 
row
 = 
šdex
.
	`row
()

80 
cŞ
 = 
šdex
.
	`cŞumn
()

81 
’abËd
 = 
F®£


83 
nÙ
 
šdex
.
	$isV®id
():

84 
´št
 'index is invalid'

85  
NÚe


87 
æags
 = 
šdex
.
	`æags
()

88 
æags
 & 
QtCÜe
.
Qt
.
I‹mIsEd™abË
:

89 
’abËd
 = 
True


91 
rŞe
 =ğ
QtCÜe
.
Qt
.
Di¥ÏyRŞe
:

92 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

93 if(
cŞ
 == 0):

94 
v
 = 
sÿn
[
SPDB_ID_VAL
]

96 
v
 = 
	`g‘_v®_äom_¥_db
(
£lf
.
cŞumn_m­
[
cŞ
]['hdr'], 
sÿn
)

97 #v = 
sÿn
[
£lf
.
cŞumn_m­
[
cŞ
]['hdr']]

99 if(
	$ty³
(
v
è
is
 
¡r
):

100 (
v
)

101 if(
	$ty³
(
v
è
is
 
Å
.
æßt64
):

102 
v®
 = '%.3f' % 
v


103 (
v®
)

104 if(
	$ty³
(
v
è
is
 ):

105 
v®
 = '%.3f' % 
v


106 (
v®
)

107 if(
	$ty³
(
v
è
is
 ):

108 
v®
 = '%d' % 
v


109 (
v®
)

110 if(
	$ty³
(
v
è
is
 ):

111 
v®
 = '%d' % 
v


112 (
v®
)

113 if(
	$ty³
(
v
è
is
 
boŞ
):

114 if(
v
):

119 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
BackgroundRŞe
:

120 if(
cŞ
 == 0):

121 
bg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
g¿y
)

122 
	`–if
(
cŞ
 < 5):

123 
bg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
lightG¿y
)

126 if(
’abËd
):

127 
bg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
wh™e
)

129 
bg
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(220, 220, 220))

130  
bg


131 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
FÜegroundRŞe
:

132 if(
’abËd
):

133 
fg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
bÏck
)

135 
fg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
blue
)

136  
fg


137 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
FÚtRŞe
:

138 
ât
 = 
QtGui
.
	`QFÚt
()

139 
ât
.
	`£tPoštSize
(
TABLE_FONT_SIZE
)

140 if(
cŞ
 == 0):

141 
ât
.
	`£tBŞd
(
True
)

142  
ât


143 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
TextAlignm’tRŞe
:

144 ià(
cŞ
 == 0):

145 (
QtCÜe
.
Qt
.
AlignLeá
)

147 #»tuº(
QtCÜe
.
Qt
.
AlignRight
)

148 (
QtCÜe
.
Qt
.
AlignC’‹r
)

151 #´šˆ'»tuºšg NÚ[%d,%d]„Şğ%d' % (
row
,
cŞ
, 
rŞe
)

152  
NÚe


154 
def
 
	$£tD©a
(
£lf
, 
šdex
, 
v®ue
, 
rŞe
, 
»ÿlc
=
True
, 
do_sigÇl
=True):

156 
	$£tD©a
(): 
desütiÚ


158 :
·¿m
 
šdex
: index 
desütiÚ


159 :
ty³
 
šdex
: indexype

161 :
·¿m
 
v®ue
: v®u
desütiÚ


162 :
ty³
 
v®ue
: valueype

164 :
·¿m
 
rŞe
:„Ş
desütiÚ


165 :
ty³
 
rŞe
:„oleype

167 :
·¿m
 
»ÿlc
=
True
:„eÿlc=Tru
desütiÚ


168 :
ty³
 
»ÿlc
=
True
:„ecalc=Trueype

170 :
·¿m
 
do_sigÇl
=
True
: do_sigÇl=Tru
desütiÚ


171 :
ty³
 
do_sigÇl
=
True
: do_signal=Trueype

173 :
»tuºs
: 
NÚe


175 
row
 = 
šdex
.
	`row
()

176 
cŞ
 = 
šdex
.
	`cŞumn
()

177 
ok
 = 
True


178 if(
rŞe
 =ğ
QtCÜe
.
Qt
.
Ed™RŞe
):

180 if(
cŞ
 == 0):

181  
True


182 #v®, 
ok
 = 
v®ue
.
	`toLÚgLÚg
()

183 
	`–if
(
cŞ
 == 10):

184 
v®
 = 
	`¡r
(
v®ue
.
	`toSŒšg
())

185 if(
	`Ën
(
v®
) < 1):

186 
ok
 = 
F®£


188 if(
	`Ën
(
v®ue
) > 0):

189 
v®
 = (
v®ue
)

191 (
True
)

193 #ÿÎ 
the
 
assocŸ‹d
 
£‰”
 
funùiÚ
 
this
 
	`cŞumn
 (thi 
is
 
£tup
 
š
h
sÿn
 
defš™iÚ
 
şass


194 if(
ok
):

195 #Úly 
chªge
 
the
 
v®ue
 th
u£r
 
’‹»d
 
a
 value

196 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

197 #dù['hdr'] = 
hdr_Çme


198 #dù['func_¡r'] = 
func_¡r


199 #dù['æoÜ_v®'] = 
æoÜ_v®


200 #dù['ûšg_v®'] = 
ûšg_v®


201 #if((
£lf
.
cŞumn_m­
[
cŞ
]['æoÜ_v®'] !ğ
NÚe
è
	`ªd
 (
v®
 > self.column_map[col]['floor_val'])):

202 #if((
£lf
.
cŞumn_m­
[
cŞ
]['ûšg_v®'] !ğ
NÚe
è
	`ªd
 (
v®
 <= self.column_map[col]['ceiling_val'])):

203 ##
sÿn
[
£lf
.
cŞumn_m­
[
cŞ
]['hdr']] = 
v®


204 #ro˜ğ
	`g‘_roi_äom_¥_db
(
£lf
.
cŞumn_m­
[
cŞ
]['hdr'], 
sÿn
)

205 #£t_f›ld_v®_š_¥_db(
£lf
.
cŞumn_m­
[
cŞ
]['hdr'], 
v®
, 
sÿn
)

206 #funøğ
£lf
.
cŞumn_m­
[
cŞ
]['func']

210 ##
dÚt
 
chªge
 
™


213 #if((
£lf
.
cŞumn_m­
[
cŞ
]['æoÜ_v®'] !ğ
NÚe
è
	`ªd
 (
v®
 > self.column_map[col]['floor_val'])):

214 #if((
£lf
.
cŞumn_m­
[
cŞ
]['ûšg_v®'] !ğ
NÚe
è
	`ªd
 (
v®
 <= self.column_map[col]['ceiling_val'])):

215 ##
sÿn
[
£lf
.
cŞumn_m­
[
cŞ
]['hdr']] = 
v®


216 
roi
 = 
	`g‘_roi_äom_¥_db
(
£lf
.
cŞumn_m­
[
cŞ
]['hdr'], 
sÿn
)

217 
	`£t_f›ld_v®_š_¥_db
(
£lf
.
cŞumn_m­
[
cŞ
]['hdr'], 
v®
, 
sÿn
)

218 
func
 = 
£lf
.
cŞumn_m­
[
cŞ
]['func']

222 ##
dÚt
 
chªge
 
™


224 #´šˆ'\n£tD©¨TOP:„eù' , 
sÿn
[
SPDB_RECT
]

225 #fÜû 
the
 
row
 
to
 
»ÿlc


226 if(
»ÿlc
):

227 #now 
ÿÎ
 
the
 
»£pùive
 
funùiÚ
 
to
 
»ÿlc
h
sÿn
 
·¿ms


228 
	`func
(
roi
)

229 #´šˆ'£tD©¨BTM:„eù' , 
sÿn
[
SPDB_RECT
]

230 if((
rŞe
 =ğ
QtCÜe
.
Qt
.
Ed™RŞe
è
	$Ü
 (
rŞe
 =ğ
QtCÜe
.
Qt
.
Di¥ÏyRŞe
)):

231 #mu¡ 
em™
 
this
 
as
 
·¹
 
of
 
the
 
äamewÜk
 
suµÜt
 
ª
 
ed™abË
 
Ab¡¿ùTabËMod–


232 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

233 
£lf
.
d©aChªged
.
	`em™
(
šdex
, index)

235 if(
do_sigÇl
):

237 
£lf
.
sÿn_chªged
.
	`em™
(
row
, 
sÿn
)

239  
True


241 
def
 
	$modify_d©a
(
£lf
, 
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
=
F®£
):

243 
	$modify_d©a
(): 
desütiÚ


245 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


246 :
ty³
 
sÿn_id
: scan_idype

248 :
·¿m
 
Ãwsÿn
:‚ewsÿÀ
desütiÚ


249 :
ty³
 
Ãwsÿn
:‚ewscanype

251 :
·¿m
 
do_¡•_Åts
=
F®£
: do_¡•_Åts=F®£ 
desütiÚ


252 :
ty³
 
do_¡•_Åts
=
F®£
: do_step_npts=Falseype

254 :
»tuºs
: 
NÚe


257 
£lf
.
	`»¶aû_sÿn
(
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
)

258 
£lf
.
d©aChªged
.
	`em™
(
QtCÜe
.
	`QMod–Index
(), QtCore.QModelIndex())

261 
şass
 
	$S·tŸlSÿnTabËV›w
(
Ba£SÿnTabËV›w
):

263 
def
 
	$__š™__
(
£lf
, 
sÿnLi¡
=[], 
·»Á
=
NÚe
, 
u£_ûÁ”
=
True
, 
is_pošt
=
F®£
, 
is_¬b_lše
=False):

265 
	$__š™__
(): 
desütiÚ


267 :
·¿m
 
sÿnLi¡
=[]: sÿnLi¡=[] 
desütiÚ


268 :
ty³
 
sÿnLi¡
=[]: scanList=[]ype

270 :
·¿m
 
·»Á
=
NÚe
:…¬’t=NÚ
desütiÚ


271 :
ty³
 
·»Á
=
NÚe
:…arent=Noneype

273 :
·¿m
 
u£_ûÁ”
=
True
: 
£tup
 
bË
 
u£šg
 
ûÁ”
/
¿nge
 
Ü
 
¡¬t
/
¡İ


274 :
ty³
 
u£_ûÁ”
=
NÚe
: 
boŞ—n


276 :
·¿m
 
is_pošt
=
True
: 
£tup
 
bË
 
w™h
 
»ad
 
Úly
 
cŞumnds
 
Rªge
, 
S‹p
, 
Npošts


277 :
ty³
 
is_pošt
=
NÚe
: 
boŞ—n


279 :
»tuºs
: 
NÚe


281 #£tu°
the
 
h—d”
 th
tİ
 
of
h
bË


282 if(
u£_ûÁ”
):

283 
hdrLi¡
 = ['ID','CenterX', 'RangeX', 'CenterY', 'RangeY', 'StepX', 'StepY', 'PointsX', 'PointsY']

285 
hdrLi¡
 = ['ID','StartX', 'StopX', 'StartY', 'StopY', 'StepX', 'StepY', 'PointsX', 'PointsY']

286 #£lf.
func_li¡
 = ['xy_id', 'centerX', 'rangeX','centerY', 'rangeY','stepX', 'stepY', 'NpointsX', 'NpointsY']

288 if(
is_¬b_lše
):

289 
	`su³r
(
S·tŸlSÿnTabËV›w
, 
£lf
).
	`__š™__
(
hdrLi¡
, 
sÿnLi¡
, 
Arb™¿ryLšeSÿnTabËMod–
, 
·»Á
)

291 
	`su³r
(
S·tŸlSÿnTabËV›w
, 
£lf
).
	`__š™__
(
hdrLi¡
, 
sÿnLi¡
, 
S·tŸlSÿnTabËMod–
, 
·»Á
)

292 
£lf
.
xyNum
 = 0

294 
£lf
.
	`£tStyËSh“t
(
SPATIAL_SS
)

295 if(
is_pošt
):

296 
£lf
.
£t_mod–_cŞumn_deçuÉs
 = s–f.
£t_mod–_cŞumn_fÜ_pošts


297 if(
is_¬b_lše
):

298 
£lf
.
£t_mod–_cŞumn_deçuÉs
 = s–f.
£t_mod–_cŞumn_fÜ_¬b™¿¹y_lše


300 
£lf
.
	`š™_mod–
(
u£_ûÁ”
, 
is_¬b_lše
)

302 #£lf.
	`£t_mod–_id_¡¬t_v®
(
SPATIAL_CNTR
)

304 
def
 
	$š™_mod–
(
£lf
, 
u£_ûÁ”
=
True
, 
is_¬b_lše
=
F®£
):

306 
	$š™_mod–
(): 
desütiÚ


308 :
»tuºs
: 
NÚe


310 if(
is_¬b_lše
):

311 
£lf
.
bËmod–
 = 
	`Arb™¿ryLšeSÿnTabËMod–
(£lf.
hdrLi¡
, s–f.
sÿns
, s–f, 
u£_ûÁ”
=use_center)

313 
£lf
.
bËmod–
 = 
	`S·tŸlSÿnTabËMod–
(£lf.
hdrLi¡
, s–f.
sÿns
, s–f, 
u£_ûÁ”
=use_center)

314 
£lf
.
	`£t_mod–_cŞumn_deçuÉs
()

316 
def
 
	$modify_sÿn
(
£lf
, 
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
=
F®£
):

318 
	$modify_sÿn
(): 
desütiÚ


320 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


321 :
ty³
 
sÿn_id
: scan_idype

323 :
·¿m
 
Ãwsÿn
:‚ewsÿÀ
desütiÚ


324 :
ty³
 
Ãwsÿn
:‚ewscanype

326 :
·¿m
 
do_¡•_Åts
=
F®£
: do_¡•_Åts=F®£ 
desütiÚ


327 :
ty³
 
do_¡•_Åts
=
F®£
: do_step_npts=Falseype

329 :
»tuºs
: 
NÚe


332 
sÿn
 = 
£lf
.
bËmod–
.
	`g‘_sÿn
(
sÿn_id
)

333 if(
sÿn
 
is
 
nÙ
 
NÚe
):

334 
£lf
.
bËmod–
.
	`modify_d©a
(
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
)

336 
def
 
	$£t_max_¥©Ÿl_v®
(
£lf
, 
cŞumn_Çme
, 
_max
):

338 
this
 
funùiÚ
 
£ts
 
the
 
ûšg_v®
 
š
h
mod–
 th
¥ecif›d
 
cŞumn
 
so
 
th©


339 
the
 
u£r
 
ÿÂÙ
 
’‹r
 
a
 
v®ue
 
th©
hu£¸
wßÁs
 
d“med
 "OUT of RANGE"

341 
cŞ
 = 
£lf
.
bËmod–
.
	`g‘_cŞumn_w™h_Çme
(
cŞumn_Çme
)

342 if(
cŞ
):

343 
£lf
.
bËmod–
.
cŞumn_m­
[
cŞ
]['ûšg_v®'] = 
_max


345 
_logg”
.
	`”rÜ
('% dÛ nÙƒxi¡ iÀbËmod–.cŞumn_m­' % 
cŞumn_Çme
)

347 
def
 
	$£t_mš_¥©Ÿl_v®
(
£lf
, 
cŞumn_Çme
, 
_mš
):

349 
this
 
funùiÚ
 
£ts
 
the
 
ûšg_v®
 
š
h
mod–
 th
¥ecif›d
 
cŞumn
 
so
 
th©


350 
the
 
u£r
 
ÿÂÙ
 
’‹r
 
a
 
v®ue
 
th©
hu£¸
wßÁs
 
d“med
 "OUT of RANGE"

352 
cŞ
 = 
£lf
.
bËmod–
.
	`g‘_cŞumn_w™h_Çme
(
cŞumn_Çme
)

353 if(
cŞ
):

354 
£lf
.
bËmod–
.
cŞumn_m­
[
cŞ
]['æoÜ_v®'] = 
_mš


356 
_logg”
.
	`”rÜ
('% dÛ nÙƒxi¡ iÀbËmod–.cŞumn_m­' % 
cŞumn_Çme
)

358 
def
 
	$£t_x_¥©Ÿl_¿nge
(
£lf
, 
_max
):

359 
£lf
.
	`£t_max_¥©Ÿl_v®
('RANGEX', 
_max
)

361 
def
 
	$£t_y_¥©Ÿl_¿nge
(
£lf
, 
_max
):

362 
£lf
.
	`£t_max_¥©Ÿl_v®
('RANGEY', 
_max
)

364 
def
 
	$£t_x_¥©Ÿl_¡¬t¡İ
(
£lf
, 
¡¹_¡İ
):

365 
£lf
.
	`£t_mš_¥©Ÿl_v®
('STARTX', 
¡¹_¡İ
[0])

366 
£lf
.
	`£t_max_¥©Ÿl_v®
('STARTX', 
¡¹_¡İ
[1])

367 
£lf
.
	`£t_mš_¥©Ÿl_v®
('STOPX', 
¡¹_¡İ
[0])

368 
£lf
.
	`£t_max_¥©Ÿl_v®
('STOPX', 
¡¹_¡İ
[1])

370 
def
 
	$£t_y_¥©Ÿl_¡¬t¡İ
(
£lf
, 
¡¹_¡İ
):

371 
£lf
.
	`£t_mš_¥©Ÿl_v®
('STARTY', 
¡¹_¡İ
[0])

372 
£lf
.
	`£t_max_¥©Ÿl_v®
('STARTY', 
¡¹_¡İ
[1])

373 
£lf
.
	`£t_mš_¥©Ÿl_v®
('STOPY', 
¡¹_¡İ
[0])

374 
£lf
.
	`£t_max_¥©Ÿl_v®
('STOPY', 
¡¹_¡İ
[1])

376 
def
 
	$£t_mod–_cŞumn_deçuÉs
(
£lf
):

378 
	$£t_mod–_cŞumn_deçuÉs
(): 
desütiÚ


380 :
»tuºs
: 
NÚe


382 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(0)

383 #fÜ 
i
 
š
 
	`¿nge
(1,
	`Ën
(
£lf
.
hdrLi¡
)):

384 #£lf.
	`hÜizÚlH—d”
().
	`£tSeùiÚResizeMode
(
i
, 
QtWidg‘s
.
QH—d”V›w
.
SŒ‘ch
)

386 
def
 
	$£t_mod–_cŞumn_fÜ_pošts
(
£lf
):

388 
	$£t_mod–_cŞumn_deçuÉs
(): 
£t
 
cŞumns
 
of
 
bË
 
to
 
be
 
»ad
 
Úly
 
Rªge
, 
S‹p
, 
Npošts


390 
hdrLi¡
 = ['ID','StartX', 'StopX', 'StartY', 'StopY', 'StepX', 'StepY', 'PointsX', 'PointsY']

392 :
»tuºs
: 
NÚe


394 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(0)

395 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(2)

396 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(4)

397 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(5)

398 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(6)

399 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(7)

400 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(8)

402 #fÜ 
i
 
š
 
	`¿nge
(1,
	`Ën
(
£lf
.
hdrLi¡
)):

403 #£lf.
	`hÜizÚlH—d”
().
	`£tSeùiÚResizeMode
(
i
, 
QtWidg‘s
.
QH—d”V›w
.
SŒ‘ch
)

406 
def
 
	$£t_mod–_cŞumn_fÜ_¬b™¿¹y_lše
(
£lf
):

408 
	$£t_mod–_cŞumn_deçuÉs
(): 
£t
 
cŞumns
 
of
 
bË
 
to
 
be
 
»ad
 
Úly
 
S‹pY
, 
NpoštsY


410 
hdrLi¡
 = ['ID','StartX', 'StopX', 'StartY', 'StopY', 'StepX', 'StepY', 'PointsX', 'PointsY']

412 :
»tuºs
: 
NÚe


414 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(0)

415 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(6)

416 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(8)

418 #fÜ 
i
 
š
 
	`¿nge
(1,
	`Ën
(
£lf
.
hdrLi¡
)):

419 #£lf.
	`hÜizÚlH—d”
().
	`£tSeùiÚResizeMode
(
i
, 
QtWidg‘s
.
QH—d”V›w
.
SŒ‘ch
)

422 
def
 
	$sizeHštFÜCŞumn
(
£lf
, 
cŞumn
):

424 
	$sizeHštFÜCŞumn
(): 
desütiÚ


426 :
·¿m
 
cŞumn
: cŞumÀ
desütiÚ


427 :
ty³
 
cŞumn
: columnype

429 :
»tuºs
: 
NÚe


431 
fm
 = 
£lf
.
	`fÚtM‘rics
()

432 
max_width
 = 0

433 
i
 
š
 
	`¿nge
(
£lf
.
	`mod–
().
	$rowCouÁ
()):

434 
width
 = 
fm
.
	`width
(
£lf
.
	`mod–
().
	`g‘_ûÎ
(
i
,
cŞumn
)) + 10

435 
width
 > 
max_width
:

436 
max_width
 = 
width


437  
max_width


447 
__Çme__
 == '__main__':

448 
impÜt
 
sys


449 
äom
 
şs
.
­pWidg‘s
.
¥yd”_cÚsŞe
 
impÜt
 
Sh–lWidg‘
#, 
Sh–lDock


451 
	`log_to_qt
()

452 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

453 #wš = 
	`EÃrgyS–Widg‘
()

454 #wš.
	`show
()

455 #¥©ŸÈğ
	`S·tŸlS–Widg‘
()

456 #¥©Ÿl.
	`show
()

458 
muÉi
 = 
	`MuÉiRegiÚWidg‘
(
u£_ûÁ”
=
True
, 
’abË_muÉi_¥©Ÿl
=True)

459 
muÉi
.
	`’abË_add_¥©Ÿl_»giÚ_m’u
(
True
)

460 
muÉi
.
	`show_lßd_bŠ
()

461 
muÉi
.
	`show_g‘d©a_bŠ
()

463 
ns
 = {'maš': 
muÉi
, 'g':
	`glob®s
(è
	}
}

465 
pythÚsh–l
 = 
Sh–lWidg‘
(
·»Á
=
NÚe
, 
Çme¥aû
=
ns
,
commªds
=[], 
muÉ™h»aded
=
True
)

466 
muÉi
.
Ïyout
().
addWidg‘
(
pythÚsh–l
)

468 
muÉi
.
show
()

470 
sys
.
ex™
(
­p
.
exec_
())

	@widgets/scan_table_view/spatialTableView.py

2 
C»©ed
 
Ú
 
	gNov
 16, 2016

4 @
	gauthÜ
: 
b”gr


6 
impÜt
 
numpy
 
as
 
Å


7 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui


8 
impÜt
 
	gcİy


9 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


11 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
bl10ID01
 
impÜt
 
	gMAIN_OBJ


12 
äom
 
	gşs
.
	guts
.
roi_uts
 
impÜt
 
	gg‘_ba£_roi
, 
	gg‘_ba£_’”gy_roi
, \

13 
	gg‘_•u_pŞ_dù
, 
	gmake_¥©Ÿl_db_diù
, 
	gwidg‘_com_cmnd_ty³s
, \

14 
	gÚ_¿nge_chªged
, 
	gÚ_Åošts_chªged
, 
	gÚ_¡•_size_chªged
, 
	gÚ_¡¬t_chªged
, 
	gÚ_¡İ_chªged
, \

15 
	gÚ_ûÁ”_chªged
, 
	g»ÿlc_£ošts
, 
	gg‘_unique_roi_id


17 
äom
 
	gşs
.
	gsÿÂšg
.
¡xmTy³s
 
impÜt
 
	gsÿn_ty³s
, 
	gsÿn_·Ãl_Üd”
, 
	gsÿn_image_ty³s
, 
	g¥©Ÿl_ty³_´efix
, 
	gIMAGE_LXL
, 
	gIMAGE_PXP
, 
	g’”gy_sÿn_Üd”_ty³s


19 
äom
 
	gşs
.
	guts
.
diù_uts
 
impÜt
 
	gdù_put
, 
	gdù_g‘


20 
äom
 
	gşs
.
	guts
.
roi_diù_defs
 
	gimpÜt
 *

21 
äom
 
	gbcm
.
	gdeviû
.
deviû_Çmes
 
	gimpÜt
 *

23 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
ba£SÿnTabË
 
	gimpÜt
 *

24 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gpyStxm
.
	gwidg‘s
.
	gsÿn_bË_v›w
.
¬b™¿ryLšeTabËMod–
 
impÜt
 
	gArb™¿ryLšeSÿnTabËMod–


28 
şass
 
	$S·tŸlSÿnTabËMod–
(
Ba£SÿnTabËMod–
):

30 
sÿn_chªged
 = 
QtCÜe
.
	`pyqtSigÇl
(, 
objeù
)

32 
def
 
	$__š™__
(
£lf
, 
hdrLi¡
, 
d©aš
, 
·»Á
 = 
NÚe
, 
u£_ûÁ”
=
True
, 
is_¬b_lše
=
F®£
, *
¬gs
):

34 
	$__š™__
(): 
desütiÚ


36 :
·¿m
 
hdrLi¡
: hdrLi¡ 
desütiÚ


37 :
ty³
 
hdrLi¡
: hdrListype

39 :
·¿m
 
d©aš
: d©aš 
desütiÚ


40 :
ty³
 
d©aš
: datainype

42 :
·¿m
 
·»Á
=
NÚe
:…¬’t=NÚ
desütiÚ


43 :
ty³
 
·»Á
=
NÚe
:…arent=Noneype

45 :
·¿m
 *
¬gs
: *¬g 
desütiÚ


46 :
ty³
 *
¬gs
: *argsype

48 :
»tuºs
: 
NÚe


50 #QtCÜe.
QAb¡¿ùTabËMod–
.
	`__š™__
(
£lf
, 
·»Á
, *
¬gs
)

51 
	`su³r
(
S·tŸlSÿnTabËMod–
, 
£lf
).
	`__š™__
Ğ
hdrLi¡
, 
d©aš
, 
·»Á
, *
¬gs
)

52 #¨
diù
 
th©
 
wl
 
u£
 
¥©Ÿl
 
»giÚ
 
sÿn_id
' a keyØEÃrgyRegiÚSÿnDef'
s


53 
£lf
.
cur_sÿn_row
 = 
NÚe


54 
£lf
.
sÿnLi¡D©a
 = 
d©aš


55 
£lf
.
ed™abË
 = 
F®£


56 if('C’‹rX' 
š
 
hdrLi¡
):

57 
£lf
.
cŞumn_m­
 = 
C_SPATIAL_DCT


59 
£lf
.
cŞumn_m­
 = 
S_SPATIAL_DCT


61 
£lf
.
	`£t_mš_rows
(0)

62 
£lf
.
	`£t_max_rows
(20)

65 
def
 
	$d©a
(
£lf
, 
šdex
, 
rŞe
):

67 
ov”ride
 
ba£
 
bË
 
mod–
 
d©a
 
funùiÚ


68 
	$d©a
(): 
desütiÚ


70 :
·¿m
 
šdex
: index 
desütiÚ


71 :
ty³
 
šdex
: indexype

73 :
·¿m
 
rŞe
:„Ş
desütiÚ


74 :
ty³
 
rŞe
:„oleype

76 :
»tuºs
: 
NÚe


79 
row
 = 
šdex
.
	`row
()

80 
cŞ
 = 
šdex
.
	`cŞumn
()

81 
’abËd
 = 
F®£


83 
nÙ
 
šdex
.
	$isV®id
():

84 
´št
 'index is invalid'

85  
NÚe


87 
æags
 = 
šdex
.
	`æags
()

88 
æags
 & 
QtCÜe
.
Qt
.
I‹mIsEd™abË
:

89 
’abËd
 = 
True


91 
rŞe
 =ğ
QtCÜe
.
Qt
.
Di¥ÏyRŞe
:

92 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

93 if(
cŞ
 == 0):

94 
v
 = 
sÿn
[
SPDB_ID_VAL
]

96 
v
 = 
	`g‘_v®_äom_¥_db
(
£lf
.
cŞumn_m­
[
cŞ
]['hdr'], 
sÿn
)

97 #v = 
sÿn
[
£lf
.
cŞumn_m­
[
cŞ
]['hdr']]

99 if(
	$ty³
(
v
è
is
 
¡r
):

100 (
v
)

101 if(
	$ty³
(
v
è
is
 
Å
.
æßt64
):

102 
v®
 = '%.3f' % 
v


103 (
v®
)

104 if(
	$ty³
(
v
è
is
 ):

105 
v®
 = '%.3f' % 
v


106 (
v®
)

107 if(
	$ty³
(
v
è
is
 ):

108 
v®
 = '%d' % 
v


109 (
v®
)

110 if(
	$ty³
(
v
è
is
 ):

111 
v®
 = '%d' % 
v


112 (
v®
)

113 if(
	$ty³
(
v
è
is
 
boŞ
):

114 if(
v
):

119 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
BackgroundRŞe
:

120 if(
cŞ
 == 0):

121 
bg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
g¿y
)

122 
	`–if
(
cŞ
 < 5):

123 
bg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
lightG¿y
)

126 if(
’abËd
):

127 
bg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
wh™e
)

129 
bg
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(220, 220, 220))

130  
bg


131 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
FÜegroundRŞe
:

132 if(
’abËd
):

133 
fg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
bÏck
)

135 
fg
 = 
QtGui
.
	`QBrush
(
QtCÜe
.
Qt
.
blue
)

136  
fg


137 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
FÚtRŞe
:

138 
ât
 = 
QtGui
.
	`QFÚt
()

139 
ât
.
	`£tPoštSize
(
TABLE_FONT_SIZE
)

140 if(
cŞ
 == 0):

141 
ât
.
	`£tBŞd
(
True
)

142  
ât


143 
–if
 
rŞe
 =ğ
QtCÜe
.
Qt
.
TextAlignm’tRŞe
:

144 ià(
cŞ
 == 0):

145 (
QtCÜe
.
Qt
.
AlignLeá
)

147 #»tuº(
QtCÜe
.
Qt
.
AlignRight
)

148 (
QtCÜe
.
Qt
.
AlignC’‹r
)

151 #´šˆ'»tuºšg NÚ[%d,%d]„Şğ%d' % (
row
,
cŞ
, 
rŞe
)

152  
NÚe


154 
def
 
	$£tD©a
(
£lf
, 
šdex
, 
v®ue
, 
rŞe
, 
»ÿlc
=
True
, 
do_sigÇl
=True):

156 
	$£tD©a
(): 
desütiÚ


158 :
·¿m
 
šdex
: index 
desütiÚ


159 :
ty³
 
šdex
: indexype

161 :
·¿m
 
v®ue
: v®u
desütiÚ


162 :
ty³
 
v®ue
: valueype

164 :
·¿m
 
rŞe
:„Ş
desütiÚ


165 :
ty³
 
rŞe
:„oleype

167 :
·¿m
 
»ÿlc
=
True
:„eÿlc=Tru
desütiÚ


168 :
ty³
 
»ÿlc
=
True
:„ecalc=Trueype

170 :
·¿m
 
do_sigÇl
=
True
: do_sigÇl=Tru
desütiÚ


171 :
ty³
 
do_sigÇl
=
True
: do_signal=Trueype

173 :
»tuºs
: 
NÚe


175 
row
 = 
šdex
.
	`row
()

176 
cŞ
 = 
šdex
.
	`cŞumn
()

177 
ok
 = 
True


178 if(
rŞe
 =ğ
QtCÜe
.
Qt
.
Ed™RŞe
):

180 if(
cŞ
 == 0):

181  
True


182 #v®, 
ok
 = 
v®ue
.
	`toLÚgLÚg
()

183 
	`–if
(
cŞ
 == 10):

184 
v®
 = 
	`¡r
(
v®ue
.
	`toSŒšg
())

185 if(
	`Ën
(
v®
) < 1):

186 
ok
 = 
F®£


188 if(
	`Ën
(
v®ue
) > 0):

189 
v®
 = (
v®ue
)

191 (
True
)

193 #ÿÎ 
the
 
assocŸ‹d
 
£‰”
 
funùiÚ
 
this
 
	`cŞumn
 (thi 
is
 
£tup
 
š
h
sÿn
 
defš™iÚ
 
şass


194 if(
ok
):

195 #Úly 
chªge
 
the
 
v®ue
 th
u£r
 
’‹»d
 
a
 value

196 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

197 #dù['hdr'] = 
hdr_Çme


198 #dù['func_¡r'] = 
func_¡r


199 #dù['æoÜ_v®'] = 
æoÜ_v®


200 #dù['ûšg_v®'] = 
ûšg_v®


201 #if((
£lf
.
cŞumn_m­
[
cŞ
]['æoÜ_v®'] !ğ
NÚe
è
	`ªd
 (
v®
 > self.column_map[col]['floor_val'])):

202 #if((
£lf
.
cŞumn_m­
[
cŞ
]['ûšg_v®'] !ğ
NÚe
è
	`ªd
 (
v®
 <= self.column_map[col]['ceiling_val'])):

203 ##
sÿn
[
£lf
.
cŞumn_m­
[
cŞ
]['hdr']] = 
v®


204 #ro˜ğ
	`g‘_roi_äom_¥_db
(
£lf
.
cŞumn_m­
[
cŞ
]['hdr'], 
sÿn
)

205 #£t_f›ld_v®_š_¥_db(
£lf
.
cŞumn_m­
[
cŞ
]['hdr'], 
v®
, 
sÿn
)

206 #funøğ
£lf
.
cŞumn_m­
[
cŞ
]['func']

210 ##
dÚt
 
chªge
 
™


213 #if((
£lf
.
cŞumn_m­
[
cŞ
]['æoÜ_v®'] !ğ
NÚe
è
	`ªd
 (
v®
 > self.column_map[col]['floor_val'])):

214 #if((
£lf
.
cŞumn_m­
[
cŞ
]['ûšg_v®'] !ğ
NÚe
è
	`ªd
 (
v®
 <= self.column_map[col]['ceiling_val'])):

215 ##
sÿn
[
£lf
.
cŞumn_m­
[
cŞ
]['hdr']] = 
v®


216 
roi
 = 
	`g‘_roi_äom_¥_db
(
£lf
.
cŞumn_m­
[
cŞ
]['hdr'], 
sÿn
)

217 
	`£t_f›ld_v®_š_¥_db
(
£lf
.
cŞumn_m­
[
cŞ
]['hdr'], 
v®
, 
sÿn
)

218 
func
 = 
£lf
.
cŞumn_m­
[
cŞ
]['func']

222 ##
dÚt
 
chªge
 
™


224 #´šˆ'\n£tD©¨TOP:„eù' , 
sÿn
[
SPDB_RECT
]

225 #fÜû 
the
 
row
 
to
 
»ÿlc


226 if(
»ÿlc
):

227 #now 
ÿÎ
 
the
 
»£pùive
 
funùiÚ
 
to
 
»ÿlc
h
sÿn
 
·¿ms


228 
	`func
(
roi
)

229 #´šˆ'£tD©¨BTM:„eù' , 
sÿn
[
SPDB_RECT
]

230 if((
rŞe
 =ğ
QtCÜe
.
Qt
.
Ed™RŞe
è
	$Ü
 (
rŞe
 =ğ
QtCÜe
.
Qt
.
Di¥ÏyRŞe
)):

231 #mu¡ 
em™
 
this
 
as
 
·¹
 
of
 
the
 
äamewÜk
 
suµÜt
 
ª
 
ed™abË
 
Ab¡¿ùTabËMod–


232 
sÿn
 = 
£lf
.
sÿnLi¡D©a
[
row
]

233 
£lf
.
d©aChªged
.
	`em™
(
šdex
, index)

235 if(
do_sigÇl
):

237 
£lf
.
sÿn_chªged
.
	`em™
(
row
, 
sÿn
)

239  
True


241 
def
 
	$modify_d©a
(
£lf
, 
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
=
F®£
):

243 
	$modify_d©a
(): 
desütiÚ


245 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


246 :
ty³
 
sÿn_id
: scan_idype

248 :
·¿m
 
Ãwsÿn
:‚ewsÿÀ
desütiÚ


249 :
ty³
 
Ãwsÿn
:‚ewscanype

251 :
·¿m
 
do_¡•_Åts
=
F®£
: do_¡•_Åts=F®£ 
desütiÚ


252 :
ty³
 
do_¡•_Åts
=
F®£
: do_step_npts=Falseype

254 :
»tuºs
: 
NÚe


257 
£lf
.
	`»¶aû_sÿn
(
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
)

258 
£lf
.
d©aChªged
.
	`em™
(
QtCÜe
.
	`QMod–Index
(), QtCore.QModelIndex())

261 
şass
 
	$S·tŸlSÿnTabËV›w
(
Ba£SÿnTabËV›w
):

263 
def
 
	$__š™__
(
£lf
, 
sÿnLi¡
=[], 
·»Á
=
NÚe
, 
u£_ûÁ”
=
True
, 
is_pošt
=
F®£
, 
is_¬b_lše
=False):

265 
	$__š™__
(): 
desütiÚ


267 :
·¿m
 
sÿnLi¡
=[]: sÿnLi¡=[] 
desütiÚ


268 :
ty³
 
sÿnLi¡
=[]: scanList=[]ype

270 :
·¿m
 
·»Á
=
NÚe
:…¬’t=NÚ
desütiÚ


271 :
ty³
 
·»Á
=
NÚe
:…arent=Noneype

273 :
·¿m
 
u£_ûÁ”
=
True
: 
£tup
 
bË
 
u£šg
 
ûÁ”
/
¿nge
 
Ü
 
¡¬t
/
¡İ


274 :
ty³
 
u£_ûÁ”
=
NÚe
: 
boŞ—n


276 :
·¿m
 
is_pošt
=
True
: 
£tup
 
bË
 
w™h
 
»ad
 
Úly
 
cŞumnds
 
Rªge
, 
S‹p
, 
Npošts


277 :
ty³
 
is_pošt
=
NÚe
: 
boŞ—n


279 :
»tuºs
: 
NÚe


281 #£tu°
the
 
h—d”
 th
tİ
 
of
h
bË


282 if(
u£_ûÁ”
):

283 
hdrLi¡
 = ['ID','CenterX', 'RangeX', 'CenterY', 'RangeY', 'StepX', 'StepY', 'PointsX', 'PointsY']

285 
hdrLi¡
 = ['ID','StartX', 'StopX', 'StartY', 'StopY', 'StepX', 'StepY', 'PointsX', 'PointsY']

286 #£lf.
func_li¡
 = ['xy_id', 'centerX', 'rangeX','centerY', 'rangeY','stepX', 'stepY', 'NpointsX', 'NpointsY']

288 if(
is_¬b_lše
):

289 
	`su³r
(
S·tŸlSÿnTabËV›w
, 
£lf
).
	`__š™__
(
hdrLi¡
, 
sÿnLi¡
, 
Arb™¿ryLšeSÿnTabËMod–
, 
·»Á
)

291 
	`su³r
(
S·tŸlSÿnTabËV›w
, 
£lf
).
	`__š™__
(
hdrLi¡
, 
sÿnLi¡
, 
S·tŸlSÿnTabËMod–
, 
·»Á
)

292 
£lf
.
xyNum
 = 0

294 
£lf
.
	`£tStyËSh“t
(
SPATIAL_SS
)

295 if(
is_pošt
):

296 
£lf
.
£t_mod–_cŞumn_deçuÉs
 = s–f.
£t_mod–_cŞumn_fÜ_pošts


297 if(
is_¬b_lše
):

298 
£lf
.
£t_mod–_cŞumn_deçuÉs
 = s–f.
£t_mod–_cŞumn_fÜ_¬b™¿¹y_lše


300 
£lf
.
	`š™_mod–
(
u£_ûÁ”
, 
is_¬b_lše
)

302 #£lf.
	`£t_mod–_id_¡¬t_v®
(
SPATIAL_CNTR
)

304 
def
 
	$š™_mod–
(
£lf
, 
u£_ûÁ”
=
True
, 
is_¬b_lše
=
F®£
):

306 
	$š™_mod–
(): 
desütiÚ


308 :
»tuºs
: 
NÚe


310 if(
is_¬b_lše
):

311 
£lf
.
bËmod–
 = 
	`Arb™¿ryLšeSÿnTabËMod–
(£lf.
hdrLi¡
, s–f.
sÿns
, s–f, 
u£_ûÁ”
=use_center)

313 
£lf
.
bËmod–
 = 
	`S·tŸlSÿnTabËMod–
(£lf.
hdrLi¡
, s–f.
sÿns
, s–f, 
u£_ûÁ”
=use_center)

314 
£lf
.
	`£t_mod–_cŞumn_deçuÉs
()

316 
def
 
	$modify_sÿn
(
£lf
, 
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
=
F®£
):

318 
	$modify_sÿn
(): 
desütiÚ


320 :
·¿m
 
sÿn_id
: sÿn_id 
desütiÚ


321 :
ty³
 
sÿn_id
: scan_idype

323 :
·¿m
 
Ãwsÿn
:‚ewsÿÀ
desütiÚ


324 :
ty³
 
Ãwsÿn
:‚ewscanype

326 :
·¿m
 
do_¡•_Åts
=
F®£
: do_¡•_Åts=F®£ 
desütiÚ


327 :
ty³
 
do_¡•_Åts
=
F®£
: do_step_npts=Falseype

329 :
»tuºs
: 
NÚe


332 
sÿn
 = 
£lf
.
bËmod–
.
	`g‘_sÿn
(
sÿn_id
)

333 if(
sÿn
 
is
 
nÙ
 
NÚe
):

334 
£lf
.
bËmod–
.
	`modify_d©a
(
sÿn_id
, 
Ãwsÿn
, 
do_¡•_Åts
)

336 
def
 
	$£t_max_¥©Ÿl_v®
(
£lf
, 
cŞumn_Çme
, 
_max
):

338 
this
 
funùiÚ
 
£ts
 
the
 
ûšg_v®
 
š
h
mod–
 th
¥ecif›d
 
cŞumn
 
so
 
th©


339 
the
 
u£r
 
ÿÂÙ
 
’‹r
 
a
 
v®ue
 
th©
hu£¸
wßÁs
 
d“med
 "OUT of RANGE"

341 
cŞ
 = 
£lf
.
bËmod–
.
	`g‘_cŞumn_w™h_Çme
(
cŞumn_Çme
)

342 if(
cŞ
):

343 
£lf
.
bËmod–
.
cŞumn_m­
[
cŞ
]['ûšg_v®'] = 
_max


345 
_logg”
.
	`”rÜ
('% dÛ nÙƒxi¡ iÀbËmod–.cŞumn_m­' % 
cŞumn_Çme
)

347 
def
 
	$£t_mš_¥©Ÿl_v®
(
£lf
, 
cŞumn_Çme
, 
_mš
):

349 
this
 
funùiÚ
 
£ts
 
the
 
ûšg_v®
 
š
h
mod–
 th
¥ecif›d
 
cŞumn
 
so
 
th©


350 
the
 
u£r
 
ÿÂÙ
 
’‹r
 
a
 
v®ue
 
th©
hu£¸
wßÁs
 
d“med
 "OUT of RANGE"

352 
cŞ
 = 
£lf
.
bËmod–
.
	`g‘_cŞumn_w™h_Çme
(
cŞumn_Çme
)

353 if(
cŞ
):

354 
£lf
.
bËmod–
.
cŞumn_m­
[
cŞ
]['æoÜ_v®'] = 
_mš


356 
_logg”
.
	`”rÜ
('% dÛ nÙƒxi¡ iÀbËmod–.cŞumn_m­' % 
cŞumn_Çme
)

358 
def
 
	$£t_x_¥©Ÿl_¿nge
(
£lf
, 
_max
):

359 
£lf
.
	`£t_max_¥©Ÿl_v®
('RANGEX', 
_max
)

361 
def
 
	$£t_y_¥©Ÿl_¿nge
(
£lf
, 
_max
):

362 
£lf
.
	`£t_max_¥©Ÿl_v®
('RANGEY', 
_max
)

364 
def
 
	$£t_x_¥©Ÿl_¡¬t¡İ
(
£lf
, 
¡¹_¡İ
):

365 
£lf
.
	`£t_mš_¥©Ÿl_v®
('STARTX', 
¡¹_¡İ
[0])

366 
£lf
.
	`£t_max_¥©Ÿl_v®
('STARTX', 
¡¹_¡İ
[1])

367 
£lf
.
	`£t_mš_¥©Ÿl_v®
('STOPX', 
¡¹_¡İ
[0])

368 
£lf
.
	`£t_max_¥©Ÿl_v®
('STOPX', 
¡¹_¡İ
[1])

370 
def
 
	$£t_y_¥©Ÿl_¡¬t¡İ
(
£lf
, 
¡¹_¡İ
):

371 
£lf
.
	`£t_mš_¥©Ÿl_v®
('STARTY', 
¡¹_¡İ
[0])

372 
£lf
.
	`£t_max_¥©Ÿl_v®
('STARTY', 
¡¹_¡İ
[1])

373 
£lf
.
	`£t_mš_¥©Ÿl_v®
('STOPY', 
¡¹_¡İ
[0])

374 
£lf
.
	`£t_max_¥©Ÿl_v®
('STOPY', 
¡¹_¡İ
[1])

376 
def
 
	$£t_mod–_cŞumn_deçuÉs
(
£lf
):

378 
	$£t_mod–_cŞumn_deçuÉs
(): 
desütiÚ


380 :
»tuºs
: 
NÚe


382 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(0)

383 #fÜ 
i
 
š
 
	`¿nge
(1,
	`Ën
(
£lf
.
hdrLi¡
)):

384 #£lf.
	`hÜizÚlH—d”
().
	`£tSeùiÚResizeMode
(
i
, 
QtWidg‘s
.
QH—d”V›w
.
SŒ‘ch
)

386 
def
 
	$£t_mod–_cŞumn_fÜ_pošts
(
£lf
):

388 
	$£t_mod–_cŞumn_deçuÉs
(): 
£t
 
cŞumns
 
of
 
bË
 
to
 
be
 
»ad
 
Úly
 
Rªge
, 
S‹p
, 
Npošts


390 
hdrLi¡
 = ['ID','StartX', 'StopX', 'StartY', 'StopY', 'StepX', 'StepY', 'PointsX', 'PointsY']

392 :
»tuºs
: 
NÚe


394 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(0)

395 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(2)

396 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(4)

397 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(5)

398 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(6)

399 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(7)

400 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(8)

402 #fÜ 
i
 
š
 
	`¿nge
(1,
	`Ën
(
£lf
.
hdrLi¡
)):

403 #£lf.
	`hÜizÚlH—d”
().
	`£tSeùiÚResizeMode
(
i
, 
QtWidg‘s
.
QH—d”V›w
.
SŒ‘ch
)

406 
def
 
	$£t_mod–_cŞumn_fÜ_¬b™¿¹y_lše
(
£lf
):

408 
	$£t_mod–_cŞumn_deçuÉs
(): 
£t
 
cŞumns
 
of
 
bË
 
to
 
be
 
»ad
 
Úly
 
S‹pY
, 
NpoštsY


410 
hdrLi¡
 = ['ID','StartX', 'StopX', 'StartY', 'StopY', 'StepX', 'StepY', 'PointsX', 'PointsY']

412 :
»tuºs
: 
NÚe


414 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(0)

415 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(6)

416 
£lf
.
bËmod–
.
	`£t_cŞ_»adÚly
(8)

418 #fÜ 
i
 
š
 
	`¿nge
(1,
	`Ën
(
£lf
.
hdrLi¡
)):

419 #£lf.
	`hÜizÚlH—d”
().
	`£tSeùiÚResizeMode
(
i
, 
QtWidg‘s
.
QH—d”V›w
.
SŒ‘ch
)

422 
def
 
	$sizeHštFÜCŞumn
(
£lf
, 
cŞumn
):

424 
	$sizeHštFÜCŞumn
(): 
desütiÚ


426 :
·¿m
 
cŞumn
: cŞumÀ
desütiÚ


427 :
ty³
 
cŞumn
: columnype

429 :
»tuºs
: 
NÚe


431 
fm
 = 
£lf
.
	`fÚtM‘rics
()

432 
max_width
 = 0

433 
i
 
š
 
	`¿nge
(
£lf
.
	`mod–
().
	$rowCouÁ
()):

434 
width
 = 
fm
.
	`width
(
£lf
.
	`mod–
().
	`g‘_ûÎ
(
i
,
cŞumn
)) + 10

435 
width
 > 
max_width
:

436 
max_width
 = 
width


437  
max_width


447 
__Çme__
 == '__main__':

448 
impÜt
 
sys


449 
äom
 
şs
.
­pWidg‘s
.
¥yd”_cÚsŞe
 
impÜt
 
Sh–lWidg‘
#, 
Sh–lDock


451 
	`log_to_qt
()

452 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

453 #wš = 
	`EÃrgyS–Widg‘
()

454 #wš.
	`show
()

455 #¥©ŸÈğ
	`S·tŸlS–Widg‘
()

456 #¥©Ÿl.
	`show
()

458 
muÉi
 = 
	`MuÉiRegiÚWidg‘
(
u£_ûÁ”
=
True
, 
’abË_muÉi_¥©Ÿl
=True)

459 
muÉi
.
	`’abË_add_¥©Ÿl_»giÚ_m’u
(
True
)

460 
muÉi
.
	`show_lßd_bŠ
()

461 
muÉi
.
	`show_g‘d©a_bŠ
()

463 
ns
 = {'maš': 
muÉi
, 'g':
	`glob®s
(è
	}
}

465 
pythÚsh–l
 = 
Sh–lWidg‘
(
·»Á
=
NÚe
, 
Çme¥aû
=
ns
,
commªds
=[], 
muÉ™h»aded
=
True
)

466 
muÉi
.
Ïyout
().
addWidg‘
(
pythÚsh–l
)

468 
muÉi
.
show
()

470 
sys
.
ex™
(
­p
.
exec_
())

	@widgets/spfbk_small.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #FÜm 
im¶em’tiÚ
 
g’”©ed
 
äom
 
»adšg
 
ui
 
fe
 'spfbk_small.ui'

4 #
#C»©ed 
by
: 
PyQt5
 
UI
 
code
 
g’”©Ü
 5.6

5 #
#WARNING! 
AÎ
 
chªges
 
made
 
š
 
this
 
fe
 
wl
 
be
 
lo¡
!

7 
äom
 
PyQt5
 
impÜt
 
	gQtCÜe
, 
	gQtGui
, 
	gQtWidg‘s


9 
şass
 
	$Ui_FÜm
(
objeù
):

10 
def
 
	$£tupUi
(
£lf
, 
FÜm
):

11 
FÜm
.
	`£tObjeùName
("Form")

12 
FÜm
.
	`»size
(351, 20)

13 
FÜm
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(0, 20))

14 
FÜm
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(500, 300))

15 
£lf
.
v”tiÿlLayout
 = 
QtWidg‘s
.
	`QVBoxLayout
(
FÜm
)

16 
£lf
.
v”tiÿlLayout
.
	`£tSizeCÚ¡¿št
(
QtWidg‘s
.
QLayout
.
S‘NoCÚ¡¿št
)

17 
£lf
.
v”tiÿlLayout
.
	`£tCÚ‹ÁsM¬gšs
(0, 0, 0, 0)

18 
£lf
.
v”tiÿlLayout
.
	`£tS·cšg
(0)

19 
£lf
.
v”tiÿlLayout
.
	`£tObjeùName
("verticalLayout")

20 
£lf
.
äame
 = 
QtWidg‘s
.
	`QF¿me
(
FÜm
)

21 
£lf
.
äame
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(351, 21))

22 
£lf
.
äame
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(351, 21))

23 
£lf
.
äame
.
	`£tF¿meSh­e
(
QtWidg‘s
.
QF¿me
.
StyËdPª–
)

24 
£lf
.
äame
.
	`£tF¿meShadow
(
QtWidg‘s
.
QF¿me
.
Rai£d
)

25 
£lf
.
äame
.
	`£tObjeùName
("frame")

26 
£lf
.
hÜizÚlLayout
 = 
QtWidg‘s
.
	`QHBoxLayout
(£lf.
äame
)

27 
£lf
.
hÜizÚlLayout
.
	`£tCÚ‹ÁsM¬gšs
(1, 1, 1, 1)

28 
£lf
.
hÜizÚlLayout
.
	`£tS·cšg
(2)

29 
£lf
.
hÜizÚlLayout
.
	`£tObjeùName
("horizontalLayout")

30 
£lf
.
mŒNameFld
 = 
QtWidg‘s
.
	`QLab–
(£lf.
äame
)

31 
£lf
.
mŒNameFld
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(100, 0))

32 
£lf
.
mŒNameFld
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(16777215, 16777215))

33 
£lf
.
mŒNameFld
.
	`£tBa£Size
(
QtCÜe
.
	`QSize
(0, 0))

34 
fÚt
 = 
QtGui
.
	`QFÚt
()

35 
fÚt
.
	`£tPoštSize
(8)

36 
fÚt
.
	`£tBŞd
(
True
)

37 
fÚt
.
	`£tIlic
(
F®£
)

38 
fÚt
.
	`£tWeight
(75)

39 
£lf
.
mŒNameFld
.
	`£tFÚt
(
fÚt
)

40 
£lf
.
mŒNameFld
.
	`£tAutoFlBackground
(
True
)

41 
£lf
.
mŒNameFld
.
	`£tF¿meSh­e
(
QtWidg‘s
.
QF¿me
.
StyËdPª–
)

42 
£lf
.
mŒNameFld
.
	`£tF¿meShadow
(
QtWidg‘s
.
QF¿me
.
Sunk’
)

43 
£lf
.
mŒNameFld
.
	`£tAlignm’t
(
QtCÜe
.
Qt
.
AlignC’‹r
)

44 
£lf
.
mŒNameFld
.
	`£tPrİ”ty
("movšg", 
F®£
)

45 
£lf
.
mŒNameFld
.
	`£tObjeùName
("mtrNameFld")

46 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
mŒNameFld
)

47 
£lf
.
£tPosFld
 = 
QtWidg‘s
.
	`QLšeEd™
(£lf.
äame
)

48 
£lf
.
£tPosFld
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(50, 0))

49 
£lf
.
£tPosFld
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(70, 16777215))

50 
fÚt
 = 
QtGui
.
	`QFÚt
()

51 
fÚt
.
	`£tPoštSize
(8)

52 
fÚt
.
	`£tBŞd
(
F®£
)

53 
fÚt
.
	`£tWeight
(50)

54 
£lf
.
£tPosFld
.
	`£tFÚt
(
fÚt
)

55 
£lf
.
£tPosFld
.
	`£tToŞT
("")

56 
£lf
.
£tPosFld
.
	`£tStyËSh“t
("")

57 
£lf
.
£tPosFld
.
	`£tObjeùName
("setPosFld")

58 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
£tPosFld
)

59 
£lf
.
posFbkLbl
 = 
QtWidg‘s
.
	`QLab–
(£lf.
äame
)

60 
£lf
.
posFbkLbl
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(80, 0))

61 
£lf
.
posFbkLbl
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(70, 30))

62 
£lf
.
posFbkLbl
.
	`£tBa£Size
(
QtCÜe
.
	`QSize
(0, 0))

63 
·Ë‰e
 = 
QtGui
.
	`QP®‘‹
()

64 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

65 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

66 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

67 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

68 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

69 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

70 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

71 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

72 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Light
, 
brush
)

73 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

74 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

75 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Midlight
, 
brush
)

76 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

77 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

78 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
D¬k
, 
brush
)

79 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

80 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

81 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Mid
, 
brush
)

82 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

83 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

84 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Text
, 
brush
)

85 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

86 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

87 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
BrightText
, 
brush
)

88 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

89 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

90 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

91 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

92 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

93 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Ba£
, 
brush
)

94 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

95 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

96 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

97 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

98 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

99 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Shadow
, 
brush
)

100 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

101 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

102 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

103 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

104 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

105 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

106 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

107 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

108 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

109 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

110 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

111 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

112 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

113 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

114 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

115 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

116 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

117 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Light
, 
brush
)

118 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

119 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

120 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Midlight
, 
brush
)

121 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

122 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

123 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
D¬k
, 
brush
)

124 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

125 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

126 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Mid
, 
brush
)

127 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

128 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

129 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Text
, 
brush
)

130 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

131 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

132 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
BrightText
, 
brush
)

133 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

134 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

135 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

136 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

137 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

138 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Ba£
, 
brush
)

139 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

140 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

141 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

142 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

143 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

144 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Shadow
, 
brush
)

145 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

146 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

147 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

148 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

149 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

150 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

151 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

152 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

153 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

154 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

155 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

156 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

157 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

158 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

159 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

160 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

161 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

162 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Light
, 
brush
)

163 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

164 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

165 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Midlight
, 
brush
)

166 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

167 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

168 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
D¬k
, 
brush
)

169 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

170 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

171 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Mid
, 
brush
)

172 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

173 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

174 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Text
, 
brush
)

175 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

176 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

177 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
BrightText
, 
brush
)

178 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

179 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

180 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

181 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

182 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

183 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Ba£
, 
brush
)

184 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

185 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

186 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

187 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

188 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

189 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Shadow
, 
brush
)

190 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

191 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

192 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

193 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

194 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

195 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

196 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

197 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

198 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

199 
£lf
.
posFbkLbl
.
	`£tP®‘‹
(
·Ë‰e
)

200 
fÚt
 = 
QtGui
.
	`QFÚt
()

201 
fÚt
.
	`£tPoštSize
(8)

202 
fÚt
.
	`£tBŞd
(
True
)

203 
fÚt
.
	`£tWeight
(75)

204 
£lf
.
posFbkLbl
.
	`£tFÚt
(
fÚt
)

205 
£lf
.
posFbkLbl
.
	`£tAutoFlBackground
(
True
)

206 
£lf
.
posFbkLbl
.
	`£tF¿meSh­e
(
QtWidg‘s
.
QF¿me
.
StyËdPª–
)

207 
£lf
.
posFbkLbl
.
	`£tF¿meShadow
(
QtWidg‘s
.
QF¿me
.
Sunk’
)

208 
£lf
.
posFbkLbl
.
	`£tAlignm’t
(
QtCÜe
.
Qt
.
AlignC’‹r
)

209 
£lf
.
posFbkLbl
.
	`£tObjeùName
("posFbkLbl")

210 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
posFbkLbl
)

211 
£lf
.
un™sLbl
 = 
QtWidg‘s
.
	`QLab–
(£lf.
äame
)

212 
£lf
.
un™sLbl
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(35, 0))

213 
fÚt
 = 
QtGui
.
	`QFÚt
()

214 
fÚt
.
	`£tPoštSize
(8)

215 
fÚt
.
	`£tBŞd
(
True
)

216 
fÚt
.
	`£tWeight
(75)

217 
£lf
.
un™sLbl
.
	`£tFÚt
(
fÚt
)

218 
£lf
.
un™sLbl
.
	`£tAlignm’t
(
QtCÜe
.
Qt
.
AlignC’‹r
)

219 
£lf
.
un™sLbl
.
	`£tObjeùName
("unitsLbl")

220 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
un™sLbl
)

221 
£lf
.
¡İBŠ
 = 
QtWidg‘s
.
	`QToŞBu‰Ú
(£lf.
äame
)

222 
£lf
.
¡İBŠ
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(20, 20))

223 
fÚt
 = 
QtGui
.
	`QFÚt
()

224 
fÚt
.
	`£tK”nšg
(
True
)

225 
£lf
.
¡İBŠ
.
	`£tFÚt
(
fÚt
)

226 
£lf
.
¡İBŠ
.
	`£tAutoR•—tIÁ”v®
(101)

227 
£lf
.
¡İBŠ
.
	`£tObjeùName
("stopBtn")

228 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
¡İBŠ
)

229 
£lf
.
d‘asBŠ
 = 
QtWidg‘s
.
	`QToŞBu‰Ú
(£lf.
äame
)

230 
£lf
.
d‘asBŠ
.
	`£tObjeùName
("detailsBtn")

231 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
d‘asBŠ
)

232 
£lf
.
v”tiÿlLayout
.
	`addWidg‘
(£lf.
äame
)

234 
£lf
.
	`»Œª¦©eUi
(
FÜm
)

235 
QtCÜe
.
QM‘aObjeù
.
	`cÚÃùSlÙsByName
(
FÜm
)

237 
def
 
	$»Œª¦©eUi
(
£lf
, 
FÜm
):

238 
_Œª¦©e
 = 
QtCÜe
.
QCÜeAµliÿtiÚ
.
Œª¦©e


239 
FÜm
.
	`£tWšdowT™Ë
(
	`_Œª¦©e
("Form", "Form"))

240 
£lf
.
mŒNameFld
.
	`£tText
(
	`_Œª¦©e
("Form", "mtrName"))

241 
£lf
.
£tPosFld
.
	`£tText
(
	`_Œª¦©e
("Form", "0.0"))

242 
£lf
.
posFbkLbl
.
	`£tText
(
	`_Œª¦©e
("Form", "0.0"))

243 
£lf
.
un™sLbl
.
	`£tText
(
	`_Œª¦©e
("Form", "mrad"))

244 
£lf
.
¡İBŠ
.
	`£tToŞT
(
	`_Œª¦©e
("Form", "Stop"))

245 
£lf
.
¡İBŠ
.
	`£tText
(
	`_Œª¦©e
("Form", "..."))

246 
£lf
.
d‘asBŠ
.
	`£tToŞT
(
	`_Œª¦©e
("Form", "Details"))

247 
£lf
.
d‘asBŠ
.
	`£tText
(
	`_Œª¦©e
("Form", "..."))

	@widgets/spfbk_small.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #FÜm 
im¶em’tiÚ
 
g’”©ed
 
äom
 
»adšg
 
ui
 
fe
 'spfbk_small.ui'

4 #
#C»©ed 
by
: 
PyQt5
 
UI
 
code
 
g’”©Ü
 5.6

5 #
#WARNING! 
AÎ
 
chªges
 
made
 
š
 
this
 
fe
 
wl
 
be
 
lo¡
!

7 
äom
 
PyQt5
 
impÜt
 
	gQtCÜe
, 
	gQtGui
, 
	gQtWidg‘s


9 
şass
 
	$Ui_FÜm
(
objeù
):

10 
def
 
	$£tupUi
(
£lf
, 
FÜm
):

11 
FÜm
.
	`£tObjeùName
("Form")

12 
FÜm
.
	`»size
(351, 20)

13 
FÜm
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(0, 20))

14 
FÜm
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(500, 300))

15 
£lf
.
v”tiÿlLayout
 = 
QtWidg‘s
.
	`QVBoxLayout
(
FÜm
)

16 
£lf
.
v”tiÿlLayout
.
	`£tSizeCÚ¡¿št
(
QtWidg‘s
.
QLayout
.
S‘NoCÚ¡¿št
)

17 
£lf
.
v”tiÿlLayout
.
	`£tCÚ‹ÁsM¬gšs
(0, 0, 0, 0)

18 
£lf
.
v”tiÿlLayout
.
	`£tS·cšg
(0)

19 
£lf
.
v”tiÿlLayout
.
	`£tObjeùName
("verticalLayout")

20 
£lf
.
äame
 = 
QtWidg‘s
.
	`QF¿me
(
FÜm
)

21 
£lf
.
äame
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(351, 21))

22 
£lf
.
äame
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(351, 21))

23 
£lf
.
äame
.
	`£tF¿meSh­e
(
QtWidg‘s
.
QF¿me
.
StyËdPª–
)

24 
£lf
.
äame
.
	`£tF¿meShadow
(
QtWidg‘s
.
QF¿me
.
Rai£d
)

25 
£lf
.
äame
.
	`£tObjeùName
("frame")

26 
£lf
.
hÜizÚlLayout
 = 
QtWidg‘s
.
	`QHBoxLayout
(£lf.
äame
)

27 
£lf
.
hÜizÚlLayout
.
	`£tCÚ‹ÁsM¬gšs
(1, 1, 1, 1)

28 
£lf
.
hÜizÚlLayout
.
	`£tS·cšg
(2)

29 
£lf
.
hÜizÚlLayout
.
	`£tObjeùName
("horizontalLayout")

30 
£lf
.
mŒNameFld
 = 
QtWidg‘s
.
	`QLab–
(£lf.
äame
)

31 
£lf
.
mŒNameFld
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(100, 0))

32 
£lf
.
mŒNameFld
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(16777215, 16777215))

33 
£lf
.
mŒNameFld
.
	`£tBa£Size
(
QtCÜe
.
	`QSize
(0, 0))

34 
fÚt
 = 
QtGui
.
	`QFÚt
()

35 
fÚt
.
	`£tPoštSize
(8)

36 
fÚt
.
	`£tBŞd
(
True
)

37 
fÚt
.
	`£tIlic
(
F®£
)

38 
fÚt
.
	`£tWeight
(75)

39 
£lf
.
mŒNameFld
.
	`£tFÚt
(
fÚt
)

40 
£lf
.
mŒNameFld
.
	`£tAutoFlBackground
(
True
)

41 
£lf
.
mŒNameFld
.
	`£tF¿meSh­e
(
QtWidg‘s
.
QF¿me
.
StyËdPª–
)

42 
£lf
.
mŒNameFld
.
	`£tF¿meShadow
(
QtWidg‘s
.
QF¿me
.
Sunk’
)

43 
£lf
.
mŒNameFld
.
	`£tAlignm’t
(
QtCÜe
.
Qt
.
AlignC’‹r
)

44 
£lf
.
mŒNameFld
.
	`£tPrİ”ty
("movšg", 
F®£
)

45 
£lf
.
mŒNameFld
.
	`£tObjeùName
("mtrNameFld")

46 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
mŒNameFld
)

47 
£lf
.
£tPosFld
 = 
QtWidg‘s
.
	`QLšeEd™
(£lf.
äame
)

48 
£lf
.
£tPosFld
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(50, 0))

49 
£lf
.
£tPosFld
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(70, 16777215))

50 
fÚt
 = 
QtGui
.
	`QFÚt
()

51 
fÚt
.
	`£tPoštSize
(8)

52 
fÚt
.
	`£tBŞd
(
F®£
)

53 
fÚt
.
	`£tWeight
(50)

54 
£lf
.
£tPosFld
.
	`£tFÚt
(
fÚt
)

55 
£lf
.
£tPosFld
.
	`£tToŞT
("")

56 
£lf
.
£tPosFld
.
	`£tStyËSh“t
("")

57 
£lf
.
£tPosFld
.
	`£tObjeùName
("setPosFld")

58 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
£tPosFld
)

59 
£lf
.
posFbkLbl
 = 
QtWidg‘s
.
	`QLab–
(£lf.
äame
)

60 
£lf
.
posFbkLbl
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(80, 0))

61 
£lf
.
posFbkLbl
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(70, 30))

62 
£lf
.
posFbkLbl
.
	`£tBa£Size
(
QtCÜe
.
	`QSize
(0, 0))

63 
·Ë‰e
 = 
QtGui
.
	`QP®‘‹
()

64 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

65 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

66 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

67 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

68 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

69 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

70 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

71 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

72 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Light
, 
brush
)

73 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

74 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

75 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Midlight
, 
brush
)

76 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

77 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

78 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
D¬k
, 
brush
)

79 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

80 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

81 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Mid
, 
brush
)

82 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

83 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

84 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Text
, 
brush
)

85 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

86 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

87 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
BrightText
, 
brush
)

88 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

89 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

90 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

91 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

92 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

93 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Ba£
, 
brush
)

94 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

95 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

96 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

97 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

98 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

99 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Shadow
, 
brush
)

100 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

101 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

102 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

103 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

104 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

105 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

106 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

107 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

108 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

109 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

110 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

111 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

112 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

113 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

114 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

115 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

116 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

117 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Light
, 
brush
)

118 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

119 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

120 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Midlight
, 
brush
)

121 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

122 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

123 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
D¬k
, 
brush
)

124 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

125 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

126 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Mid
, 
brush
)

127 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

128 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

129 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Text
, 
brush
)

130 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

131 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

132 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
BrightText
, 
brush
)

133 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

134 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

135 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

136 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

137 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

138 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Ba£
, 
brush
)

139 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

140 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

141 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

142 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

143 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

144 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Shadow
, 
brush
)

145 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

146 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

147 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

148 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

149 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

150 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

151 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

152 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

153 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

154 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

155 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

156 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

157 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

158 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

159 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

160 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

161 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

162 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Light
, 
brush
)

163 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

164 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

165 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Midlight
, 
brush
)

166 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

167 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

168 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
D¬k
, 
brush
)

169 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

170 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

171 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Mid
, 
brush
)

172 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

173 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

174 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Text
, 
brush
)

175 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

176 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

177 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
BrightText
, 
brush
)

178 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

179 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

180 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

181 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

182 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

183 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Ba£
, 
brush
)

184 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

185 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

186 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

187 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

188 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

189 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Shadow
, 
brush
)

190 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

191 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

192 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

193 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

194 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

195 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

196 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

197 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

198 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

199 
£lf
.
posFbkLbl
.
	`£tP®‘‹
(
·Ë‰e
)

200 
fÚt
 = 
QtGui
.
	`QFÚt
()

201 
fÚt
.
	`£tPoštSize
(8)

202 
fÚt
.
	`£tBŞd
(
True
)

203 
fÚt
.
	`£tWeight
(75)

204 
£lf
.
posFbkLbl
.
	`£tFÚt
(
fÚt
)

205 
£lf
.
posFbkLbl
.
	`£tAutoFlBackground
(
True
)

206 
£lf
.
posFbkLbl
.
	`£tF¿meSh­e
(
QtWidg‘s
.
QF¿me
.
StyËdPª–
)

207 
£lf
.
posFbkLbl
.
	`£tF¿meShadow
(
QtWidg‘s
.
QF¿me
.
Sunk’
)

208 
£lf
.
posFbkLbl
.
	`£tAlignm’t
(
QtCÜe
.
Qt
.
AlignC’‹r
)

209 
£lf
.
posFbkLbl
.
	`£tObjeùName
("posFbkLbl")

210 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
posFbkLbl
)

211 
£lf
.
un™sLbl
 = 
QtWidg‘s
.
	`QLab–
(£lf.
äame
)

212 
£lf
.
un™sLbl
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(35, 0))

213 
fÚt
 = 
QtGui
.
	`QFÚt
()

214 
fÚt
.
	`£tPoštSize
(8)

215 
fÚt
.
	`£tBŞd
(
True
)

216 
fÚt
.
	`£tWeight
(75)

217 
£lf
.
un™sLbl
.
	`£tFÚt
(
fÚt
)

218 
£lf
.
un™sLbl
.
	`£tAlignm’t
(
QtCÜe
.
Qt
.
AlignC’‹r
)

219 
£lf
.
un™sLbl
.
	`£tObjeùName
("unitsLbl")

220 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
un™sLbl
)

221 
£lf
.
¡İBŠ
 = 
QtWidg‘s
.
	`QToŞBu‰Ú
(£lf.
äame
)

222 
£lf
.
¡İBŠ
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(20, 20))

223 
fÚt
 = 
QtGui
.
	`QFÚt
()

224 
fÚt
.
	`£tK”nšg
(
True
)

225 
£lf
.
¡İBŠ
.
	`£tFÚt
(
fÚt
)

226 
£lf
.
¡İBŠ
.
	`£tAutoR•—tIÁ”v®
(101)

227 
£lf
.
¡İBŠ
.
	`£tObjeùName
("stopBtn")

228 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
¡İBŠ
)

229 
£lf
.
d‘asBŠ
 = 
QtWidg‘s
.
	`QToŞBu‰Ú
(£lf.
äame
)

230 
£lf
.
d‘asBŠ
.
	`£tObjeùName
("detailsBtn")

231 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
d‘asBŠ
)

232 
£lf
.
v”tiÿlLayout
.
	`addWidg‘
(£lf.
äame
)

234 
£lf
.
	`»Œª¦©eUi
(
FÜm
)

235 
QtCÜe
.
QM‘aObjeù
.
	`cÚÃùSlÙsByName
(
FÜm
)

237 
def
 
	$»Œª¦©eUi
(
£lf
, 
FÜm
):

238 
_Œª¦©e
 = 
QtCÜe
.
QCÜeAµliÿtiÚ
.
Œª¦©e


239 
FÜm
.
	`£tWšdowT™Ë
(
	`_Œª¦©e
("Form", "Form"))

240 
£lf
.
mŒNameFld
.
	`£tText
(
	`_Œª¦©e
("Form", "mtrName"))

241 
£lf
.
£tPosFld
.
	`£tText
(
	`_Œª¦©e
("Form", "0.0"))

242 
£lf
.
posFbkLbl
.
	`£tText
(
	`_Œª¦©e
("Form", "0.0"))

243 
£lf
.
un™sLbl
.
	`£tText
(
	`_Œª¦©e
("Form", "mrad"))

244 
£lf
.
¡İBŠ
.
	`£tToŞT
(
	`_Œª¦©e
("Form", "Stop"))

245 
£lf
.
¡İBŠ
.
	`£tText
(
	`_Œª¦©e
("Form", "..."))

246 
£lf
.
d‘asBŠ
.
	`£tToŞT
(
	`_Œª¦©e
("Form", "Details"))

247 
£lf
.
d‘asBŠ
.
	`£tText
(
	`_Œª¦©e
("Form", "..."))

	@widgets/thumbnailViewer.py

2 
C»©ed
 
	gÚ
 2016-10-11

4 @
	gauthÜ
: 
b”gr


6 
The
 
basic
 
İ”©iÚ
 
of
 
this
 
widg‘
 
is
 
to
 
cÚÃù
Ø
a
 
DœeùÜyMÚ™Ü
 
şass
 
th©
 
wl
 
d‘eù
 
wh’
‡ 
	$fe
(
s
è
¬e
 
added
/
»moved
 
to
/
äom
 
a
 
dœeùÜy
.

8 
This
 
şass
 
wl
 
·ss
 
a
 
Queue
 
to
 
the
 
	$DœeùÜyMÚ™Ü
(è
th©
 
wl
 
be
 
u£d
 
to
 
£nd
 
šfÜm©iÚ
 
back
 
äom
 
the
 
	$DI»tÜyMÚ™Ü
(è
şass
.

10 
Wh’
 
a
 
chªge
 
to
 
the
 
dœeùÜy
 
has
 
occu¼ed
h
	$DI»ùÜyMÚ™Ü
(è
wl
 
cŞËù
 
the
 
chªges
 
š
 
two
 
ÿ‹gÜ›s
, 'added' 
ªd
 '»moved', 
the£
 wÈ
be
 
added


11 
to
 
a
 
diùiÚ¬y
 
th©
 
cÚšs
 
the£
 
ÿ‹gÜ›s
 
as
 
key
 
wÜds
, 
cÚšed
 
š
 
—ch
 
is
‡ 
li¡
 
of
 
the
 
f’ames
h© 
have
 
b“n
 
e™h”
 
added
 
Ü
 
»moved
. 
This


12 
diùiÚ¬y
 
wl
 
th’
 
be
 
wr™‹n
 
to
 
the
 
queue
 
ªd
h’h
	$DœeùÜyMÚ™Ü
(è
şass
 
wl
 
em™
 
™
' '
chªged
' sigÇl. Th'chªged 
sigÇl
' is monitored by

13 
the
 
	$CÚùSh“t
(è
©
 
which
 
pošt
 
™
 
wl
 
»ad
 
out
 
of
 
the
 
queue
 
®l
 oàth
added
/
»moved
 
diùiÚ¬›s
 
·ssšg
 
th©
 
šfÜm©iÚ
 
off
 
to
h
g¿phics
 
widg‘


14 
funùiÚs
 
th©
 
hªdË
 
ü—tšg
 
the
 
g¿phics
 
—ch
 
d©a
 
fe
.

17 
impÜt
 
sys


18 
impÜt
 
os


19 
impÜt
 
™”toŞs


20 
impÜt
 
sim¶ejsÚ
 
as
 
jsÚ


21 
impÜt
 
Queue


22 
impÜt
 
numpy
 
as
 
Å


24 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
QtGui
, 
QtWidg‘s


26 
äom
 
bcm
.
deviû
.
•u
 
impÜt
 
cÚv”t_w¿µ”_•u_to_¡r


28 
äom
 
şs
.
uts
.
images
 
impÜt
 
¬¿y_to_g¿y_qpixm­


30 
äom
 
şs
.
­¶iÿtiÚs
.
pyStxm
 
impÜt
 
abs_·th_to_ši_fe


31 
äom
 
şs
.
­p_d©a
.
deçuÉs
 
impÜt
 
ma¡”_cŞÜs
, 
g‘_¡yË
, 
rgb_as_hex


33 
äom
 
şs
.
uts
.
¬¿ys
 
impÜt
 
æ_d©a_upsdown


34 
äom
 
şs
.
­pWidg‘s
.
dŸlogs
 
impÜt
 
£tExi¡šgDœeùÜy


35 
äom
 
şs
.
uts
.
dœli¡
 
impÜt
 dirlist

36 
äom
 
şs
.
uts
.
feUts
 
impÜt
 
g‘_fe_·th_as_·¹s


37 
äom
 
şs
.
uts
.
log
 
impÜt
 
g‘_moduË_logg”
, 
log_to_qt


38 
äom
 
şs
.
uts
.
cfg·r£r
 
impÜt
 
CÚfigCÏss


39 
äom
 
şs
.
uts
.
diù_uts
 
impÜt
 
dù_g‘
, 
dù_put


40 
äom
 
şs
.
sÿÂšg
.
ty³s
 
impÜt
 
¥©Ÿl_ty³_´efix
, 
image_ty³s
, 
sÿn_image_ty³s
, 
sÿn_ty³s
, 
sÿn_sub_ty³s
, 
§m¶e_pos™iÚšg_modes


41 
äom
 
şs
.
­¶iÿtiÚs
.
bioXasIM
.
d©a
.
bioxas_im_d©a_io
 
impÜt
 
BioxasD©aIo


42 
äom
 
şs
.
¶ÙWidg‘s
.
imageWidg‘
 
impÜt
 
make_deçuÉ_¡ªd_®Úe_¡xm_imagewidg‘


43 
äom
 
şs
.
uts
.
roi_uts
 
impÜt
 
g‘_fœ¡_¥_db_äom_wdg_com


44 
äom
 
şs
.
uts
.
roi_diù_defs
 
impÜt
 *

45 
äom
 
şs
.
uts
.
feSy¡emMÚ™Ü
 
impÜt
 
DœeùÜyMÚ™Ü


47 
­pCÚfig
 = 
	$CÚfigCÏss
(
abs_·th_to_ši_fe
)

48 
icoDœ1
 = 
­pCÚfig
.
	`g‘_v®ue
('DEFAULT', 'icoDir1')

50 
_logg”
 = 
	$g‘_moduË_logg”
(
__Çme__
)

52 
MAX_THUMB_COLUMNS
 = 3

53 
THMB_SIZE
 = 90

54 
SCENE_WIDTH
 = 290.0

55 
THUMB_WIDTH
 = 150.0

56 
THUMB_HEIGHT
 = 130.0

59 
COLORTABLE
=[]

60 
i
 
š
 
	`¿nge
(256): 
COLORTABLE
.
	`­³nd
(
QtGui
.
	`qRgb
(i/4,i,i/2))

64 
şass
 
	$ThumbÇWidg‘
(
QtWidg‘s
.
QG¿phicsWidg‘
):

65 
upd©e_v›w
 = 
QtCÜe
.
	$pyqtSigÇl
()

66 
£Ëù
 = 
QtCÜe
.
	$pyqtSigÇl
(
objeù
)

67 
Ïunch_v›w”
 = 
QtCÜe
.
	$pyqtSigÇl
(
objeù
)

68 
d¿g
 = 
QtCÜe
.
	$pyqtSigÇl
(
objeù
, object)

70 
def
 
	$__š™__
(
£lf
, 
âame
, 
¥_db
, 
d©a
, 
t™Ë
, 
šfo_dù
, 
·»Á
 = 
NÚe
):

72 
	$__š™__
(): 
desütiÚ


74 :
·¿m
 
âame
: fÇm
desütiÚ


75 :
ty³
 
âame
: fnameype

77 :
·¿m
 
¥_db
: sp_db 
desütiÚ


78 :
ty³
 
¥_db
: sp_dbype

80 :
·¿m
 
d©a
: d©¨
desütiÚ


81 :
ty³
 
d©a
: dataype

83 :
·¿m
 
t™Ë
:™Ë 
desütiÚ


84 :
ty³
 
t™Ë
:itleype

86 :
·¿m
 
šfo_dù
: info_dù 
desütiÚ


87 :
ty³
 
šfo_dù
: info_dctype

89 :
·¿m
 
·»Á
=
NÚe
:…¬’t=NÚ
desütiÚ


90 :
ty³
 
·»Á
=
NÚe
:…arent=Noneype

92 :
»tuºs
: 
NÚe


95 
This
 
şass
 
is
 
u£d
 
to
 
ü—‹
 
a
 
sšgË
 
g¿phics
 
widg‘
 
th©
 
di¥Ïys
‡ 
thumbÇ
 
of


96 
a
 
¡xm
 
image
 
d©a
, 
the
 
thumbÇ
 
is
 
ü—‹d
 
äom
hd©¨
£ùiÚ
 
of
h
hdf5
 
fe


98 
QtWidg‘s
.
QG¿phicsWidg‘
.
	$__š™__
(
£lf
, 
·»Á
)

99 
£lf
.
·»Á
 =…arent

100 
âame
 = 
	$¡r
(
âame
)

101 
d©a_dœ
, 
å»fix
, 
fsuffix
 = 
	$g‘_fe_·th_as_·¹s
(
âame
)

102 if(
t™Ë
 
is
 
NÚe
):

103 
£lf
.
t™Ë
 = 
	$¡r
(
å»fix
)

105 
£lf
.
t™Ë
 =itle

107 
£lf
.
d©a
 = data

108 
£lf
.
¥_db
 = sp_db

109 
£lf
.
Ïb–height
 = 20

110 
£lf
.
bÜd”size
 = 1

112 
£lf
.
hdf5_·th
 = 
âame


113 
£lf
.
d©a_dœ
 = data_dir

114 
£lf
.
âame
 = fname

115 
£lf
.
³n
 = 
QtGui
.
	$QP’
()

116 
£lf
.
³n
.
	`£tWidth
(2)

117 
£lf
.
³n
.
	$£tBrush
(
QtCÜe
.
Qt
.
bÏck
)

118 
£lf
.
³n
.
	$£tStyË
(
QtCÜe
.
Qt
.
SŞidLše
)

119 
£lf
.
is_£Ëùed
 = 
F®£


120 
£lf
.
v®id_fe
 = 
F®£


121 
£lf
.
pic
 = 
NÚe


122 
£lf
.
šfo_¡r
 = 
šfo_dù
['info_str']

123 
£lf
.
šfo_j¡r
 = 
šfo_dù
['info_jstr']

125 
£lf
.
v®id_fe
 = 
True


126 
£lf
.
pic
 = s–f.
	$g‘pic
()

127 
£lf
.
	$£tToŞT
(
£lf
.
šfo_¡r
)

128 
£lf
.
	$£tAcû±Hov”Ev’ts
(
True
)

130 
def
 
	$is_v®id
(
£lf
):

132 
	$is_v®id
(): 
desütiÚ


134 :
»tuºs
: 
NÚe


136 (
£lf
.
v®id_fe
)

140 
def
 
	$boundšgReù
(
£lf
):

142 
	$boundšgReù
(): 
desütiÚ


144 :
»tuºs
: 
NÚe


146 if(
£lf
.
pic
 
is
 
nÙ
 
NÚe
):

147 
width
 = 
£lf
.
pic
.
	`»ù
().
	`width
(è+ s–f.
bÜd”size
 * 2

148 
height
 = 
£lf
.
pic
.
	`»ù
().
	`height
(è+ s–f.
Ïb–height
 + s–f.
bÜd”size
 * 2

149 
thumb_widg‘_»ù
 = 
QtCÜe
.
	`QReùF
(0.0, 0.0, 
width
, 
height
)

152 
thumb_widg‘_»ù
 = 
QtCÜe
.
	`QReùF
(0.0, 0.0, 
THUMB_WIDTH
, 
THUMB_HEIGHT
)

153 #thumb_widg‘_»ù = 
QtCÜe
.
	`QReùF
()

155 #£lf.
_boundšgReù
 = 
thumb_widg‘_»ù


156  
thumb_widg‘_»ù


158 
def
 
	`sizeHšt
(
£lf
, 
which
, 
cÚ¡¿št
 = 
QtCÜe
.
	$QSizeF
()):

160 
	$sizeHšt
(): 
desütiÚ


162 :
·¿m
 
which
: which 
desütiÚ


163 :
ty³
 
which
: whichype

165 :
·¿m
 
cÚ¡¿št
=
QtCÜe
.
	$QSizeF
(): 
cÚ¡¿št
=
QtCÜe
.
	$QSizeF
(è
desütiÚ


166 :
ty³
 
cÚ¡¿št
=
QtCÜe
.
	$QSizeF
(): 
cÚ¡¿št
=
QtCÜe
.
	$QSizeF
(è
ty³


168 :
»tuºs
: 
NÚe


170 
br
 = 
£lf
.
	$boundšgReù
()

171  
br
.
	$size
()

173 
def
 
	$g‘pic
(
£lf
):

175 
	$g‘pic
(): 
desütiÚ


177 :
»tuºs
: 
NÚe


179 if(
£lf
.
d©a
 
is
 
nÙ
 
NÚe
):

180 if(
	`Ën
(
£lf
.
d©a
.
sh­e
) == 2):

181 
wd
, 
ht
 = 
£lf
.
d©a
.
sh­e


182 #d©¨ğ
Å
.
	`æud
(
£lf
.
d©a
)

183 #d©¨ğ
£lf
.
d©a


184 
d©a
 = 
	$æ_d©a_upsdown
(
£lf
.
d©a
)

185 
sh­e
 = 
d©a
.shape

187 
	`–if
(
	`Ën
(
£lf
.
d©a
.
sh­e
) == 3):

188 
img_£q
, 
wd
, 
ht
 = 
£lf
.
d©a
.
sh­e


189 #d©¨ğ
Å
.
	`æud
(
£lf
.
d©a
[0])

190 #d©¨ğ
£lf
.
d©a
[0]

191 
d©a
 = 
	`æ_d©a_upsdown
(
£lf
.data[0])

192 
sh­e
 = 
d©a
.shape

195 #_logg”.
	`”rÜ
('unsupported data shape')

196 (
NÚe
)

198 
_logg”
.
	`”rÜ
('d©¨i NÚš [%s]' % 
£lf
.
hdf5_·th
)

199 (
NÚe
)

201 #cÚv”ˆ
™
 
to
 
a
 
QPixm­
 
di¥Ïy
:

202 
pm­
 = 
	$¬¿y_to_g¿y_qpixm­
(
d©a
)

203 #pm­ = 
pm­
.
	`sÿËd
(
QtCÜe
.
	`QSize
(128,128), QtCÜe.
Qt
.
K“pA¥eùR©io
)

204 
pm­
 =…m­.
	`sÿËd
(
QtCÜe
.
	$QSize
(
THMB_SIZE
,THMB_SIZE))

206  
pm­


208 
def
 
	$·št
(
£lf
, 
·š‹r
, 
İtiÚ
, 
widg‘
):

210 
	$·št
(): 
desütiÚ


212 :
·¿m
 
·š‹r
:…aš‹¸
desütiÚ


213 :
ty³
 
·š‹r
:…ainterype

215 :
·¿m
 
İtiÚ
: o±iÚ 
desütiÚ


216 :
ty³
 
İtiÚ
: optionype

218 :
·¿m
 
widg‘
: widg‘ 
desütiÚ


219 :
ty³
 
widg‘
: widgetype

221 :
»tuºs
: 
NÚe


223 if(
£lf
.
pic
 
is
 
nÙ
 
NÚe
):

224 if(
£lf
.
is_£Ëùed
):

225 
£lf
.
³n
.
	$£tBrush
(
QtCÜe
.
Qt
.
blue
)

227 
£lf
.
³n
.
	$£tBrush
(
QtCÜe
.
Qt
.
bÏck
)

228 
£lf
.
³n
.
	$£tStyË
(
QtCÜe
.
Qt
.
SŞidLše
)

230 
·š‹r
.
	$£tP’
(
£lf
.
³n
)

231 #D¿w 
bÜd”


232 
·š‹r
.
	`d¿wReù
(
QtCÜe
.
	`QReù
(0,

234 
£lf
.
pic
.
	`»ù
().
	`width
(è+ s–f.
bÜd”size
,

235 
£lf
.
pic
.
	`»ù
().
	`height
(è+ s–f.
Ïb–height
 + s–f.
bÜd”size
))

237 #FÈ
Ïb–


238 
·š‹r
.
	`flReù
(
QtCÜe
.
	`QReù
(
£lf
.
bÜd”size
,

239 
£lf
.
bÜd”size
 + s–f.
pic
.
	`»ù
().
	`height
(),

240 
£lf
.
pic
.
	`»ù
().
	`width
(),

241 
£lf
.
Ïb–height
),

242 
QtCÜe
.
Qt
.
g¿y
)

244 #D¿w 
image


245 
·š‹r
.
	`d¿wPixm­
(
QtCÜe
.
	`QReù
(
£lf
.
bÜd”size
,

246 
£lf
.
bÜd”size
,

247 
£lf
.
pic
.
	`»ù
().
	`width
(),

248 
£lf
.
pic
.
	`»ù
().
	`height
()),

249 
£lf
.
pic
,

250 
£lf
.
pic
.
	$»ù
())

252 #D¿w 
‹xt


253 
‹xt_»ù
 = 
QtCÜe
.
	`QReù
(0,

254 
£lf
.
pic
.
	`»ù
().
	`y
(è+ s–f.pic.»ù().
	`height
(),

255 
£lf
.
pic
.
	`»ù
().
	`width
(),

256 
£lf
.
Ïb–height
)

258 
·š‹r
.
	$d¿wText
(
‹xt_»ù
, 
QtCÜe
.
Qt
.
AlignC’‹r
, 
£lf
.
t™Ë
)

261 
def
 
	$mou£P»ssEv’t
(
£lf
, 
ev’t
):

263 
	$mou£P»ssEv’t
(): 
desütiÚ


265 :
·¿m
 
ev’t
:ƒv’ˆ
desütiÚ


266 :
ty³
 
ev’t
:ƒventype

268 :
»tuºs
: 
NÚe


270 
bŠ
 = 
ev’t
.
	$bu‰Ú
()

272 if(
£lf
.
is_£Ëùed
):

273 
£lf
.
is_£Ëùed
 = 
F®£


275 
£lf
.
is_£Ëùed
 = 
True


277 
£lf
.
£Ëù
.
	$em™
(
£lf
)

278 
£lf
.
	`upd©e
(
QtCÜe
.
	`QReùF
(0.0,

280 
£lf
.
pic
.
	`»ù
().
	`width
(è+ s–f.
bÜd”size
,

281 
£lf
.
pic
.
	`»ù
().
	`height
(è+ s–f.
Ïb–height
 + s–f.
bÜd”size
))

282 
QtWidg‘s
.
QG¿phicsI‹m
.
	$mou£P»ssEv’t
(
£lf
, 
ev’t
)

284 
bŠ
 =ğ
QtCÜe
.
Qt
.
LeáBu‰Ú
:

285 
£lf
.
d¿g
.
	$em™
(
£lf
, 
ev’t
)

289 
def
 
	$cÚ‹xtM’uEv’t
(
£lf
, 
ev’t
):

291 
	$cÚ‹xtM’uEv’t
(): 
desütiÚ


293 :
·¿m
 
ev’t
:ƒv’ˆ
desütiÚ


294 :
ty³
 
ev’t
:ƒventype

296 :
»tuºs
: 
NÚe


299 
m’u
 = 
QtWidg‘s
.
	$QM’u
()

300 #lßdAùiÚ = 
QtWidg‘s
.
	`QAùiÚ
("Lßd Sÿn", 
£lf
)

301 
ÏunchAùiÚ
 = 
QtWidg‘s
.
	`QAùiÚ
("Launch iÀV›w”", 
£lf
)

302 #lßdAùiÚ.
Œigg”ed
.
	`cÚÃù
(
£lf
.
lßd_sÿn
)

303 
ÏunchAùiÚ
.
Œigg”ed
.
	$cÚÃù
(
£lf
.
Ïunch_vwr
)

305 #m’u.
	`addAùiÚ
(
lßdAùiÚ
)

306 
m’u
.
	$addAùiÚ
(
ÏunchAùiÚ
)

307 
m’u
.
	`exec_
(
ev’t
.
	$sü“nPos
())

309 
def
 
	$lßd_sÿn
(
£lf
):

311 
	$lßd_sÿn
(): 
desütiÚ


313 :
»tuºs
: 
NÚe


315 
´št
 'lßdšg %s.hdf5' % 
£lf
.
hdf5_·th


318 
def
 
	$Ïunch_vwr
(
£lf
):

320 
	$Ïunch_vwr
(): 
desütiÚ


322 :
»tuºs
: 
NÚe


324 #´šˆ'Ïunch_v›w” %s.hdf5' % 
£lf
.
hdf5_·th


325 if(
£lf
.
d©a
.
ndim
 == 3):

327 
l
 = 
	`Ën
(
£lf
.
t™Ë
.
	`¥l™
('.')[0].split('_'))

328 if(
l
 > 1):

329 #found 
a
 '_' 
ch¬aù”
 
šdiÿtšg
 
™s
‡ 
¡ack
 
image


330 
i
 = (
£lf
.
t™Ë
.
	`¥l™
('.')[0].split('_')[1])

331 
d©a
 = 
£lf
.d©a[
i
]

333 #™ 
a
 
sšgË
 
image


334 
d©a
 = 
£lf
.data[0]

336 if(
£lf
.
d©a
.
ndim
 == 2):

337 
d©a
 = 
£lf
.data

339 
dù
 = {
	}
}

340 #beÿu£ 
the
 
d©a
 
š
h
StxmImageWidg‘
 
is
 
di¥Ïyed
 
w™h
 0
Y
 
©
h
btm


341 #ªd 
maxY
 
©
 
the
 
tİ
 
I
 
mu¡
 
æ
 
™
 
befÜe
 
£ndšg
 it

342 #dù['d©a'] = 
Å
.
æud
(
d©a
)

343 
dù
['d©a'] = 
d©a


344 
dù
['·th'] = 
£lf
.
hdf5_·th


345 
dù
['¥_db'] = 
£lf
.
¥_db


346 
dù
['t™Ë'] = 
NÚe


347 if(
£lf
.
¥_db
 
is
 
nÙ
 
NÚe
):

348 
dù
['t™Ë'] = 
£lf
.
t™Ë


349 
£lf
.
Ïunch_v›w”
.
	$em™
(
dù
)

351 
def
 
	$mou£Hov”Ev’t
(
£lf
, 
ev’t
):

353 
	$mou£Hov”Ev’t
(): 
desütiÚ


355 :
·¿m
 
ev’t
:ƒv’ˆ
desütiÚ


356 :
ty³
 
ev’t
:ƒventype

358 :
»tuºs
: 
NÚe


360 
	`´št
('Widgetƒnter')

362 
def
 
	$mou£R–—£Ev’t
(
£lf
, 
ev’t
):

364 
	$mou£R–—£Ev’t
(): 
desütiÚ


366 :
·¿m
 
ev’t
:ƒv’ˆ
desütiÚ


367 :
ty³
 
ev’t
:ƒventype

369 :
»tuºs
: 
NÚe


371 
QtWidg‘s
.
QG¿phicsI‹m
.
	$mou£R–—£Ev’t
(
£lf
, 
ev’t
)

374 
def
 
	$hov”EÁ”Ev’t
(
£lf
, 
ev’t
):

376 
	$hov”EÁ”Ev’t
(): 
desütiÚ


378 :
·¿m
 
ev’t
:ƒv’ˆ
desütiÚ


379 :
ty³
 
ev’t
:ƒventype

381 :
»tuºs
: 
NÚe


383 
·ss


384 #£lf.
³n
.
	`£tStyË
(
QtCÜe
.
Qt
.
DÙLše
)

385 #QtWidg‘s.
QG¿phicsWidg‘
.
	`hov”EÁ”Ev’t
(
£lf
, 
ev’t
)

387 
def
 
	$hov”L—veEv’t
(
£lf
, 
ev’t
):

389 
	$hov”L—veEv’t
(): 
desütiÚ


391 :
·¿m
 
ev’t
:ƒv’ˆ
desütiÚ


392 :
ty³
 
ev’t
:ƒventype

394 :
»tuºs
: 
NÚe


396 
·ss


397 #£lf.
³n
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidLše
)

398 #QtWidg‘s.
QG¿phicsWidg‘
.
	`hov”L—veEv’t
(
£lf
, 
ev’t
)

400 
def
 
	$g‘_pixm­
(
âame
):

402 
	$g‘_pixm­
(): 
desütiÚ


404 :
·¿m
 
	`g‘_pixm­
(
âame
: g‘_pixm­(âam
desütiÚ


405 :
ty³
 
	`g‘_pixm­
(
âame
: get_pixmap(fnameype

407 :
»tuºs
: 
NÚe


409 
pm­
 = 
QtGui
.
	$QPixm­
(
âame
)

410 #pm­.
	`sÿËd
(64, 64)#, 
a¥eùR©ioMode
=
Qt_IgnÜeA¥eùR©io
, 
ŒªsfÜmMode
=
Qt_Fa¡T¿nsfÜm©iÚ
)

411 
pm­
 =…m­.
	`sÿËd
(
QtCÜe
.
	`QSize
(16,16), QtCÜe.
Qt
.
K“pA¥eùR©io
)

412 (
pm­
)

415 
şass
 
	$MašG¿phicsWidg‘
(
QtWidg‘s
.
QG¿phicsWidg‘
):

416 
def
 
	$__š™__
(
£lf
):

418 
	$__š™__
(): 
desütiÚ


420 :
»tuºs
: 
NÚe


422 
QtWidg‘s
.
QG¿phicsWidg‘
.
	$__š™__
(
£lf
)

423 
£lf
.
gridÏyout
 = 
QtWidg‘s
.
	$QG¿phicsGridLayout
()

424 
£lf
.
gridÏyout
.
	`£tCÚ‹ÁsM¬gšs
(0, 5, 5, 0)

425 
£lf
.
	$£tLayout
(
£lf
.
gridÏyout
)

427 
def
 
	$£t_Ïyout_size
(
£lf
, 
qr
):

429 
	$£t_Ïyout_size
(): 
desütiÚ


431 :
·¿m
 
qr
: q¸
desütiÚ


432 :
ty³
 
qr
: qrype

434 :
»tuºs
: 
NÚe


436 
gwl
 = 
£lf
.
	$Ïyout
()

437 
gwl
.
	`£tGeom‘ry
(
QtCÜe
.
	`QReùF
(
qr
.
	`x
(), qr.
	`y
(), qr.
	`width
(), 
THUMB_HEIGHT
))

438 
gwl
.
	$upd©eGeom‘ry
()

440 
def
 
	$boundšgReù
(
£lf
):

442 
	$boundšgReù
(): 
desütiÚ


444 :
»tuºs
: 
NÚe


446 #´šˆ
£lf
.
gridÏyout
.
	`cÚ‹ÁsReù
()

447 (
£lf
.
gridÏyout
.
	$cÚ‹ÁsReù
())

449 
def
 
	$ş—r_Ïyout
(
£lf
):

451 
	$ş—r_Ïyout
(): 
desütiÚ


453 :
»tuºs
: 
NÚe


455 if((
£lf
.
gridÏyout
.
	`rowCouÁ
(è=ğ0è
	`ªd
 (£lf.gridÏyout.
	`cŞumnCouÁ
() == 0)):

457 
row
 
š
 
	`¿nge
(
£lf
.
gridÏyout
.
	$couÁ
()):

458 #th
	`couÁ
(è
wl
 
chªge
 
as
 
the
 
™ems
 
¬e
 
»moved


459 #sØ
ju¡
 
k“p
 
puÎšg
 
them
 
äom
 
‹h
 
tİ
 [0]

460 
™em
 = 
£lf
.
gridÏyout
.
	`™emAt
(£lf.gridÏyout.
	`couÁ
()-1)

461 
£lf
.
gridÏyout
.
	`»moveAt
(£lf.gridÏyout.
	`couÁ
()-1)

462 
d–
 
™em


463 
£lf
.
	`£t_Ïyout_size
(
QtCÜe
.
	`QReùF
(£lf.
	`»ù
().
	`x
(), s–f.»ù().
	`y
(), s–f.»ù().
	`width
(), 
THUMB_HEIGHT
))

464 #£lf.
gridÏyout
.
	`upd©eGeom‘ry
()

466 
şass
 
	$CÚùSh“t
(
QtWidg‘s
.
QWidg‘
):

467 
def
 
	`__š™__
(
£lf
, 
d©a_dœ
=""):

469 
	$__š™__
(): 
desütiÚ


471 :
·¿m
 
d©a_dœ
="": d©a_dœ="" 
desütiÚ


472 :
ty³
 
d©a_dœ
="": data_dir=""ype

474 :
»tuºs
: 
NÚe


477 
QtWidg‘s
.
QWidg‘
.
	$__š™__
(
£lf
)

479 #£lf.
	`£tStyËSh“t
("QToolTip { color: #ffffff; background-color: #2a82da; border: 1px solid white; }")

480 #£lf.
	`£tStyËSh“t
("QToolTip { color: #ffffff; background-color:„gb(26, 106, 255); border: 1px solid white; }")

481 
£lf
.
	`£tStyËSh“t
("QToolTip { color:„gb(20, 20, 20); background-color:„gb(181, 179, 181); border: 1px solid grey; }")

483 
£lf
.
d©a_io
 = 
NÚe


484 
£lf
.
­²ame
 = "Contact Sheet"

485 
£lf
.
	`£tObjeùName
('contactSheet')

486 
£lf
.
wš
 = 
NÚe


487 
£lf
.
thumbs
 = []

488 
£lf
.
	$£tWšdowT™Ë
(
£lf
.
­²ame
)

489 
£lf
.
sûÃ
 = 
QtWidg‘s
.
	$QG¿phicsSûÃ
()

490 
£lf
.
sûÃ
.
	`£tBackgroundBrush
(
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(50, 50, 50)))

491 #£lf.
d©a_dœ
 = 
r
'C:/controls/py2.7/Beamlines/sm/data/guest/Apr29'

492 
£lf
.
d©a_dœ
 = ""

493 
£lf
.
image_fe_ex‹nsiÚ
 = '.jpg'

494 
£lf
.
d©a_fe_ex‹nsiÚ
 = '.hdf5'

495 
£lf
.
fÜm©s
 = '*' + s–f.
image_fe_ex‹nsiÚ


497 
£lf
.
dœ_lbl
 = 
QtWidg‘s
.
	`QLab–
('')

498 
£lf
.
dœ_lbl
.
	$£tAlignm’t
(
QtCÜe
.
Qt
.
AlignHC’‹r
)

499 
fÚt
 = 
£lf
.
dœ_lbl
.
	$fÚt
()

500 
fÚt
.
	$£tBŞd
(
True
)

501 
£lf
.
dœ_lbl
.
	$£tFÚt
(
fÚt
)

502 
£lf
.
dœ_lbl
.
cÚ‹xtM’uEv’t
 = s–f.
dœLab–CÚ‹xtM’uEv’t


503 # ğ'<¨¡yË="background-cŞÜ:¿n¥¬’t; cŞÜ: %s"><b>%s</b>\ˆ<¨bÜd”-width: 50px; styË="background-cŞÜ: %s; cŞÜ: %s"><b>%s</b> </a>' % (
t™Ë_cŞÜ
, 
t™Ë
, 
bgcŞÜ
, 
v¬_cŞÜ
, 
v¬
)

505 
£lf
.
»äeshBŠ
 = 
QtWidg‘s
.
	$QToŞBu‰Ú
()

506 
ico_dœ
 = 
icoDœ1


507 
ico_psize
 = '/64x64/'

508 
ico_şr
 = 'gray'

510 #pm­ = 
	`g‘_pixm­
(
ico_dœ
 + 
ico_şr
 + 
ico_psize
 + 'reload.png')

511 #£lf.
»äeshBŠ
.
	`icÚ
(
QtGui
.
	`QPixm­
(
pm­
))

512 #£lf.
»äeshBŠ
.
	`£tMaximumSize
(50, 25)

513 #£lf.
»äeshBŠ
.
şicked
.
	`cÚÃù
(
£lf
.
»lßd_v›w
)

515 
£lf
.
v›w
 = 
QtWidg‘s
.
	$QG¿phicsV›w
(
£lf
.
sûÃ
)

517 
£lf
.
cur_thumb_row
 = 0

518 
£lf
.
cur_thumb_cŞumn
 = 0

520 
£lf
.
f_queue
 = 
Queue
.
	$Queue
()

522 
£lf
.
fsys_mÚ
 = 
	$DœeùÜyMÚ™Ü
(
£lf
.
f_queue
)

523 #£lf.
fsys_mÚ
.
	`£t_fe_ex‹nsiÚ_f‹r
(
£lf
.
image_fe_ex‹nsiÚ
)

524 
£lf
.
fsys_mÚ
.
	`£t_fe_ex‹nsiÚ_f‹r
('hdf5')

525 
£lf
.
fsys_mÚ
.
	$£t_d©a_dœ
Ğ
£lf
.
d©a_dœ
)

526 #£lf.
fsys_mÚ
.
chªged
.
	`cÚÃù
(
£lf
.
Ú_dœ_chªged
)

527 
£lf
.
fsys_mÚ
.
chªged
.
	$cÚÃù
(
£lf
.
upd©e_fe_li¡
)

528 #£ˆ
QG¿phicsV›w
 
©Œibu‹s


529 #£lf.
v›w
.
	`£tR’d”Hšts
(
QtGui
.
QPaš‹r
.
AÁŸlŸsšg
 | QtGui.QPaš‹r.
HighQu®™yAÁŸlŸsšg
)

530 #£lf.
v›w
.
	`£tV›wpÜtUpd©eMode
(
QtWidg‘s
.
QG¿phicsV›w
.
Mšim®V›wpÜtUpd©e
)

531 
hÏyout
 = 
QtWidg‘s
.
	$QHBoxLayout
()

532 
vÏyout
 = 
QtWidg‘s
.
	$QVBoxLayout
()

533 
vÏyout
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

534 
hÏyout
.
	`£tCÚ‹ÁsM¬gšs
(1,1,1,1)

535 
hÏyout
.
	$addWidg‘
(
£lf
.
dœ_lbl
)

536 #hÏyout.
	`addWidg‘
(
£lf
.
»äeshBŠ
)

537 
vÏyout
.
	$addLayout
(
hÏyout
)

538 
vÏyout
.
	$addWidg‘
(
£lf
.
v›w
)

539 
£lf
.
	$£tLayout
(
vÏyout
)

540 #£lf.
g¿phics_wdg
 = 
QtWidg‘s
.
	`QG¿phicsWidg‘
()

541 
£lf
.
g¿phics_wdg
 = 
	$MašG¿phicsWidg‘
()

543 
£lf
.
sûÃ
.
	$addI‹m
(
£lf
.
g¿phics_wdg
)

545 
£lf
.
upd©eTim”
 = 
QtCÜe
.
	$QTim”
()

546 
£lf
.
upd©eTim”
.
timeout
.
	$cÚÃù
(
£lf
.
upd©e_fe_li¡
)

547 #£lf.
gridÏyout
 = 
QtWidg‘s
.
	`QG¿phicsGridLayout
()

548 #£lf.
gridÏyout
.
	`£tCÚ‹ÁsM¬gšs
(5, 5, 5, 5)

549 #£lf.
g¿phics_wdg
.
	`£tLayout
(
£lf
.
gridÏyout
)

550 
£lf
.
	$£t_d©a_dœ
(
d©a_dœ
)

551 #£lf.
upd©eTim”
.
	`¡¬t
(1000)

553 
def
 
	$upd©e_fe_li¡
(
£lf
):

554 
ÿÎ_sk_dÚe
 = 
F®£


555 
f_added
 = []

556 
f_»moved
 = []

557 
nÙ
 
£lf
.
f_queue
.
	$em±y
():

558 
»¥
 = 
£lf
.
f_queue
.
	$g‘
()

559 if('added' 
š
 
»¥
.
	$keys
()):

560 
f_added
 = 
»¥
['added']

561 
ÿÎ_sk_dÚe
 = 
True


563 if('»moved' 
š
 
»¥
.
	$keys
()):

564 
f_»moved
 = 
»¥
['removed']

565 
ÿÎ_sk_dÚe
 = 
True


567 if(
ÿÎ_sk_dÚe
):

568 
£lf
.
	`Ú_dœ_chªged
((
f_added
, 
f_»moved
))

569 
£lf
.
f_queue
.
	$sk_dÚe
()

571 
def
 
	$dœLab–CÚ‹xtM’uEv’t
(
£lf
, 
ev’t
):

573 
	$dœLab–CÚ‹xtM’uEv’t
(): 
desütiÚ


575 :
·¿m
 
ev’t
:ƒv’ˆ
desütiÚ


576 :
ty³
 
ev’t
:ƒventype

578 :
»tuºs
: 
NÚe


581 
m’u
 = 
QtWidg‘s
.
	$QM’u
()

582 
chgdœAùiÚ
 = 
QtWidg‘s
.
	`QAùiÚ
("ChªgDœeùÜy", 
£lf
)

583 
chgdœAùiÚ
.
Œigg”ed
.
	$cÚÃù
(
£lf
.
chªge_dœ
)

585 
m’u
.
	$addAùiÚ
(
chgdœAùiÚ
)

586 
m’u
.
	`exec_
(
ev’t
.
	$glob®Pos
())

588 
def
 
	$is_¡ack_dœ
(
£lf
, 
d©a_dœ
):

590 
	$is_¡ack_dœ
(): 
desütiÚ


592 :
·¿m
 
d©a_dœ
: d©a_dœ 
desütiÚ


593 :
ty³
 
d©a_dœ
: data_dirype

595 :
»tuºs
: 
NÚe


597 if(
	`Ën
(
d©a_dœ
) > 0):

598 
d_l¡
 = 
£lf
.
	$¥l™_d©a_dœ
(
d©a_dœ
)

599 
dÇme
 = 
d_l¡
[-1]

600 if(
os
.
·th
.
	`exi¡s
(
d©a_dœ
 + '/' + 
dÇme
 + '.hdf5')):

601 (
True
)

603 (
F®£
)

605 
_logg”
.
	`”rÜ
('Invalid data directory')

606 (
F®£
)

608 
def
 
	$g‘_¡ack_fe_Çme
(
£lf
, 
d©a_dœ
):

610 
	$g‘_¡ack_fe_Çme
(): 
desütiÚ


612 :
·¿m
 
d©a_dœ
: d©a_dœ 
desütiÚ


613 :
ty³
 
d©a_dœ
: data_dirype

615 :
»tuºs
: 
NÚe


617 
d_l¡
 = 
£lf
.
	$¥l™_d©a_dœ
(
d©a_dœ
)

618 
dÇme
 = 
d_l¡
[-1]

619 (
dÇme
 + '.hdf5')

621 
def
 
	$g‘_¡ack_d©a
(
£lf
, 
âame
):

623 
	$g‘_¡ack_d©a
(): 
desütiÚ


625 :
·¿m
 
âame
: fÇm
desütiÚ


626 :
ty³
 
âame
: fnameype

628 :
»tuºs
: 
NÚe


630 
âame
 = 
	$¡r
(
âame
)

631 
d©a_dœ
, 
å»fix
, 
fsuffix
 = 
	$g‘_fe_·th_as_·¹s
(
âame
)

632 if(
d©a_dœ
 
is
 
NÚe
):

633 #_logg”.
	`šfo
('ProbËm w™h f[%s]' % 
âame
)

634 (
NÚe
, None)

636 #ado_obj = 
£lf
.
	`g‘_’Œ›s
(
d©a_dœ
, 
å»fix
, 
fsuffix
)

637 #if(
ado_obj
 
is
 
NÚe
):

638 ##
_logg”
.
	`šfo
('ProbËm w™h f[%s]' % 
âame
)

640 
’Œy_dù
 = 
£lf
.
	$g‘_’Œ›s
(
d©a_dœ
, 
å»fix
, 
fsuffix
)

641 if(
’Œy_dù
 
is
 
NÚe
):

642 
_logg”
.
	`šfo
('ProbËm w™h f[%s]' % 
âame
)

643 (
NÚe
, None)

645 #wdg_com = 
	`dù_g‘
(
ado_obj
, 
ADO_CFG_WDG_COM
)

646 
ekey
 = 
’Œy_dù
.
	`keys
()[0]

647 
wdg_com
 = 
£lf
.
d©a_io
.
	$g‘_wdg_com_äom_’Œy
(
’Œy_dù
, 
ekey
)

648 
¥_db
 = 
	$g‘_fœ¡_¥_db_äom_wdg_com
(
wdg_com
)

649 #d©¨ğ
ado_obj
['DATA']

650 
d©a
 = 
£lf
.
	$g‘_d©a_äom_’Œy
(
’Œy_dù
, 
¡ack_dœ
=
True
)

652 (
¥_db
, 
d©a
 )

654 
def
 
	$g‘_¥_db_ªd_d©a
(
£lf
, 
âame
, 
¡ack_dœ
=
F®£
):

656 
	$g‘_¥_db_ªd_d©a
(): 
desütiÚ


658 :
·¿m
 
âame
: fÇm
desütiÚ


659 :
ty³
 
âame
: fnameype

661 :
»tuºs
: 
NÚe


663 
äom
 
şs
.
uts
.
roi_uts
 
impÜt
 
g‘_ado_obj_äom_wdg_com


665 
âame
 = 
	$¡r
(
âame
)

666 
d©a_dœ
, 
å»fix
, 
fsuffix
 = 
	$g‘_fe_·th_as_·¹s
(
âame
)

667 if(
d©a_dœ
 
is
 
NÚe
):

668 
_logg”
.
	`šfo
('ProbËm w™h f[%s]' % 
âame
)

669 (
NÚe
, None)

671 
’Œy_dù
 = 
£lf
.
	$g‘_’Œ›s
(
d©a_dœ
, 
å»fix
, 
fsuffix
)

672 if(
’Œy_dù
 
is
 
NÚe
):

673 
_logg”
.
	`šfo
('ProbËm w™h f[%s]' % 
âame
)

674 (
NÚe
, None)

675 
d©a
 = 
£lf
.
	$g‘_d©a_äom_’Œy
(
’Œy_dù
, 
¡ack_dœ
=stack_dir)

676 #dù_put(
£lf
.
d©a_dù
, 
ADO_CFG_DATA_STATUS
, 
DATA_STATUS_FINISHED
)

677 
ekey
 = 
’Œy_dù
.
	`keys
()[0]

678 
wdg_com
 = 
£lf
.
d©a_io
.
	$g‘_wdg_com_äom_’Œy
(
’Œy_dù
, 
ekey
)

679 #d©a_¡©u ğ
	`g‘_d©a_¡©us_äom_wdg_com
(
wdg_com
)

680 #wdg_com = 
	`dù_g‘
(
ado_obj
, 
ADO_CFG_WDG_COM
)

681 #adØğ
	`g‘_ado_obj_äom_wdg_com
(
wdg_com
)

682 #if(
’Œy_dù
[
ekey
]['DATA_STATUS'] =ğ
DATA_STATUS_FINISHED
):

683 
¥_db
 = 
	$g‘_fœ¡_¥_db_äom_wdg_com
(
wdg_com
)

684 #»tuºĞ
£lf
.
	`»pÜt_image_·¿ms
(
å»fix
, 
¥_db
, s–f.
d©a
))

685 (
¥_db
, 
d©a
)

687 #»tuº(
NÚe
, None)

689 
def
 
	$g‘_’Œ›s
(
£lf
, 
d©a_dœ
, 
å»fix
, 
fsuffix
):

691 
	$g‘_’Œ›s
(): 
desütiÚ


693 :
·¿m
 
d©a_dœ
: d©a_dœ 
desütiÚ


694 :
ty³
 
d©a_dœ
: data_dirype

696 :
·¿m
 
å»fix
: f´efix 
desütiÚ


697 :
ty³
 
å»fix
: fprefixype

699 :
·¿m
 
fsuffix
: fsuffix 
desütiÚ


700 :
ty³
 
fsuffix
: fsuffixype

702 :
»tuºs
: 
NÚe


704 
£lf
.
d©a_io
 = 
	$STXMD©aIo
(
d©a_dœ
, 
å»fix
)

705 #ado_obj = 
NÚe


706 #wh
ado_obj
 
is
 
NÚe
:

707 
’Œy_dù
 = 
£lf
.
d©a_io
.
	$lßd
()

708 (
’Œy_dù
)

710 
def
 
	`g‘_d©a_äom_’Œy
(
£lf
, 
’Œy_dù
, 
¥id_idx
=0, 
¡ack_dœ
=
F®£
):

712 
	$g‘_d©a_äom_’Œy
(): 
desütiÚ


714 :
·¿m
 
ado_obj
:‡do_obj 
desütiÚ


715 :
ty³
 
ado_obj
:‡do_objype

717 :
·¿m
 
¥id_idx
: spid_idx 
šdex
 
što
 
li¡
 
of
 
¥_ids


718 :
ty³
 
¥id_idx
: 
š‹g”


721 :
»tuºs
: 
NÚe


723 if(
’Œy_dù
 
is
 
NÚe
):

724 
´št


725 
ekey
 = 
’Œy_dù
.
	`keys
()[0]

727 #¡©u ğ
	`dù_g‘
(
’Œy_dù
[
ekey
], 
ADO_CFG_SCAN_STATUS
)

728 #if(
¡©us
 
is
 
nÙ
 
SCAN_STATUS_FINISHED
):

729 ##
_logg”
.
	`šfo
('skipping‡s scan was‚ot completed')

730 #»tuº(
NÚe
)

732 
nx_d©as
 = 
£lf
.
d©a_io
.
	$g‘_NXd©as_äom_’Œy
(
’Œy_dù
, 
ekey
)

733 #cu¼’y 
Úly
 
suµÜt
 1 
couÁ”


734 
couÁ”_Çme
 = 
nx_d©as
.
	`keys
()[0]

735 
d©a
 = 
£lf
.
d©a_io
.
	$g‘_sigÇl_d©a_äom_NXd©a
(
nx_d©as
, 
couÁ”_Çme
)

737 if((
d©a
.
ndim
 
is
 3)):

738 if(
¡ack_dœ
):

739 (
d©a
)

741 if(
	`Ën
(
d©a
) > 0):

742 
d©a
 = data[0]

744 (
NÚe
)

746 if((
d©a
.
ndim
 
is
 
nÙ
 2)):

747 #_logg”.
	`”rÜ
('D©¨ i oàwrÚg dim’siÚ, i [%d] should b[2]' % (
d©a
.
ndim
))

748 #´šˆ'D©¨i oàwrÚg dim’siÚ, i [%d] should b[2]' % (
d©a
.
ndim
)

749 (
NÚe
)

750 #wdg_com = 
£lf
.
d©a_io
.
	`g‘_wdg_com_äom_’Œy
(
’Œy_dù
, 
ekey
)

753 #wdg_com = 
	`dù_g‘
(
ado_obj
, 
ADO_CFG_WDG_COM
)

754 #if(
¥id_idx
 == 0):

755 #¥_db = 
	`g‘_fœ¡_¥_db_äom_wdg_com
(
wdg_com
)

757 #d©¨ğ
ado_obj
['DATA']

760 (
d©a
)

762 
def
 
	$£t_image_»pÜt
(
£lf
, 
šfo_¡r
, 
šfo_j¡r
):

764 
	$£t_image_»pÜt
(): 
desütiÚ


766 :
·¿m
 
šfo_¡r
: info_¡¸
desütiÚ


767 :
ty³
 
šfo_¡r
: info_strype

769 :
·¿m
 
šfo_j¡r
: info_j¡¸
desütiÚ


770 :
ty³
 
šfo_j¡r
: info_jstrype

772 :
»tuºs
: 
NÚe


774 
£lf
.
image_šfo_¡r
 = 
šfo_¡r


775 
£lf
.
image_šfo_j¡r
 = 
šfo_j¡r


778 
def
 
	$cÚv”t_gÚi_th‘a_ªgË
(
£lf
, 
ªgË
):

780 
cÚv”t
 
äom
 
hund»ths
 
of
 
a
 
deg
 
to
 
deg»e
 
as
 
the


781 :
·¿m
 
ªgË
: 
the
‡ngË 
as
 
»tuºed
 
by
h
GÚiom‘”
 
Th‘a
 
mÙÜ
 
ãedback
 
š
 
hund»ths
 
of
 
a
 
deg»e


782 :
ty³
 
ªgË
: 

784 :
»tuºs
: 
The
 
v®ue
 
·s£d
 
š
 
muÉl›d
 
by
 0.01

786 (
ªgË
 * 0.01)

788 
def
 
	`bud_image_·¿ms
(
£lf
, 
å©h
, 
¥_db
, 
d©a
, 
ev_idx
=0, 
ev_²t
=0, 
pŞ_idx
=0, 
pŞ_²t
=0):

790 
	$bud_image_·¿ms
(): 
ü—‹
 
a
 
¡ršg
 
ªd
 
jsÚ
 sŒšg 
th©
 
»´e£Ás
 
the
 
key
 
b™s
 
of
 
šfÜm©iÚ


791 
Ú
 
this
 
image
. 
The
 
jsÚ
 
¡ršg
 
is
 
u£d
 
d¿g
 
ªd
 
drİ
 
ev’ts
 
so
 
th©
 
the
 
widg‘
h© 
»ûives
h'drİ' 
has


792 
’ough
 
šfo
 
to
 
lßd
 
the
 
image
, 
sÿn
 
Ü
 
di¥Ïy
h
»Ëvªt
 
šfÜm©iÚ
.

794 :
·¿m
 
å©h
: 
the
 
f’ame


795 :
ty³
 
å©h
: 
¡ršg


797 :
·¿m
 
¥_db
: 
This
 
is
 
the
 
¡ªd¬d
 
¥©Ÿl
 
d©aba£
 
diù
 
th©
 i 
u£d
 
throughout
h
­¶iÿtiÚ
, 
»ãr
 
to


798 
	$make_¥©Ÿl_db_diù
(è
š
 
¡xm_cÚŒŞ
/
¡xm_uts
/
roi_uts
.
py
 
a
 
d‘aed
 
look
 
©
 
the
 
¡ruùu»


799 
of
 
ª
 
¥_db


800 :
ty³
 
¥_db
: sp_dbype

802 :
·¿m
 
d©a
: 
A
 
numpy
 
¬¿y
 
th©
 
cÚšs
 
the
 
image
 data

803 :
ty³
 
d©a
: dataype

805 :
·¿m
 
ev_idx
: 
the
 
šdex
 
što
h
cÜ»ù
 
ev_roi
 
this
 
image


806 :
ty³
 
ev_idx
: 
š‹g”


808 :
·¿m
 
ev_²t
: 
the
 
šdex
 
što
h
cÜ»ù
 
’”gy
 
pošt
 
š
h
ev_roi
 
this
 
image


809 :
ty³
 
ev_²t
: 
š‹g”


811 :
·¿m
 
pŞ_idx
: 
the
 
šdex
 
što
h
cÜ»ù
 
pŞ¬™y_roi
 
this
 
image


812 :
ty³
 
pŞ_idx
: 
š‹g”


814 :
·¿m
 
pŞ_²t
: 
the
 
šdex
 
što
h
cÜ»ù
 
pŞ¬™y
 
pošt
 
š
h
pŞ_roi
 
this
 
image


815 :
ty³
 
pŞ_²t
: 
š‹g”


817 :
»tuºs
: 
a
 
tu¶e
 
cÚsi¡šg
 
of
‡ 
¡ršg
 
u£d
 
the
 
toŞt
 
d©a
 
ªd
‡ 
jsÚ
 sŒšg u£d 
d¿g
‡nd 
drİ
 
İ”©iÚs


819 if(
d©a
.
size
 == 0):

820 (
NÚe
, None)

822 if(
d©a
.
ndim
 == 3):

823 
d©a
 = data[0]

825 if(
d©a
.
ndim
 == 2):

827 
height
, 
width
 = 
d©a
.
sh­e


828 # ğ'Fe: %  \n' % (
å»fix
 + '.hdf5')

829 
dù
 = {
	}
}

830 
dù
['fe'] = 
å©h


831 
dù
['sÿn_ty³'] = 
sÿn_ty³s
[
dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
)] + ' ' + 
	gsÿn_sub_ty³s
[dù_g‘(¥_db, 
SPDB_SCAN_PLUGIN_SUBTYPE
)]

832 
	gdù
['sÿn_·Ãl_idx'] = 
	$dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_PANEL_IDX
)

833 
dù
['’”gy'] = 
¥_db
['EV_ROIS'][
ev_idx
]['SETPOINTS'][
ev_²t
]

834 
dù
['pŞ¬™y'] = 
	`cÚv”t_w¿µ”_•u_to_¡r
(
¥_db
['EV_ROIS'][
ev_idx
]['POL_ROIS'][
pŞ_idx
]['POL'])

835 
dù
['off£t'] = 
¥_db
['EV_ROIS'][
ev_idx
]['POL_ROIS'][
pŞ_idx
]['OFF']

836 
dù
['ªgË'] = 
¥_db
['EV_ROIS'][
ev_idx
]['POL_ROIS'][
pŞ_idx
]['ANGLE']

837 
dù
['dw–l'] = 
¥_db
['EV_ROIS'][
ev_idx
]['DWELL']

838 
dù
['Åošts'] = (
width
, 
height
)

839 
dù
['ûÁ”'] = (
	`dù_g‘
(
¥_db
, 
SPDB_XCENTER
), 
	$dù_g‘
(
¥_db
, 
SPDB_YCENTER
))

840 
dù
['¿nge'] = (
	`dù_g‘
(
¥_db
, 
SPDB_XRANGE
), 
	$dù_g‘
(
¥_db
, 
SPDB_YRANGE
))

842 if('GONI' 
š
 
¥_db
.
	$keys
()):

843 if(
¥_db
['GONI']['T'] 
is
 
NÚe
):

844 
·ss


845 
	`–if
(
¥_db
['GONI']['Z'] 
is
 
NÚe
):

846 
·ss


847 
	`–if
(
¥_db
['GONI']['T']['CENTER'] 
is
 
nÙ
 
NÚe
):

848 
dù
['gÚi_th‘a_úŒ'] = 
£lf
.
	`cÚv”t_gÚi_th‘a_ªgË
(
¥_db
['GONI']['T']['CENTER'])

851 
j¡r
 = 
jsÚ
.
	$dumps
(
dù
)

852 
s
 = 'Fe: %  \n' % 
dù
['file']

853 
s
 +ğ'SÿÀTy³: \t%s\n' % 
dù
['scan_type']

854 
s
 +ğ'EÃrgy: \t%.2àeV\n' % 
¥_db
['EV_ROIS'][
ev_idx
]['SETPOINTS'][
ev_²t
]

855 
s
 +ğ'PŞ¬™y: \t%  Off£t: %.2àmm AngË: %.2àdeg\n' % (
	`cÚv”t_w¿µ”_•u_to_¡r
(
¥_db
['EV_ROIS'][
ev_idx
]['EPU_POL_PNTS'][
pŞ_idx
]), sp_db['EV_ROIS'][ev_idx]['EPU_OFF_PNTS'][pol_idx], sp_db['EV_ROIS'][ev_idx]['EPU_ANG_PNTS'][pol_idx])

856 
s
 +ğ'Dw–l: \t%.2àms\n' % 
¥_db
['EV_ROIS'][
ev_idx
]['DWELL']

857 
s
 +ğ'# Pošts: \t%d x %d \n' % (
width
, 
height
)

858 
s
 +ğ'C’‹r: \t(%.2f, %.2fèum\n' % 
dù
['center']

859 
s
 +ğ'Rªge: \t(%.2f, %.2fèum' % 
dù
['range']

860 if('gÚi_th‘a_úŒ' 
š
 
dù
.
	$keys
()):

861 
s
 +ğ'\nGÚ˜Th‘a: \t%.2àdeg' % 
dù
['goni_theta_cntr']

862 (
s
, 
j¡r
)

864 #´šˆ'bud_image_·¿ms: UnsuµÜ‹d dim’siÚ oàd©¨->[%d]'% 
d©a
.
ndim


865 (
NÚe
, None)

867 
def
 
	$chªge_dœ
(
£lf
):

869 
	$chªge_dœ
(): 
desütiÚ


871 :
»tuºs
: 
NÚe


873 
dœ
 = 
	`£tExi¡šgDœeùÜy
("Pick DœeùÜy", 
š™_dœ
=
£lf
.
d©a_dœ
)

874 
´ev_cursÜ
 = 
£lf
.
	$cursÜ
()

875 #QtWidg‘s.
QAµliÿtiÚ
.
	`£tOv”rideCursÜ
(
QtWidg‘s
.
	`QCursÜ
(
QtCÜe
.
Qt
.
Wa™CursÜ
))

877 
£lf
.
	$£tCursÜ
(
QtCÜe
.
Qt
.
Wa™CursÜ
)

878 
QtWidg‘s
.
QAµliÿtiÚ
.
	$´oûssEv’ts
()

879 #check 
dœeùÜy
 
cÚšs
 
a
 
¡ack


880 if(
£lf
.
	$is_¡ack_dœ
(
dœ
)):

881 
£lf
.
	$£t_d©a_dœ
(
dœ
, 
is_¡ack_dœ
=
True
)

882 
d©a_âames
 = 
	$dœli¡
(
dœ
, 
£lf
.
d©a_fe_ex‹nsiÚ
, 
»move_suffix
=
F®£
)

883 
âame
 = 
dœ
 + '/' + 
d©a_âames
[0]

884 
¥_db
, 
d©a
 = 
£lf
.
	$g‘_¡ack_d©a
(
âame
)

885 
£lf
.
	`lßd_¡ack_što_v›w
(
d©a_âames
[0])

887 
£lf
.
fsys_mÚ
.
	$£t_d©a_dœ
Ğ
£lf
.
d©a_dœ
)

888 #QtWidg‘s.
QAµliÿtiÚ
.
	`£tOv”rideCursÜ
(
QtWidg‘s
.
	`QCursÜ
(
´ev_cursÜ
))

889 
£lf
.
	$un£tCursÜ
()

890 
QtWidg‘s
.
QAµliÿtiÚ
.
	$´oûssEv’ts
()

893 if(
	`Ën
(
dœ
) > 0):

894 
£lf
.
	$£t_d©a_dœ
(
dœ
, 
is_¡ack_dœ
=
F®£
)

895 
£lf
.
fsys_mÚ
.
	$£t_d©a_dœ
Ğ
£lf
.
d©a_dœ
)

897 
£lf
.
	$un£tCursÜ
()

898 #QtWidg‘s.
QAµliÿtiÚ
.
	`£tOv”rideCursÜ
(
QtWidg‘s
.
	`QCursÜ
(
´ev_cursÜ
))

899 
QtWidg‘s
.
QAµliÿtiÚ
.
	$´oûssEv’ts
()

902 
def
 
	`Ú_dœ_chªged
(
£lf
, (
f_added
, 
f_»moved
)):

904 
	$Ú_dœ_chªged
(): 
this
 
hªdËr
 
Ãeds
 
to
 
disûº
 
b‘w“n
 
fes
 
th©
 
¬e
 
nÙ
 
fšished
 
wr™šg
 
ªd
 
tho£
h©‡» 
»ady
Ø
be
 
»ad


906 :
	`·¿m
 (
f_added
: (f_added 
desütiÚ


907 :
	`ty³
 (
f_added
: (f_added 
ty³


909 :
·¿m
 
f_»moved
): f_»movedè
desütiÚ


910 :
ty³
 
f_»moved
): f_removed)ype

912 :
»tuºs
: 
NÚe


914 #´šˆ'Ú_dœ_chªged:‡dded: ' , 
f_added


915 #´šˆ'Ú_dœ_chªged:„emoved: ' , 
f_»moved


916 
´ev_cursÜ
 = 
£lf
.
	$cursÜ
()

917 #QtWidg‘s.
QAµliÿtiÚ
.
	`£tOv”rideCursÜ
(
QtWidg‘s
.
	`QCursÜ
(
QtCÜe
.
Qt
.
Wa™CursÜ
))

918 
£lf
.
	$£tCursÜ
(
QtCÜe
.
Qt
.
Wa™CursÜ
)

919 
QtWidg‘s
.
QAµliÿtiÚ
.
	$´oûssEv’ts
()

921 if(
	`Ën
(
f_added
) > 0):

922 #£lf.
	`add_to_v›w
(
f_added
)

923 
ROWS
 = (
	`Ën
(
£lf
.
thumbs
è+†’(
f_added
)è/ 
MAX_THUMB_COLUMNS


924 
âame
 
š
 
f_added
:

925 if(
£lf
.
cur_thumb_cŞumn
 >ğ
MAX_THUMB_COLUMNS
):

926 
£lf
.
	$šü_cur_row
()

927 
£lf
.
	$»£t_cur_cŞumn
()

929 
¥_db
, 
d©a
 = 
£lf
.
	`g‘_¥_db_ªd_d©a
(£lf.
d©a_dœ
 + '/' + 
âame
)

930 #¡©u ğ
£lf
.
	`add_to_v›w
(
âame
, 
¥_db
, 
d©a
, 
ev_idx
=0, 
ev_²t
=0, 
pŞ_idx
=0, 
pŞ_²t
=0, 
row
=£lf.
cur_thumb_row
, 
cŞ
=£lf.
cur_thumb_cŞumn
, 
upd©e_sûÃ
=
F®£
)

931 
¡©us
 = 
£lf
.
	`add_to_v›w
(
âame
, 
¥_db
, 
d©a
, 
ev_idx
=0, 
ev_²t
=0, 
pŞ_idx
=0, 
pŞ_²t
=0, 
row
=
NÚe
, 
cŞ
=NÚe, 
upd©e_sûÃ
=
F®£
)

932 if(
¡©us
 
is
 
nÙ
 
NÚe
):

933 
£lf
.
	$šü_cur_cŞumn
()

935 
£lf
.
	$upd©e_sûÃ
()

936 #QtWidg‘s.
QAµliÿtiÚ
.
	`£tOv”rideCursÜ
(
QtWidg‘s
.
	`QCursÜ
(
´ev_cursÜ
))

937 
£lf
.
	$un£tCursÜ
()

938 
QtWidg‘s
.
QAµliÿtiÚ
.
	$´oûssEv’ts
()

941 
def
 
	$£t_cur_row
(
£lf
, 
v®
):

942 
£lf
.
cur_thumb_row
 = 
v®


944 
def
 
	$£t_cur_cŞumn
(
£lf
, 
v®
):

945 
£lf
.
cur_thumb_cŞumn
 = 
v®


947 
def
 
	$»£t_cur_row
(
£lf
):

948 
£lf
.
cur_thumb_row
 = 0

950 
def
 
	$»£t_cur_cŞumn
(
£lf
):

951 
£lf
.
cur_thumb_cŞumn
 = 0

953 
def
 
	$šü_cur_row
(
£lf
):

954 
£lf
.
cur_thumb_row
 += 1

956 
def
 
	$šü_cur_cŞumn
(
£lf
):

957 
£lf
.
cur_thumb_cŞumn
 += 1

960 
def
 
	$g‘_Ãxt_row_ªd_cŞ
(
£lf
):

961 
ROWS
 = (
	`Ën
(
£lf
.
thumbs
è+ 1è/ 
MAX_THUMB_COLUMNS


962 if(
£lf
.
cur_thumb_cŞumn
 >ğ
MAX_THUMB_COLUMNS
):

963 
£lf
.
	$šü_cur_row
()

964 
rows
 = 
£lf
.
cur_thumb_row


965 
£lf
.
	`£t_cur_cŞumn
(0)

967 (
£lf
.
cur_thumb_row
, s–f.
cur_thumb_cŞumn
)

971 
def
 
	$Ú_d¿g
(
£lf
, 
obj
, 
ev’t
):

973 
	$Ú_d¿g
(): 
desütiÚ


975 :
·¿m
 
obj
: obj 
desütiÚ


976 :
ty³
 
obj
: objype

978 :
·¿m
 
ev’t
:ƒv’ˆ
desütiÚ


979 :
ty³
 
ev’t
:ƒventype

981 :
»tuºs
: 
NÚe


983 
ev’t
.
	$acû±
()

985 
™emD©a
 = 
QtCÜe
.
	$QBy‹A¼ay
()

986 
d©aSŒ—m
 = 
QtCÜe
.
	$QD©aSŒ—m
(
™emD©a
, 
QtCÜe
.
QIODeviû
.
Wr™eOÆy
)

987 
d©aSŒ—m
 << 
QtCÜe
.
	`QBy‹A¼ay
(
obj
.
šfo_j¡r
è<< (
ev’t
.
	`pos
(è- obj.
	`»ù
().
	$tİLeá
())

988 #d©aSŒ—m << 
QtCÜe
.
	`QBy‹A¼ay
(
obj
.
d©a
.
	`toby‹s
()è<< QtCÜe.QBy‹A¼ay(obj.
šfo_¡r
è<< (
ev’t
.
	`pos
(è- obj.
	`»ù
().
	`tİLeá
())

990 
mimeD©a
 = 
QtCÜe
.
	$QMimeD©a
()

991 
mimeD©a
.
	`£tD©a
('­¶iÿtiÚ/x-¡xmsÿn', 
™emD©a
)

992 
mimeD©a
.
	$£tText
(
obj
.
šfo_j¡r
)

994 
d¿g
 = 
QtGui
.
	$QD¿g
(
£lf
)

995 
d¿g
.
	$£tMimeD©a
(
mimeD©a
)

996 
pos
 = 
ev’t
.
	`pos
(è- 
obj
.
	`»ù
().
	$tİLeá
()

997 
d¿g
.
	`£tHÙSpÙ
(
QtCÜe
.
	`QPošt
(
pos
.
	`x
(),…os.
	$y
()))

998 
d¿g
.
	$£tPixm­
(
obj
.
pic
)

1000 
d¿g
.
	`exec_
(
QtCÜe
.
Qt
.
MoveAùiÚ
 | QtCÜe.Qt.
CİyAùiÚ
, QtCore.Qt.CopyAction) == QtCore.Qt.MoveAction:

1001 
·ss


1003 
·ss


1006 
def
 
	$make_thumbWidg‘
(
£lf
, 
d©a_dœ
, 
âame
, 
šfo_dù
, 
t™Ë
=
NÚe
, 
¥_db
=NÚe, 
d©a
=None):

1008 
	$make_thumbWidg‘
(): 
desütiÚ


1010 :
·¿m
 
d©a_dœ
: d©a_dœ 
desütiÚ


1011 :
ty³
 
d©a_dœ
: data_dirype

1013 :
·¿m
 
âame
: fÇm
desütiÚ


1014 :
ty³
 
âame
: fnameype

1016 :
·¿m
 
šfo_dù
: info_dù 
desütiÚ


1017 :
ty³
 
šfo_dù
: info_dctype

1019 :
·¿m
 
t™Ë
=
NÚe
:™Ë=NÚ
desütiÚ


1020 :
ty³
 
t™Ë
=
NÚe
:itle=Noneype

1022 :
·¿m
 
¥_db
=
NÚe
: sp_db=NÚ
desütiÚ


1023 :
ty³
 
¥_db
=
NÚe
: sp_db=Noneype

1025 :
·¿m
 
d©a
=
NÚe
: d©a=NÚ
desütiÚ


1026 :
ty³
 
d©a
=
NÚe
: data=Noneype

1028 :
»tuºs
: 
NÚe


1030 
thumb_widg‘
 = 
	`ThumbÇWidg‘
(
d©a_dœ
 + '/' + 
âame
, 
¥_db
, 
d©a
, 
t™Ë
, 
šfo_dù
, 
·»Á
 = 
NÚe
)

1031 if(
thumb_widg‘
.
is_v®id
):

1032 #thumb_widg‘.
upd©e_v›w
.
	`cÚÃù
(
£lf
.update_view)

1033 
thumb_widg‘
.
£Ëù
.
	$cÚÃù
(
£lf
.
do_£Ëù
)

1034 
thumb_widg‘
.
Ïunch_v›w”
.
	$cÚÃù
(
£lf
.
Ïunch_v›w”
)

1035 
thumb_widg‘
.
d¿g
.
	$cÚÃù
(
£lf
.
Ú_d¿g
)

1036 (
thumb_widg‘
)

1038 (
NÚe
)

1040 
def
 
	$add_thumb_widg‘
(
£lf
, 
d©a_dœ
, 
âame
, 
šfo_dù
, 
row
, 
cŞumn
, 
t™Ë
=
NÚe
, 
¥_db
=NÚe, 
d©a
=None):

1042 
	$add_thumb_widg‘
(): 
desütiÚ


1044 :
·¿m
 
d©a_dœ
: d©a_dœ 
desütiÚ


1045 :
ty³
 
d©a_dœ
: data_dirype

1047 :
·¿m
 
âame
: fÇm
desütiÚ


1048 :
ty³
 
âame
: fnameype

1050 :
·¿m
 
šfo_dù
: info_dù 
desütiÚ


1051 :
ty³
 
šfo_dù
: info_dctype

1053 :
·¿m
 
row
:„ow 
desütiÚ


1054 :
ty³
 
row
:„owype

1056 :
·¿m
 
cŞumn
: cŞumÀ
desütiÚ


1057 :
ty³
 
cŞumn
: columnype

1059 :
·¿m
 
t™Ë
=
NÚe
:™Ë=NÚ
desütiÚ


1060 :
ty³
 
t™Ë
=
NÚe
:itle=Noneype

1062 :
·¿m
 
¥_db
=
NÚe
: sp_db=NÚ
desütiÚ


1063 :
ty³
 
¥_db
=
NÚe
: sp_db=Noneype

1065 :
·¿m
 
d©a
=
NÚe
: d©a=NÚ
desütiÚ


1066 :
ty³
 
d©a
=
NÚe
: data=Noneype

1068 :
»tuºs
: 
NÚe


1070 
thumb_widg‘
 = 
£lf
.
	$make_thumbWidg‘
(
d©a_dœ
, 
âame
, 
šfo_dù
, 
t™Ë
ñ™Ë, 
¥_db
=¥_db, 
d©a
=data)

1071 if(
thumb_widg‘
):

1072 
£lf
.
g¿phics_wdg
.
gridÏyout
.
	`addI‹m
(
thumb_widg‘
, 
row
, 
cŞumn
, 1, 1)

1073 
£lf
.
g¿phics_wdg
.
gridÏyout
.
	`£tCŞumnS·cšg
(
cŞumn
, 20)

1074 
£lf
.
g¿phics_wdg
.
gridÏyout
.
	`£tRowS·cšg
(
row
, 15)

1076 
£lf
.
thumbs
.
	$­³nd
(
thumb_widg‘
)

1077 (
True
)

1079 (
F®£
)

1082 
def
 
	$ş—r_grid_Ïyout
(
£lf
):

1084 
	$ş—r_grid_Ïyout
(): 
desütiÚ


1086 :
»tuºs
: 
NÚe


1088 if((
£lf
.
g¿phics_wdg
.
gridÏyout
.
	`rowCouÁ
(è=ğ0è
	`ªd
 (£lf.g¿phics_wdg.gridÏyout.
	`cŞumnCouÁ
() == 0)):

1090 
i
 = 0

1091 
£lf
.
g¿phics_wdg
.
	$ş—r_Ïyout
()

1092 
œ
 = 
£lf
.
sûÃ
.
	$™emsBoundšgReù
()

1093 
qr
 = 
QtCÜe
.
	`QReùF
(
œ
.
	`x
(), ir.
	`y
(), ir.
	`width
(), 
THUMB_HEIGHT
)

1094 
£lf
.
sûÃ
.
	$£tSûÃReù
(
qr
)

1095 
£lf
.
v›w
.
	$£tSûÃReù
(
qr
)

1096 
£lf
.
g¿phics_wdg
.
	$£t_Ïyout_size
(
qr
)

1097 
d–
 
£lf
.
thumbs


1098 
£lf
.
thumbs
 = []

1099 
£lf
.
	`£t_cur_row
(0)

1100 
£lf
.
	`£t_cur_cŞumn
(0)

1102 
def
 
	`add_to_v›w
(
£lf
, 
âame
, 
¥_db
, 
d©a
, 
image_num
=
NÚe
, 
ev_idx
=0, 
ev_²t
=0, 
pŞ_idx
=0, 
pŞ_²t
=0, 
row
=NÚe, 
cŞ
=NÚe, 
upd©e_sûÃ
=
F®£
):

1104 
	$lßd_¡ack_što_v›w
(): 
desütiÚ


1106 :
·¿m
 
âame
: fÇm
desütiÚ


1107 :
ty³
 
âame
: fnameype

1109 :
»tuºs
: 
NÚe


1112 if(
d©a
 
is
 
NÚe
):

1113 (
F®£
)

1115 if(
d©a
.
ndim
 == 3):

1116 
d©a
 = data[0]

1117 
	`–if
(
d©a
.
ndim
 == 2):

1118 #™ 
a
 
sšgË
 
image


1119 
d©a
 = data

1120 
	`–if
(
d©a
.
ndim
 == 1):

1121 #™ 
a
 
¥eù¿
 
which
 
is
 
nÙ
 
suµÜ‹d
 
so
 
ju¡
  
NÚe


1122 (
NÚe
)

1124 #™ 
unknown


1125 (
NÚe
)

1127 
rows
, 
cŞs
 = 
d©a
.
sh­e


1128 #¥_db, 
d©a
 = 
£lf
.
	`g‘_¥_db_ªd_d©a
(£lf.
d©a_dœ
 + '/' + 
âame
)

1129 if((
¥_db
 
is
 
nÙ
 
NÚe
è
	$ªd
 (
d©a
 
is
 
nÙ
 
NÚe
)):

1130 if(
	$dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
è
nÙ
 
š
 [
sÿn_ty³s
.
GENERIC_SCAN
, sÿn_ty³s.
SAMPLE_POINT_SPECTRUM
]):

1131 
šfo_¡r
, 
šfo_j¡r
 = 
£lf
.
	`bud_image_·¿ms
(£lf.
d©a_dœ
 + '/' + 
âame
, 
¥_db
, 
d©a
, 
ev_idx
óv_idx, 
ev_²t
óv_²t, 
pŞ_idx
õŞ_idx, 
pŞ_²t
=0)

1132 
šfo_dù
 = {'šfo_¡r': 
šfo_¡r
, 'šfo_j¡r': 
šfo_j¡r
}

1133 
lâ
 = 
	$Ën
(
âame
)

1134 
t™Ë
 = 
âame
[0:
lâ
-5]

1136 #™ 
nÙ
 
a
 
suµÜ‹d
 
sÿn
 
ty³


1139 if((
row
 
is
 
NÚe
è
	$ªd
 (
cŞ
 
is
 
NÚe
)):

1140 
row
, 
cŞ
 = 
£lf
.
	$g‘_Ãxt_row_ªd_cŞ
()

1143 
num_rows
 = 
£lf
.
g¿phics_wdg
.
gridÏyout
.
	$rowCouÁ
()

1144 
cŞumn
 = 0

1145 if(
image_num
 
is
 
NÚe
):

1146 
‰l
 = 
t™Ë


1148 
‰l
 = 
t™Ë
 + '_%d'%
image_num


1150 
¡©us
 = 
£lf
.
	$add_thumb_widg‘
Ğ
£lf
.
d©a_dœ
, 
âame
, 
šfo_dù
, 
row
, 
cŞ
, 
t™Ë
=
‰l
, 
¥_db
=¥_db, 
d©a
=data)

1152 if(
upd©e_sûÃ
 
ªd
 
¡©us
):

1153 
£lf
.
	$upd©e_sûÃ
()

1155 (
¡©us
)

1158 
def
 
	$upd©e_sûÃ
(
£lf
):

1159 
num_rows
 = 
£lf
.
g¿phics_wdg
.
gridÏyout
.
	$rowCouÁ
()

1160 #q¸ğ
QtCÜe
.
	`QReùF
(0.0, 0.0, 290.0, 
num_rows
 * 170.0)

1161 
qr
 = 
QtCÜe
.
	`QReùF
(0.0, 0.0, 
SCENE_WIDTH
, 
num_rows
 * 
THUMB_HEIGHT
)

1162 #´šˆ'num_row ğ%d, hˆğ%d' % (
num_rows
,‚um_rows * 170.0)

1163 
£lf
.
g¿phics_wdg
.
	$£t_Ïyout_size
(
qr
)

1164 
£lf
.
sûÃ
.
	$£tSûÃReù
(
qr
)

1165 
£lf
.
v›w
.
	$£tSûÃReù
(
qr
)

1166 
yPos
 = 
£lf
.
v›w
.
	$v”tiÿlSüŞlB¬
()

1167 if(
num_rows
 > 3):

1168 
yPos
.
	`£tV®ue
(yPos.
	$maximum
())

1170 
yPos
.
	`£tV®ue
(yPos.
	$mšimum
())

1173 #deà
	`lßd_¡ack_što_v›w
(
£lf
, 
âame
):

1175 #lßd_¡ack_što_v›w(): 
desütiÚ


1176 #
#:
·¿m
 
âame
: fÇm
desütiÚ


1177 #:
ty³
 
âame
: fnameype

1178 #
#:
»tuºs
: 
NÚe


1180 #¥_db, 
d©a
 = 
£lf
.
	`g‘_¥_db_ªd_d©a
(£lf.
d©a_dœ
 + '/' + 
âame
)

1181 #£lf.
	`ş—r_grid_Ïyout
()

1182 #num_images, 
rows
, 
cŞs
 = 
d©a
.
sh­e


1183 #ROWSğ
num_images
 / 
MAX_THUMB_COLUMNS


1185 #fÜ 
ev_roi
 
š
 
¥_db
['EV_ROIS']:

1186 #’²t ğ(
ev_roi
['NPOINTS'])

1187 #pŞÅÁ ğ
	`Ën
(
ev_roi
['POL_ROIS'])

1188 #ev_pŞ_idx ğ
™”toŞs
.
	`´oduù
(
	`¿nge
(
’²ts
),„ªge(
pŞÅÁs
))

1190 #fÜ 
row
, 
cŞumn
 
š
 
™”toŞs
.
	`´oduù
(
	`¿nge
(
ROWS
),¿nge(
MAX_THUMB_COLUMNS
)):

1191 #ev_²t, 
pŞ_idx
 = 
ev_pŞ_idxs
.
	`Ãxt
()

1192 #¡©u ğ
£lf
.
	`add_to_v›w
(
âame
, 
¥_db
, 
d©a
[
i
], 
image_num
=i, 
ev_idx
óv_idx, 
ev_²t
óv_²t, 
pŞ_idx
õŞ_idx, 
pŞ_²t
=0, 
row
ôow, 
cŞ
=
cŞumn
, 
upd©e_sûÃ
=
F®£
)

1193 #
#if(
nÙ
 
¡©us
):

1196 ##
pŞ_idx
 += 1

1198 #£lf.
	`£t_cur_row
(
row
 + 1)

1199 #£lf.
	`£t_cur_cŞumn
(
cŞumn
 + 1)

1200 #
#£lf.
	`upd©e_sûÃ
()

1201 
def
 
	$lßd_¡ack_što_v›w
(
£lf
, 
âame
):

1203 
	$lßd_¡ack_što_v›w
(): 
desütiÚ


1205 :
·¿m
 
âame
: fÇm
desütiÚ


1206 :
ty³
 
âame
: fnameype

1208 :
»tuºs
: 
NÚe


1210 
¥_db
, 
d©a
 = 
£lf
.
	`g‘_¥_db_ªd_d©a
(£lf.
d©a_dœ
 + '/' + 
âame
, 
¡ack_dœ
=
True
)

1211 
£lf
.
	$ş—r_grid_Ïyout
()

1212 
num_images
, 
rows
, 
cŞs
 = 
d©a
.
sh­e


1213 
ROWS
ğ
num_images
 / 
MAX_THUMB_COLUMNS


1214 #rowcŞ = 
™”toŞs
.
	`´oduù
(
	`¿nge
(
ROWS
),¿nge(
MAX_THUMB_COLUMNS
))

1215 
rowcŞ
 = 
™”toŞs
.
	`´oduù
(
	`¿nge
(
ROWS
+1),
	$¿nge
(
MAX_THUMB_COLUMNS
))

1216 
ev_idx
 = 0

1217 
i
 = 0

1218 
ev_roi
 
š
 
¥_db
['EV_ROIS']:

1220 
’²ts
 = (
ev_roi
['NPOINTS'])

1221 
pŞÅÁs
 = 
	`Ën
(
ev_roi
['POL_ROIS'])

1222 
ev_pŞ_idxs
 = 
™”toŞs
.
	`´oduù
(
	`¿nge
(
’²ts
), 
	$¿nge
(
pŞÅÁs
) )

1224 #fÜ 
ev_pŞ_idxs
 
š
 
™”toŞs
.
	`´oduù
(
	`¿nge
(
’²ts
),„ªge(
pŞÅÁs
) ):

1225 
x
 
š
 
	$¿nge
(
’²ts
):

1226 #fÜ 
row
, 
cŞumn
 
š
 
™”toŞs
.
	`´oduù
(
	`¿nge
(
ROWS
),¿nge(
MAX_THUMB_COLUMNS
)):

1227 #´šˆ'lßd_¡ack_što_v›w: %d oà%d' % (
x
, 
’²ts
)

1228 
row
, 
cŞumn
 = 
rowcŞ
.
	$Ãxt
()

1229 
ev_²t
, 
pŞ_idx
 = 
ev_pŞ_idxs
.
	$Ãxt
()

1230 
¡©us
 = 
£lf
.
	`add_to_v›w
(
âame
, 
¥_db
, 
d©a
[
i
], 
image_num
=i, 
ev_idx
óv_idx, 
ev_²t
óv_²t, 
pŞ_idx
õŞ_idx, 
pŞ_²t
=0, 
row
ôow, 
cŞ
=
cŞumn
, 
upd©e_sûÃ
=
F®£
)

1232 if(
nÙ
 
¡©us
):

1234 
i
 += 1

1236 
ev_idx
 += 1

1237 
£lf
.
	`£t_cur_row
(
row
 + 1)

1238 
£lf
.
	`£t_cur_cŞumn
(
cŞumn
 + 1)

1240 
£lf
.
	$upd©e_sûÃ
()

1243 
def
 
	$»lßd_v›w
(
£lf
, 
is_¡ack_dœ
=
F®£
):

1245 
	$»lßd_v›w
(): 
w®k
 
the
 
£lf
.
d©a_dœ
 
ªd
 
Œy
 
to
 
lßd
 
ev”y
 .
hdf5
 
fe
, 
di¥Ïy
 
Úly
h
Úes
 
th©
 
¬e
 
v®id


1246 
sk
 
the
 
Úes
 
th©
 
¬e
 
nÙ


1248 :
·¿m
 
is_¡ack_dœ
=
F®£
: is_¡ack_dœ=F®£ 
desütiÚ


1249 :
ty³
 
is_¡ack_dœ
=
F®£
: is_stack_dir=Falseype

1251 :
»tuºs
: 
NÚe


1253 
£lf
.
	$ş—r_grid_Ïyout
()

1254 
row
 = 0

1255 
cŞumn
 = 0

1256 if(
£lf
.
d©a_dœ
 
is
 
NÚe
):

1259 if(
nÙ
 
os
.
·th
.
	$exi¡s
(
£lf
.
d©a_dœ
)):

1260 
_logg”
.
	`”rÜ
('D©¨dœeùÜy dÛ nÙƒxi¡: [%s]' % 
£lf
.
d©a_dœ
)

1263 
d©a_âames
 = 
	$dœli¡
(
£lf
.
d©a_dœ
, s–f.
d©a_fe_ex‹nsiÚ
, 
»move_suffix
=
F®£
)

1264 #Úly 
look
 
©
 
fes
 
th©
 
have
 
ª
 
image
 
ªd
 
d©a
 
fe
, 
th’
 
tuº
 
to
 
li¡
,h’ 
sÜt
 
asûndšg


1265 #thumb_âame ğ
	`sÜ‹d
Ğ
	`li¡
(
	`£t
(
image_âames
è& s‘(
d©a_âames
)) )

1266 
thumb_âames
 = 
	$sÜ‹d
Ğ
d©a_âames
 )

1268 if(
	`Ën
(
thumb_âames
) < 1):

1270 
	`–if
(
	`Ën
(
thumb_âames
) == 1):

1271 #th”
is
 
Úly
 
a
 
sšgË
 
fe
 
š
 
dœeùÜy


1272 
¥_db
, 
d©a
 = 
£lf
.
	`g‘_¥_db_ªd_d©a
(£lf.
d©a_dœ
 + '/' + 
thumb_âames
[0])

1273 if((
¥_db
 
is
 
nÙ
 
NÚe
è
	$ªd
 (
d©a
 
is
 
nÙ
 
NÚe
)):

1274 if(
	$dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
è
nÙ
 
š
 [
sÿn_ty³s
.
GENERIC_SCAN
, sÿn_ty³s.
SAMPLE_POINT_SPECTRUM
]):

1275 
šfo_¡r
, 
šfo_j¡r
 = 
£lf
.
	`bud_image_·¿ms
(£lf.
d©a_dœ
 + '/' + 
thumb_âames
[0], 
¥_db
, 
d©a
, 
ev_idx
=0, 
pŞ_idx
=0)

1276 
šfo_dù
 = {'šfo_¡r': 
šfo_¡r
, 'šfo_j¡r': 
šfo_j¡r
}

1277 
¡©us
 = 
£lf
.
add_thumb_widg‘
Ğ£lf.
d©a_dœ
, 
thumb_âames
[0], 
šfo_dù
, 0, 0, 
¥_db
=¥_db, 
d©a
=data)

1278 if(
nÙ
 
¡©us
):

1279 #f
mu¡
 
have
 
had
 
a
 
´obËm
 
w™h
 
™


1280 
yPos
 = 
£lf
.
v›w
.
	$v”tiÿlSüŞlB¬
()

1281 
yPos
.
	`£tV®ue
(yPos.
	$mšimum
())

1284 
£lf
.
	`£t_cur_row
(0)

1285 
£lf
.
	`£t_cur_cŞumn
(1)

1287 #Œy 
to
 
lßd
 
the
 
whŞe
 
dœeùÜy


1288 
ROWS
 = (
	`round
((
	`Ën
(
thumb_âames
è/ (
MAX_THUMB_COLUMNS
)))) + 1

1289 if(
ROWS
 == 0):

1290 
ROWS
 = 1

1291 
i
 = 0

1292 
rowcŞ
 = 
™”toŞs
.
	`´oduù
(
	`¿nge
(
ROWS
),
	$¿nge
(
MAX_THUMB_COLUMNS
))

1293 #fÜ 
row
, 
cŞumn
 
š
 
™”toŞs
.
	`´oduù
(
	`¿nge
(
ROWS
),¿nge(
MAX_THUMB_COLUMNS
)):

1294 
i
 
š
 
	`¿nge
(
	$Ën
(
thumb_âames
)):

1295 if(
i
 >ğ
	$Ën
(
thumb_âames
)):

1296 #ià
™
 
is
 
Ëss
 
thª
 1 
fuÎ
 
row


1298 
¥_db
, 
d©a
 = 
£lf
.
	`g‘_¥_db_ªd_d©a
(£lf.
d©a_dœ
 + '/' + 
thumb_âames
[
i
])

1299 if((
¥_db
 
is
 
nÙ
 
NÚe
è
	$ªd
 (
d©a
 
is
 
nÙ
 
NÚe
)):

1300 if(
	$dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
è
nÙ
 
š
 [
sÿn_ty³s
.
GENERIC_SCAN
, sÿn_ty³s.
SAMPLE_POINT_SPECTRUM
]):

1301 
row
, 
cŞumn
 = 
rowcŞ
.
	$Ãxt
()

1302 
šfo_¡r
, 
šfo_j¡r
 = 
£lf
.
	`bud_image_·¿ms
(£lf.
d©a_dœ
 + '/' + 
thumb_âames
[
i
], 
¥_db
, 
d©a
, 
ev_idx
=0, 
pŞ_idx
=0)

1303 
šfo_dù
 = {'šfo_¡r': 
šfo_¡r
, 'šfo_j¡r': 
šfo_j¡r
}

1304 
¡©us
 = 
£lf
.
	$add_thumb_widg‘
Ğ
£lf
.
d©a_dœ
, 
thumb_âames
[
i
], 
šfo_dù
, 
row
, 
cŞumn
, 
¥_db
=¥_db, 
d©a
=data)

1305 if(
nÙ
 
¡©us
):

1308 
i
 += 1

1309 #£lf.
	`£t_cur_row
(
row
 + 1)

1310 
£lf
.
	$£t_cur_row
(
row
 )

1311 
£lf
.
	`£t_cur_cŞumn
(
cŞumn
 + 1)

1313 
£lf
.
	$upd©e_sûÃ
()

1315 
def
 
	$¥l™_d©a_dœ
(
£lf
, 
d©a_dœ
):

1317 
	$¥l™_d©a_dœ
(): 
desütiÚ


1319 :
·¿m
 
d©a_dœ
: d©a_dœ 
desütiÚ


1320 :
ty³
 
d©a_dœ
: data_dirype

1322 :
»tuºs
: 
NÚe


1324 if(
d©a_dœ
 
is
 
NÚe
):

1327 if(
d©a_dœ
.
	`fšd
('/') > -1):

1328 
£p
 = '/'

1329 
	`–if
(
d©a_dœ
.
	`fšd
('/') > -1):

1330 
£p
 = '/'

1332 
_logg”
.
	`”rÜ
('UnsuµÜ‹d dœeùÜy sŒšg [%s]' % 
d©a_dœ
)

1334 
d_l¡
 = 
d©a_dœ
.
	$¥l™
(
£p
)

1335 (
d_l¡
)

1337 
def
 
	$£t_d©a_dœ
(
£lf
, 
d©a_dœ
, 
is_¡ack_dœ
=
F®£
):

1339 
	$£t_d©a_dœ
(): 
desütiÚ


1341 :
·¿m
 
d©a_dœ
: d©a_dœ 
desütiÚ


1342 :
ty³
 
d©a_dœ
: data_dirype

1344 :
·¿m
 
is_¡ack_dœ
=
F®£
: is_¡ack_dœ=F®£ 
desütiÚ


1345 :
ty³
 
is_¡ack_dœ
=
F®£
: is_stack_dir=Falseype

1347 :
»tuºs
: 
NÚe


1349 if(
	`Ën
(
d©a_dœ
) > 0):

1350 
£lf
.
d©a_dœ
 = data_dir

1351 
d
 = 
£lf
.
	$¥l™_d©a_dœ
(
d©a_dœ
)

1352 
num_dœs
 = 
	`Ën
(
d
)-1

1353 
£lf
.
dœ_lbl
.
	`£tText
(
d
[
num_dœs
-1] + '/' + d[num_dirs])

1354 
£lf
.
fsys_mÚ
.
	$£t_d©a_dœ
(
d©a_dœ
)

1355 if(
nÙ
 
is_¡ack_dœ
):

1356 
£lf
.
	$»lßd_v›w
(
is_¡ack_dœ
)

1358 
def
 
	$do_£Ëù
(
£lf
, 
thumb
):

1360 
	$do_£Ëù
(): 
desütiÚ


1362 :
·¿m
 
thumb
:humb 
desütiÚ


1363 :
ty³
 
thumb
:humbype

1365 :
»tuºs
: 
NÚe


1367 
t
 
š
 
£lf
.
thumbs
:

1368 if(
	`id
(
thumb
è!ğ
	$id
(
t
)):

1369 
t
.
is_£Ëùed
 = 
F®£


1371 
t
.
is_£Ëùed
 = 
True


1372 
£lf
.
	$upd©e_v›w
()

1374 
def
 
	$upd©e_v›w
(
£lf
):

1376 
	$upd©e_v›w
(): 
desütiÚ


1378 :
»tuºs
: 
NÚe


1380 
£lf
.
v›w
.
	$upd©e
()

1381 #£lf.
sûÃ
.
	`upd©e
(
»ù
=
QtCÜe
.
	`QReùF
(0,0,1500,1500))

1382 
»ù
 = 
£lf
.
sûÃ
.
	$sûÃReù
()

1383 
£lf
.
sûÃ
.
	`upd©e
(
»ù
=
QtCÜe
.
	`QReùF
Ôeù.
	`Ëá
(),„eù.
	`tİ
(),»ù.
	`width
(),»ù.
	$height
()))

1385 #deà
	`lßd_sÿn
(
£lf
, 
sÿn
):

1387 #lßd_sÿn(): 
desütiÚ


1388 #
#:
·¿m
 
sÿn
: sÿÀ
desütiÚ


1389 #:
ty³
 
sÿn
: scanype

1390 #
#:
»tuºs
: 
NÚe


1394 
def
 
	$Ïunch_v›w”
(
£lf
, 
dù
):

1396 
	$Ïunch_v›w”
(): 
desütiÚ


1398 :
·¿m
 
dù
: dù 
desütiÚ


1399 :
ty³
 
dù
: dctype

1401 :
»tuºs
: 
NÚe


1403 
impÜt
 
Œaûback


1404 #âame, 
d©a
, 
t™Ë
=
NÚe
):

1405 
Œy
:

1406 
âame
 = 
dù
['path']

1407 
d©a
 = 
dù
['data']

1408 
¥_db
 = 
dù
['sp_db']

1409 
t™Ë
 = 
dù
['title']

1411 
d©a_dœ
, 
å»fix
, 
fsuffix
 = 
	$g‘_fe_·th_as_·¹s
(
âame
)

1412 #£lf.
wš
.
	`İ’fe
(
d©a_dœ
 + '//' + 
å»fix
 + '.hdf5')

1413 if(
£lf
.
wš
 
is
 
NÚe
):

1414 
fg_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_forgrnd'])

1415 
bg_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_bckgrnd'])

1416 
mš_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_gridmaj'])

1417 
maj_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_gridmin'])

1419 
£lf
.
wš
 = 
	$make_deçuÉ_¡ªd_®Úe_¡xm_imagewidg‘
()

1420 
qssh“t
 = 
	`g‘_¡yË
('dark')

1421 
£lf
.
wš
.
	$£tStyËSh“t
(
qssh“t
)

1422 #
.wš.£t_grid_·¿m‘”s(bg_şr, mš_şr, maj_şr)

1423 
£lf
.
wš
.
	$£t_cs_grid_·¿m‘”s
(
fg_şr
, 
bg_şr
, 
mš_şr
, 
maj_şr
)

1425 
£lf
.
wš
.
şo£Ev’t
 = s–f.
Ú_v›w”_şo£Ev’t


1426 
numX
 = (
	$dù_g‘
(
¥_db
, 
SPDB_XNPOINTS
))

1427 
numY
 = (
	$dù_g‘
(
¥_db
, 
SPDB_YNPOINTS
))

1428 
»ù
 = 
	$dù_g‘
(
¥_db
, 
SPDB_RECT
)

1429 
£lf
.
wš
.
	`š™D©a
(
image_ty³s
.
IMAGE
, 
numY
 , 
numX
, {
SPDB_RECT
: 
»ù
})

1430 #£lf.
wš
.
İ’fe
(
d©a_dœ
 + '//' + 
å»fix
 + '.hdf5')

1431 
£lf
.
wš
.
	$£t_d©a
(
d©a
)

1432 
£lf
.
wš
.
	$Ú_£t_a¥eù_¿tio
(
True
)

1433 
£lf
.
wš
.
	$upd©e_cÚŒa¡
()

1434 
£lf
.
wš
.
	$show
()

1437 
£lf
.
wš
.
	$£t_d©a
(
d©a
)

1438 
»ù
 = 
	$dù_g‘
(
¥_db
, 
SPDB_RECT
)

1439 (
x1
, 
y1
, 
x2
, 
y2
èğ
»ù


1440 
£lf
.
wš
.
	$£t_image_·¿m‘”s
(
£lf
.
wš
.
™em
, 
x1
, 
y1
, 
x2
, 
y2
)

1441 
£lf
.
wš
.
	$Ú_£t_a¥eù_¿tio
(
True
)

1442 
£lf
.
wš
.
	$upd©e_cÚŒa¡
()

1443 
£lf
.
wš
.
	$¿i£_
()

1446 if(
t™Ë
 
is
 
nÙ
 
NÚe
):

1447 
£lf
.
wš
.
¶Ù
.
	`£t_t™Ë
('%s' % 
t™Ë
)

1449 
£lf
.
wš
.
¶Ù
.
	`£t_t™Ë
('%s%s' % (
å»fix
, 
fsuffix
))

1452 #£lf.
wš
.
	`İ’fe
(
d©a_dœ
 + '//' + 
å»fix
 + '.hdf5')

1453 
exû±
:

1454 
Œaûback
.
	$´št_exc
()

1456 
def
 
	$Ú_v›w”_şo£Ev’t
(
£lf
, 
ev’t
):

1458 
£lf
.
wš
 = 
NÚe


1459 
ev’t
.
	$acû±
(è#Ëˆ
the
 
wšdow
 
şo£


1460 #ev’t.
	`ignÜe
()

1462 
__Çme__
 == "__main__":

1463 
	$log_to_qt
()

1464 
­p
 = 
QtWidg‘s
.
	$QAµliÿtiÚ
(
sys
.
¬gv
)

1465 
­p
.
	`£tAµliÿtiÚName
("Pyqt Image galleryƒxample")

1466 
dœ
 = 
r
'S:\STXM-data\Cryo-STXM\2017\guest\0201'

1467 #dœ = 
r
'S:\STXM-data\Cryo-STXM\2016\guest\1007\C161007184''

1468 #maš = 
	`CÚùSh“t
(
r
'S:\STXM-data\Cryo-STXM\2016\guest\test')

1469 
maš
 = 
	$CÚùSh“t
(
dœ
)

1470 
maš
.
	$£t_d©a_dœ
(
dœ
)

1471 
maš
.
	$show
()

1472 
maš
.
	`»size
(385, 700)

1474 
sys
.
	`ex™
(
­p
.
	`exec_
())

	@widgets/thumbnailViewer.py

2 
C»©ed
 
	gÚ
 2016-10-11

4 @
	gauthÜ
: 
b”gr


6 
The
 
basic
 
İ”©iÚ
 
of
 
this
 
widg‘
 
is
 
to
 
cÚÃù
Ø
a
 
DœeùÜyMÚ™Ü
 
şass
 
th©
 
wl
 
d‘eù
 
wh’
‡ 
	$fe
(
s
è
¬e
 
added
/
»moved
 
to
/
äom
 
a
 
dœeùÜy
.

8 
This
 
şass
 
wl
 
·ss
 
a
 
Queue
 
to
 
the
 
	$DœeùÜyMÚ™Ü
(è
th©
 
wl
 
be
 
u£d
 
to
 
£nd
 
šfÜm©iÚ
 
back
 
äom
 
the
 
	$DI»tÜyMÚ™Ü
(è
şass
.

10 
Wh’
 
a
 
chªge
 
to
 
the
 
dœeùÜy
 
has
 
occu¼ed
h
	$DI»ùÜyMÚ™Ü
(è
wl
 
cŞËù
 
the
 
chªges
 
š
 
two
 
ÿ‹gÜ›s
, 'added' 
ªd
 '»moved', 
the£
 wÈ
be
 
added


11 
to
 
a
 
diùiÚ¬y
 
th©
 
cÚšs
 
the£
 
ÿ‹gÜ›s
 
as
 
key
 
wÜds
, 
cÚšed
 
š
 
—ch
 
is
‡ 
li¡
 
of
 
the
 
f’ames
h© 
have
 
b“n
 
e™h”
 
added
 
Ü
 
»moved
. 
This


12 
diùiÚ¬y
 
wl
 
th’
 
be
 
wr™‹n
 
to
 
the
 
queue
 
ªd
h’h
	$DœeùÜyMÚ™Ü
(è
şass
 
wl
 
em™
 
™
' '
chªged
' sigÇl. Th'chªged 
sigÇl
' is monitored by

13 
the
 
	$CÚùSh“t
(è
©
 
which
 
pošt
 
™
 
wl
 
»ad
 
out
 
of
 
the
 
queue
 
®l
 oàth
added
/
»moved
 
diùiÚ¬›s
 
·ssšg
 
th©
 
šfÜm©iÚ
 
off
 
to
h
g¿phics
 
widg‘


14 
funùiÚs
 
th©
 
hªdË
 
ü—tšg
 
the
 
g¿phics
 
—ch
 
d©a
 
fe
.

17 
impÜt
 
sys


18 
impÜt
 
os


19 
impÜt
 
™”toŞs


20 
impÜt
 
sim¶ejsÚ
 
as
 
jsÚ


21 
impÜt
 
Queue


22 
impÜt
 
numpy
 
as
 
Å


24 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
QtGui
, 
QtWidg‘s


26 
äom
 
bcm
.
deviû
.
•u
 
impÜt
 
cÚv”t_w¿µ”_•u_to_¡r


28 
äom
 
şs
.
uts
.
images
 
impÜt
 
¬¿y_to_g¿y_qpixm­


30 
äom
 
şs
.
­¶iÿtiÚs
.
pyStxm
 
impÜt
 
abs_·th_to_ši_fe


31 
äom
 
şs
.
­p_d©a
.
deçuÉs
 
impÜt
 
ma¡”_cŞÜs
, 
g‘_¡yË
, 
rgb_as_hex


33 
äom
 
şs
.
uts
.
¬¿ys
 
impÜt
 
æ_d©a_upsdown


34 
äom
 
şs
.
­pWidg‘s
.
dŸlogs
 
impÜt
 
£tExi¡šgDœeùÜy


35 
äom
 
şs
.
uts
.
dœli¡
 
impÜt
 dirlist

36 
äom
 
şs
.
uts
.
feUts
 
impÜt
 
g‘_fe_·th_as_·¹s


37 
äom
 
şs
.
uts
.
log
 
impÜt
 
g‘_moduË_logg”
, 
log_to_qt


38 
äom
 
şs
.
uts
.
cfg·r£r
 
impÜt
 
CÚfigCÏss


39 
äom
 
şs
.
uts
.
diù_uts
 
impÜt
 
dù_g‘
, 
dù_put


40 
äom
 
şs
.
sÿÂšg
.
ty³s
 
impÜt
 
¥©Ÿl_ty³_´efix
, 
image_ty³s
, 
sÿn_image_ty³s
, 
sÿn_ty³s
, 
sÿn_sub_ty³s
, 
§m¶e_pos™iÚšg_modes


41 
äom
 
şs
.
­¶iÿtiÚs
.
bioXasIM
.
d©a
.
bioxas_im_d©a_io
 
impÜt
 
BioxasD©aIo


42 
äom
 
şs
.
¶ÙWidg‘s
.
imageWidg‘
 
impÜt
 
make_deçuÉ_¡ªd_®Úe_¡xm_imagewidg‘


43 
äom
 
şs
.
uts
.
roi_uts
 
impÜt
 
g‘_fœ¡_¥_db_äom_wdg_com


44 
äom
 
şs
.
uts
.
roi_diù_defs
 
impÜt
 *

45 
äom
 
şs
.
uts
.
feSy¡emMÚ™Ü
 
impÜt
 
DœeùÜyMÚ™Ü


47 
­pCÚfig
 = 
	$CÚfigCÏss
(
abs_·th_to_ši_fe
)

48 
icoDœ1
 = 
­pCÚfig
.
	`g‘_v®ue
('DEFAULT', 'icoDir1')

50 
_logg”
 = 
	$g‘_moduË_logg”
(
__Çme__
)

52 
MAX_THUMB_COLUMNS
 = 3

53 
THMB_SIZE
 = 90

54 
SCENE_WIDTH
 = 290.0

55 
THUMB_WIDTH
 = 150.0

56 
THUMB_HEIGHT
 = 130.0

59 
COLORTABLE
=[]

60 
i
 
š
 
	`¿nge
(256): 
COLORTABLE
.
	`­³nd
(
QtGui
.
	`qRgb
(i/4,i,i/2))

64 
şass
 
	$ThumbÇWidg‘
(
QtWidg‘s
.
QG¿phicsWidg‘
):

65 
upd©e_v›w
 = 
QtCÜe
.
	$pyqtSigÇl
()

66 
£Ëù
 = 
QtCÜe
.
	$pyqtSigÇl
(
objeù
)

67 
Ïunch_v›w”
 = 
QtCÜe
.
	$pyqtSigÇl
(
objeù
)

68 
d¿g
 = 
QtCÜe
.
	$pyqtSigÇl
(
objeù
, object)

70 
def
 
	$__š™__
(
£lf
, 
âame
, 
¥_db
, 
d©a
, 
t™Ë
, 
šfo_dù
, 
·»Á
 = 
NÚe
):

72 
	$__š™__
(): 
desütiÚ


74 :
·¿m
 
âame
: fÇm
desütiÚ


75 :
ty³
 
âame
: fnameype

77 :
·¿m
 
¥_db
: sp_db 
desütiÚ


78 :
ty³
 
¥_db
: sp_dbype

80 :
·¿m
 
d©a
: d©¨
desütiÚ


81 :
ty³
 
d©a
: dataype

83 :
·¿m
 
t™Ë
:™Ë 
desütiÚ


84 :
ty³
 
t™Ë
:itleype

86 :
·¿m
 
šfo_dù
: info_dù 
desütiÚ


87 :
ty³
 
šfo_dù
: info_dctype

89 :
·¿m
 
·»Á
=
NÚe
:…¬’t=NÚ
desütiÚ


90 :
ty³
 
·»Á
=
NÚe
:…arent=Noneype

92 :
»tuºs
: 
NÚe


95 
This
 
şass
 
is
 
u£d
 
to
 
ü—‹
 
a
 
sšgË
 
g¿phics
 
widg‘
 
th©
 
di¥Ïys
‡ 
thumbÇ
 
of


96 
a
 
¡xm
 
image
 
d©a
, 
the
 
thumbÇ
 
is
 
ü—‹d
 
äom
hd©¨
£ùiÚ
 
of
h
hdf5
 
fe


98 
QtWidg‘s
.
QG¿phicsWidg‘
.
	$__š™__
(
£lf
, 
·»Á
)

99 
£lf
.
·»Á
 =…arent

100 
âame
 = 
	$¡r
(
âame
)

101 
d©a_dœ
, 
å»fix
, 
fsuffix
 = 
	$g‘_fe_·th_as_·¹s
(
âame
)

102 if(
t™Ë
 
is
 
NÚe
):

103 
£lf
.
t™Ë
 = 
	$¡r
(
å»fix
)

105 
£lf
.
t™Ë
 =itle

107 
£lf
.
d©a
 = data

108 
£lf
.
¥_db
 = sp_db

109 
£lf
.
Ïb–height
 = 20

110 
£lf
.
bÜd”size
 = 1

112 
£lf
.
hdf5_·th
 = 
âame


113 
£lf
.
d©a_dœ
 = data_dir

114 
£lf
.
âame
 = fname

115 
£lf
.
³n
 = 
QtGui
.
	$QP’
()

116 
£lf
.
³n
.
	`£tWidth
(2)

117 
£lf
.
³n
.
	$£tBrush
(
QtCÜe
.
Qt
.
bÏck
)

118 
£lf
.
³n
.
	$£tStyË
(
QtCÜe
.
Qt
.
SŞidLše
)

119 
£lf
.
is_£Ëùed
 = 
F®£


120 
£lf
.
v®id_fe
 = 
F®£


121 
£lf
.
pic
 = 
NÚe


122 
£lf
.
šfo_¡r
 = 
šfo_dù
['info_str']

123 
£lf
.
šfo_j¡r
 = 
šfo_dù
['info_jstr']

125 
£lf
.
v®id_fe
 = 
True


126 
£lf
.
pic
 = s–f.
	$g‘pic
()

127 
£lf
.
	$£tToŞT
(
£lf
.
šfo_¡r
)

128 
£lf
.
	$£tAcû±Hov”Ev’ts
(
True
)

130 
def
 
	$is_v®id
(
£lf
):

132 
	$is_v®id
(): 
desütiÚ


134 :
»tuºs
: 
NÚe


136 (
£lf
.
v®id_fe
)

140 
def
 
	$boundšgReù
(
£lf
):

142 
	$boundšgReù
(): 
desütiÚ


144 :
»tuºs
: 
NÚe


146 if(
£lf
.
pic
 
is
 
nÙ
 
NÚe
):

147 
width
 = 
£lf
.
pic
.
	`»ù
().
	`width
(è+ s–f.
bÜd”size
 * 2

148 
height
 = 
£lf
.
pic
.
	`»ù
().
	`height
(è+ s–f.
Ïb–height
 + s–f.
bÜd”size
 * 2

149 
thumb_widg‘_»ù
 = 
QtCÜe
.
	`QReùF
(0.0, 0.0, 
width
, 
height
)

152 
thumb_widg‘_»ù
 = 
QtCÜe
.
	`QReùF
(0.0, 0.0, 
THUMB_WIDTH
, 
THUMB_HEIGHT
)

153 #thumb_widg‘_»ù = 
QtCÜe
.
	`QReùF
()

155 #£lf.
_boundšgReù
 = 
thumb_widg‘_»ù


156  
thumb_widg‘_»ù


158 
def
 
	`sizeHšt
(
£lf
, 
which
, 
cÚ¡¿št
 = 
QtCÜe
.
	$QSizeF
()):

160 
	$sizeHšt
(): 
desütiÚ


162 :
·¿m
 
which
: which 
desütiÚ


163 :
ty³
 
which
: whichype

165 :
·¿m
 
cÚ¡¿št
=
QtCÜe
.
	$QSizeF
(): 
cÚ¡¿št
=
QtCÜe
.
	$QSizeF
(è
desütiÚ


166 :
ty³
 
cÚ¡¿št
=
QtCÜe
.
	$QSizeF
(): 
cÚ¡¿št
=
QtCÜe
.
	$QSizeF
(è
ty³


168 :
»tuºs
: 
NÚe


170 
br
 = 
£lf
.
	$boundšgReù
()

171  
br
.
	$size
()

173 
def
 
	$g‘pic
(
£lf
):

175 
	$g‘pic
(): 
desütiÚ


177 :
»tuºs
: 
NÚe


179 if(
£lf
.
d©a
 
is
 
nÙ
 
NÚe
):

180 if(
	`Ën
(
£lf
.
d©a
.
sh­e
) == 2):

181 
wd
, 
ht
 = 
£lf
.
d©a
.
sh­e


182 #d©¨ğ
Å
.
	`æud
(
£lf
.
d©a
)

183 #d©¨ğ
£lf
.
d©a


184 
d©a
 = 
	$æ_d©a_upsdown
(
£lf
.
d©a
)

185 
sh­e
 = 
d©a
.shape

187 
	`–if
(
	`Ën
(
£lf
.
d©a
.
sh­e
) == 3):

188 
img_£q
, 
wd
, 
ht
 = 
£lf
.
d©a
.
sh­e


189 #d©¨ğ
Å
.
	`æud
(
£lf
.
d©a
[0])

190 #d©¨ğ
£lf
.
d©a
[0]

191 
d©a
 = 
	`æ_d©a_upsdown
(
£lf
.data[0])

192 
sh­e
 = 
d©a
.shape

195 #_logg”.
	`”rÜ
('unsupported data shape')

196 (
NÚe
)

198 
_logg”
.
	`”rÜ
('d©¨i NÚš [%s]' % 
£lf
.
hdf5_·th
)

199 (
NÚe
)

201 #cÚv”ˆ
™
 
to
 
a
 
QPixm­
 
di¥Ïy
:

202 
pm­
 = 
	$¬¿y_to_g¿y_qpixm­
(
d©a
)

203 #pm­ = 
pm­
.
	`sÿËd
(
QtCÜe
.
	`QSize
(128,128), QtCÜe.
Qt
.
K“pA¥eùR©io
)

204 
pm­
 =…m­.
	`sÿËd
(
QtCÜe
.
	$QSize
(
THMB_SIZE
,THMB_SIZE))

206  
pm­


208 
def
 
	$·št
(
£lf
, 
·š‹r
, 
İtiÚ
, 
widg‘
):

210 
	$·št
(): 
desütiÚ


212 :
·¿m
 
·š‹r
:…aš‹¸
desütiÚ


213 :
ty³
 
·š‹r
:…ainterype

215 :
·¿m
 
İtiÚ
: o±iÚ 
desütiÚ


216 :
ty³
 
İtiÚ
: optionype

218 :
·¿m
 
widg‘
: widg‘ 
desütiÚ


219 :
ty³
 
widg‘
: widgetype

221 :
»tuºs
: 
NÚe


223 if(
£lf
.
pic
 
is
 
nÙ
 
NÚe
):

224 if(
£lf
.
is_£Ëùed
):

225 
£lf
.
³n
.
	$£tBrush
(
QtCÜe
.
Qt
.
blue
)

227 
£lf
.
³n
.
	$£tBrush
(
QtCÜe
.
Qt
.
bÏck
)

228 
£lf
.
³n
.
	$£tStyË
(
QtCÜe
.
Qt
.
SŞidLše
)

230 
·š‹r
.
	$£tP’
(
£lf
.
³n
)

231 #D¿w 
bÜd”


232 
·š‹r
.
	`d¿wReù
(
QtCÜe
.
	`QReù
(0,

234 
£lf
.
pic
.
	`»ù
().
	`width
(è+ s–f.
bÜd”size
,

235 
£lf
.
pic
.
	`»ù
().
	`height
(è+ s–f.
Ïb–height
 + s–f.
bÜd”size
))

237 #FÈ
Ïb–


238 
·š‹r
.
	`flReù
(
QtCÜe
.
	`QReù
(
£lf
.
bÜd”size
,

239 
£lf
.
bÜd”size
 + s–f.
pic
.
	`»ù
().
	`height
(),

240 
£lf
.
pic
.
	`»ù
().
	`width
(),

241 
£lf
.
Ïb–height
),

242 
QtCÜe
.
Qt
.
g¿y
)

244 #D¿w 
image


245 
·š‹r
.
	`d¿wPixm­
(
QtCÜe
.
	`QReù
(
£lf
.
bÜd”size
,

246 
£lf
.
bÜd”size
,

247 
£lf
.
pic
.
	`»ù
().
	`width
(),

248 
£lf
.
pic
.
	`»ù
().
	`height
()),

249 
£lf
.
pic
,

250 
£lf
.
pic
.
	$»ù
())

252 #D¿w 
‹xt


253 
‹xt_»ù
 = 
QtCÜe
.
	`QReù
(0,

254 
£lf
.
pic
.
	`»ù
().
	`y
(è+ s–f.pic.»ù().
	`height
(),

255 
£lf
.
pic
.
	`»ù
().
	`width
(),

256 
£lf
.
Ïb–height
)

258 
·š‹r
.
	$d¿wText
(
‹xt_»ù
, 
QtCÜe
.
Qt
.
AlignC’‹r
, 
£lf
.
t™Ë
)

261 
def
 
	$mou£P»ssEv’t
(
£lf
, 
ev’t
):

263 
	$mou£P»ssEv’t
(): 
desütiÚ


265 :
·¿m
 
ev’t
:ƒv’ˆ
desütiÚ


266 :
ty³
 
ev’t
:ƒventype

268 :
»tuºs
: 
NÚe


270 
bŠ
 = 
ev’t
.
	$bu‰Ú
()

272 if(
£lf
.
is_£Ëùed
):

273 
£lf
.
is_£Ëùed
 = 
F®£


275 
£lf
.
is_£Ëùed
 = 
True


277 
£lf
.
£Ëù
.
	$em™
(
£lf
)

278 
£lf
.
	`upd©e
(
QtCÜe
.
	`QReùF
(0.0,

280 
£lf
.
pic
.
	`»ù
().
	`width
(è+ s–f.
bÜd”size
,

281 
£lf
.
pic
.
	`»ù
().
	`height
(è+ s–f.
Ïb–height
 + s–f.
bÜd”size
))

282 
QtWidg‘s
.
QG¿phicsI‹m
.
	$mou£P»ssEv’t
(
£lf
, 
ev’t
)

284 
bŠ
 =ğ
QtCÜe
.
Qt
.
LeáBu‰Ú
:

285 
£lf
.
d¿g
.
	$em™
(
£lf
, 
ev’t
)

289 
def
 
	$cÚ‹xtM’uEv’t
(
£lf
, 
ev’t
):

291 
	$cÚ‹xtM’uEv’t
(): 
desütiÚ


293 :
·¿m
 
ev’t
:ƒv’ˆ
desütiÚ


294 :
ty³
 
ev’t
:ƒventype

296 :
»tuºs
: 
NÚe


299 
m’u
 = 
QtWidg‘s
.
	$QM’u
()

300 #lßdAùiÚ = 
QtWidg‘s
.
	`QAùiÚ
("Lßd Sÿn", 
£lf
)

301 
ÏunchAùiÚ
 = 
QtWidg‘s
.
	`QAùiÚ
("Launch iÀV›w”", 
£lf
)

302 #lßdAùiÚ.
Œigg”ed
.
	`cÚÃù
(
£lf
.
lßd_sÿn
)

303 
ÏunchAùiÚ
.
Œigg”ed
.
	$cÚÃù
(
£lf
.
Ïunch_vwr
)

305 #m’u.
	`addAùiÚ
(
lßdAùiÚ
)

306 
m’u
.
	$addAùiÚ
(
ÏunchAùiÚ
)

307 
m’u
.
	`exec_
(
ev’t
.
	$sü“nPos
())

309 
def
 
	$lßd_sÿn
(
£lf
):

311 
	$lßd_sÿn
(): 
desütiÚ


313 :
»tuºs
: 
NÚe


315 
´št
 'lßdšg %s.hdf5' % 
£lf
.
hdf5_·th


318 
def
 
	$Ïunch_vwr
(
£lf
):

320 
	$Ïunch_vwr
(): 
desütiÚ


322 :
»tuºs
: 
NÚe


324 #´šˆ'Ïunch_v›w” %s.hdf5' % 
£lf
.
hdf5_·th


325 if(
£lf
.
d©a
.
ndim
 == 3):

327 
l
 = 
	`Ën
(
£lf
.
t™Ë
.
	`¥l™
('.')[0].split('_'))

328 if(
l
 > 1):

329 #found 
a
 '_' 
ch¬aù”
 
šdiÿtšg
 
™s
‡ 
¡ack
 
image


330 
i
 = (
£lf
.
t™Ë
.
	`¥l™
('.')[0].split('_')[1])

331 
d©a
 = 
£lf
.d©a[
i
]

333 #™ 
a
 
sšgË
 
image


334 
d©a
 = 
£lf
.data[0]

336 if(
£lf
.
d©a
.
ndim
 == 2):

337 
d©a
 = 
£lf
.data

339 
dù
 = {
	}
}

340 #beÿu£ 
the
 
d©a
 
š
h
StxmImageWidg‘
 
is
 
di¥Ïyed
 
w™h
 0
Y
 
©
h
btm


341 #ªd 
maxY
 
©
 
the
 
tİ
 
I
 
mu¡
 
æ
 
™
 
befÜe
 
£ndšg
 it

342 #dù['d©a'] = 
Å
.
æud
(
d©a
)

343 
dù
['d©a'] = 
d©a


344 
dù
['·th'] = 
£lf
.
hdf5_·th


345 
dù
['¥_db'] = 
£lf
.
¥_db


346 
dù
['t™Ë'] = 
NÚe


347 if(
£lf
.
¥_db
 
is
 
nÙ
 
NÚe
):

348 
dù
['t™Ë'] = 
£lf
.
t™Ë


349 
£lf
.
Ïunch_v›w”
.
	$em™
(
dù
)

351 
def
 
	$mou£Hov”Ev’t
(
£lf
, 
ev’t
):

353 
	$mou£Hov”Ev’t
(): 
desütiÚ


355 :
·¿m
 
ev’t
:ƒv’ˆ
desütiÚ


356 :
ty³
 
ev’t
:ƒventype

358 :
»tuºs
: 
NÚe


360 
	`´št
('Widgetƒnter')

362 
def
 
	$mou£R–—£Ev’t
(
£lf
, 
ev’t
):

364 
	$mou£R–—£Ev’t
(): 
desütiÚ


366 :
·¿m
 
ev’t
:ƒv’ˆ
desütiÚ


367 :
ty³
 
ev’t
:ƒventype

369 :
»tuºs
: 
NÚe


371 
QtWidg‘s
.
QG¿phicsI‹m
.
	$mou£R–—£Ev’t
(
£lf
, 
ev’t
)

374 
def
 
	$hov”EÁ”Ev’t
(
£lf
, 
ev’t
):

376 
	$hov”EÁ”Ev’t
(): 
desütiÚ


378 :
·¿m
 
ev’t
:ƒv’ˆ
desütiÚ


379 :
ty³
 
ev’t
:ƒventype

381 :
»tuºs
: 
NÚe


383 
·ss


384 #£lf.
³n
.
	`£tStyË
(
QtCÜe
.
Qt
.
DÙLše
)

385 #QtWidg‘s.
QG¿phicsWidg‘
.
	`hov”EÁ”Ev’t
(
£lf
, 
ev’t
)

387 
def
 
	$hov”L—veEv’t
(
£lf
, 
ev’t
):

389 
	$hov”L—veEv’t
(): 
desütiÚ


391 :
·¿m
 
ev’t
:ƒv’ˆ
desütiÚ


392 :
ty³
 
ev’t
:ƒventype

394 :
»tuºs
: 
NÚe


396 
·ss


397 #£lf.
³n
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidLše
)

398 #QtWidg‘s.
QG¿phicsWidg‘
.
	`hov”L—veEv’t
(
£lf
, 
ev’t
)

400 
def
 
	$g‘_pixm­
(
âame
):

402 
	$g‘_pixm­
(): 
desütiÚ


404 :
·¿m
 
	`g‘_pixm­
(
âame
: g‘_pixm­(âam
desütiÚ


405 :
ty³
 
	`g‘_pixm­
(
âame
: get_pixmap(fnameype

407 :
»tuºs
: 
NÚe


409 
pm­
 = 
QtGui
.
	$QPixm­
(
âame
)

410 #pm­.
	`sÿËd
(64, 64)#, 
a¥eùR©ioMode
=
Qt_IgnÜeA¥eùR©io
, 
ŒªsfÜmMode
=
Qt_Fa¡T¿nsfÜm©iÚ
)

411 
pm­
 =…m­.
	`sÿËd
(
QtCÜe
.
	`QSize
(16,16), QtCÜe.
Qt
.
K“pA¥eùR©io
)

412 (
pm­
)

415 
şass
 
	$MašG¿phicsWidg‘
(
QtWidg‘s
.
QG¿phicsWidg‘
):

416 
def
 
	$__š™__
(
£lf
):

418 
	$__š™__
(): 
desütiÚ


420 :
»tuºs
: 
NÚe


422 
QtWidg‘s
.
QG¿phicsWidg‘
.
	$__š™__
(
£lf
)

423 
£lf
.
gridÏyout
 = 
QtWidg‘s
.
	$QG¿phicsGridLayout
()

424 
£lf
.
gridÏyout
.
	`£tCÚ‹ÁsM¬gšs
(0, 5, 5, 0)

425 
£lf
.
	$£tLayout
(
£lf
.
gridÏyout
)

427 
def
 
	$£t_Ïyout_size
(
£lf
, 
qr
):

429 
	$£t_Ïyout_size
(): 
desütiÚ


431 :
·¿m
 
qr
: q¸
desütiÚ


432 :
ty³
 
qr
: qrype

434 :
»tuºs
: 
NÚe


436 
gwl
 = 
£lf
.
	$Ïyout
()

437 
gwl
.
	`£tGeom‘ry
(
QtCÜe
.
	`QReùF
(
qr
.
	`x
(), qr.
	`y
(), qr.
	`width
(), 
THUMB_HEIGHT
))

438 
gwl
.
	$upd©eGeom‘ry
()

440 
def
 
	$boundšgReù
(
£lf
):

442 
	$boundšgReù
(): 
desütiÚ


444 :
»tuºs
: 
NÚe


446 #´šˆ
£lf
.
gridÏyout
.
	`cÚ‹ÁsReù
()

447 (
£lf
.
gridÏyout
.
	$cÚ‹ÁsReù
())

449 
def
 
	$ş—r_Ïyout
(
£lf
):

451 
	$ş—r_Ïyout
(): 
desütiÚ


453 :
»tuºs
: 
NÚe


455 if((
£lf
.
gridÏyout
.
	`rowCouÁ
(è=ğ0è
	`ªd
 (£lf.gridÏyout.
	`cŞumnCouÁ
() == 0)):

457 
row
 
š
 
	`¿nge
(
£lf
.
gridÏyout
.
	$couÁ
()):

458 #th
	`couÁ
(è
wl
 
chªge
 
as
 
the
 
™ems
 
¬e
 
»moved


459 #sØ
ju¡
 
k“p
 
puÎšg
 
them
 
äom
 
‹h
 
tİ
 [0]

460 
™em
 = 
£lf
.
gridÏyout
.
	`™emAt
(£lf.gridÏyout.
	`couÁ
()-1)

461 
£lf
.
gridÏyout
.
	`»moveAt
(£lf.gridÏyout.
	`couÁ
()-1)

462 
d–
 
™em


463 
£lf
.
	`£t_Ïyout_size
(
QtCÜe
.
	`QReùF
(£lf.
	`»ù
().
	`x
(), s–f.»ù().
	`y
(), s–f.»ù().
	`width
(), 
THUMB_HEIGHT
))

464 #£lf.
gridÏyout
.
	`upd©eGeom‘ry
()

466 
şass
 
	$CÚùSh“t
(
QtWidg‘s
.
QWidg‘
):

467 
def
 
	`__š™__
(
£lf
, 
d©a_dœ
=""):

469 
	$__š™__
(): 
desütiÚ


471 :
·¿m
 
d©a_dœ
="": d©a_dœ="" 
desütiÚ


472 :
ty³
 
d©a_dœ
="": data_dir=""ype

474 :
»tuºs
: 
NÚe


477 
QtWidg‘s
.
QWidg‘
.
	$__š™__
(
£lf
)

479 #£lf.
	`£tStyËSh“t
("QToolTip { color: #ffffff; background-color: #2a82da; border: 1px solid white; }")

480 #£lf.
	`£tStyËSh“t
("QToolTip { color: #ffffff; background-color:„gb(26, 106, 255); border: 1px solid white; }")

481 
£lf
.
	`£tStyËSh“t
("QToolTip { color:„gb(20, 20, 20); background-color:„gb(181, 179, 181); border: 1px solid grey; }")

483 
£lf
.
d©a_io
 = 
NÚe


484 
£lf
.
­²ame
 = "Contact Sheet"

485 
£lf
.
	`£tObjeùName
('contactSheet')

486 
£lf
.
wš
 = 
NÚe


487 
£lf
.
thumbs
 = []

488 
£lf
.
	$£tWšdowT™Ë
(
£lf
.
­²ame
)

489 
£lf
.
sûÃ
 = 
QtWidg‘s
.
	$QG¿phicsSûÃ
()

490 
£lf
.
sûÃ
.
	`£tBackgroundBrush
(
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(50, 50, 50)))

491 #£lf.
d©a_dœ
 = 
r
'C:/controls/py2.7/Beamlines/sm/data/guest/Apr29'

492 
£lf
.
d©a_dœ
 = ""

493 
£lf
.
image_fe_ex‹nsiÚ
 = '.jpg'

494 
£lf
.
d©a_fe_ex‹nsiÚ
 = '.hdf5'

495 
£lf
.
fÜm©s
 = '*' + s–f.
image_fe_ex‹nsiÚ


497 
£lf
.
dœ_lbl
 = 
QtWidg‘s
.
	`QLab–
('')

498 
£lf
.
dœ_lbl
.
	$£tAlignm’t
(
QtCÜe
.
Qt
.
AlignHC’‹r
)

499 
fÚt
 = 
£lf
.
dœ_lbl
.
	$fÚt
()

500 
fÚt
.
	$£tBŞd
(
True
)

501 
£lf
.
dœ_lbl
.
	$£tFÚt
(
fÚt
)

502 
£lf
.
dœ_lbl
.
cÚ‹xtM’uEv’t
 = s–f.
dœLab–CÚ‹xtM’uEv’t


503 # ğ'<¨¡yË="background-cŞÜ:¿n¥¬’t; cŞÜ: %s"><b>%s</b>\ˆ<¨bÜd”-width: 50px; styË="background-cŞÜ: %s; cŞÜ: %s"><b>%s</b> </a>' % (
t™Ë_cŞÜ
, 
t™Ë
, 
bgcŞÜ
, 
v¬_cŞÜ
, 
v¬
)

505 
£lf
.
»äeshBŠ
 = 
QtWidg‘s
.
	$QToŞBu‰Ú
()

506 
ico_dœ
 = 
icoDœ1


507 
ico_psize
 = '/64x64/'

508 
ico_şr
 = 'gray'

510 #pm­ = 
	`g‘_pixm­
(
ico_dœ
 + 
ico_şr
 + 
ico_psize
 + 'reload.png')

511 #£lf.
»äeshBŠ
.
	`icÚ
(
QtGui
.
	`QPixm­
(
pm­
))

512 #£lf.
»äeshBŠ
.
	`£tMaximumSize
(50, 25)

513 #£lf.
»äeshBŠ
.
şicked
.
	`cÚÃù
(
£lf
.
»lßd_v›w
)

515 
£lf
.
v›w
 = 
QtWidg‘s
.
	$QG¿phicsV›w
(
£lf
.
sûÃ
)

517 
£lf
.
cur_thumb_row
 = 0

518 
£lf
.
cur_thumb_cŞumn
 = 0

520 
£lf
.
f_queue
 = 
Queue
.
	$Queue
()

522 
£lf
.
fsys_mÚ
 = 
	$DœeùÜyMÚ™Ü
(
£lf
.
f_queue
)

523 #£lf.
fsys_mÚ
.
	`£t_fe_ex‹nsiÚ_f‹r
(
£lf
.
image_fe_ex‹nsiÚ
)

524 
£lf
.
fsys_mÚ
.
	`£t_fe_ex‹nsiÚ_f‹r
('hdf5')

525 
£lf
.
fsys_mÚ
.
	$£t_d©a_dœ
Ğ
£lf
.
d©a_dœ
)

526 #£lf.
fsys_mÚ
.
chªged
.
	`cÚÃù
(
£lf
.
Ú_dœ_chªged
)

527 
£lf
.
fsys_mÚ
.
chªged
.
	$cÚÃù
(
£lf
.
upd©e_fe_li¡
)

528 #£ˆ
QG¿phicsV›w
 
©Œibu‹s


529 #£lf.
v›w
.
	`£tR’d”Hšts
(
QtGui
.
QPaš‹r
.
AÁŸlŸsšg
 | QtGui.QPaš‹r.
HighQu®™yAÁŸlŸsšg
)

530 #£lf.
v›w
.
	`£tV›wpÜtUpd©eMode
(
QtWidg‘s
.
QG¿phicsV›w
.
Mšim®V›wpÜtUpd©e
)

531 
hÏyout
 = 
QtWidg‘s
.
	$QHBoxLayout
()

532 
vÏyout
 = 
QtWidg‘s
.
	$QVBoxLayout
()

533 
vÏyout
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

534 
hÏyout
.
	`£tCÚ‹ÁsM¬gšs
(1,1,1,1)

535 
hÏyout
.
	$addWidg‘
(
£lf
.
dœ_lbl
)

536 #hÏyout.
	`addWidg‘
(
£lf
.
»äeshBŠ
)

537 
vÏyout
.
	$addLayout
(
hÏyout
)

538 
vÏyout
.
	$addWidg‘
(
£lf
.
v›w
)

539 
£lf
.
	$£tLayout
(
vÏyout
)

540 #£lf.
g¿phics_wdg
 = 
QtWidg‘s
.
	`QG¿phicsWidg‘
()

541 
£lf
.
g¿phics_wdg
 = 
	$MašG¿phicsWidg‘
()

543 
£lf
.
sûÃ
.
	$addI‹m
(
£lf
.
g¿phics_wdg
)

545 
£lf
.
upd©eTim”
 = 
QtCÜe
.
	$QTim”
()

546 
£lf
.
upd©eTim”
.
timeout
.
	$cÚÃù
(
£lf
.
upd©e_fe_li¡
)

547 #£lf.
gridÏyout
 = 
QtWidg‘s
.
	`QG¿phicsGridLayout
()

548 #£lf.
gridÏyout
.
	`£tCÚ‹ÁsM¬gšs
(5, 5, 5, 5)

549 #£lf.
g¿phics_wdg
.
	`£tLayout
(
£lf
.
gridÏyout
)

550 
£lf
.
	$£t_d©a_dœ
(
d©a_dœ
)

551 #£lf.
upd©eTim”
.
	`¡¬t
(1000)

553 
def
 
	$upd©e_fe_li¡
(
£lf
):

554 
ÿÎ_sk_dÚe
 = 
F®£


555 
f_added
 = []

556 
f_»moved
 = []

557 
nÙ
 
£lf
.
f_queue
.
	$em±y
():

558 
»¥
 = 
£lf
.
f_queue
.
	$g‘
()

559 if('added' 
š
 
»¥
.
	$keys
()):

560 
f_added
 = 
»¥
['added']

561 
ÿÎ_sk_dÚe
 = 
True


563 if('»moved' 
š
 
»¥
.
	$keys
()):

564 
f_»moved
 = 
»¥
['removed']

565 
ÿÎ_sk_dÚe
 = 
True


567 if(
ÿÎ_sk_dÚe
):

568 
£lf
.
	`Ú_dœ_chªged
((
f_added
, 
f_»moved
))

569 
£lf
.
f_queue
.
	$sk_dÚe
()

571 
def
 
	$dœLab–CÚ‹xtM’uEv’t
(
£lf
, 
ev’t
):

573 
	$dœLab–CÚ‹xtM’uEv’t
(): 
desütiÚ


575 :
·¿m
 
ev’t
:ƒv’ˆ
desütiÚ


576 :
ty³
 
ev’t
:ƒventype

578 :
»tuºs
: 
NÚe


581 
m’u
 = 
QtWidg‘s
.
	$QM’u
()

582 
chgdœAùiÚ
 = 
QtWidg‘s
.
	`QAùiÚ
("ChªgDœeùÜy", 
£lf
)

583 
chgdœAùiÚ
.
Œigg”ed
.
	$cÚÃù
(
£lf
.
chªge_dœ
)

585 
m’u
.
	$addAùiÚ
(
chgdœAùiÚ
)

586 
m’u
.
	`exec_
(
ev’t
.
	$glob®Pos
())

588 
def
 
	$is_¡ack_dœ
(
£lf
, 
d©a_dœ
):

590 
	$is_¡ack_dœ
(): 
desütiÚ


592 :
·¿m
 
d©a_dœ
: d©a_dœ 
desütiÚ


593 :
ty³
 
d©a_dœ
: data_dirype

595 :
»tuºs
: 
NÚe


597 if(
	`Ën
(
d©a_dœ
) > 0):

598 
d_l¡
 = 
£lf
.
	$¥l™_d©a_dœ
(
d©a_dœ
)

599 
dÇme
 = 
d_l¡
[-1]

600 if(
os
.
·th
.
	`exi¡s
(
d©a_dœ
 + '/' + 
dÇme
 + '.hdf5')):

601 (
True
)

603 (
F®£
)

605 
_logg”
.
	`”rÜ
('Invalid data directory')

606 (
F®£
)

608 
def
 
	$g‘_¡ack_fe_Çme
(
£lf
, 
d©a_dœ
):

610 
	$g‘_¡ack_fe_Çme
(): 
desütiÚ


612 :
·¿m
 
d©a_dœ
: d©a_dœ 
desütiÚ


613 :
ty³
 
d©a_dœ
: data_dirype

615 :
»tuºs
: 
NÚe


617 
d_l¡
 = 
£lf
.
	$¥l™_d©a_dœ
(
d©a_dœ
)

618 
dÇme
 = 
d_l¡
[-1]

619 (
dÇme
 + '.hdf5')

621 
def
 
	$g‘_¡ack_d©a
(
£lf
, 
âame
):

623 
	$g‘_¡ack_d©a
(): 
desütiÚ


625 :
·¿m
 
âame
: fÇm
desütiÚ


626 :
ty³
 
âame
: fnameype

628 :
»tuºs
: 
NÚe


630 
âame
 = 
	$¡r
(
âame
)

631 
d©a_dœ
, 
å»fix
, 
fsuffix
 = 
	$g‘_fe_·th_as_·¹s
(
âame
)

632 if(
d©a_dœ
 
is
 
NÚe
):

633 #_logg”.
	`šfo
('ProbËm w™h f[%s]' % 
âame
)

634 (
NÚe
, None)

636 #ado_obj = 
£lf
.
	`g‘_’Œ›s
(
d©a_dœ
, 
å»fix
, 
fsuffix
)

637 #if(
ado_obj
 
is
 
NÚe
):

638 ##
_logg”
.
	`šfo
('ProbËm w™h f[%s]' % 
âame
)

640 
’Œy_dù
 = 
£lf
.
	$g‘_’Œ›s
(
d©a_dœ
, 
å»fix
, 
fsuffix
)

641 if(
’Œy_dù
 
is
 
NÚe
):

642 
_logg”
.
	`šfo
('ProbËm w™h f[%s]' % 
âame
)

643 (
NÚe
, None)

645 #wdg_com = 
	`dù_g‘
(
ado_obj
, 
ADO_CFG_WDG_COM
)

646 
ekey
 = 
’Œy_dù
.
	`keys
()[0]

647 
wdg_com
 = 
£lf
.
d©a_io
.
	$g‘_wdg_com_äom_’Œy
(
’Œy_dù
, 
ekey
)

648 
¥_db
 = 
	$g‘_fœ¡_¥_db_äom_wdg_com
(
wdg_com
)

649 #d©¨ğ
ado_obj
['DATA']

650 
d©a
 = 
£lf
.
	$g‘_d©a_äom_’Œy
(
’Œy_dù
, 
¡ack_dœ
=
True
)

652 (
¥_db
, 
d©a
 )

654 
def
 
	$g‘_¥_db_ªd_d©a
(
£lf
, 
âame
, 
¡ack_dœ
=
F®£
):

656 
	$g‘_¥_db_ªd_d©a
(): 
desütiÚ


658 :
·¿m
 
âame
: fÇm
desütiÚ


659 :
ty³
 
âame
: fnameype

661 :
»tuºs
: 
NÚe


663 
äom
 
şs
.
uts
.
roi_uts
 
impÜt
 
g‘_ado_obj_äom_wdg_com


665 
âame
 = 
	$¡r
(
âame
)

666 
d©a_dœ
, 
å»fix
, 
fsuffix
 = 
	$g‘_fe_·th_as_·¹s
(
âame
)

667 if(
d©a_dœ
 
is
 
NÚe
):

668 
_logg”
.
	`šfo
('ProbËm w™h f[%s]' % 
âame
)

669 (
NÚe
, None)

671 
’Œy_dù
 = 
£lf
.
	$g‘_’Œ›s
(
d©a_dœ
, 
å»fix
, 
fsuffix
)

672 if(
’Œy_dù
 
is
 
NÚe
):

673 
_logg”
.
	`šfo
('ProbËm w™h f[%s]' % 
âame
)

674 (
NÚe
, None)

675 
d©a
 = 
£lf
.
	$g‘_d©a_äom_’Œy
(
’Œy_dù
, 
¡ack_dœ
=stack_dir)

676 #dù_put(
£lf
.
d©a_dù
, 
ADO_CFG_DATA_STATUS
, 
DATA_STATUS_FINISHED
)

677 
ekey
 = 
’Œy_dù
.
	`keys
()[0]

678 
wdg_com
 = 
£lf
.
d©a_io
.
	$g‘_wdg_com_äom_’Œy
(
’Œy_dù
, 
ekey
)

679 #d©a_¡©u ğ
	`g‘_d©a_¡©us_äom_wdg_com
(
wdg_com
)

680 #wdg_com = 
	`dù_g‘
(
ado_obj
, 
ADO_CFG_WDG_COM
)

681 #adØğ
	`g‘_ado_obj_äom_wdg_com
(
wdg_com
)

682 #if(
’Œy_dù
[
ekey
]['DATA_STATUS'] =ğ
DATA_STATUS_FINISHED
):

683 
¥_db
 = 
	$g‘_fœ¡_¥_db_äom_wdg_com
(
wdg_com
)

684 #»tuºĞ
£lf
.
	`»pÜt_image_·¿ms
(
å»fix
, 
¥_db
, s–f.
d©a
))

685 (
¥_db
, 
d©a
)

687 #»tuº(
NÚe
, None)

689 
def
 
	$g‘_’Œ›s
(
£lf
, 
d©a_dœ
, 
å»fix
, 
fsuffix
):

691 
	$g‘_’Œ›s
(): 
desütiÚ


693 :
·¿m
 
d©a_dœ
: d©a_dœ 
desütiÚ


694 :
ty³
 
d©a_dœ
: data_dirype

696 :
·¿m
 
å»fix
: f´efix 
desütiÚ


697 :
ty³
 
å»fix
: fprefixype

699 :
·¿m
 
fsuffix
: fsuffix 
desütiÚ


700 :
ty³
 
fsuffix
: fsuffixype

702 :
»tuºs
: 
NÚe


704 
£lf
.
d©a_io
 = 
	$STXMD©aIo
(
d©a_dœ
, 
å»fix
)

705 #ado_obj = 
NÚe


706 #wh
ado_obj
 
is
 
NÚe
:

707 
’Œy_dù
 = 
£lf
.
d©a_io
.
	$lßd
()

708 (
’Œy_dù
)

710 
def
 
	`g‘_d©a_äom_’Œy
(
£lf
, 
’Œy_dù
, 
¥id_idx
=0, 
¡ack_dœ
=
F®£
):

712 
	$g‘_d©a_äom_’Œy
(): 
desütiÚ


714 :
·¿m
 
ado_obj
:‡do_obj 
desütiÚ


715 :
ty³
 
ado_obj
:‡do_objype

717 :
·¿m
 
¥id_idx
: spid_idx 
šdex
 
što
 
li¡
 
of
 
¥_ids


718 :
ty³
 
¥id_idx
: 
š‹g”


721 :
»tuºs
: 
NÚe


723 if(
’Œy_dù
 
is
 
NÚe
):

724 
´št


725 
ekey
 = 
’Œy_dù
.
	`keys
()[0]

727 #¡©u ğ
	`dù_g‘
(
’Œy_dù
[
ekey
], 
ADO_CFG_SCAN_STATUS
)

728 #if(
¡©us
 
is
 
nÙ
 
SCAN_STATUS_FINISHED
):

729 ##
_logg”
.
	`šfo
('skipping‡s scan was‚ot completed')

730 #»tuº(
NÚe
)

732 
nx_d©as
 = 
£lf
.
d©a_io
.
	$g‘_NXd©as_äom_’Œy
(
’Œy_dù
, 
ekey
)

733 #cu¼’y 
Úly
 
suµÜt
 1 
couÁ”


734 
couÁ”_Çme
 = 
nx_d©as
.
	`keys
()[0]

735 
d©a
 = 
£lf
.
d©a_io
.
	$g‘_sigÇl_d©a_äom_NXd©a
(
nx_d©as
, 
couÁ”_Çme
)

737 if((
d©a
.
ndim
 
is
 3)):

738 if(
¡ack_dœ
):

739 (
d©a
)

741 if(
	`Ën
(
d©a
) > 0):

742 
d©a
 = data[0]

744 (
NÚe
)

746 if((
d©a
.
ndim
 
is
 
nÙ
 2)):

747 #_logg”.
	`”rÜ
('D©¨ i oàwrÚg dim’siÚ, i [%d] should b[2]' % (
d©a
.
ndim
))

748 #´šˆ'D©¨i oàwrÚg dim’siÚ, i [%d] should b[2]' % (
d©a
.
ndim
)

749 (
NÚe
)

750 #wdg_com = 
£lf
.
d©a_io
.
	`g‘_wdg_com_äom_’Œy
(
’Œy_dù
, 
ekey
)

753 #wdg_com = 
	`dù_g‘
(
ado_obj
, 
ADO_CFG_WDG_COM
)

754 #if(
¥id_idx
 == 0):

755 #¥_db = 
	`g‘_fœ¡_¥_db_äom_wdg_com
(
wdg_com
)

757 #d©¨ğ
ado_obj
['DATA']

760 (
d©a
)

762 
def
 
	$£t_image_»pÜt
(
£lf
, 
šfo_¡r
, 
šfo_j¡r
):

764 
	$£t_image_»pÜt
(): 
desütiÚ


766 :
·¿m
 
šfo_¡r
: info_¡¸
desütiÚ


767 :
ty³
 
šfo_¡r
: info_strype

769 :
·¿m
 
šfo_j¡r
: info_j¡¸
desütiÚ


770 :
ty³
 
šfo_j¡r
: info_jstrype

772 :
»tuºs
: 
NÚe


774 
£lf
.
image_šfo_¡r
 = 
šfo_¡r


775 
£lf
.
image_šfo_j¡r
 = 
šfo_j¡r


778 
def
 
	$cÚv”t_gÚi_th‘a_ªgË
(
£lf
, 
ªgË
):

780 
cÚv”t
 
äom
 
hund»ths
 
of
 
a
 
deg
 
to
 
deg»e
 
as
 
the


781 :
·¿m
 
ªgË
: 
the
‡ngË 
as
 
»tuºed
 
by
h
GÚiom‘”
 
Th‘a
 
mÙÜ
 
ãedback
 
š
 
hund»ths
 
of
 
a
 
deg»e


782 :
ty³
 
ªgË
: 

784 :
»tuºs
: 
The
 
v®ue
 
·s£d
 
š
 
muÉl›d
 
by
 0.01

786 (
ªgË
 * 0.01)

788 
def
 
	`bud_image_·¿ms
(
£lf
, 
å©h
, 
¥_db
, 
d©a
, 
ev_idx
=0, 
ev_²t
=0, 
pŞ_idx
=0, 
pŞ_²t
=0):

790 
	$bud_image_·¿ms
(): 
ü—‹
 
a
 
¡ršg
 
ªd
 
jsÚ
 sŒšg 
th©
 
»´e£Ás
 
the
 
key
 
b™s
 
of
 
šfÜm©iÚ


791 
Ú
 
this
 
image
. 
The
 
jsÚ
 
¡ršg
 
is
 
u£d
 
d¿g
 
ªd
 
drİ
 
ev’ts
 
so
 
th©
 
the
 
widg‘
h© 
»ûives
h'drİ' 
has


792 
’ough
 
šfo
 
to
 
lßd
 
the
 
image
, 
sÿn
 
Ü
 
di¥Ïy
h
»Ëvªt
 
šfÜm©iÚ
.

794 :
·¿m
 
å©h
: 
the
 
f’ame


795 :
ty³
 
å©h
: 
¡ršg


797 :
·¿m
 
¥_db
: 
This
 
is
 
the
 
¡ªd¬d
 
¥©Ÿl
 
d©aba£
 
diù
 
th©
 i 
u£d
 
throughout
h
­¶iÿtiÚ
, 
»ãr
 
to


798 
	$make_¥©Ÿl_db_diù
(è
š
 
¡xm_cÚŒŞ
/
¡xm_uts
/
roi_uts
.
py
 
a
 
d‘aed
 
look
 
©
 
the
 
¡ruùu»


799 
of
 
ª
 
¥_db


800 :
ty³
 
¥_db
: sp_dbype

802 :
·¿m
 
d©a
: 
A
 
numpy
 
¬¿y
 
th©
 
cÚšs
 
the
 
image
 data

803 :
ty³
 
d©a
: dataype

805 :
·¿m
 
ev_idx
: 
the
 
šdex
 
što
h
cÜ»ù
 
ev_roi
 
this
 
image


806 :
ty³
 
ev_idx
: 
š‹g”


808 :
·¿m
 
ev_²t
: 
the
 
šdex
 
što
h
cÜ»ù
 
’”gy
 
pošt
 
š
h
ev_roi
 
this
 
image


809 :
ty³
 
ev_²t
: 
š‹g”


811 :
·¿m
 
pŞ_idx
: 
the
 
šdex
 
što
h
cÜ»ù
 
pŞ¬™y_roi
 
this
 
image


812 :
ty³
 
pŞ_idx
: 
š‹g”


814 :
·¿m
 
pŞ_²t
: 
the
 
šdex
 
što
h
cÜ»ù
 
pŞ¬™y
 
pošt
 
š
h
pŞ_roi
 
this
 
image


815 :
ty³
 
pŞ_²t
: 
š‹g”


817 :
»tuºs
: 
a
 
tu¶e
 
cÚsi¡šg
 
of
‡ 
¡ršg
 
u£d
 
the
 
toŞt
 
d©a
 
ªd
‡ 
jsÚ
 sŒšg u£d 
d¿g
‡nd 
drİ
 
İ”©iÚs


819 if(
d©a
.
size
 == 0):

820 (
NÚe
, None)

822 if(
d©a
.
ndim
 == 3):

823 
d©a
 = data[0]

825 if(
d©a
.
ndim
 == 2):

827 
height
, 
width
 = 
d©a
.
sh­e


828 # ğ'Fe: %  \n' % (
å»fix
 + '.hdf5')

829 
dù
 = {
	}
}

830 
dù
['fe'] = 
å©h


831 
dù
['sÿn_ty³'] = 
sÿn_ty³s
[
dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
)] + ' ' + 
	gsÿn_sub_ty³s
[dù_g‘(¥_db, 
SPDB_SCAN_PLUGIN_SUBTYPE
)]

832 
	gdù
['sÿn_·Ãl_idx'] = 
	$dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_PANEL_IDX
)

833 
dù
['’”gy'] = 
¥_db
['EV_ROIS'][
ev_idx
]['SETPOINTS'][
ev_²t
]

834 
dù
['pŞ¬™y'] = 
	`cÚv”t_w¿µ”_•u_to_¡r
(
¥_db
['EV_ROIS'][
ev_idx
]['POL_ROIS'][
pŞ_idx
]['POL'])

835 
dù
['off£t'] = 
¥_db
['EV_ROIS'][
ev_idx
]['POL_ROIS'][
pŞ_idx
]['OFF']

836 
dù
['ªgË'] = 
¥_db
['EV_ROIS'][
ev_idx
]['POL_ROIS'][
pŞ_idx
]['ANGLE']

837 
dù
['dw–l'] = 
¥_db
['EV_ROIS'][
ev_idx
]['DWELL']

838 
dù
['Åošts'] = (
width
, 
height
)

839 
dù
['ûÁ”'] = (
	`dù_g‘
(
¥_db
, 
SPDB_XCENTER
), 
	$dù_g‘
(
¥_db
, 
SPDB_YCENTER
))

840 
dù
['¿nge'] = (
	`dù_g‘
(
¥_db
, 
SPDB_XRANGE
), 
	$dù_g‘
(
¥_db
, 
SPDB_YRANGE
))

842 if('GONI' 
š
 
¥_db
.
	$keys
()):

843 if(
¥_db
['GONI']['T'] 
is
 
NÚe
):

844 
·ss


845 
	`–if
(
¥_db
['GONI']['Z'] 
is
 
NÚe
):

846 
·ss


847 
	`–if
(
¥_db
['GONI']['T']['CENTER'] 
is
 
nÙ
 
NÚe
):

848 
dù
['gÚi_th‘a_úŒ'] = 
£lf
.
	`cÚv”t_gÚi_th‘a_ªgË
(
¥_db
['GONI']['T']['CENTER'])

851 
j¡r
 = 
jsÚ
.
	$dumps
(
dù
)

852 
s
 = 'Fe: %  \n' % 
dù
['file']

853 
s
 +ğ'SÿÀTy³: \t%s\n' % 
dù
['scan_type']

854 
s
 +ğ'EÃrgy: \t%.2àeV\n' % 
¥_db
['EV_ROIS'][
ev_idx
]['SETPOINTS'][
ev_²t
]

855 
s
 +ğ'PŞ¬™y: \t%  Off£t: %.2àmm AngË: %.2àdeg\n' % (
	`cÚv”t_w¿µ”_•u_to_¡r
(
¥_db
['EV_ROIS'][
ev_idx
]['EPU_POL_PNTS'][
pŞ_idx
]), sp_db['EV_ROIS'][ev_idx]['EPU_OFF_PNTS'][pol_idx], sp_db['EV_ROIS'][ev_idx]['EPU_ANG_PNTS'][pol_idx])

856 
s
 +ğ'Dw–l: \t%.2àms\n' % 
¥_db
['EV_ROIS'][
ev_idx
]['DWELL']

857 
s
 +ğ'# Pošts: \t%d x %d \n' % (
width
, 
height
)

858 
s
 +ğ'C’‹r: \t(%.2f, %.2fèum\n' % 
dù
['center']

859 
s
 +ğ'Rªge: \t(%.2f, %.2fèum' % 
dù
['range']

860 if('gÚi_th‘a_úŒ' 
š
 
dù
.
	$keys
()):

861 
s
 +ğ'\nGÚ˜Th‘a: \t%.2àdeg' % 
dù
['goni_theta_cntr']

862 (
s
, 
j¡r
)

864 #´šˆ'bud_image_·¿ms: UnsuµÜ‹d dim’siÚ oàd©¨->[%d]'% 
d©a
.
ndim


865 (
NÚe
, None)

867 
def
 
	$chªge_dœ
(
£lf
):

869 
	$chªge_dœ
(): 
desütiÚ


871 :
»tuºs
: 
NÚe


873 
dœ
 = 
	`£tExi¡šgDœeùÜy
("Pick DœeùÜy", 
š™_dœ
=
£lf
.
d©a_dœ
)

874 
´ev_cursÜ
 = 
£lf
.
	$cursÜ
()

875 #QtWidg‘s.
QAµliÿtiÚ
.
	`£tOv”rideCursÜ
(
QtWidg‘s
.
	`QCursÜ
(
QtCÜe
.
Qt
.
Wa™CursÜ
))

877 
£lf
.
	$£tCursÜ
(
QtCÜe
.
Qt
.
Wa™CursÜ
)

878 
QtWidg‘s
.
QAµliÿtiÚ
.
	$´oûssEv’ts
()

879 #check 
dœeùÜy
 
cÚšs
 
a
 
¡ack


880 if(
£lf
.
	$is_¡ack_dœ
(
dœ
)):

881 
£lf
.
	$£t_d©a_dœ
(
dœ
, 
is_¡ack_dœ
=
True
)

882 
d©a_âames
 = 
	$dœli¡
(
dœ
, 
£lf
.
d©a_fe_ex‹nsiÚ
, 
»move_suffix
=
F®£
)

883 
âame
 = 
dœ
 + '/' + 
d©a_âames
[0]

884 
¥_db
, 
d©a
 = 
£lf
.
	$g‘_¡ack_d©a
(
âame
)

885 
£lf
.
	`lßd_¡ack_što_v›w
(
d©a_âames
[0])

887 
£lf
.
fsys_mÚ
.
	$£t_d©a_dœ
Ğ
£lf
.
d©a_dœ
)

888 #QtWidg‘s.
QAµliÿtiÚ
.
	`£tOv”rideCursÜ
(
QtWidg‘s
.
	`QCursÜ
(
´ev_cursÜ
))

889 
£lf
.
	$un£tCursÜ
()

890 
QtWidg‘s
.
QAµliÿtiÚ
.
	$´oûssEv’ts
()

893 if(
	`Ën
(
dœ
) > 0):

894 
£lf
.
	$£t_d©a_dœ
(
dœ
, 
is_¡ack_dœ
=
F®£
)

895 
£lf
.
fsys_mÚ
.
	$£t_d©a_dœ
Ğ
£lf
.
d©a_dœ
)

897 
£lf
.
	$un£tCursÜ
()

898 #QtWidg‘s.
QAµliÿtiÚ
.
	`£tOv”rideCursÜ
(
QtWidg‘s
.
	`QCursÜ
(
´ev_cursÜ
))

899 
QtWidg‘s
.
QAµliÿtiÚ
.
	$´oûssEv’ts
()

902 
def
 
	`Ú_dœ_chªged
(
£lf
, (
f_added
, 
f_»moved
)):

904 
	$Ú_dœ_chªged
(): 
this
 
hªdËr
 
Ãeds
 
to
 
disûº
 
b‘w“n
 
fes
 
th©
 
¬e
 
nÙ
 
fšished
 
wr™šg
 
ªd
 
tho£
h©‡» 
»ady
Ø
be
 
»ad


906 :
	`·¿m
 (
f_added
: (f_added 
desütiÚ


907 :
	`ty³
 (
f_added
: (f_added 
ty³


909 :
·¿m
 
f_»moved
): f_»movedè
desütiÚ


910 :
ty³
 
f_»moved
): f_removed)ype

912 :
»tuºs
: 
NÚe


914 #´šˆ'Ú_dœ_chªged:‡dded: ' , 
f_added


915 #´šˆ'Ú_dœ_chªged:„emoved: ' , 
f_»moved


916 
´ev_cursÜ
 = 
£lf
.
	$cursÜ
()

917 #QtWidg‘s.
QAµliÿtiÚ
.
	`£tOv”rideCursÜ
(
QtWidg‘s
.
	`QCursÜ
(
QtCÜe
.
Qt
.
Wa™CursÜ
))

918 
£lf
.
	$£tCursÜ
(
QtCÜe
.
Qt
.
Wa™CursÜ
)

919 
QtWidg‘s
.
QAµliÿtiÚ
.
	$´oûssEv’ts
()

921 if(
	`Ën
(
f_added
) > 0):

922 #£lf.
	`add_to_v›w
(
f_added
)

923 
ROWS
 = (
	`Ën
(
£lf
.
thumbs
è+†’(
f_added
)è/ 
MAX_THUMB_COLUMNS


924 
âame
 
š
 
f_added
:

925 if(
£lf
.
cur_thumb_cŞumn
 >ğ
MAX_THUMB_COLUMNS
):

926 
£lf
.
	$šü_cur_row
()

927 
£lf
.
	$»£t_cur_cŞumn
()

929 
¥_db
, 
d©a
 = 
£lf
.
	`g‘_¥_db_ªd_d©a
(£lf.
d©a_dœ
 + '/' + 
âame
)

930 #¡©u ğ
£lf
.
	`add_to_v›w
(
âame
, 
¥_db
, 
d©a
, 
ev_idx
=0, 
ev_²t
=0, 
pŞ_idx
=0, 
pŞ_²t
=0, 
row
=£lf.
cur_thumb_row
, 
cŞ
=£lf.
cur_thumb_cŞumn
, 
upd©e_sûÃ
=
F®£
)

931 
¡©us
 = 
£lf
.
	`add_to_v›w
(
âame
, 
¥_db
, 
d©a
, 
ev_idx
=0, 
ev_²t
=0, 
pŞ_idx
=0, 
pŞ_²t
=0, 
row
=
NÚe
, 
cŞ
=NÚe, 
upd©e_sûÃ
=
F®£
)

932 if(
¡©us
 
is
 
nÙ
 
NÚe
):

933 
£lf
.
	$šü_cur_cŞumn
()

935 
£lf
.
	$upd©e_sûÃ
()

936 #QtWidg‘s.
QAµliÿtiÚ
.
	`£tOv”rideCursÜ
(
QtWidg‘s
.
	`QCursÜ
(
´ev_cursÜ
))

937 
£lf
.
	$un£tCursÜ
()

938 
QtWidg‘s
.
QAµliÿtiÚ
.
	$´oûssEv’ts
()

941 
def
 
	$£t_cur_row
(
£lf
, 
v®
):

942 
£lf
.
cur_thumb_row
 = 
v®


944 
def
 
	$£t_cur_cŞumn
(
£lf
, 
v®
):

945 
£lf
.
cur_thumb_cŞumn
 = 
v®


947 
def
 
	$»£t_cur_row
(
£lf
):

948 
£lf
.
cur_thumb_row
 = 0

950 
def
 
	$»£t_cur_cŞumn
(
£lf
):

951 
£lf
.
cur_thumb_cŞumn
 = 0

953 
def
 
	$šü_cur_row
(
£lf
):

954 
£lf
.
cur_thumb_row
 += 1

956 
def
 
	$šü_cur_cŞumn
(
£lf
):

957 
£lf
.
cur_thumb_cŞumn
 += 1

960 
def
 
	$g‘_Ãxt_row_ªd_cŞ
(
£lf
):

961 
ROWS
 = (
	`Ën
(
£lf
.
thumbs
è+ 1è/ 
MAX_THUMB_COLUMNS


962 if(
£lf
.
cur_thumb_cŞumn
 >ğ
MAX_THUMB_COLUMNS
):

963 
£lf
.
	$šü_cur_row
()

964 
rows
 = 
£lf
.
cur_thumb_row


965 
£lf
.
	`£t_cur_cŞumn
(0)

967 (
£lf
.
cur_thumb_row
, s–f.
cur_thumb_cŞumn
)

971 
def
 
	$Ú_d¿g
(
£lf
, 
obj
, 
ev’t
):

973 
	$Ú_d¿g
(): 
desütiÚ


975 :
·¿m
 
obj
: obj 
desütiÚ


976 :
ty³
 
obj
: objype

978 :
·¿m
 
ev’t
:ƒv’ˆ
desütiÚ


979 :
ty³
 
ev’t
:ƒventype

981 :
»tuºs
: 
NÚe


983 
ev’t
.
	$acû±
()

985 
™emD©a
 = 
QtCÜe
.
	$QBy‹A¼ay
()

986 
d©aSŒ—m
 = 
QtCÜe
.
	$QD©aSŒ—m
(
™emD©a
, 
QtCÜe
.
QIODeviû
.
Wr™eOÆy
)

987 
d©aSŒ—m
 << 
QtCÜe
.
	`QBy‹A¼ay
(
obj
.
šfo_j¡r
è<< (
ev’t
.
	`pos
(è- obj.
	`»ù
().
	$tİLeá
())

988 #d©aSŒ—m << 
QtCÜe
.
	`QBy‹A¼ay
(
obj
.
d©a
.
	`toby‹s
()è<< QtCÜe.QBy‹A¼ay(obj.
šfo_¡r
è<< (
ev’t
.
	`pos
(è- obj.
	`»ù
().
	`tİLeá
())

990 
mimeD©a
 = 
QtCÜe
.
	$QMimeD©a
()

991 
mimeD©a
.
	`£tD©a
('­¶iÿtiÚ/x-¡xmsÿn', 
™emD©a
)

992 
mimeD©a
.
	$£tText
(
obj
.
šfo_j¡r
)

994 
d¿g
 = 
QtGui
.
	$QD¿g
(
£lf
)

995 
d¿g
.
	$£tMimeD©a
(
mimeD©a
)

996 
pos
 = 
ev’t
.
	`pos
(è- 
obj
.
	`»ù
().
	$tİLeá
()

997 
d¿g
.
	`£tHÙSpÙ
(
QtCÜe
.
	`QPošt
(
pos
.
	`x
(),…os.
	$y
()))

998 
d¿g
.
	$£tPixm­
(
obj
.
pic
)

1000 
d¿g
.
	`exec_
(
QtCÜe
.
Qt
.
MoveAùiÚ
 | QtCÜe.Qt.
CİyAùiÚ
, QtCore.Qt.CopyAction) == QtCore.Qt.MoveAction:

1001 
·ss


1003 
·ss


1006 
def
 
	$make_thumbWidg‘
(
£lf
, 
d©a_dœ
, 
âame
, 
šfo_dù
, 
t™Ë
=
NÚe
, 
¥_db
=NÚe, 
d©a
=None):

1008 
	$make_thumbWidg‘
(): 
desütiÚ


1010 :
·¿m
 
d©a_dœ
: d©a_dœ 
desütiÚ


1011 :
ty³
 
d©a_dœ
: data_dirype

1013 :
·¿m
 
âame
: fÇm
desütiÚ


1014 :
ty³
 
âame
: fnameype

1016 :
·¿m
 
šfo_dù
: info_dù 
desütiÚ


1017 :
ty³
 
šfo_dù
: info_dctype

1019 :
·¿m
 
t™Ë
=
NÚe
:™Ë=NÚ
desütiÚ


1020 :
ty³
 
t™Ë
=
NÚe
:itle=Noneype

1022 :
·¿m
 
¥_db
=
NÚe
: sp_db=NÚ
desütiÚ


1023 :
ty³
 
¥_db
=
NÚe
: sp_db=Noneype

1025 :
·¿m
 
d©a
=
NÚe
: d©a=NÚ
desütiÚ


1026 :
ty³
 
d©a
=
NÚe
: data=Noneype

1028 :
»tuºs
: 
NÚe


1030 
thumb_widg‘
 = 
	`ThumbÇWidg‘
(
d©a_dœ
 + '/' + 
âame
, 
¥_db
, 
d©a
, 
t™Ë
, 
šfo_dù
, 
·»Á
 = 
NÚe
)

1031 if(
thumb_widg‘
.
is_v®id
):

1032 #thumb_widg‘.
upd©e_v›w
.
	`cÚÃù
(
£lf
.update_view)

1033 
thumb_widg‘
.
£Ëù
.
	$cÚÃù
(
£lf
.
do_£Ëù
)

1034 
thumb_widg‘
.
Ïunch_v›w”
.
	$cÚÃù
(
£lf
.
Ïunch_v›w”
)

1035 
thumb_widg‘
.
d¿g
.
	$cÚÃù
(
£lf
.
Ú_d¿g
)

1036 (
thumb_widg‘
)

1038 (
NÚe
)

1040 
def
 
	$add_thumb_widg‘
(
£lf
, 
d©a_dœ
, 
âame
, 
šfo_dù
, 
row
, 
cŞumn
, 
t™Ë
=
NÚe
, 
¥_db
=NÚe, 
d©a
=None):

1042 
	$add_thumb_widg‘
(): 
desütiÚ


1044 :
·¿m
 
d©a_dœ
: d©a_dœ 
desütiÚ


1045 :
ty³
 
d©a_dœ
: data_dirype

1047 :
·¿m
 
âame
: fÇm
desütiÚ


1048 :
ty³
 
âame
: fnameype

1050 :
·¿m
 
šfo_dù
: info_dù 
desütiÚ


1051 :
ty³
 
šfo_dù
: info_dctype

1053 :
·¿m
 
row
:„ow 
desütiÚ


1054 :
ty³
 
row
:„owype

1056 :
·¿m
 
cŞumn
: cŞumÀ
desütiÚ


1057 :
ty³
 
cŞumn
: columnype

1059 :
·¿m
 
t™Ë
=
NÚe
:™Ë=NÚ
desütiÚ


1060 :
ty³
 
t™Ë
=
NÚe
:itle=Noneype

1062 :
·¿m
 
¥_db
=
NÚe
: sp_db=NÚ
desütiÚ


1063 :
ty³
 
¥_db
=
NÚe
: sp_db=Noneype

1065 :
·¿m
 
d©a
=
NÚe
: d©a=NÚ
desütiÚ


1066 :
ty³
 
d©a
=
NÚe
: data=Noneype

1068 :
»tuºs
: 
NÚe


1070 
thumb_widg‘
 = 
£lf
.
	$make_thumbWidg‘
(
d©a_dœ
, 
âame
, 
šfo_dù
, 
t™Ë
ñ™Ë, 
¥_db
=¥_db, 
d©a
=data)

1071 if(
thumb_widg‘
):

1072 
£lf
.
g¿phics_wdg
.
gridÏyout
.
	`addI‹m
(
thumb_widg‘
, 
row
, 
cŞumn
, 1, 1)

1073 
£lf
.
g¿phics_wdg
.
gridÏyout
.
	`£tCŞumnS·cšg
(
cŞumn
, 20)

1074 
£lf
.
g¿phics_wdg
.
gridÏyout
.
	`£tRowS·cšg
(
row
, 15)

1076 
£lf
.
thumbs
.
	$­³nd
(
thumb_widg‘
)

1077 (
True
)

1079 (
F®£
)

1082 
def
 
	$ş—r_grid_Ïyout
(
£lf
):

1084 
	$ş—r_grid_Ïyout
(): 
desütiÚ


1086 :
»tuºs
: 
NÚe


1088 if((
£lf
.
g¿phics_wdg
.
gridÏyout
.
	`rowCouÁ
(è=ğ0è
	`ªd
 (£lf.g¿phics_wdg.gridÏyout.
	`cŞumnCouÁ
() == 0)):

1090 
i
 = 0

1091 
£lf
.
g¿phics_wdg
.
	$ş—r_Ïyout
()

1092 
œ
 = 
£lf
.
sûÃ
.
	$™emsBoundšgReù
()

1093 
qr
 = 
QtCÜe
.
	`QReùF
(
œ
.
	`x
(), ir.
	`y
(), ir.
	`width
(), 
THUMB_HEIGHT
)

1094 
£lf
.
sûÃ
.
	$£tSûÃReù
(
qr
)

1095 
£lf
.
v›w
.
	$£tSûÃReù
(
qr
)

1096 
£lf
.
g¿phics_wdg
.
	$£t_Ïyout_size
(
qr
)

1097 
d–
 
£lf
.
thumbs


1098 
£lf
.
thumbs
 = []

1099 
£lf
.
	`£t_cur_row
(0)

1100 
£lf
.
	`£t_cur_cŞumn
(0)

1102 
def
 
	`add_to_v›w
(
£lf
, 
âame
, 
¥_db
, 
d©a
, 
image_num
=
NÚe
, 
ev_idx
=0, 
ev_²t
=0, 
pŞ_idx
=0, 
pŞ_²t
=0, 
row
=NÚe, 
cŞ
=NÚe, 
upd©e_sûÃ
=
F®£
):

1104 
	$lßd_¡ack_što_v›w
(): 
desütiÚ


1106 :
·¿m
 
âame
: fÇm
desütiÚ


1107 :
ty³
 
âame
: fnameype

1109 :
»tuºs
: 
NÚe


1112 if(
d©a
 
is
 
NÚe
):

1113 (
F®£
)

1115 if(
d©a
.
ndim
 == 3):

1116 
d©a
 = data[0]

1117 
	`–if
(
d©a
.
ndim
 == 2):

1118 #™ 
a
 
sšgË
 
image


1119 
d©a
 = data

1120 
	`–if
(
d©a
.
ndim
 == 1):

1121 #™ 
a
 
¥eù¿
 
which
 
is
 
nÙ
 
suµÜ‹d
 
so
 
ju¡
  
NÚe


1122 (
NÚe
)

1124 #™ 
unknown


1125 (
NÚe
)

1127 
rows
, 
cŞs
 = 
d©a
.
sh­e


1128 #¥_db, 
d©a
 = 
£lf
.
	`g‘_¥_db_ªd_d©a
(£lf.
d©a_dœ
 + '/' + 
âame
)

1129 if((
¥_db
 
is
 
nÙ
 
NÚe
è
	$ªd
 (
d©a
 
is
 
nÙ
 
NÚe
)):

1130 if(
	$dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
è
nÙ
 
š
 [
sÿn_ty³s
.
GENERIC_SCAN
, sÿn_ty³s.
SAMPLE_POINT_SPECTRUM
]):

1131 
šfo_¡r
, 
šfo_j¡r
 = 
£lf
.
	`bud_image_·¿ms
(£lf.
d©a_dœ
 + '/' + 
âame
, 
¥_db
, 
d©a
, 
ev_idx
óv_idx, 
ev_²t
óv_²t, 
pŞ_idx
õŞ_idx, 
pŞ_²t
=0)

1132 
šfo_dù
 = {'šfo_¡r': 
šfo_¡r
, 'šfo_j¡r': 
šfo_j¡r
}

1133 
lâ
 = 
	$Ën
(
âame
)

1134 
t™Ë
 = 
âame
[0:
lâ
-5]

1136 #™ 
nÙ
 
a
 
suµÜ‹d
 
sÿn
 
ty³


1139 if((
row
 
is
 
NÚe
è
	$ªd
 (
cŞ
 
is
 
NÚe
)):

1140 
row
, 
cŞ
 = 
£lf
.
	$g‘_Ãxt_row_ªd_cŞ
()

1143 
num_rows
 = 
£lf
.
g¿phics_wdg
.
gridÏyout
.
	$rowCouÁ
()

1144 
cŞumn
 = 0

1145 if(
image_num
 
is
 
NÚe
):

1146 
‰l
 = 
t™Ë


1148 
‰l
 = 
t™Ë
 + '_%d'%
image_num


1150 
¡©us
 = 
£lf
.
	$add_thumb_widg‘
Ğ
£lf
.
d©a_dœ
, 
âame
, 
šfo_dù
, 
row
, 
cŞ
, 
t™Ë
=
‰l
, 
¥_db
=¥_db, 
d©a
=data)

1152 if(
upd©e_sûÃ
 
ªd
 
¡©us
):

1153 
£lf
.
	$upd©e_sûÃ
()

1155 (
¡©us
)

1158 
def
 
	$upd©e_sûÃ
(
£lf
):

1159 
num_rows
 = 
£lf
.
g¿phics_wdg
.
gridÏyout
.
	$rowCouÁ
()

1160 #q¸ğ
QtCÜe
.
	`QReùF
(0.0, 0.0, 290.0, 
num_rows
 * 170.0)

1161 
qr
 = 
QtCÜe
.
	`QReùF
(0.0, 0.0, 
SCENE_WIDTH
, 
num_rows
 * 
THUMB_HEIGHT
)

1162 #´šˆ'num_row ğ%d, hˆğ%d' % (
num_rows
,‚um_rows * 170.0)

1163 
£lf
.
g¿phics_wdg
.
	$£t_Ïyout_size
(
qr
)

1164 
£lf
.
sûÃ
.
	$£tSûÃReù
(
qr
)

1165 
£lf
.
v›w
.
	$£tSûÃReù
(
qr
)

1166 
yPos
 = 
£lf
.
v›w
.
	$v”tiÿlSüŞlB¬
()

1167 if(
num_rows
 > 3):

1168 
yPos
.
	`£tV®ue
(yPos.
	$maximum
())

1170 
yPos
.
	`£tV®ue
(yPos.
	$mšimum
())

1173 #deà
	`lßd_¡ack_što_v›w
(
£lf
, 
âame
):

1175 #lßd_¡ack_što_v›w(): 
desütiÚ


1176 #
#:
·¿m
 
âame
: fÇm
desütiÚ


1177 #:
ty³
 
âame
: fnameype

1178 #
#:
»tuºs
: 
NÚe


1180 #¥_db, 
d©a
 = 
£lf
.
	`g‘_¥_db_ªd_d©a
(£lf.
d©a_dœ
 + '/' + 
âame
)

1181 #£lf.
	`ş—r_grid_Ïyout
()

1182 #num_images, 
rows
, 
cŞs
 = 
d©a
.
sh­e


1183 #ROWSğ
num_images
 / 
MAX_THUMB_COLUMNS


1185 #fÜ 
ev_roi
 
š
 
¥_db
['EV_ROIS']:

1186 #’²t ğ(
ev_roi
['NPOINTS'])

1187 #pŞÅÁ ğ
	`Ën
(
ev_roi
['POL_ROIS'])

1188 #ev_pŞ_idx ğ
™”toŞs
.
	`´oduù
(
	`¿nge
(
’²ts
),„ªge(
pŞÅÁs
))

1190 #fÜ 
row
, 
cŞumn
 
š
 
™”toŞs
.
	`´oduù
(
	`¿nge
(
ROWS
),¿nge(
MAX_THUMB_COLUMNS
)):

1191 #ev_²t, 
pŞ_idx
 = 
ev_pŞ_idxs
.
	`Ãxt
()

1192 #¡©u ğ
£lf
.
	`add_to_v›w
(
âame
, 
¥_db
, 
d©a
[
i
], 
image_num
=i, 
ev_idx
óv_idx, 
ev_²t
óv_²t, 
pŞ_idx
õŞ_idx, 
pŞ_²t
=0, 
row
ôow, 
cŞ
=
cŞumn
, 
upd©e_sûÃ
=
F®£
)

1193 #
#if(
nÙ
 
¡©us
):

1196 ##
pŞ_idx
 += 1

1198 #£lf.
	`£t_cur_row
(
row
 + 1)

1199 #£lf.
	`£t_cur_cŞumn
(
cŞumn
 + 1)

1200 #
#£lf.
	`upd©e_sûÃ
()

1201 
def
 
	$lßd_¡ack_što_v›w
(
£lf
, 
âame
):

1203 
	$lßd_¡ack_što_v›w
(): 
desütiÚ


1205 :
·¿m
 
âame
: fÇm
desütiÚ


1206 :
ty³
 
âame
: fnameype

1208 :
»tuºs
: 
NÚe


1210 
¥_db
, 
d©a
 = 
£lf
.
	`g‘_¥_db_ªd_d©a
(£lf.
d©a_dœ
 + '/' + 
âame
, 
¡ack_dœ
=
True
)

1211 
£lf
.
	$ş—r_grid_Ïyout
()

1212 
num_images
, 
rows
, 
cŞs
 = 
d©a
.
sh­e


1213 
ROWS
ğ
num_images
 / 
MAX_THUMB_COLUMNS


1214 #rowcŞ = 
™”toŞs
.
	`´oduù
(
	`¿nge
(
ROWS
),¿nge(
MAX_THUMB_COLUMNS
))

1215 
rowcŞ
 = 
™”toŞs
.
	`´oduù
(
	`¿nge
(
ROWS
+1),
	$¿nge
(
MAX_THUMB_COLUMNS
))

1216 
ev_idx
 = 0

1217 
i
 = 0

1218 
ev_roi
 
š
 
¥_db
['EV_ROIS']:

1220 
’²ts
 = (
ev_roi
['NPOINTS'])

1221 
pŞÅÁs
 = 
	`Ën
(
ev_roi
['POL_ROIS'])

1222 
ev_pŞ_idxs
 = 
™”toŞs
.
	`´oduù
(
	`¿nge
(
’²ts
), 
	$¿nge
(
pŞÅÁs
) )

1224 #fÜ 
ev_pŞ_idxs
 
š
 
™”toŞs
.
	`´oduù
(
	`¿nge
(
’²ts
),„ªge(
pŞÅÁs
) ):

1225 
x
 
š
 
	$¿nge
(
’²ts
):

1226 #fÜ 
row
, 
cŞumn
 
š
 
™”toŞs
.
	`´oduù
(
	`¿nge
(
ROWS
),¿nge(
MAX_THUMB_COLUMNS
)):

1227 #´šˆ'lßd_¡ack_što_v›w: %d oà%d' % (
x
, 
’²ts
)

1228 
row
, 
cŞumn
 = 
rowcŞ
.
	$Ãxt
()

1229 
ev_²t
, 
pŞ_idx
 = 
ev_pŞ_idxs
.
	$Ãxt
()

1230 
¡©us
 = 
£lf
.
	`add_to_v›w
(
âame
, 
¥_db
, 
d©a
[
i
], 
image_num
=i, 
ev_idx
óv_idx, 
ev_²t
óv_²t, 
pŞ_idx
õŞ_idx, 
pŞ_²t
=0, 
row
ôow, 
cŞ
=
cŞumn
, 
upd©e_sûÃ
=
F®£
)

1232 if(
nÙ
 
¡©us
):

1234 
i
 += 1

1236 
ev_idx
 += 1

1237 
£lf
.
	`£t_cur_row
(
row
 + 1)

1238 
£lf
.
	`£t_cur_cŞumn
(
cŞumn
 + 1)

1240 
£lf
.
	$upd©e_sûÃ
()

1243 
def
 
	$»lßd_v›w
(
£lf
, 
is_¡ack_dœ
=
F®£
):

1245 
	$»lßd_v›w
(): 
w®k
 
the
 
£lf
.
d©a_dœ
 
ªd
 
Œy
 
to
 
lßd
 
ev”y
 .
hdf5
 
fe
, 
di¥Ïy
 
Úly
h
Úes
 
th©
 
¬e
 
v®id


1246 
sk
 
the
 
Úes
 
th©
 
¬e
 
nÙ


1248 :
·¿m
 
is_¡ack_dœ
=
F®£
: is_¡ack_dœ=F®£ 
desütiÚ


1249 :
ty³
 
is_¡ack_dœ
=
F®£
: is_stack_dir=Falseype

1251 :
»tuºs
: 
NÚe


1253 
£lf
.
	$ş—r_grid_Ïyout
()

1254 
row
 = 0

1255 
cŞumn
 = 0

1256 if(
£lf
.
d©a_dœ
 
is
 
NÚe
):

1259 if(
nÙ
 
os
.
·th
.
	$exi¡s
(
£lf
.
d©a_dœ
)):

1260 
_logg”
.
	`”rÜ
('D©¨dœeùÜy dÛ nÙƒxi¡: [%s]' % 
£lf
.
d©a_dœ
)

1263 
d©a_âames
 = 
	$dœli¡
(
£lf
.
d©a_dœ
, s–f.
d©a_fe_ex‹nsiÚ
, 
»move_suffix
=
F®£
)

1264 #Úly 
look
 
©
 
fes
 
th©
 
have
 
ª
 
image
 
ªd
 
d©a
 
fe
, 
th’
 
tuº
 
to
 
li¡
,h’ 
sÜt
 
asûndšg


1265 #thumb_âame ğ
	`sÜ‹d
Ğ
	`li¡
(
	`£t
(
image_âames
è& s‘(
d©a_âames
)) )

1266 
thumb_âames
 = 
	$sÜ‹d
Ğ
d©a_âames
 )

1268 if(
	`Ën
(
thumb_âames
) < 1):

1270 
	`–if
(
	`Ën
(
thumb_âames
) == 1):

1271 #th”
is
 
Úly
 
a
 
sšgË
 
fe
 
š
 
dœeùÜy


1272 
¥_db
, 
d©a
 = 
£lf
.
	`g‘_¥_db_ªd_d©a
(£lf.
d©a_dœ
 + '/' + 
thumb_âames
[0])

1273 if((
¥_db
 
is
 
nÙ
 
NÚe
è
	$ªd
 (
d©a
 
is
 
nÙ
 
NÚe
)):

1274 if(
	$dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
è
nÙ
 
š
 [
sÿn_ty³s
.
GENERIC_SCAN
, sÿn_ty³s.
SAMPLE_POINT_SPECTRUM
]):

1275 
šfo_¡r
, 
šfo_j¡r
 = 
£lf
.
	`bud_image_·¿ms
(£lf.
d©a_dœ
 + '/' + 
thumb_âames
[0], 
¥_db
, 
d©a
, 
ev_idx
=0, 
pŞ_idx
=0)

1276 
šfo_dù
 = {'šfo_¡r': 
šfo_¡r
, 'šfo_j¡r': 
šfo_j¡r
}

1277 
¡©us
 = 
£lf
.
add_thumb_widg‘
Ğ£lf.
d©a_dœ
, 
thumb_âames
[0], 
šfo_dù
, 0, 0, 
¥_db
=¥_db, 
d©a
=data)

1278 if(
nÙ
 
¡©us
):

1279 #f
mu¡
 
have
 
had
 
a
 
´obËm
 
w™h
 
™


1280 
yPos
 = 
£lf
.
v›w
.
	$v”tiÿlSüŞlB¬
()

1281 
yPos
.
	`£tV®ue
(yPos.
	$mšimum
())

1284 
£lf
.
	`£t_cur_row
(0)

1285 
£lf
.
	`£t_cur_cŞumn
(1)

1287 #Œy 
to
 
lßd
 
the
 
whŞe
 
dœeùÜy


1288 
ROWS
 = (
	`round
((
	`Ën
(
thumb_âames
è/ (
MAX_THUMB_COLUMNS
)))) + 1

1289 if(
ROWS
 == 0):

1290 
ROWS
 = 1

1291 
i
 = 0

1292 
rowcŞ
 = 
™”toŞs
.
	`´oduù
(
	`¿nge
(
ROWS
),
	$¿nge
(
MAX_THUMB_COLUMNS
))

1293 #fÜ 
row
, 
cŞumn
 
š
 
™”toŞs
.
	`´oduù
(
	`¿nge
(
ROWS
),¿nge(
MAX_THUMB_COLUMNS
)):

1294 
i
 
š
 
	`¿nge
(
	$Ën
(
thumb_âames
)):

1295 if(
i
 >ğ
	$Ën
(
thumb_âames
)):

1296 #ià
™
 
is
 
Ëss
 
thª
 1 
fuÎ
 
row


1298 
¥_db
, 
d©a
 = 
£lf
.
	`g‘_¥_db_ªd_d©a
(£lf.
d©a_dœ
 + '/' + 
thumb_âames
[
i
])

1299 if((
¥_db
 
is
 
nÙ
 
NÚe
è
	$ªd
 (
d©a
 
is
 
nÙ
 
NÚe
)):

1300 if(
	$dù_g‘
(
¥_db
, 
SPDB_SCAN_PLUGIN_TYPE
è
nÙ
 
š
 [
sÿn_ty³s
.
GENERIC_SCAN
, sÿn_ty³s.
SAMPLE_POINT_SPECTRUM
]):

1301 
row
, 
cŞumn
 = 
rowcŞ
.
	$Ãxt
()

1302 
šfo_¡r
, 
šfo_j¡r
 = 
£lf
.
	`bud_image_·¿ms
(£lf.
d©a_dœ
 + '/' + 
thumb_âames
[
i
], 
¥_db
, 
d©a
, 
ev_idx
=0, 
pŞ_idx
=0)

1303 
šfo_dù
 = {'šfo_¡r': 
šfo_¡r
, 'šfo_j¡r': 
šfo_j¡r
}

1304 
¡©us
 = 
£lf
.
	$add_thumb_widg‘
Ğ
£lf
.
d©a_dœ
, 
thumb_âames
[
i
], 
šfo_dù
, 
row
, 
cŞumn
, 
¥_db
=¥_db, 
d©a
=data)

1305 if(
nÙ
 
¡©us
):

1308 
i
 += 1

1309 #£lf.
	`£t_cur_row
(
row
 + 1)

1310 
£lf
.
	$£t_cur_row
(
row
 )

1311 
£lf
.
	`£t_cur_cŞumn
(
cŞumn
 + 1)

1313 
£lf
.
	$upd©e_sûÃ
()

1315 
def
 
	$¥l™_d©a_dœ
(
£lf
, 
d©a_dœ
):

1317 
	$¥l™_d©a_dœ
(): 
desütiÚ


1319 :
·¿m
 
d©a_dœ
: d©a_dœ 
desütiÚ


1320 :
ty³
 
d©a_dœ
: data_dirype

1322 :
»tuºs
: 
NÚe


1324 if(
d©a_dœ
 
is
 
NÚe
):

1327 if(
d©a_dœ
.
	`fšd
('/') > -1):

1328 
£p
 = '/'

1329 
	`–if
(
d©a_dœ
.
	`fšd
('/') > -1):

1330 
£p
 = '/'

1332 
_logg”
.
	`”rÜ
('UnsuµÜ‹d dœeùÜy sŒšg [%s]' % 
d©a_dœ
)

1334 
d_l¡
 = 
d©a_dœ
.
	$¥l™
(
£p
)

1335 (
d_l¡
)

1337 
def
 
	$£t_d©a_dœ
(
£lf
, 
d©a_dœ
, 
is_¡ack_dœ
=
F®£
):

1339 
	$£t_d©a_dœ
(): 
desütiÚ


1341 :
·¿m
 
d©a_dœ
: d©a_dœ 
desütiÚ


1342 :
ty³
 
d©a_dœ
: data_dirype

1344 :
·¿m
 
is_¡ack_dœ
=
F®£
: is_¡ack_dœ=F®£ 
desütiÚ


1345 :
ty³
 
is_¡ack_dœ
=
F®£
: is_stack_dir=Falseype

1347 :
»tuºs
: 
NÚe


1349 if(
	`Ën
(
d©a_dœ
) > 0):

1350 
£lf
.
d©a_dœ
 = data_dir

1351 
d
 = 
£lf
.
	$¥l™_d©a_dœ
(
d©a_dœ
)

1352 
num_dœs
 = 
	`Ën
(
d
)-1

1353 
£lf
.
dœ_lbl
.
	`£tText
(
d
[
num_dœs
-1] + '/' + d[num_dirs])

1354 
£lf
.
fsys_mÚ
.
	$£t_d©a_dœ
(
d©a_dœ
)

1355 if(
nÙ
 
is_¡ack_dœ
):

1356 
£lf
.
	$»lßd_v›w
(
is_¡ack_dœ
)

1358 
def
 
	$do_£Ëù
(
£lf
, 
thumb
):

1360 
	$do_£Ëù
(): 
desütiÚ


1362 :
·¿m
 
thumb
:humb 
desütiÚ


1363 :
ty³
 
thumb
:humbype

1365 :
»tuºs
: 
NÚe


1367 
t
 
š
 
£lf
.
thumbs
:

1368 if(
	`id
(
thumb
è!ğ
	$id
(
t
)):

1369 
t
.
is_£Ëùed
 = 
F®£


1371 
t
.
is_£Ëùed
 = 
True


1372 
£lf
.
	$upd©e_v›w
()

1374 
def
 
	$upd©e_v›w
(
£lf
):

1376 
	$upd©e_v›w
(): 
desütiÚ


1378 :
»tuºs
: 
NÚe


1380 
£lf
.
v›w
.
	$upd©e
()

1381 #£lf.
sûÃ
.
	`upd©e
(
»ù
=
QtCÜe
.
	`QReùF
(0,0,1500,1500))

1382 
»ù
 = 
£lf
.
sûÃ
.
	$sûÃReù
()

1383 
£lf
.
sûÃ
.
	`upd©e
(
»ù
=
QtCÜe
.
	`QReùF
Ôeù.
	`Ëá
(),„eù.
	`tİ
(),»ù.
	`width
(),»ù.
	$height
()))

1385 #deà
	`lßd_sÿn
(
£lf
, 
sÿn
):

1387 #lßd_sÿn(): 
desütiÚ


1388 #
#:
·¿m
 
sÿn
: sÿÀ
desütiÚ


1389 #:
ty³
 
sÿn
: scanype

1390 #
#:
»tuºs
: 
NÚe


1394 
def
 
	$Ïunch_v›w”
(
£lf
, 
dù
):

1396 
	$Ïunch_v›w”
(): 
desütiÚ


1398 :
·¿m
 
dù
: dù 
desütiÚ


1399 :
ty³
 
dù
: dctype

1401 :
»tuºs
: 
NÚe


1403 
impÜt
 
Œaûback


1404 #âame, 
d©a
, 
t™Ë
=
NÚe
):

1405 
Œy
:

1406 
âame
 = 
dù
['path']

1407 
d©a
 = 
dù
['data']

1408 
¥_db
 = 
dù
['sp_db']

1409 
t™Ë
 = 
dù
['title']

1411 
d©a_dœ
, 
å»fix
, 
fsuffix
 = 
	$g‘_fe_·th_as_·¹s
(
âame
)

1412 #£lf.
wš
.
	`İ’fe
(
d©a_dœ
 + '//' + 
å»fix
 + '.hdf5')

1413 if(
£lf
.
wš
 
is
 
NÚe
):

1414 
fg_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_forgrnd'])

1415 
bg_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_bckgrnd'])

1416 
mš_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_gridmaj'])

1417 
maj_şr
 = 
	`rgb_as_hex
(
ma¡”_cŞÜs
['plot_gridmin'])

1419 
£lf
.
wš
 = 
	$make_deçuÉ_¡ªd_®Úe_¡xm_imagewidg‘
()

1420 
qssh“t
 = 
	`g‘_¡yË
('dark')

1421 
£lf
.
wš
.
	$£tStyËSh“t
(
qssh“t
)

1422 #
.wš.£t_grid_·¿m‘”s(bg_şr, mš_şr, maj_şr)

1423 
£lf
.
wš
.
	$£t_cs_grid_·¿m‘”s
(
fg_şr
, 
bg_şr
, 
mš_şr
, 
maj_şr
)

1425 
£lf
.
wš
.
şo£Ev’t
 = s–f.
Ú_v›w”_şo£Ev’t


1426 
numX
 = (
	$dù_g‘
(
¥_db
, 
SPDB_XNPOINTS
))

1427 
numY
 = (
	$dù_g‘
(
¥_db
, 
SPDB_YNPOINTS
))

1428 
»ù
 = 
	$dù_g‘
(
¥_db
, 
SPDB_RECT
)

1429 
£lf
.
wš
.
	`š™D©a
(
image_ty³s
.
IMAGE
, 
numY
 , 
numX
, {
SPDB_RECT
: 
»ù
})

1430 #£lf.
wš
.
İ’fe
(
d©a_dœ
 + '//' + 
å»fix
 + '.hdf5')

1431 
£lf
.
wš
.
	$£t_d©a
(
d©a
)

1432 
£lf
.
wš
.
	$Ú_£t_a¥eù_¿tio
(
True
)

1433 
£lf
.
wš
.
	$upd©e_cÚŒa¡
()

1434 
£lf
.
wš
.
	$show
()

1437 
£lf
.
wš
.
	$£t_d©a
(
d©a
)

1438 
»ù
 = 
	$dù_g‘
(
¥_db
, 
SPDB_RECT
)

1439 (
x1
, 
y1
, 
x2
, 
y2
èğ
»ù


1440 
£lf
.
wš
.
	$£t_image_·¿m‘”s
(
£lf
.
wš
.
™em
, 
x1
, 
y1
, 
x2
, 
y2
)

1441 
£lf
.
wš
.
	$Ú_£t_a¥eù_¿tio
(
True
)

1442 
£lf
.
wš
.
	$upd©e_cÚŒa¡
()

1443 
£lf
.
wš
.
	$¿i£_
()

1446 if(
t™Ë
 
is
 
nÙ
 
NÚe
):

1447 
£lf
.
wš
.
¶Ù
.
	`£t_t™Ë
('%s' % 
t™Ë
)

1449 
£lf
.
wš
.
¶Ù
.
	`£t_t™Ë
('%s%s' % (
å»fix
, 
fsuffix
))

1452 #£lf.
wš
.
	`İ’fe
(
d©a_dœ
 + '//' + 
å»fix
 + '.hdf5')

1453 
exû±
:

1454 
Œaûback
.
	$´št_exc
()

1456 
def
 
	$Ú_v›w”_şo£Ev’t
(
£lf
, 
ev’t
):

1458 
£lf
.
wš
 = 
NÚe


1459 
ev’t
.
	$acû±
(è#Ëˆ
the
 
wšdow
 
şo£


1460 #ev’t.
	`ignÜe
()

1462 
__Çme__
 == "__main__":

1463 
	$log_to_qt
()

1464 
­p
 = 
QtWidg‘s
.
	$QAµliÿtiÚ
(
sys
.
¬gv
)

1465 
­p
.
	`£tAµliÿtiÚName
("Pyqt Image galleryƒxample")

1466 
dœ
 = 
r
'S:\STXM-data\Cryo-STXM\2017\guest\0201'

1467 #dœ = 
r
'S:\STXM-data\Cryo-STXM\2016\guest\1007\C161007184''

1468 #maš = 
	`CÚùSh“t
(
r
'S:\STXM-data\Cryo-STXM\2016\guest\test')

1469 
maš
 = 
	$CÚùSh“t
(
dœ
)

1470 
maš
.
	$£t_d©a_dœ
(
dœ
)

1471 
maš
.
	$show
()

1472 
maš
.
	`»size
(385, 700)

1474 
sys
.
	`ex™
(
­p
.
	`exec_
())

	@widgets/toolsPanel.py

2 
C»©ed
 
Ú
 
	gS•
 9, 2016

4 @
	gauthÜ
: 
b”gr


6 
impÜt
 
sys


7 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
	guic
, 
	gQtWidg‘s


9 
impÜt
 
	gtime


10 
impÜt
 
	gQueue


11 
impÜt
 
	g©ex™


13 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
bl07ID01
 
impÜt
 
	gMAIN_OBJ
, 
	gPOS_TYPE_BL
, 
	gPOS_TYPE_ES


14 
äom
 
	gşs
.
	g­p_d©a
.
deçuÉs
 
impÜt
 
	grgb_as_hex
, 
	gma¡”_cŞÜs
, 
	gg‘_¡yË


15 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


16 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	gwidg‘s
.
p›zoReÿlib¿‹
 
impÜt
 
	gP›zoReÿlibPª–


17 #äom 
şs
.
ÿWidg‘s
.
ÿLab–Widg‘
 
impÜt
 
assign_aiLab–Widg‘


19 #£tu°
moduË
 
logg”
 
w™h
 
a
  do-
nÙhšg
 
hªdËr


20 
	g_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

23 
şass
 
	$ToŞsPª–
(
QtWidg‘s
.
QWidg‘
):

25 
This
 
is
 
a
 
widg‘
 
th©
 i 
giv’
‡ 
li¡
 
of
 
pv
'shat MUSTƒxist inhe MAIN_OBJ dict‡nd creates Qlabel‡nd ca_aiLabel

26 
—ch


28 :
»tuºs
: 
NÚe


30 
def
 
	$__š™__
(
£lf
):

31 
	`su³r
(
ToŞsPª–
, 
£lf
).
	`__š™__
()

32 
£lf
.
	`£tMšimumSize
(100, 100)

33 
£lf
.
vbox
 = 
QtWidg‘s
.
	`QVBoxLayout
()

34 
£lf
.
vbox
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

35 
£lf
.
vbox
.
	`£tS·cšg
(0)

37 
£lf
.
	`£tLayout
(£lf.
vbox
)

39 
£lf
.
p›zoReÿlWidg‘
 = 
	`P›zoReÿlibPª–
()

40 
£lf
.
	`addWidg‘
(£lf.
p›zoReÿlWidg‘
)

42 
©ex™
.(
£lf
.
Ú_ex™
)

44 
def
 
	$addWidg‘
(
£lf
, 
widg
):

45 
£lf
.
vbox
.
	`addWidg‘
(
widg
)

47 
def
 
	$Ú_ex™
(
£lf
):

49 
·ss


51 
__Çme__
 == '__main__':

53 
	`log_to_qt
()

54 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

55 
wšdow2
 = 
	`ToŞsPª–
()

56 #°ğ
	`P›zoReÿlibPª–
()

57 #wšdow2.
	`addWidg‘
(
p
)

58 
wšdow2
.
	`show
()

59 
­p
.
	`exec_
()

	@widgets/toolsPanel.py

2 
C»©ed
 
Ú
 
	gS•
 9, 2016

4 @
	gauthÜ
: 
b”gr


6 
impÜt
 
sys


7 
äom
 
PyQt5
 
impÜt
 
QtCÜe
, 
	gQtGui
, 
	guic
, 
	gQtWidg‘s


9 
impÜt
 
	gtime


10 
impÜt
 
	gQueue


11 
impÜt
 
	g©ex™


13 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
bl07ID01
 
impÜt
 
	gMAIN_OBJ
, 
	gPOS_TYPE_BL
, 
	gPOS_TYPE_ES


14 
äom
 
	gşs
.
	g­p_d©a
.
deçuÉs
 
impÜt
 
	grgb_as_hex
, 
	gma¡”_cŞÜs
, 
	gg‘_¡yË


15 
äom
 
	gşs
.
	guts
.
log
 
impÜt
 
	gg‘_moduË_logg”
, 
	glog_to_qt


16 
äom
 
	gşs
.
	g­¶iÿtiÚs
.
	gbioXasIM
.
	gwidg‘s
.
p›zoReÿlib¿‹
 
impÜt
 
	gP›zoReÿlibPª–


17 #äom 
şs
.
ÿWidg‘s
.
ÿLab–Widg‘
 
impÜt
 
assign_aiLab–Widg‘


19 #£tu°
moduË
 
logg”
 
w™h
 
a
  do-
nÙhšg
 
hªdËr


20 
	g_logg”
 = 
g‘_moduË_logg”
(
__Çme__
)

23 
şass
 
	$ToŞsPª–
(
QtWidg‘s
.
QWidg‘
):

25 
This
 
is
 
a
 
widg‘
 
th©
 i 
giv’
‡ 
li¡
 
of
 
pv
'shat MUSTƒxist inhe MAIN_OBJ dict‡nd creates Qlabel‡nd ca_aiLabel

26 
—ch


28 :
»tuºs
: 
NÚe


30 
def
 
	$__š™__
(
£lf
):

31 
	`su³r
(
ToŞsPª–
, 
£lf
).
	`__š™__
()

32 
£lf
.
	`£tMšimumSize
(100, 100)

33 
£lf
.
vbox
 = 
QtWidg‘s
.
	`QVBoxLayout
()

34 
£lf
.
vbox
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

35 
£lf
.
vbox
.
	`£tS·cšg
(0)

37 
£lf
.
	`£tLayout
(£lf.
vbox
)

39 
£lf
.
p›zoReÿlWidg‘
 = 
	`P›zoReÿlibPª–
()

40 
£lf
.
	`addWidg‘
(£lf.
p›zoReÿlWidg‘
)

42 
©ex™
.(
£lf
.
Ú_ex™
)

44 
def
 
	$addWidg‘
(
£lf
, 
widg
):

45 
£lf
.
vbox
.
	`addWidg‘
(
widg
)

47 
def
 
	$Ú_ex™
(
£lf
):

49 
·ss


51 
__Çme__
 == '__main__':

53 
	`log_to_qt
()

54 
­p
 = 
QtWidg‘s
.
	`QAµliÿtiÚ
(
sys
.
¬gv
)

55 
wšdow2
 = 
	`ToŞsPª–
()

56 #°ğ
	`P›zoReÿlibPª–
()

57 #wšdow2.
	`addWidg‘
(
p
)

58 
wšdow2
.
	`show
()

59 
­p
.
	`exec_
()

	@widgets/ui/piezoRecal.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #FÜm 
im¶em’tiÚ
 
g’”©ed
 
äom
 
»adšg
 
ui
 
fe
 'piezoRecal.ui'

4 #
#C»©ed: 
Tue
 
S•
 13 11:08:06 2016

5 #by: 
PyQt4
 
UI
 
code
 
g’”©Ü
 4.8.5

6 #
#WARNING! 
AÎ
 
chªges
 
made
 
š
 
this
 
fe
 
wl
 
be
 
lo¡
!

8 
äom
 
PyQt5
 
impÜt
 
	gQtCÜe
, 
	gQtGui


11 #_äomUtf8 = 
QtCÜe
.
QSŒšg
.
äomUtf8


12 #exû± 
A‰ribu‹E¼Ü
:

13 
	g_äomUtf8
 = 
Ïmbda
 
s
: s

15 
şass
 
	$Ui_FÜm
(
objeù
):

16 
def
 
	$£tupUi
(
£lf
, 
FÜm
):

17 
FÜm
.
	`£tObjeùName
(
	`_äomUtf8
("Form"))

18 
FÜm
.
	`»size
(502, 20)

19 
FÜm
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(0, 20))

20 
FÜm
.
	`£tWšdowT™Ë
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "FÜm", 
NÚe
))

21 
£lf
.
v”tiÿlLayout
 = 
QtWidg‘s
.
	`QVBoxLayout
(
FÜm
)

22 
£lf
.
v”tiÿlLayout
.
	`£tS·cšg
(0)

23 
£lf
.
v”tiÿlLayout
.
	`£tSizeCÚ¡¿št
(
QtWidg‘s
.
QLayout
.
S‘NoCÚ¡¿št
)

24 
£lf
.
v”tiÿlLayout
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

25 
£lf
.
v”tiÿlLayout
.
	`£tObjeùName
(
	`_äomUtf8
("verticalLayout"))

26 
£lf
.
hÜizÚlLayout
 = 
QtWidg‘s
.
	`QHBoxLayout
()

27 
£lf
.
hÜizÚlLayout
.
	`£tObjeùName
(
	`_äomUtf8
("horizontalLayout"))

28 
£lf
.
»ûÁ”BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
(
FÜm
)

29 
£lf
.
»ûÁ”BŠ
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(160, 0))

30 
£lf
.
»ûÁ”BŠ
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(16777215, 20))

31 
£lf
.
»ûÁ”BŠ
.
	`£tText
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "Re-ûÁ” FšeX P›zo", 
NÚe
))

32 
£lf
.
»ûÁ”BŠ
.
	`£tObjeùName
(
	`_äomUtf8
("recenterBtn"))

33 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
»ûÁ”BŠ
)

34 
¥aûrI‹m
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(10, 20, QtWidg‘s.
QSizePŞicy
.
Ex·ndšg
, QtWidg‘s.QSizePŞicy.
Mšimum
)

35 
£lf
.
hÜizÚlLayout
.
	`addI‹m
(
¥aûrI‹m
)

36 
£lf
.
posStsLbl
 = 
QtWidg‘s
.
	`QLab–
(
FÜm
)

37 
£lf
.
posStsLbl
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(50, 0))

38 
£lf
.
posStsLbl
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(50, 20))

39 
£lf
.
posStsLbl
.
	`£tText
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "STOPPED", 
NÚe
))

40 
£lf
.
posStsLbl
.
	`£tAlignm’t
(
QtCÜe
.
Qt
.
AlignC’‹r
)

41 
£lf
.
posStsLbl
.
	`£tObjeùName
(
	`_äomUtf8
("posStsLbl"))

42 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
posStsLbl
)

43 
¥aûrI‹m1
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(40, 20, QtWidg‘s.
QSizePŞicy
.
Ex·ndšg
, QtWidg‘s.QSizePŞicy.
Mšimum
)

44 
£lf
.
hÜizÚlLayout
.
	`addI‹m
(
¥aûrI‹m1
)

45 
£lf
.
posFbkLbl
 = 
QtWidg‘s
.
	`QLab–
(
FÜm
)

46 
£lf
.
posFbkLbl
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(80, 17))

47 
£lf
.
posFbkLbl
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(70, 17))

48 
£lf
.
posFbkLbl
.
	`£tBa£Size
(
QtCÜe
.
	`QSize
(0, 0))

49 
·Ë‰e
 = 
QtGui
.
	`QP®‘‹
()

50 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

51 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

52 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

53 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

54 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

55 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

56 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

57 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

58 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Light
, 
brush
)

59 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

60 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

61 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Midlight
, 
brush
)

62 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

63 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

64 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
D¬k
, 
brush
)

65 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

66 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

67 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Mid
, 
brush
)

68 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

69 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

70 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Text
, 
brush
)

71 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

72 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

73 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
BrightText
, 
brush
)

74 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

75 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

76 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

77 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

78 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

79 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Ba£
, 
brush
)

80 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

81 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

82 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

83 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

84 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

85 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Shadow
, 
brush
)

86 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

87 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

88 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

89 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

90 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

91 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

92 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

93 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

94 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

95 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

96 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

97 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

98 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

99 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

100 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

101 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

102 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

103 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Light
, 
brush
)

104 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

105 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

106 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Midlight
, 
brush
)

107 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

108 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

109 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
D¬k
, 
brush
)

110 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

111 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

112 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Mid
, 
brush
)

113 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

114 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

115 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Text
, 
brush
)

116 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

117 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

118 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
BrightText
, 
brush
)

119 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

120 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

121 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

122 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

123 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

124 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Ba£
, 
brush
)

125 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

126 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

127 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

128 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

129 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

130 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Shadow
, 
brush
)

131 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

132 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

133 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

134 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

135 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

136 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

137 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

138 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

139 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

140 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

141 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

142 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

143 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

144 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

145 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

146 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

147 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

148 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Light
, 
brush
)

149 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

150 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

151 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Midlight
, 
brush
)

152 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

153 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

154 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
D¬k
, 
brush
)

155 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

156 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

157 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Mid
, 
brush
)

158 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

159 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

160 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Text
, 
brush
)

161 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

162 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

163 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
BrightText
, 
brush
)

164 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

165 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

166 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

167 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

168 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

169 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Ba£
, 
brush
)

170 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

171 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

172 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

173 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

174 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

175 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Shadow
, 
brush
)

176 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

177 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

178 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

179 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

180 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

181 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

182 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

183 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

184 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

185 
£lf
.
posFbkLbl
.
	`£tP®‘‹
(
·Ë‰e
)

186 
fÚt
 = 
QtGui
.
	`QFÚt
()

187 
fÚt
.
	`£tPoštSize
(8)

188 
fÚt
.
	`£tBŞd
(
True
)

189 
fÚt
.
	`£tWeight
(75)

190 
£lf
.
posFbkLbl
.
	`£tFÚt
(
fÚt
)

191 
£lf
.
posFbkLbl
.
	`£tAutoFlBackground
(
True
)

192 
£lf
.
posFbkLbl
.
	`£tF¿meSh­e
(
QtWidg‘s
.
QF¿me
.
StyËdPª–
)

193 
£lf
.
posFbkLbl
.
	`£tF¿meShadow
(
QtWidg‘s
.
QF¿me
.
Sunk’
)

194 
£lf
.
posFbkLbl
.
	`£tText
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "0.0", 
NÚe
))

195 
£lf
.
posFbkLbl
.
	`£tAlignm’t
(
QtCÜe
.
Qt
.
AlignC’‹r
)

196 
£lf
.
posFbkLbl
.
	`£tObjeùName
(
	`_äomUtf8
("posFbkLbl"))

197 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
posFbkLbl
)

198 
£lf
.
v”tiÿlLayout
.
	`addLayout
(£lf.
hÜizÚlLayout
)

200 
£lf
.
	`»Œª¦©eUi
(
FÜm
)

201 
QtCÜe
.
QM‘aObjeù
.
	`cÚÃùSlÙsByName
(
FÜm
)

203 
def
 
	$»Œª¦©eUi
(
£lf
, 
FÜm
):

204 
·ss


	@widgets/ui/piezoRecal.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #FÜm 
im¶em’tiÚ
 
g’”©ed
 
äom
 
»adšg
 
ui
 
fe
 'piezoRecal.ui'

4 #
#C»©ed: 
Tue
 
S•
 13 11:08:06 2016

5 #by: 
PyQt4
 
UI
 
code
 
g’”©Ü
 4.8.5

6 #
#WARNING! 
AÎ
 
chªges
 
made
 
š
 
this
 
fe
 
wl
 
be
 
lo¡
!

8 
äom
 
PyQt5
 
impÜt
 
	gQtCÜe
, 
	gQtGui


11 #_äomUtf8 = 
QtCÜe
.
QSŒšg
.
äomUtf8


12 #exû± 
A‰ribu‹E¼Ü
:

13 
	g_äomUtf8
 = 
Ïmbda
 
s
: s

15 
şass
 
	$Ui_FÜm
(
objeù
):

16 
def
 
	$£tupUi
(
£lf
, 
FÜm
):

17 
FÜm
.
	`£tObjeùName
(
	`_äomUtf8
("Form"))

18 
FÜm
.
	`»size
(502, 20)

19 
FÜm
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(0, 20))

20 
FÜm
.
	`£tWšdowT™Ë
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "FÜm", 
NÚe
))

21 
£lf
.
v”tiÿlLayout
 = 
QtWidg‘s
.
	`QVBoxLayout
(
FÜm
)

22 
£lf
.
v”tiÿlLayout
.
	`£tS·cšg
(0)

23 
£lf
.
v”tiÿlLayout
.
	`£tSizeCÚ¡¿št
(
QtWidg‘s
.
QLayout
.
S‘NoCÚ¡¿št
)

24 
£lf
.
v”tiÿlLayout
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

25 
£lf
.
v”tiÿlLayout
.
	`£tObjeùName
(
	`_äomUtf8
("verticalLayout"))

26 
£lf
.
hÜizÚlLayout
 = 
QtWidg‘s
.
	`QHBoxLayout
()

27 
£lf
.
hÜizÚlLayout
.
	`£tObjeùName
(
	`_äomUtf8
("horizontalLayout"))

28 
£lf
.
»ûÁ”BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
(
FÜm
)

29 
£lf
.
»ûÁ”BŠ
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(160, 0))

30 
£lf
.
»ûÁ”BŠ
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(16777215, 20))

31 
£lf
.
»ûÁ”BŠ
.
	`£tText
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "Re-ûÁ” FšeX P›zo", 
NÚe
))

32 
£lf
.
»ûÁ”BŠ
.
	`£tObjeùName
(
	`_äomUtf8
("recenterBtn"))

33 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
»ûÁ”BŠ
)

34 
¥aûrI‹m
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(10, 20, QtWidg‘s.
QSizePŞicy
.
Ex·ndšg
, QtWidg‘s.QSizePŞicy.
Mšimum
)

35 
£lf
.
hÜizÚlLayout
.
	`addI‹m
(
¥aûrI‹m
)

36 
£lf
.
posStsLbl
 = 
QtWidg‘s
.
	`QLab–
(
FÜm
)

37 
£lf
.
posStsLbl
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(50, 0))

38 
£lf
.
posStsLbl
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(50, 20))

39 
£lf
.
posStsLbl
.
	`£tText
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "STOPPED", 
NÚe
))

40 
£lf
.
posStsLbl
.
	`£tAlignm’t
(
QtCÜe
.
Qt
.
AlignC’‹r
)

41 
£lf
.
posStsLbl
.
	`£tObjeùName
(
	`_äomUtf8
("posStsLbl"))

42 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
posStsLbl
)

43 
¥aûrI‹m1
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(40, 20, QtWidg‘s.
QSizePŞicy
.
Ex·ndšg
, QtWidg‘s.QSizePŞicy.
Mšimum
)

44 
£lf
.
hÜizÚlLayout
.
	`addI‹m
(
¥aûrI‹m1
)

45 
£lf
.
posFbkLbl
 = 
QtWidg‘s
.
	`QLab–
(
FÜm
)

46 
£lf
.
posFbkLbl
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(80, 17))

47 
£lf
.
posFbkLbl
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(70, 17))

48 
£lf
.
posFbkLbl
.
	`£tBa£Size
(
QtCÜe
.
	`QSize
(0, 0))

49 
·Ë‰e
 = 
QtGui
.
	`QP®‘‹
()

50 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

51 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

52 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

53 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

54 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

55 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

56 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

57 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

58 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Light
, 
brush
)

59 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

60 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

61 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Midlight
, 
brush
)

62 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

63 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

64 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
D¬k
, 
brush
)

65 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

66 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

67 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Mid
, 
brush
)

68 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

69 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

70 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Text
, 
brush
)

71 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

72 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

73 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
BrightText
, 
brush
)

74 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

75 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

76 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

77 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

78 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

79 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Ba£
, 
brush
)

80 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

81 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

82 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

83 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

84 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

85 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Shadow
, 
brush
)

86 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

87 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

88 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

89 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

90 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

91 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

92 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

93 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

94 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

95 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

96 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

97 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

98 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

99 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

100 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

101 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

102 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

103 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Light
, 
brush
)

104 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

105 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

106 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Midlight
, 
brush
)

107 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

108 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

109 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
D¬k
, 
brush
)

110 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

111 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

112 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Mid
, 
brush
)

113 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

114 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

115 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Text
, 
brush
)

116 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

117 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

118 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
BrightText
, 
brush
)

119 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

120 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

121 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

122 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

123 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

124 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Ba£
, 
brush
)

125 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

126 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

127 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

128 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

129 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

130 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Shadow
, 
brush
)

131 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

132 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

133 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

134 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

135 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

136 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

137 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

138 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

139 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

140 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

141 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

142 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

143 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

144 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

145 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

146 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

147 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

148 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Light
, 
brush
)

149 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

150 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

151 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Midlight
, 
brush
)

152 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

153 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

154 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
D¬k
, 
brush
)

155 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

156 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

157 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Mid
, 
brush
)

158 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

159 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

160 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Text
, 
brush
)

161 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

162 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

163 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
BrightText
, 
brush
)

164 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

165 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

166 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

167 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

168 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

169 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Ba£
, 
brush
)

170 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

171 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

172 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

173 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

174 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

175 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Shadow
, 
brush
)

176 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

177 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

178 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

179 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

180 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

181 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

182 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

183 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

184 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

185 
£lf
.
posFbkLbl
.
	`£tP®‘‹
(
·Ë‰e
)

186 
fÚt
 = 
QtGui
.
	`QFÚt
()

187 
fÚt
.
	`£tPoštSize
(8)

188 
fÚt
.
	`£tBŞd
(
True
)

189 
fÚt
.
	`£tWeight
(75)

190 
£lf
.
posFbkLbl
.
	`£tFÚt
(
fÚt
)

191 
£lf
.
posFbkLbl
.
	`£tAutoFlBackground
(
True
)

192 
£lf
.
posFbkLbl
.
	`£tF¿meSh­e
(
QtWidg‘s
.
QF¿me
.
StyËdPª–
)

193 
£lf
.
posFbkLbl
.
	`£tF¿meShadow
(
QtWidg‘s
.
QF¿me
.
Sunk’
)

194 
£lf
.
posFbkLbl
.
	`£tText
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "0.0", 
NÚe
))

195 
£lf
.
posFbkLbl
.
	`£tAlignm’t
(
QtCÜe
.
Qt
.
AlignC’‹r
)

196 
£lf
.
posFbkLbl
.
	`£tObjeùName
(
	`_äomUtf8
("posFbkLbl"))

197 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
posFbkLbl
)

198 
£lf
.
v”tiÿlLayout
.
	`addLayout
(£lf.
hÜizÚlLayout
)

200 
£lf
.
	`»Œª¦©eUi
(
FÜm
)

201 
QtCÜe
.
QM‘aObjeù
.
	`cÚÃùSlÙsByName
(
FÜm
)

203 
def
 
	$»Œª¦©eUi
(
£lf
, 
FÜm
):

204 
·ss


	@widgets/ui/piezo_recal.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #FÜm 
im¶em’tiÚ
 
g’”©ed
 
äom
 
»adšg
 
ui
 
fe
 'piezoRecal.ui'

4 #
#C»©ed: 
Tue
 
S•
 13 11:08:30 2016

5 #by: 
PyQt4
 
UI
 
code
 
g’”©Ü
 4.8.5

6 #
#WARNING! 
AÎ
 
chªges
 
made
 
š
 
this
 
fe
 
wl
 
be
 
lo¡
!

8 
äom
 
PyQt5
 
impÜt
 
	gQtCÜe
, 
	gQtGui


11 #_äomUtf8 = 
QtCÜe
.
QSŒšg
.
äomUtf8


12 #exû± 
A‰ribu‹E¼Ü
:

13 
	g_äomUtf8
 = 
Ïmbda
 
s
: s

15 
şass
 
	$Ui_FÜm
(
objeù
):

16 
def
 
	$£tupUi
(
£lf
, 
FÜm
):

17 
FÜm
.
	`£tObjeùName
(
	`_äomUtf8
("Form"))

18 
FÜm
.
	`»size
(502, 20)

19 
FÜm
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(0, 20))

20 
FÜm
.
	`£tWšdowT™Ë
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "FÜm", 
NÚe
))

21 
£lf
.
v”tiÿlLayout
 = 
QtWidg‘s
.
	`QVBoxLayout
(
FÜm
)

22 
£lf
.
v”tiÿlLayout
.
	`£tS·cšg
(0)

23 
£lf
.
v”tiÿlLayout
.
	`£tSizeCÚ¡¿št
(
QtWidg‘s
.
QLayout
.
S‘NoCÚ¡¿št
)

24 
£lf
.
v”tiÿlLayout
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

25 
£lf
.
v”tiÿlLayout
.
	`£tObjeùName
(
	`_äomUtf8
("verticalLayout"))

26 
£lf
.
hÜizÚlLayout
 = 
QtWidg‘s
.
	`QHBoxLayout
()

27 
£lf
.
hÜizÚlLayout
.
	`£tObjeùName
(
	`_äomUtf8
("horizontalLayout"))

28 
£lf
.
»ûÁ”BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
(
FÜm
)

29 
£lf
.
»ûÁ”BŠ
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(160, 0))

30 
£lf
.
»ûÁ”BŠ
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(16777215, 20))

31 
£lf
.
»ûÁ”BŠ
.
	`£tText
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "Re-ûÁ” FšeX P›zo", 
NÚe
))

32 
£lf
.
»ûÁ”BŠ
.
	`£tObjeùName
(
	`_äomUtf8
("recenterBtn"))

33 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
»ûÁ”BŠ
)

34 
¥aûrI‹m
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(10, 20, QtWidg‘s.
QSizePŞicy
.
Ex·ndšg
, QtWidg‘s.QSizePŞicy.
Mšimum
)

35 
£lf
.
hÜizÚlLayout
.
	`addI‹m
(
¥aûrI‹m
)

36 
£lf
.
posStsLbl
 = 
QtWidg‘s
.
	`QLab–
(
FÜm
)

37 
£lf
.
posStsLbl
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(50, 0))

38 
£lf
.
posStsLbl
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(50, 20))

39 
£lf
.
posStsLbl
.
	`£tText
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "STOPPED", 
NÚe
))

40 
£lf
.
posStsLbl
.
	`£tAlignm’t
(
QtCÜe
.
Qt
.
AlignC’‹r
)

41 
£lf
.
posStsLbl
.
	`£tObjeùName
(
	`_äomUtf8
("posStsLbl"))

42 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
posStsLbl
)

43 
¥aûrI‹m1
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(40, 20, QtWidg‘s.
QSizePŞicy
.
Ex·ndšg
, QtWidg‘s.QSizePŞicy.
Mšimum
)

44 
£lf
.
hÜizÚlLayout
.
	`addI‹m
(
¥aûrI‹m1
)

45 
£lf
.
posFbkLbl
 = 
QtWidg‘s
.
	`QLab–
(
FÜm
)

46 
£lf
.
posFbkLbl
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(80, 17))

47 
£lf
.
posFbkLbl
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(70, 17))

48 
£lf
.
posFbkLbl
.
	`£tBa£Size
(
QtCÜe
.
	`QSize
(0, 0))

49 
·Ë‰e
 = 
QtGui
.
	`QP®‘‹
()

50 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

51 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

52 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

53 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

54 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

55 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

56 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

57 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

58 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Light
, 
brush
)

59 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

60 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

61 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Midlight
, 
brush
)

62 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

63 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

64 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
D¬k
, 
brush
)

65 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

66 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

67 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Mid
, 
brush
)

68 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

69 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

70 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Text
, 
brush
)

71 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

72 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

73 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
BrightText
, 
brush
)

74 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

75 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

76 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

77 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

78 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

79 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Ba£
, 
brush
)

80 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

81 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

82 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

83 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

84 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

85 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Shadow
, 
brush
)

86 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

87 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

88 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

89 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

90 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

91 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

92 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

93 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

94 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

95 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

96 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

97 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

98 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

99 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

100 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

101 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

102 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

103 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Light
, 
brush
)

104 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

105 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

106 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Midlight
, 
brush
)

107 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

108 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

109 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
D¬k
, 
brush
)

110 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

111 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

112 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Mid
, 
brush
)

113 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

114 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

115 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Text
, 
brush
)

116 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

117 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

118 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
BrightText
, 
brush
)

119 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

120 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

121 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

122 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

123 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

124 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Ba£
, 
brush
)

125 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

126 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

127 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

128 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

129 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

130 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Shadow
, 
brush
)

131 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

132 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

133 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

134 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

135 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

136 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

137 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

138 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

139 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

140 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

141 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

142 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

143 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

144 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

145 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

146 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

147 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

148 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Light
, 
brush
)

149 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

150 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

151 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Midlight
, 
brush
)

152 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

153 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

154 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
D¬k
, 
brush
)

155 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

156 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

157 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Mid
, 
brush
)

158 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

159 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

160 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Text
, 
brush
)

161 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

162 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

163 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
BrightText
, 
brush
)

164 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

165 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

166 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

167 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

168 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

169 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Ba£
, 
brush
)

170 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

171 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

172 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

173 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

174 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

175 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Shadow
, 
brush
)

176 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

177 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

178 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

179 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

180 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

181 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

182 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

183 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

184 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

185 
£lf
.
posFbkLbl
.
	`£tP®‘‹
(
·Ë‰e
)

186 
fÚt
 = 
QtGui
.
	`QFÚt
()

187 
fÚt
.
	`£tPoštSize
(8)

188 
fÚt
.
	`£tBŞd
(
True
)

189 
fÚt
.
	`£tWeight
(75)

190 
£lf
.
posFbkLbl
.
	`£tFÚt
(
fÚt
)

191 
£lf
.
posFbkLbl
.
	`£tAutoFlBackground
(
True
)

192 
£lf
.
posFbkLbl
.
	`£tF¿meSh­e
(
QtWidg‘s
.
QF¿me
.
StyËdPª–
)

193 
£lf
.
posFbkLbl
.
	`£tF¿meShadow
(
QtWidg‘s
.
QF¿me
.
Sunk’
)

194 
£lf
.
posFbkLbl
.
	`£tText
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "0.0", 
NÚe
))

195 
£lf
.
posFbkLbl
.
	`£tAlignm’t
(
QtCÜe
.
Qt
.
AlignC’‹r
)

196 
£lf
.
posFbkLbl
.
	`£tObjeùName
(
	`_äomUtf8
("posFbkLbl"))

197 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
posFbkLbl
)

198 
£lf
.
v”tiÿlLayout
.
	`addLayout
(£lf.
hÜizÚlLayout
)

200 
£lf
.
	`»Œª¦©eUi
(
FÜm
)

201 
QtCÜe
.
QM‘aObjeù
.
	`cÚÃùSlÙsByName
(
FÜm
)

203 
def
 
	$»Œª¦©eUi
(
£lf
, 
FÜm
):

204 
·ss


	@widgets/ui/piezo_recal.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #FÜm 
im¶em’tiÚ
 
g’”©ed
 
äom
 
»adšg
 
ui
 
fe
 'piezoRecal.ui'

4 #
#C»©ed: 
Tue
 
S•
 13 11:08:30 2016

5 #by: 
PyQt4
 
UI
 
code
 
g’”©Ü
 4.8.5

6 #
#WARNING! 
AÎ
 
chªges
 
made
 
š
 
this
 
fe
 
wl
 
be
 
lo¡
!

8 
äom
 
PyQt5
 
impÜt
 
	gQtCÜe
, 
	gQtGui


11 #_äomUtf8 = 
QtCÜe
.
QSŒšg
.
äomUtf8


12 #exû± 
A‰ribu‹E¼Ü
:

13 
	g_äomUtf8
 = 
Ïmbda
 
s
: s

15 
şass
 
	$Ui_FÜm
(
objeù
):

16 
def
 
	$£tupUi
(
£lf
, 
FÜm
):

17 
FÜm
.
	`£tObjeùName
(
	`_äomUtf8
("Form"))

18 
FÜm
.
	`»size
(502, 20)

19 
FÜm
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(0, 20))

20 
FÜm
.
	`£tWšdowT™Ë
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "FÜm", 
NÚe
))

21 
£lf
.
v”tiÿlLayout
 = 
QtWidg‘s
.
	`QVBoxLayout
(
FÜm
)

22 
£lf
.
v”tiÿlLayout
.
	`£tS·cšg
(0)

23 
£lf
.
v”tiÿlLayout
.
	`£tSizeCÚ¡¿št
(
QtWidg‘s
.
QLayout
.
S‘NoCÚ¡¿št
)

24 
£lf
.
v”tiÿlLayout
.
	`£tCÚ‹ÁsM¬gšs
(0,0,0,0)

25 
£lf
.
v”tiÿlLayout
.
	`£tObjeùName
(
	`_äomUtf8
("verticalLayout"))

26 
£lf
.
hÜizÚlLayout
 = 
QtWidg‘s
.
	`QHBoxLayout
()

27 
£lf
.
hÜizÚlLayout
.
	`£tObjeùName
(
	`_äomUtf8
("horizontalLayout"))

28 
£lf
.
»ûÁ”BŠ
 = 
QtWidg‘s
.
	`QPushBu‰Ú
(
FÜm
)

29 
£lf
.
»ûÁ”BŠ
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(160, 0))

30 
£lf
.
»ûÁ”BŠ
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(16777215, 20))

31 
£lf
.
»ûÁ”BŠ
.
	`£tText
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "Re-ûÁ” FšeX P›zo", 
NÚe
))

32 
£lf
.
»ûÁ”BŠ
.
	`£tObjeùName
(
	`_äomUtf8
("recenterBtn"))

33 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
»ûÁ”BŠ
)

34 
¥aûrI‹m
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(10, 20, QtWidg‘s.
QSizePŞicy
.
Ex·ndšg
, QtWidg‘s.QSizePŞicy.
Mšimum
)

35 
£lf
.
hÜizÚlLayout
.
	`addI‹m
(
¥aûrI‹m
)

36 
£lf
.
posStsLbl
 = 
QtWidg‘s
.
	`QLab–
(
FÜm
)

37 
£lf
.
posStsLbl
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(50, 0))

38 
£lf
.
posStsLbl
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(50, 20))

39 
£lf
.
posStsLbl
.
	`£tText
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "STOPPED", 
NÚe
))

40 
£lf
.
posStsLbl
.
	`£tAlignm’t
(
QtCÜe
.
Qt
.
AlignC’‹r
)

41 
£lf
.
posStsLbl
.
	`£tObjeùName
(
	`_äomUtf8
("posStsLbl"))

42 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
posStsLbl
)

43 
¥aûrI‹m1
 = 
QtWidg‘s
.
	`QS·ûrI‹m
(40, 20, QtWidg‘s.
QSizePŞicy
.
Ex·ndšg
, QtWidg‘s.QSizePŞicy.
Mšimum
)

44 
£lf
.
hÜizÚlLayout
.
	`addI‹m
(
¥aûrI‹m1
)

45 
£lf
.
posFbkLbl
 = 
QtWidg‘s
.
	`QLab–
(
FÜm
)

46 
£lf
.
posFbkLbl
.
	`£tMšimumSize
(
QtCÜe
.
	`QSize
(80, 17))

47 
£lf
.
posFbkLbl
.
	`£tMaximumSize
(
QtCÜe
.
	`QSize
(70, 17))

48 
£lf
.
posFbkLbl
.
	`£tBa£Size
(
QtCÜe
.
	`QSize
(0, 0))

49 
·Ë‰e
 = 
QtGui
.
	`QP®‘‹
()

50 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

51 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

52 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

53 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

54 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

55 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

56 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

57 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

58 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Light
, 
brush
)

59 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

60 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

61 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Midlight
, 
brush
)

62 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

63 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

64 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
D¬k
, 
brush
)

65 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

66 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

67 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Mid
, 
brush
)

68 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

69 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

70 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Text
, 
brush
)

71 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

72 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

73 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
BrightText
, 
brush
)

74 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

75 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

76 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

77 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

78 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

79 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Ba£
, 
brush
)

80 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

81 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

82 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

83 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

84 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

85 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
Shadow
, 
brush
)

86 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

87 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

88 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

89 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

90 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

91 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

92 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

93 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

94 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Aùive
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

95 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

96 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

97 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

98 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

99 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

100 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

101 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

102 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

103 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Light
, 
brush
)

104 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

105 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

106 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Midlight
, 
brush
)

107 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

108 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

109 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
D¬k
, 
brush
)

110 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

111 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

112 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Mid
, 
brush
)

113 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

114 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

115 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Text
, 
brush
)

116 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

117 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

118 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
BrightText
, 
brush
)

119 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

120 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

121 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

122 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

123 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

124 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Ba£
, 
brush
)

125 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

126 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

127 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

128 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

129 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

130 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
Shadow
, 
brush
)

131 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

132 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

133 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

134 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

135 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

136 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

137 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

138 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

139 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
IÇùive
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

140 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

141 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

142 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
WšdowText
, 
brush
)

143 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

144 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

145 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Bu‰Ú
, 
brush
)

146 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

147 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

148 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Light
, 
brush
)

149 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(235, 235, 235))

150 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

151 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Midlight
, 
brush
)

152 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

153 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

154 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
D¬k
, 
brush
)

155 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(144, 144, 144))

156 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

157 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Mid
, 
brush
)

158 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

159 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

160 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Text
, 
brush
)

161 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 255))

162 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

163 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
BrightText
, 
brush
)

164 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(108, 108, 108))

165 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

166 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Bu‰ÚText
, 
brush
)

167 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

168 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

169 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Ba£
, 
brush
)

170 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

171 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

172 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Wšdow
, 
brush
)

173 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

174 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

175 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
Shadow
, 
brush
)

176 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(216, 216, 216))

177 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

178 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
AÉ”Ç‹Ba£
, 
brush
)

179 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(255, 255, 220))

180 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

181 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
ToŞTBa£
, 
brush
)

182 
brush
 = 
QtGui
.
	`QBrush
(QtGui.
	`QCŞÜ
(0, 0, 0))

183 
brush
.
	`£tStyË
(
QtCÜe
.
Qt
.
SŞidP©‹º
)

184 
·Ë‰e
.
	`£tBrush
(
QtGui
.
QP®‘‹
.
Di§bËd
, QtGui.QP®‘‹.
ToŞTText
, 
brush
)

185 
£lf
.
posFbkLbl
.
	`£tP®‘‹
(
·Ë‰e
)

186 
fÚt
 = 
QtGui
.
	`QFÚt
()

187 
fÚt
.
	`£tPoštSize
(8)

188 
fÚt
.
	`£tBŞd
(
True
)

189 
fÚt
.
	`£tWeight
(75)

190 
£lf
.
posFbkLbl
.
	`£tFÚt
(
fÚt
)

191 
£lf
.
posFbkLbl
.
	`£tAutoFlBackground
(
True
)

192 
£lf
.
posFbkLbl
.
	`£tF¿meSh­e
(
QtWidg‘s
.
QF¿me
.
StyËdPª–
)

193 
£lf
.
posFbkLbl
.
	`£tF¿meShadow
(
QtWidg‘s
.
QF¿me
.
Sunk’
)

194 
£lf
.
posFbkLbl
.
	`£tText
(
QtWidg‘s
.
QAµliÿtiÚ
.
	`Œª¦©e
("FÜm", "0.0", 
NÚe
))

195 
£lf
.
posFbkLbl
.
	`£tAlignm’t
(
QtCÜe
.
Qt
.
AlignC’‹r
)

196 
£lf
.
posFbkLbl
.
	`£tObjeùName
(
	`_äomUtf8
("posFbkLbl"))

197 
£lf
.
hÜizÚlLayout
.
	`addWidg‘
(£lf.
posFbkLbl
)

198 
£lf
.
v”tiÿlLayout
.
	`addLayout
(£lf.
hÜizÚlLayout
)

200 
£lf
.
	`»Œª¦©eUi
(
FÜm
)

201 
QtCÜe
.
QM‘aObjeù
.
	`cÚÃùSlÙsByName
(
FÜm
)

203 
def
 
	$»Œª¦©eUi
(
£lf
, 
FÜm
):

204 
·ss


	@
1
.
1
/usr/include
98
2801
__init__.py
__init__.py
app.ini
bioMain.py
bioMain.py
bioxas_user.py
bioxas_user.py
bl07ID01.py
bl07ID01.py
counters.ini
data/__init__.py
data/__init__.py
data/bioxas_im_data_io.py
data/bioxas_im_data_io.py
device_names.py
device_names.py
init_qt.py
init_qt.py
scan_plugins/DetectorSSCAN.py
scan_plugins/DetectorSSCAN.py
scan_plugins/__init__.py
scan_plugins/__init__.py
scan_plugins/det_scan.py
scan_plugins/det_scan.py
scan_plugins/scandata_categories.py
scan_plugins/scandata_categories.py
setup_env.py
setup_env.py
ui/__init__.py
ui/__init__.py
widgets/__init__.py
widgets/__init__.py
widgets/camera_ruler.py
widgets/camera_ruler.py
widgets/detectorsPanel.py
widgets/detectorsPanel.py
widgets/energy_selection.py
widgets/energy_selection.py
widgets/energy_selection_v1.py
widgets/energy_selection_v1.py
widgets/fbk.py
widgets/fbk.py
widgets/focusAndZoneplateParms.py
widgets/focusAndZoneplateParms.py
widgets/motorPanel.py
widgets/motorPanel.py
widgets/paramLineEdit.py
widgets/paramLineEdit.py
widgets/piezoRecalibrate.py
widgets/piezoRecalibrate.py
widgets/piezo_recal.py
widgets/piezo_recal.py
widgets/prog_dict_utils.py
widgets/prog_dict_utils.py
widgets/pvDisplayPanel.py
widgets/pvDisplayPanel.py
widgets/sampleSelector.py
widgets/sampleSelector.py
widgets/scan_queue_table.py
widgets/scan_queue_table.py
widgets/scan_table_view/__init__.py
widgets/scan_table_view/__init__.py
widgets/scan_table_view/a0_pointSpecWidget.py
widgets/scan_table_view/a0_pointSpecWidget.py
widgets/scan_table_view/arbitraryLineTableModel.py
widgets/scan_table_view/arbitraryLineTableModel.py
widgets/scan_table_view/baseScanTable.py
widgets/scan_table_view/baseScanTable.py
widgets/scan_table_view/evScanTableModel.py
widgets/scan_table_view/evScanTableModel.py
widgets/scan_table_view/evScanTableView.py
widgets/scan_table_view/evScanTableView.py
widgets/scan_table_view/evSelWidget.py
widgets/scan_table_view/evSelWidget.py
widgets/scan_table_view/multiRegionWidget.py
widgets/scan_table_view/multiRegionWidget.py
widgets/scan_table_view/polarityCmboBoxDelegate.py
widgets/scan_table_view/polarityCmboBoxDelegate.py
widgets/scan_table_view/polaritySelWidget.py
widgets/scan_table_view/polaritySelWidget.py
widgets/scan_table_view/polarityTableModel.py
widgets/scan_table_view/polarityTableModel.py
widgets/scan_table_view/polarityTableView.py
widgets/scan_table_view/polarityTableView.py
widgets/scan_table_view/spatialSelWidget.py
widgets/scan_table_view/spatialSelWidget.py
widgets/scan_table_view/spatialTableView.py
widgets/scan_table_view/spatialTableView.py
widgets/spfbk_small.py
widgets/spfbk_small.py
widgets/thumbnailViewer.py
widgets/thumbnailViewer.py
widgets/toolsPanel.py
widgets/toolsPanel.py
widgets/ui/piezoRecal.py
widgets/ui/piezoRecal.py
widgets/ui/piezo_recal.py
widgets/ui/piezo_recal.py
